<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Algebra.Construct.LexProduct.Base</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- The Agda standard library</a>
<a id="103" class="Comment">--</a>
<a id="106" class="Comment">-- Definitions of the lexicographic product of two operators.</a>
<a id="168" class="Comment">------------------------------------------------------------------------</a>

<a id="242" class="Symbol">{-#</a> <a id="246" class="Keyword">OPTIONS</a> <a id="254" class="Pragma">--without-K</a> <a id="266" class="Pragma">--safe</a> <a id="273" class="Symbol">#-}</a>

<a id="278" class="Keyword">open</a> <a id="283" class="Keyword">import</a> <a id="290" href="Algebra.Core.html" class="Module">Algebra.Core</a> <a id="303" class="Keyword">using</a> <a id="309" class="Symbol">(</a><a id="310" href="Algebra.Core.html#518" class="Function">Op₂</a><a id="313" class="Symbol">)</a>
<a id="315" class="Keyword">open</a> <a id="320" class="Keyword">import</a> <a id="327" href="Data.Bool.Base.html" class="Module">Data.Bool.Base</a> <a id="342" class="Keyword">using</a> <a id="348" class="Symbol">(</a><a id="349" href="Agda.Builtin.Bool.html#188" class="InductiveConstructor">true</a><a id="353" class="Symbol">;</a> <a id="355" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">false</a><a id="360" class="Symbol">)</a>
<a id="362" class="Keyword">open</a> <a id="367" class="Keyword">import</a> <a id="374" href="Data.Product.html" class="Module">Data.Product</a> <a id="387" class="Keyword">using</a> <a id="393" class="Symbol">(</a><a id="394" href="Data.Product.Base.html#1109" class="Function Operator">_×_</a><a id="397" class="Symbol">;</a> <a id="399" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">_,_</a><a id="402" class="Symbol">)</a>
<a id="404" class="Keyword">open</a> <a id="409" class="Keyword">import</a> <a id="416" href="Relation.Binary.Core.html" class="Module">Relation.Binary.Core</a> <a id="437" class="Keyword">using</a> <a id="443" class="Symbol">(</a><a id="444" href="Relation.Binary.Core.html#882" class="Function">Rel</a><a id="447" class="Symbol">)</a>
<a id="449" class="Keyword">open</a> <a id="454" class="Keyword">import</a> <a id="461" href="Relation.Binary.Definitions.html" class="Module">Relation.Binary.Definitions</a> <a id="489" class="Keyword">using</a> <a id="495" class="Symbol">(</a><a id="496" href="Relation.Binary.Definitions.html#5900" class="Function">Decidable</a><a id="505" class="Symbol">)</a>
<a id="507" class="Keyword">open</a> <a id="512" class="Keyword">import</a> <a id="519" href="Relation.Nullary.Decidable.html" class="Module">Relation.Nullary.Decidable</a> <a id="546" class="Keyword">using</a> <a id="552" class="Symbol">(</a><a id="553" href="Relation.Nullary.Decidable.Core.html#1546" class="Field">does</a><a id="557" class="Symbol">;</a> <a id="559" href="Relation.Nullary.Decidable.Core.html#1613" class="InductiveConstructor">yes</a><a id="562" class="Symbol">;</a> <a id="564" href="Relation.Nullary.Decidable.Core.html#1650" class="InductiveConstructor">no</a><a id="566" class="Symbol">)</a>

<a id="569" class="Keyword">module</a> <a id="576" href="Algebra.Construct.LexProduct.Base.html" class="Module">Algebra.Construct.LexProduct.Base</a>
  <a id="612" class="Symbol">{</a><a id="613" href="Algebra.Construct.LexProduct.Base.html#613" class="Bound">a</a> <a id="615" href="Algebra.Construct.LexProduct.Base.html#615" class="Bound">b</a> <a id="617" href="Algebra.Construct.LexProduct.Base.html#617" class="Bound">ℓ</a><a id="618" class="Symbol">}</a> <a id="620" class="Symbol">{</a><a id="621" href="Algebra.Construct.LexProduct.Base.html#621" class="Bound">A</a> <a id="623" class="Symbol">:</a> <a id="625" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="629" href="Algebra.Construct.LexProduct.Base.html#613" class="Bound">a</a><a id="630" class="Symbol">}</a> <a id="632" class="Symbol">{</a><a id="633" href="Algebra.Construct.LexProduct.Base.html#633" class="Bound">B</a> <a id="635" class="Symbol">:</a> <a id="637" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="641" href="Algebra.Construct.LexProduct.Base.html#615" class="Bound">b</a><a id="642" class="Symbol">}</a>
  <a id="646" class="Symbol">(</a><a id="647" href="Algebra.Construct.LexProduct.Base.html#647" class="Bound Operator">_∙_</a> <a id="651" class="Symbol">:</a> <a id="653" href="Algebra.Core.html#518" class="Function">Op₂</a> <a id="657" href="Algebra.Construct.LexProduct.Base.html#621" class="Bound">A</a><a id="658" class="Symbol">)</a> <a id="660" class="Symbol">(</a><a id="661" href="Algebra.Construct.LexProduct.Base.html#661" class="Bound Operator">_◦_</a> <a id="665" class="Symbol">:</a> <a id="667" href="Algebra.Core.html#518" class="Function">Op₂</a> <a id="671" href="Algebra.Construct.LexProduct.Base.html#633" class="Bound">B</a><a id="672" class="Symbol">)</a>
  <a id="676" class="Symbol">{</a><a id="677" href="Algebra.Construct.LexProduct.Base.html#677" class="Bound Operator">_≈₁_</a> <a id="682" class="Symbol">:</a> <a id="684" href="Relation.Binary.Core.html#882" class="Function">Rel</a> <a id="688" href="Algebra.Construct.LexProduct.Base.html#621" class="Bound">A</a> <a id="690" href="Algebra.Construct.LexProduct.Base.html#617" class="Bound">ℓ</a><a id="691" class="Symbol">}</a> <a id="693" class="Symbol">(</a><a id="694" href="Algebra.Construct.LexProduct.Base.html#694" class="Bound Operator">_≟₁_</a> <a id="699" class="Symbol">:</a> <a id="701" href="Relation.Binary.Definitions.html#5900" class="Function">Decidable</a> <a id="711" href="Algebra.Construct.LexProduct.Base.html#677" class="Bound Operator">_≈₁_</a><a id="715" class="Symbol">)</a>
  <a id="719" class="Keyword">where</a>

<a id="726" class="Comment">------------------------------------------------------------------------</a>
<a id="799" class="Comment">-- Definition</a>

<a id="814" class="Comment">-- In order to get the first component to be definitionally equal to</a>
<a id="883" class="Comment">-- `a ∙ b` and to simplify some of the proofs we first define an inner</a>
<a id="954" class="Comment">-- operator that only calculates the second component of product.</a>

<a id="innerLex"></a><a id="1021" href="Algebra.Construct.LexProduct.Base.html#1021" class="Function">innerLex</a> <a id="1030" class="Symbol">:</a> <a id="1032" href="Algebra.Construct.LexProduct.Base.html#621" class="Bound">A</a> <a id="1034" class="Symbol">→</a> <a id="1036" href="Algebra.Construct.LexProduct.Base.html#621" class="Bound">A</a> <a id="1038" class="Symbol">→</a> <a id="1040" href="Algebra.Construct.LexProduct.Base.html#633" class="Bound">B</a> <a id="1042" class="Symbol">→</a> <a id="1044" href="Algebra.Construct.LexProduct.Base.html#633" class="Bound">B</a> <a id="1046" class="Symbol">→</a> <a id="1048" href="Algebra.Construct.LexProduct.Base.html#633" class="Bound">B</a>
<a id="1050" href="Algebra.Construct.LexProduct.Base.html#1021" class="Function">innerLex</a> <a id="1059" href="Algebra.Construct.LexProduct.Base.html#1059" class="Bound">a</a> <a id="1061" href="Algebra.Construct.LexProduct.Base.html#1061" class="Bound">b</a> <a id="1063" href="Algebra.Construct.LexProduct.Base.html#1063" class="Bound">x</a> <a id="1065" href="Algebra.Construct.LexProduct.Base.html#1065" class="Bound">y</a> <a id="1067" class="Keyword">with</a> <a id="1072" href="Relation.Nullary.Decidable.Core.html#1546" class="Field">does</a> <a id="1077" class="Symbol">((</a><a id="1079" href="Algebra.Construct.LexProduct.Base.html#1059" class="Bound">a</a> <a id="1081" href="Algebra.Construct.LexProduct.Base.html#647" class="Bound Operator">∙</a> <a id="1083" href="Algebra.Construct.LexProduct.Base.html#1061" class="Bound">b</a><a id="1084" class="Symbol">)</a> <a id="1086" href="Algebra.Construct.LexProduct.Base.html#694" class="Bound Operator">≟₁</a> <a id="1089" href="Algebra.Construct.LexProduct.Base.html#1059" class="Bound">a</a><a id="1090" class="Symbol">)</a> <a id="1092" class="Symbol">|</a> <a id="1094" href="Relation.Nullary.Decidable.Core.html#1546" class="Field">does</a> <a id="1099" class="Symbol">((</a><a id="1101" href="Algebra.Construct.LexProduct.Base.html#1059" class="Bound">a</a> <a id="1103" href="Algebra.Construct.LexProduct.Base.html#647" class="Bound Operator">∙</a> <a id="1105" href="Algebra.Construct.LexProduct.Base.html#1061" class="Bound">b</a><a id="1106" class="Symbol">)</a> <a id="1108" href="Algebra.Construct.LexProduct.Base.html#694" class="Bound Operator">≟₁</a> <a id="1111" href="Algebra.Construct.LexProduct.Base.html#1061" class="Bound">b</a><a id="1112" class="Symbol">)</a>
<a id="1114" class="Symbol">...</a> <a id="1118" class="Symbol">|</a> <a id="1120" href="Agda.Builtin.Bool.html#188" class="InductiveConstructor">true</a>  <a id="1126" class="Symbol">|</a> <a id="1128" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">false</a> <a id="1134" class="Symbol">=</a> <a id="1136" class="Bound">x</a>
<a id="1138" class="Symbol">...</a> <a id="1142" class="Symbol">|</a> <a id="1144" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">false</a> <a id="1150" class="Symbol">|</a> <a id="1152" href="Agda.Builtin.Bool.html#188" class="InductiveConstructor">true</a>  <a id="1158" class="Symbol">=</a> <a id="1160" class="Bound">y</a>
<a id="1162" class="CatchallClause Symbol">...</a><a id="1165" class="CatchallClause"> </a><a id="1166" class="CatchallClause Symbol">|</a><a id="1167" class="CatchallClause">     </a><a id="1172" class="CatchallClause Symbol">_</a><a id="1173" class="CatchallClause"> </a><a id="1174" class="CatchallClause Symbol">|</a><a id="1175" class="CatchallClause">     </a><a id="1180" class="CatchallClause Symbol">_</a> <a id="1182" class="Symbol">=</a> <a id="1184" class="Bound">x</a> <a id="1186" href="Algebra.Construct.LexProduct.Base.html#661" class="Bound Operator">◦</a> <a id="1188" class="Bound">y</a>

<a id="1191" class="Comment">-- The full lexicographic choice operator can then be simply defined</a>
<a id="1260" class="Comment">-- in terms of the inner one.</a>

<a id="lex"></a><a id="1291" href="Algebra.Construct.LexProduct.Base.html#1291" class="Function">lex</a> <a id="1295" class="Symbol">:</a> <a id="1297" href="Algebra.Core.html#518" class="Function">Op₂</a> <a id="1301" class="Symbol">(</a><a id="1302" href="Algebra.Construct.LexProduct.Base.html#621" class="Bound">A</a> <a id="1304" href="Data.Product.Base.html#1109" class="Function Operator">×</a> <a id="1306" href="Algebra.Construct.LexProduct.Base.html#633" class="Bound">B</a><a id="1307" class="Symbol">)</a>
<a id="1309" href="Algebra.Construct.LexProduct.Base.html#1291" class="Function">lex</a> <a id="1313" class="Symbol">(</a><a id="1314" href="Algebra.Construct.LexProduct.Base.html#1314" class="Bound">a</a> <a id="1316" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1318" href="Algebra.Construct.LexProduct.Base.html#1318" class="Bound">x</a><a id="1319" class="Symbol">)</a> <a id="1321" class="Symbol">(</a><a id="1322" href="Algebra.Construct.LexProduct.Base.html#1322" class="Bound">b</a> <a id="1324" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1326" href="Algebra.Construct.LexProduct.Base.html#1326" class="Bound">y</a><a id="1327" class="Symbol">)</a> <a id="1329" class="Symbol">=</a> <a id="1331" class="Symbol">(</a><a id="1332" href="Algebra.Construct.LexProduct.Base.html#1314" class="Bound">a</a> <a id="1334" href="Algebra.Construct.LexProduct.Base.html#647" class="Bound Operator">∙</a> <a id="1336" href="Algebra.Construct.LexProduct.Base.html#1322" class="Bound">b</a> <a id="1338" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1340" href="Algebra.Construct.LexProduct.Base.html#1021" class="Function">innerLex</a> <a id="1349" href="Algebra.Construct.LexProduct.Base.html#1314" class="Bound">a</a> <a id="1351" href="Algebra.Construct.LexProduct.Base.html#1322" class="Bound">b</a> <a id="1353" href="Algebra.Construct.LexProduct.Base.html#1318" class="Bound">x</a> <a id="1355" href="Algebra.Construct.LexProduct.Base.html#1326" class="Bound">y</a><a id="1356" class="Symbol">)</a>
</pre></body></html>