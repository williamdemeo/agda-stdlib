<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Data.String</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- The Agda standard library</a>
<a id="103" class="Comment">--</a>
<a id="106" class="Comment">-- Strings</a>
<a id="117" class="Comment">------------------------------------------------------------------------</a>

<a id="191" class="Symbol">{-#</a> <a id="195" class="Keyword">OPTIONS</a> <a id="203" class="Pragma">--without-K</a> <a id="215" class="Pragma">--safe</a> <a id="222" class="Symbol">#-}</a>

<a id="227" class="Keyword">module</a> <a id="234" href="Data.String.html" class="Module">Data.String</a> <a id="246" class="Keyword">where</a>

<a id="253" class="Keyword">open</a> <a id="258" class="Keyword">import</a> <a id="265" href="Data.Bool.html" class="Module">Data.Bool</a> <a id="275" class="Keyword">using</a> <a id="281" class="Symbol">(</a><a id="282" href="Agda.Builtin.Bool.html#188" class="InductiveConstructor">true</a><a id="286" class="Symbol">;</a> <a id="288" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">false</a><a id="293" class="Symbol">;</a> <a id="295" href="Data.Bool.Properties.html#15973" class="Function">T?</a><a id="297" class="Symbol">)</a>
<a id="299" class="Keyword">open</a> <a id="304" class="Keyword">import</a> <a id="311" href="Data.Char.html" class="Module">Data.Char</a> <a id="321" class="Symbol">as</a> <a id="324" class="Module">Char</a> <a id="329" class="Keyword">using</a> <a id="335" class="Symbol">(</a><a id="336" href="Agda.Builtin.Char.html#227" class="Postulate">Char</a><a id="340" class="Symbol">)</a>
<a id="342" class="Keyword">open</a> <a id="347" class="Keyword">import</a> <a id="354" href="Function.Base.html" class="Module">Function.Base</a>
<a id="368" class="Keyword">open</a> <a id="373" class="Keyword">import</a> <a id="380" href="Data.Nat.Base.html" class="Module">Data.Nat.Base</a> <a id="394" class="Symbol">as</a> <a id="397" class="Module">ℕ</a> <a id="399" class="Keyword">using</a> <a id="405" class="Symbol">(</a><a id="406" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="407" class="Symbol">;</a> <a id="409" href="Data.Nat.Base.html#3202" class="Primitive Operator">_∸_</a><a id="412" class="Symbol">;</a> <a id="414" href="Data.Nat.Base.html#4353" class="Function Operator">⌊_/2⌋</a><a id="419" class="Symbol">;</a> <a id="421" href="Data.Nat.Base.html#4480" class="Function Operator">⌈_/2⌉</a><a id="426" class="Symbol">)</a>
<a id="428" class="Keyword">import</a> <a id="435" href="Data.Nat.Properties.html" class="Module">Data.Nat.Properties</a> <a id="455" class="Symbol">as</a> <a id="458" class="Module">ℕₚ</a>
<a id="461" class="Keyword">open</a> <a id="466" class="Keyword">import</a> <a id="473" href="Data.List.Base.html" class="Module">Data.List.Base</a> <a id="488" class="Symbol">as</a> <a id="491" class="Module">List</a> <a id="496" class="Keyword">using</a> <a id="502" class="Symbol">(</a><a id="503" href="Agda.Builtin.List.html#148" class="Datatype">List</a><a id="507" class="Symbol">;</a> <a id="509" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">_∷_</a><a id="512" class="Symbol">;</a> <a id="514" href="Data.List.Base.html#7361" class="InductiveConstructor">[]</a><a id="516" class="Symbol">;</a> <a id="518" href="Data.List.Base.html#5219" class="Function Operator">[_]</a><a id="521" class="Symbol">)</a>
<a id="523" class="Keyword">open</a> <a id="528" class="Keyword">import</a> <a id="535" href="Data.List.NonEmpty.html" class="Module">Data.List.NonEmpty</a> <a id="554" class="Symbol">as</a> <a id="557" class="Module">NE</a> <a id="560" class="Keyword">using</a> <a id="566" class="Symbol">(</a><a id="567" href="Data.List.NonEmpty.Base.html#1267" class="Record">List⁺</a><a id="572" class="Symbol">)</a>
<a id="574" class="Keyword">open</a> <a id="579" class="Keyword">import</a> <a id="586" href="Data.List.Extrema.html" class="Module">Data.List.Extrema</a> <a id="604" href="Data.Nat.Properties.html#7139" class="Function">ℕₚ.≤-totalOrder</a>
<a id="620" class="Keyword">open</a> <a id="625" class="Keyword">import</a> <a id="632" href="Data.List.Relation.Binary.Pointwise.html" class="Module">Data.List.Relation.Binary.Pointwise</a> <a id="668" class="Keyword">using</a> <a id="674" class="Symbol">(</a><a id="675" href="Data.List.Relation.Binary.Pointwise.Base.html#775" class="Datatype">Pointwise</a><a id="684" class="Symbol">)</a>
<a id="686" class="Keyword">open</a> <a id="691" class="Keyword">import</a> <a id="698" href="Data.List.Relation.Binary.Lex.Strict.html" class="Module">Data.List.Relation.Binary.Lex.Strict</a> <a id="735" class="Keyword">using</a> <a id="741" class="Symbol">(</a><a id="742" href="Data.List.Relation.Binary.Lex.Core.html#1508" class="Function">Lex-&lt;</a><a id="747" class="Symbol">;</a> <a id="749" href="Data.List.Relation.Binary.Lex.Core.html#1614" class="Function">Lex-≤</a><a id="754" class="Symbol">)</a>
<a id="756" class="Keyword">open</a> <a id="761" class="Keyword">import</a> <a id="768" href="Data.Vec.Base.html" class="Module">Data.Vec.Base</a> <a id="782" class="Symbol">as</a> <a id="785" class="Module">Vec</a> <a id="789" class="Keyword">using</a> <a id="795" class="Symbol">(</a><a id="796" href="Data.Vec.Base.html#1067" class="Datatype">Vec</a><a id="799" class="Symbol">)</a>
<a id="801" class="Keyword">open</a> <a id="806" class="Keyword">import</a> <a id="813" href="Data.Char.Base.html" class="Module">Data.Char.Base</a> <a id="828" class="Symbol">as</a> <a id="831" class="Module">Char</a> <a id="836" class="Keyword">using</a> <a id="842" class="Symbol">(</a><a id="843" href="Agda.Builtin.Char.html#227" class="Postulate">Char</a><a id="847" class="Symbol">)</a>
<a id="849" class="Keyword">import</a> <a id="856" href="Data.Char.Properties.html" class="Module">Data.Char.Properties</a> <a id="877" class="Symbol">as</a> <a id="880" class="Module">Char</a> <a id="885" class="Keyword">using</a> <a id="891" class="Symbol">(</a><a id="892" href="Data.Char.Properties.html#1490" class="Function Operator">_≟_</a><a id="895" class="Symbol">)</a>
<a id="897" class="Keyword">open</a> <a id="902" class="Keyword">import</a> <a id="909" href="Function.html" class="Module">Function</a>
<a id="918" class="Keyword">open</a> <a id="923" class="Keyword">import</a> <a id="930" href="Relation.Binary.html" class="Module">Relation.Binary</a> <a id="946" class="Keyword">using</a> <a id="952" class="Symbol">(</a><a id="953" href="Relation.Binary.Core.html#882" class="Function">Rel</a><a id="956" class="Symbol">)</a>
<a id="958" class="Keyword">open</a> <a id="963" class="Keyword">import</a> <a id="970" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a> <a id="1008" class="Keyword">using</a> <a id="1014" class="Symbol">(</a><a id="1015" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">_≡_</a><a id="1018" class="Symbol">;</a> <a id="1020" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="1024" class="Symbol">)</a>
<a id="1026" class="Keyword">open</a> <a id="1031" class="Keyword">import</a> <a id="1038" href="Relation.Nullary.Decidable.html" class="Module">Relation.Nullary.Decidable</a> <a id="1065" class="Keyword">using</a> <a id="1071" class="Symbol">(</a><a id="1072" href="Relation.Nullary.Decidable.Core.html#1546" class="Field">does</a><a id="1076" class="Symbol">)</a>
<a id="1078" class="Keyword">open</a> <a id="1083" class="Keyword">import</a> <a id="1090" href="Relation.Unary.html" class="Module">Relation.Unary</a> <a id="1105" class="Keyword">using</a> <a id="1111" class="Symbol">(</a><a id="1112" href="Relation.Unary.html#1111" class="Function">Pred</a><a id="1116" class="Symbol">;</a> <a id="1118" href="Relation.Unary.html#3685" class="Function">Decidable</a><a id="1127" class="Symbol">)</a>

<a id="1130" class="Keyword">open</a> <a id="1135" class="Keyword">import</a> <a id="1142" href="Data.List.Membership.DecPropositional.html" class="Module">Data.List.Membership.DecPropositional</a> <a id="1180" href="Data.Char.Properties.html#1490" class="Function Operator">Char._≟_</a>



<a id="1192" class="Comment">------------------------------------------------------------------------</a>
<a id="1265" class="Comment">-- Re-export contents of base, and decidability of equality</a>

<a id="1326" class="Keyword">open</a> <a id="1331" class="Keyword">import</a> <a id="1338" href="Data.String.Base.html" class="Module">Data.String.Base</a> <a id="1355" class="Keyword">public</a>
<a id="1362" class="Keyword">open</a> <a id="1367" class="Keyword">import</a> <a id="1374" href="Data.String.Properties.html" class="Module">Data.String.Properties</a> <a id="1397" class="Keyword">using</a> <a id="1403" class="Symbol">(</a><a id="1404" href="Data.String.Properties.html#1605" class="Function Operator">_≈?_</a><a id="1408" class="Symbol">;</a> <a id="1410" href="Data.String.Properties.html#2285" class="Function Operator">_≟_</a><a id="1413" class="Symbol">;</a> <a id="1415" href="Data.String.Properties.html#2571" class="Function Operator">_&lt;?_</a><a id="1419" class="Symbol">;</a> <a id="1421" href="Data.String.Properties.html#4350" class="Function Operator">_==_</a><a id="1425" class="Symbol">)</a> <a id="1427" class="Keyword">public</a>

<a id="1435" class="Comment">------------------------------------------------------------------------</a>
<a id="1508" class="Comment">-- Conversion functions</a>

<a id="toVec"></a><a id="1533" href="Data.String.html#1533" class="Function">toVec</a> <a id="1539" class="Symbol">:</a> <a id="1541" class="Symbol">(</a><a id="1542" href="Data.String.html#1542" class="Bound">s</a> <a id="1544" class="Symbol">:</a> <a id="1546" href="Agda.Builtin.String.html#336" class="Postulate">String</a><a id="1552" class="Symbol">)</a> <a id="1554" class="Symbol">→</a> <a id="1556" href="Data.Vec.Base.html#1067" class="Datatype">Vec</a> <a id="1560" href="Agda.Builtin.Char.html#227" class="Postulate">Char</a> <a id="1565" class="Symbol">(</a><a id="1566" href="Data.String.Base.html#2478" class="Function">length</a> <a id="1573" href="Data.String.html#1542" class="Bound">s</a><a id="1574" class="Symbol">)</a>
<a id="1576" href="Data.String.html#1533" class="Function">toVec</a> <a id="1582" href="Data.String.html#1582" class="Bound">s</a> <a id="1584" class="Symbol">=</a> <a id="1586" href="Data.Vec.Base.html#8563" class="Function">Vec.fromList</a> <a id="1599" class="Symbol">(</a><a id="1600" href="Data.String.Base.html#1541" class="Primitive">toList</a> <a id="1607" href="Data.String.html#1582" class="Bound">s</a><a id="1608" class="Symbol">)</a>

<a id="fromVec"></a><a id="1611" href="Data.String.html#1611" class="Function">fromVec</a> <a id="1619" class="Symbol">:</a> <a id="1621" class="Symbol">∀</a> <a id="1623" class="Symbol">{</a><a id="1624" href="Data.String.html#1624" class="Bound">n</a><a id="1625" class="Symbol">}</a> <a id="1627" class="Symbol">→</a> <a id="1629" href="Data.Vec.Base.html#1067" class="Datatype">Vec</a> <a id="1633" href="Agda.Builtin.Char.html#227" class="Postulate">Char</a> <a id="1638" href="Data.String.html#1624" class="Bound">n</a> <a id="1640" class="Symbol">→</a> <a id="1642" href="Agda.Builtin.String.html#336" class="Postulate">String</a>
<a id="1649" href="Data.String.html#1611" class="Function">fromVec</a> <a id="1657" class="Symbol">=</a> <a id="1659" href="Data.String.Base.html#1574" class="Primitive">fromList</a> <a id="1668" href="Function.Base.html#1106" class="Function Operator">∘</a> <a id="1670" href="Data.Vec.Base.html#8469" class="Function">Vec.toList</a>


<a id="1683" class="Comment">-- enclose string with parens if it contains a space character</a>
<a id="parensIfSpace"></a><a id="1746" href="Data.String.html#1746" class="Function">parensIfSpace</a> <a id="1760" class="Symbol">:</a> <a id="1762" href="Agda.Builtin.String.html#336" class="Postulate">String</a> <a id="1769" class="Symbol">→</a> <a id="1771" href="Agda.Builtin.String.html#336" class="Postulate">String</a>
<a id="1778" href="Data.String.html#1746" class="Function">parensIfSpace</a> <a id="1792" href="Data.String.html#1792" class="Bound">s</a> <a id="1794" class="Keyword">with</a> <a id="1799" href="Relation.Nullary.Decidable.Core.html#1546" class="Field">does</a> <a id="1804" class="Symbol">(</a><a id="1805" class="String">&#39; &#39;</a> <a id="1809" href="Data.List.Membership.DecSetoid.html#818" class="Function Operator">∈?</a> <a id="1812" href="Data.String.Base.html#1541" class="Primitive">toList</a> <a id="1819" href="Data.String.html#1792" class="Bound">s</a><a id="1820" class="Symbol">)</a>
<a id="1822" class="Symbol">...</a> <a id="1826" class="Symbol">|</a> <a id="1828" href="Agda.Builtin.Bool.html#188" class="InductiveConstructor">true</a>  <a id="1834" class="Symbol">=</a> <a id="1836" href="Data.String.Base.html#2874" class="Function">parens</a> <a id="1843" class="Bound">s</a>
<a id="1845" class="Symbol">...</a> <a id="1849" class="Symbol">|</a> <a id="1851" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">false</a> <a id="1857" class="Symbol">=</a> <a id="1859" class="Bound">s</a>


<a id="1863" class="Comment">------------------------------------------------------------------------</a>
<a id="1936" class="Comment">-- Rectangle</a>

<a id="1950" class="Comment">-- Build a rectangular column by:</a>
<a id="1984" class="Comment">-- Given a vector of cells and a padding function for each one</a>
<a id="2047" class="Comment">-- Compute the max of the widths, and pad the strings accordingly.</a>

<a id="rectangle"></a><a id="2115" href="Data.String.html#2115" class="Function">rectangle</a> <a id="2125" class="Symbol">:</a> <a id="2127" class="Symbol">∀</a> <a id="2129" class="Symbol">{</a><a id="2130" href="Data.String.html#2130" class="Bound">n</a><a id="2131" class="Symbol">}</a> <a id="2133" class="Symbol">→</a> <a id="2135" href="Data.Vec.Base.html#1067" class="Datatype">Vec</a> <a id="2139" class="Symbol">(</a><a id="2140" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="2142" class="Symbol">→</a> <a id="2144" href="Agda.Builtin.String.html#336" class="Postulate">String</a> <a id="2151" class="Symbol">→</a> <a id="2153" href="Agda.Builtin.String.html#336" class="Postulate">String</a><a id="2159" class="Symbol">)</a> <a id="2161" href="Data.String.html#2130" class="Bound">n</a> <a id="2163" class="Symbol">→</a>
            <a id="2177" href="Data.Vec.Base.html#1067" class="Datatype">Vec</a> <a id="2181" href="Agda.Builtin.String.html#336" class="Postulate">String</a> <a id="2188" href="Data.String.html#2130" class="Bound">n</a> <a id="2190" class="Symbol">→</a> <a id="2192" href="Data.Vec.Base.html#1067" class="Datatype">Vec</a> <a id="2196" href="Agda.Builtin.String.html#336" class="Postulate">String</a> <a id="2203" href="Data.String.html#2130" class="Bound">n</a>
<a id="2205" href="Data.String.html#2115" class="Function">rectangle</a> <a id="2215" href="Data.String.html#2215" class="Bound">pads</a> <a id="2220" href="Data.String.html#2220" class="Bound">cells</a> <a id="2226" class="Symbol">=</a> <a id="2228" href="Data.Vec.Base.html#3583" class="Function">Vec.zipWith</a> <a id="2240" class="Symbol">(λ</a> <a id="2243" href="Data.String.html#2243" class="Bound">p</a> <a id="2245" href="Data.String.html#2245" class="Bound">c</a> <a id="2247" class="Symbol">→</a> <a id="2249" href="Data.String.html#2243" class="Bound">p</a> <a id="2251" href="Data.String.html#2325" class="Function">width</a> <a id="2257" href="Data.String.html#2245" class="Bound">c</a><a id="2258" class="Symbol">)</a> <a id="2260" href="Data.String.html#2215" class="Bound">pads</a> <a id="2265" href="Data.String.html#2220" class="Bound">cells</a> <a id="2271" class="Keyword">where</a>

  <a id="2280" href="Data.String.html#2280" class="Function">sizes</a> <a id="2286" class="Symbol">=</a> <a id="2288" href="Data.List.Base.html#1606" class="Function">List.map</a> <a id="2297" href="Data.String.Base.html#2478" class="Function">length</a> <a id="2304" class="Symbol">(</a><a id="2305" href="Data.Vec.Base.html#8469" class="Function">Vec.toList</a> <a id="2316" href="Data.String.html#2220" class="Bound">cells</a><a id="2321" class="Symbol">)</a>
  <a id="2325" href="Data.String.html#2325" class="Function">width</a> <a id="2331" class="Symbol">=</a> <a id="2333" href="Data.List.Extrema.html#1936" class="Function">max</a> <a id="2337" class="Number">0</a> <a id="2339" href="Data.String.html#2280" class="Function">sizes</a>

<a id="2346" class="Comment">-- Special cases for left, center, and right alignment</a>

<a id="rectangleˡ"></a><a id="2402" href="Data.String.html#2402" class="Function">rectangleˡ</a> <a id="2413" class="Symbol">:</a> <a id="2415" class="Symbol">∀</a> <a id="2417" class="Symbol">{</a><a id="2418" href="Data.String.html#2418" class="Bound">n</a><a id="2419" class="Symbol">}</a> <a id="2421" class="Symbol">→</a> <a id="2423" href="Agda.Builtin.Char.html#227" class="Postulate">Char</a> <a id="2428" class="Symbol">→</a> <a id="2430" href="Data.Vec.Base.html#1067" class="Datatype">Vec</a> <a id="2434" href="Agda.Builtin.String.html#336" class="Postulate">String</a> <a id="2441" href="Data.String.html#2418" class="Bound">n</a> <a id="2443" class="Symbol">→</a> <a id="2445" href="Data.Vec.Base.html#1067" class="Datatype">Vec</a> <a id="2449" href="Agda.Builtin.String.html#336" class="Postulate">String</a> <a id="2456" href="Data.String.html#2418" class="Bound">n</a>
<a id="2458" href="Data.String.html#2402" class="Function">rectangleˡ</a> <a id="2469" href="Data.String.html#2469" class="Bound">c</a> <a id="2471" class="Symbol">=</a> <a id="2473" href="Data.String.html#2115" class="Function">rectangle</a> <a id="2483" class="Symbol">(</a><a id="2484" href="Data.Vec.Base.html#6385" class="Function">Vec.replicate</a> <a id="2498" href="Function.Base.html#1994" class="Function Operator">$</a> <a id="2500" href="Data.String.Base.html#3606" class="Function">padLeft</a> <a id="2508" href="Data.String.html#2469" class="Bound">c</a><a id="2509" class="Symbol">)</a>

<a id="rectangleʳ"></a><a id="2512" href="Data.String.html#2512" class="Function">rectangleʳ</a> <a id="2523" class="Symbol">:</a> <a id="2525" class="Symbol">∀</a> <a id="2527" class="Symbol">{</a><a id="2528" href="Data.String.html#2528" class="Bound">n</a><a id="2529" class="Symbol">}</a> <a id="2531" class="Symbol">→</a> <a id="2533" href="Agda.Builtin.Char.html#227" class="Postulate">Char</a> <a id="2538" class="Symbol">→</a> <a id="2540" href="Data.Vec.Base.html#1067" class="Datatype">Vec</a> <a id="2544" href="Agda.Builtin.String.html#336" class="Postulate">String</a> <a id="2551" href="Data.String.html#2528" class="Bound">n</a> <a id="2553" class="Symbol">→</a> <a id="2555" href="Data.Vec.Base.html#1067" class="Datatype">Vec</a> <a id="2559" href="Agda.Builtin.String.html#336" class="Postulate">String</a> <a id="2566" href="Data.String.html#2528" class="Bound">n</a>
<a id="2568" href="Data.String.html#2512" class="Function">rectangleʳ</a> <a id="2579" href="Data.String.html#2579" class="Bound">c</a> <a id="2581" class="Symbol">=</a> <a id="2583" href="Data.String.html#2115" class="Function">rectangle</a> <a id="2593" class="Symbol">(</a><a id="2594" href="Data.Vec.Base.html#6385" class="Function">Vec.replicate</a> <a id="2608" href="Function.Base.html#1994" class="Function Operator">$</a> <a id="2610" href="Data.String.Base.html#3725" class="Function">padRight</a> <a id="2619" href="Data.String.html#2579" class="Bound">c</a><a id="2620" class="Symbol">)</a>

<a id="rectangleᶜ"></a><a id="2623" href="Data.String.html#2623" class="Function">rectangleᶜ</a> <a id="2634" class="Symbol">:</a> <a id="2636" class="Symbol">∀</a> <a id="2638" class="Symbol">{</a><a id="2639" href="Data.String.html#2639" class="Bound">n</a><a id="2640" class="Symbol">}</a> <a id="2642" class="Symbol">→</a> <a id="2644" href="Agda.Builtin.Char.html#227" class="Postulate">Char</a> <a id="2649" class="Symbol">→</a> <a id="2651" href="Agda.Builtin.Char.html#227" class="Postulate">Char</a> <a id="2656" class="Symbol">→</a> <a id="2658" href="Data.Vec.Base.html#1067" class="Datatype">Vec</a> <a id="2662" href="Agda.Builtin.String.html#336" class="Postulate">String</a> <a id="2669" href="Data.String.html#2639" class="Bound">n</a> <a id="2671" class="Symbol">→</a> <a id="2673" href="Data.Vec.Base.html#1067" class="Datatype">Vec</a> <a id="2677" href="Agda.Builtin.String.html#336" class="Postulate">String</a> <a id="2684" href="Data.String.html#2639" class="Bound">n</a>
<a id="2686" href="Data.String.html#2623" class="Function">rectangleᶜ</a> <a id="2697" href="Data.String.html#2697" class="Bound">cₗ</a> <a id="2700" href="Data.String.html#2700" class="Bound">cᵣ</a> <a id="2703" class="Symbol">=</a> <a id="2705" href="Data.String.html#2115" class="Function">rectangle</a> <a id="2715" class="Symbol">(</a><a id="2716" href="Data.Vec.Base.html#6385" class="Function">Vec.replicate</a> <a id="2730" href="Function.Base.html#1994" class="Function Operator">$</a> <a id="2732" href="Data.String.Base.html#3846" class="Function">padBoth</a> <a id="2740" href="Data.String.html#2697" class="Bound">cₗ</a> <a id="2743" href="Data.String.html#2700" class="Bound">cᵣ</a><a id="2745" class="Symbol">)</a>
</pre></body></html>