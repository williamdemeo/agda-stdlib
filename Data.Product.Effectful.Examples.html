<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Data.Product.Effectful.Examples</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- The Agda standard library</a>
<a id="103" class="Comment">--</a>
<a id="106" class="Comment">-- Universe-sensitive functor and monad instances for the Product type.</a>
<a id="178" class="Comment">------------------------------------------------------------------------</a>

<a id="252" class="Symbol">{-#</a> <a id="256" class="Keyword">OPTIONS</a> <a id="264" class="Pragma">--without-K</a> <a id="276" class="Pragma">--safe</a> <a id="283" class="Symbol">#-}</a>

<a id="288" class="Keyword">open</a> <a id="293" class="Keyword">import</a> <a id="300" href="Algebra.html" class="Module">Algebra</a>

<a id="309" class="Keyword">module</a> <a id="316" href="Data.Product.Effectful.Examples.html" class="Module">Data.Product.Effectful.Examples</a>
  <a id="350" class="Symbol">{</a><a id="351" href="Data.Product.Effectful.Examples.html#351" class="Bound">a</a> <a id="353" href="Data.Product.Effectful.Examples.html#353" class="Bound">e</a> <a id="355" href="Data.Product.Effectful.Examples.html#355" class="Bound">b</a><a id="356" class="Symbol">}</a> <a id="358" class="Symbol">{</a><a id="359" href="Data.Product.Effectful.Examples.html#359" class="Bound">A</a> <a id="361" class="Symbol">:</a> <a id="363" href="Algebra.Bundles.html#6007" class="Record">Monoid</a> <a id="370" href="Data.Product.Effectful.Examples.html#351" class="Bound">a</a> <a id="372" href="Data.Product.Effectful.Examples.html#353" class="Bound">e</a><a id="373" class="Symbol">}</a> <a id="375" class="Symbol">{</a><a id="376" href="Data.Product.Effectful.Examples.html#376" class="Bound">B</a> <a id="378" class="Symbol">:</a> <a id="380" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="384" href="Data.Product.Effectful.Examples.html#355" class="Bound">b</a><a id="385" class="Symbol">}</a> <a id="387" class="Keyword">where</a>

<a id="394" class="Keyword">open</a> <a id="399" class="Keyword">import</a> <a id="406" href="Level.html" class="Module">Level</a> <a id="412" class="Keyword">using</a> <a id="418" class="Symbol">(</a><a id="419" href="Level.html#400" class="Record">Lift</a><a id="423" class="Symbol">;</a> <a id="425" href="Level.html#457" class="InductiveConstructor">lift</a><a id="429" class="Symbol">;</a> <a id="431" href="Agda.Primitive.html#810" class="Primitive Operator">_⊔_</a><a id="434" class="Symbol">)</a>
<a id="436" class="Keyword">open</a> <a id="441" class="Keyword">import</a> <a id="448" href="Effect.Functor.html" class="Module">Effect.Functor</a> <a id="463" class="Keyword">using</a> <a id="469" class="Symbol">(</a><a id="470" href="Effect.Functor.html#570" class="Record">RawFunctor</a><a id="480" class="Symbol">)</a>
<a id="482" class="Keyword">open</a> <a id="487" class="Keyword">import</a> <a id="494" href="Effect.Monad.html" class="Module">Effect.Monad</a> <a id="507" class="Keyword">using</a> <a id="513" class="Symbol">(</a><a id="514" href="Effect.Monad.html#766" class="Record">RawMonad</a><a id="522" class="Symbol">)</a>
<a id="524" class="Keyword">open</a> <a id="529" class="Keyword">import</a> <a id="536" href="Data.Product.html" class="Module">Data.Product</a>
<a id="549" class="Keyword">open</a> <a id="554" class="Keyword">import</a> <a id="561" href="Data.Product.Relation.Binary.Pointwise.NonDependent.html" class="Module">Data.Product.Relation.Binary.Pointwise.NonDependent</a>
<a id="613" class="Keyword">open</a> <a id="618" class="Keyword">import</a> <a id="625" href="Function.html" class="Module">Function</a>
<a id="634" class="Keyword">import</a> <a id="641" href="Function.Identity.Effectful.html" class="Module">Function.Identity.Effectful</a> <a id="669" class="Symbol">as</a> <a id="672" class="Module">Id</a>
<a id="675" class="Keyword">open</a> <a id="680" class="Keyword">import</a> <a id="687" href="Relation.Binary.html" class="Module">Relation.Binary</a> <a id="703" class="Keyword">using</a> <a id="709" class="Symbol">(</a><a id="710" href="Relation.Binary.Core.html#882" class="Function">Rel</a><a id="713" class="Symbol">)</a>
<a id="715" class="Keyword">open</a> <a id="720" class="Keyword">import</a> <a id="727" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a> <a id="765" class="Keyword">using</a> <a id="771" class="Symbol">(</a><a id="772" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">_≡_</a><a id="775" class="Symbol">;</a> <a id="777" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="781" class="Symbol">)</a>

<a id="784" class="Comment">------------------------------------------------------------------------</a>
<a id="857" class="Comment">-- Examples</a>

<a id="870" class="Comment">-- Note that these examples are simple unit tests, because the type</a>
<a id="938" class="Comment">-- checker verifies them.</a>

<a id="965" class="Keyword">private</a>

  <a id="976" class="Keyword">module</a> <a id="A"></a><a id="983" href="Data.Product.Effectful.Examples.html#983" class="Module">A</a> <a id="985" class="Symbol">=</a> <a id="987" href="Algebra.Bundles.html#6007" class="Module">Monoid</a> <a id="994" href="Data.Product.Effectful.Examples.html#359" class="Bound">A</a>

  <a id="999" class="Keyword">open</a> <a id="1004" class="Keyword">import</a> <a id="1011" href="Data.Product.Effectful.Left.html" class="Module">Data.Product.Effectful.Left</a> <a id="1039" href="Algebra.Bundles.html#6400" class="Function">A.rawMonoid</a> <a id="1051" href="Data.Product.Effectful.Examples.html#355" class="Bound">b</a>

  <a id="_≈_"></a><a id="1056" href="Data.Product.Effectful.Examples.html#1056" class="Function Operator">_≈_</a> <a id="1060" class="Symbol">:</a> <a id="1062" href="Relation.Binary.Core.html#882" class="Function">Rel</a> <a id="1066" class="Symbol">(</a><a id="1067" href="Algebra.Bundles.html#6086" class="Function">A.Carrier</a> <a id="1077" href="Data.Product.Base.html#1109" class="Function Operator">×</a> <a id="1079" href="Level.html#400" class="Record">Lift</a> <a id="1084" href="Data.Product.Effectful.Examples.html#351" class="Bound">a</a> <a id="1086" href="Data.Product.Effectful.Examples.html#376" class="Bound">B</a><a id="1087" class="Symbol">)</a> <a id="1089" class="Symbol">(</a><a id="1090" href="Data.Product.Effectful.Examples.html#353" class="Bound">e</a> <a id="1092" href="Agda.Primitive.html#810" class="Primitive Operator">⊔</a> <a id="1094" href="Data.Product.Effectful.Examples.html#351" class="Bound">a</a> <a id="1096" href="Agda.Primitive.html#810" class="Primitive Operator">⊔</a> <a id="1098" href="Data.Product.Effectful.Examples.html#355" class="Bound">b</a><a id="1099" class="Symbol">)</a>
  <a id="1103" href="Data.Product.Effectful.Examples.html#1056" class="Function Operator">_≈_</a> <a id="1107" class="Symbol">=</a> <a id="1109" href="Data.Product.Relation.Binary.Pointwise.NonDependent.html#1320" class="Function">Pointwise</a> <a id="1119" href="Algebra.Bundles.html#6107" class="Function Operator">A._≈_</a> <a id="1125" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">_≡_</a>

  <a id="1132" class="Keyword">open</a> <a id="1137" href="Effect.Functor.html#570" class="Module">RawFunctor</a> <a id="1148" href="Data.Product.Effectful.Left.Base.html#948" class="Function">functor</a>

  <a id="1159" class="Comment">-- This type to the right of × needs to be a &quot;lifted&quot; version of (B : Set b)</a>
  <a id="1238" class="Comment">-- that lives in the universe (Set (a ⊔ b)).</a>
  <a id="fmapIdₗ"></a><a id="1285" href="Data.Product.Effectful.Examples.html#1285" class="Function">fmapIdₗ</a> <a id="1293" class="Symbol">:</a> <a id="1295" class="Symbol">(</a><a id="1296" href="Data.Product.Effectful.Examples.html#1296" class="Bound">x</a> <a id="1298" class="Symbol">:</a> <a id="1300" href="Algebra.Bundles.html#6086" class="Function">A.Carrier</a> <a id="1310" href="Data.Product.Base.html#1109" class="Function Operator">×</a> <a id="1312" href="Level.html#400" class="Record">Lift</a> <a id="1317" href="Data.Product.Effectful.Examples.html#351" class="Bound">a</a> <a id="1319" href="Data.Product.Effectful.Examples.html#376" class="Bound">B</a><a id="1320" class="Symbol">)</a> <a id="1322" class="Symbol">→</a> <a id="1324" class="Symbol">(</a><a id="1325" href="Function.Base.html#695" class="Function">id</a> <a id="1328" href="Effect.Functor.html#678" class="Function Operator">&lt;$&gt;</a> <a id="1332" href="Data.Product.Effectful.Examples.html#1296" class="Bound">x</a><a id="1333" class="Symbol">)</a> <a id="1335" href="Data.Product.Effectful.Examples.html#1056" class="Function Operator">≈</a> <a id="1337" href="Data.Product.Effectful.Examples.html#1296" class="Bound">x</a>
  <a id="1341" href="Data.Product.Effectful.Examples.html#1285" class="Function">fmapIdₗ</a> <a id="1349" href="Data.Product.Effectful.Examples.html#1349" class="Bound">x</a> <a id="1351" class="Symbol">=</a> <a id="1353" href="Relation.Binary.Structures.html#1582" class="Function">A.refl</a> <a id="1360" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1362" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

  <a id="1370" class="Keyword">open</a> <a id="1375" href="Effect.Monad.html#766" class="Module">RawMonad</a> <a id="1384" href="Data.Product.Effectful.Left.html#1315" class="Function">monad</a>

  <a id="1393" class="Comment">-- Now, let&#39;s show that &quot;pure&quot; is a unit for &gt;&gt;=. We use Lift in exactly</a>
  <a id="1468" class="Comment">-- the same way as above. The data (x : B) then needs to be &quot;lifted&quot; to</a>
  <a id="1542" class="Comment">-- this new type (Lift B).</a>
  <a id="pureUnitL"></a><a id="1571" href="Data.Product.Effectful.Examples.html#1571" class="Function">pureUnitL</a> <a id="1581" class="Symbol">:</a> <a id="1583" class="Symbol">∀</a> <a id="1585" class="Symbol">{</a><a id="1586" href="Data.Product.Effectful.Examples.html#1586" class="Bound">x</a> <a id="1588" class="Symbol">:</a> <a id="1590" href="Data.Product.Effectful.Examples.html#376" class="Bound">B</a><a id="1591" class="Symbol">}</a> <a id="1593" class="Symbol">{</a><a id="1594" href="Data.Product.Effectful.Examples.html#1594" class="Bound">f</a> <a id="1596" class="Symbol">:</a> <a id="1598" href="Level.html#400" class="Record">Lift</a> <a id="1603" href="Data.Product.Effectful.Examples.html#351" class="Bound">a</a> <a id="1605" href="Data.Product.Effectful.Examples.html#376" class="Bound">B</a> <a id="1607" class="Symbol">→</a> <a id="1609" href="Algebra.Bundles.html#6086" class="Function">A.Carrier</a> <a id="1619" href="Data.Product.Base.html#1109" class="Function Operator">×</a> <a id="1621" href="Level.html#400" class="Record">Lift</a> <a id="1626" href="Data.Product.Effectful.Examples.html#351" class="Bound">a</a> <a id="1628" href="Data.Product.Effectful.Examples.html#376" class="Bound">B</a><a id="1629" class="Symbol">}</a> <a id="1631" class="Symbol">→</a>
                <a id="1649" class="Symbol">(</a><a id="1650" href="Effect.Applicative.html#1138" class="Function">pure</a> <a id="1655" class="Symbol">(</a><a id="1656" href="Level.html#457" class="InductiveConstructor">lift</a> <a id="1661" href="Data.Product.Effectful.Examples.html#1586" class="Bound">x</a><a id="1662" class="Symbol">)</a> <a id="1664" href="Effect.Monad.html#920" class="Function Operator">&gt;&gt;=</a> <a id="1668" href="Data.Product.Effectful.Examples.html#1594" class="Bound">f</a><a id="1669" class="Symbol">)</a> <a id="1671" href="Data.Product.Effectful.Examples.html#1056" class="Function Operator">≈</a> <a id="1673" href="Data.Product.Effectful.Examples.html#1594" class="Bound">f</a> <a id="1675" class="Symbol">(</a><a id="1676" href="Level.html#457" class="InductiveConstructor">lift</a> <a id="1681" href="Data.Product.Effectful.Examples.html#1586" class="Bound">x</a><a id="1682" class="Symbol">)</a>
  <a id="1686" href="Data.Product.Effectful.Examples.html#1571" class="Function">pureUnitL</a> <a id="1696" class="Symbol">=</a> <a id="1698" href="Algebra.Structures.html#4028" class="Function">A.identityˡ</a> <a id="1710" class="Symbol">_</a> <a id="1712" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1714" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

  <a id="pureUnitR"></a><a id="1722" href="Data.Product.Effectful.Examples.html#1722" class="Function">pureUnitR</a> <a id="1732" class="Symbol">:</a> <a id="1734" class="Symbol">{</a><a id="1735" href="Data.Product.Effectful.Examples.html#1735" class="Bound">x</a> <a id="1737" class="Symbol">:</a> <a id="1739" href="Algebra.Bundles.html#6086" class="Function">A.Carrier</a> <a id="1749" href="Data.Product.Base.html#1109" class="Function Operator">×</a> <a id="1751" href="Level.html#400" class="Record">Lift</a> <a id="1756" href="Data.Product.Effectful.Examples.html#351" class="Bound">a</a> <a id="1758" href="Data.Product.Effectful.Examples.html#376" class="Bound">B</a><a id="1759" class="Symbol">}</a> <a id="1761" class="Symbol">→</a> <a id="1763" class="Symbol">(</a><a id="1764" href="Data.Product.Effectful.Examples.html#1735" class="Bound">x</a> <a id="1766" href="Effect.Monad.html#920" class="Function Operator">&gt;&gt;=</a> <a id="1770" href="Effect.Applicative.html#1138" class="Function">pure</a><a id="1774" class="Symbol">)</a> <a id="1776" href="Data.Product.Effectful.Examples.html#1056" class="Function Operator">≈</a> <a id="1778" href="Data.Product.Effectful.Examples.html#1735" class="Bound">x</a>
  <a id="1782" href="Data.Product.Effectful.Examples.html#1722" class="Function">pureUnitR</a> <a id="1792" class="Symbol">=</a> <a id="1794" href="Algebra.Structures.html#4089" class="Function">A.identityʳ</a> <a id="1806" class="Symbol">_</a> <a id="1808" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1810" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

  <a id="1818" class="Comment">-- And another (limited version of a) monad law...</a>
  <a id="bindCompose"></a><a id="1871" href="Data.Product.Effectful.Examples.html#1871" class="Function">bindCompose</a> <a id="1883" class="Symbol">:</a> <a id="1885" class="Symbol">∀</a> <a id="1887" class="Symbol">{</a><a id="1888" href="Data.Product.Effectful.Examples.html#1888" class="Bound">f</a> <a id="1890" href="Data.Product.Effectful.Examples.html#1890" class="Bound">g</a> <a id="1892" class="Symbol">:</a> <a id="1894" href="Level.html#400" class="Record">Lift</a> <a id="1899" href="Data.Product.Effectful.Examples.html#351" class="Bound">a</a> <a id="1901" href="Data.Product.Effectful.Examples.html#376" class="Bound">B</a> <a id="1903" class="Symbol">→</a> <a id="1905" href="Algebra.Bundles.html#6086" class="Function">A.Carrier</a> <a id="1915" href="Data.Product.Base.html#1109" class="Function Operator">×</a> <a id="1917" href="Level.html#400" class="Record">Lift</a> <a id="1922" href="Data.Product.Effectful.Examples.html#351" class="Bound">a</a> <a id="1924" href="Data.Product.Effectful.Examples.html#376" class="Bound">B</a><a id="1925" class="Symbol">}</a> <a id="1927" class="Symbol">→</a>
                <a id="1945" class="Symbol">{</a><a id="1946" href="Data.Product.Effectful.Examples.html#1946" class="Bound">x</a> <a id="1948" class="Symbol">:</a> <a id="1950" href="Algebra.Bundles.html#6086" class="Function">A.Carrier</a> <a id="1960" href="Data.Product.Base.html#1109" class="Function Operator">×</a> <a id="1962" href="Level.html#400" class="Record">Lift</a> <a id="1967" href="Data.Product.Effectful.Examples.html#351" class="Bound">a</a> <a id="1969" href="Data.Product.Effectful.Examples.html#376" class="Bound">B</a><a id="1970" class="Symbol">}</a> <a id="1972" class="Symbol">→</a>
                <a id="1990" class="Symbol">((</a><a id="1992" href="Data.Product.Effectful.Examples.html#1946" class="Bound">x</a> <a id="1994" href="Effect.Monad.html#920" class="Function Operator">&gt;&gt;=</a> <a id="1998" href="Data.Product.Effectful.Examples.html#1888" class="Bound">f</a><a id="1999" class="Symbol">)</a> <a id="2001" href="Effect.Monad.html#920" class="Function Operator">&gt;&gt;=</a> <a id="2005" href="Data.Product.Effectful.Examples.html#1890" class="Bound">g</a><a id="2006" class="Symbol">)</a> <a id="2008" href="Data.Product.Effectful.Examples.html#1056" class="Function Operator">≈</a> <a id="2010" class="Symbol">(</a><a id="2011" href="Data.Product.Effectful.Examples.html#1946" class="Bound">x</a> <a id="2013" href="Effect.Monad.html#920" class="Function Operator">&gt;&gt;=</a> <a id="2017" class="Symbol">(λ</a> <a id="2020" href="Data.Product.Effectful.Examples.html#2020" class="Bound">y</a> <a id="2022" class="Symbol">→</a> <a id="2024" class="Symbol">(</a><a id="2025" href="Data.Product.Effectful.Examples.html#1888" class="Bound">f</a> <a id="2027" href="Data.Product.Effectful.Examples.html#2020" class="Bound">y</a> <a id="2029" href="Effect.Monad.html#920" class="Function Operator">&gt;&gt;=</a> <a id="2033" href="Data.Product.Effectful.Examples.html#1890" class="Bound">g</a><a id="2034" class="Symbol">)))</a>
  <a id="2040" href="Data.Product.Effectful.Examples.html#1871" class="Function">bindCompose</a> <a id="2052" class="Symbol">=</a> <a id="2054" href="Algebra.Structures.html#2869" class="Function">A.assoc</a> <a id="2062" class="Symbol">_</a> <a id="2064" class="Symbol">_</a> <a id="2066" class="Symbol">_</a> <a id="2068" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2070" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
</pre></body></html>