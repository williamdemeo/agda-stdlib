<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Data.Nat.PseudoRandom.LCG</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- The Agda standard library</a>
<a id="103" class="Comment">--</a>
<a id="106" class="Comment">-- Linear congruential pseudo random generators for natural numbers</a>
<a id="174" class="Comment">-- /!\ NB: LCGs must not be used for cryptographic applications</a>
<a id="238" class="Comment">------------------------------------------------------------------------</a>

<a id="312" class="Symbol">{-#</a> <a id="316" class="Keyword">OPTIONS</a> <a id="324" class="Pragma">--without-K</a> <a id="336" class="Pragma">--safe</a> <a id="343" class="Pragma">--sized-types</a> <a id="357" class="Symbol">#-}</a>

<a id="362" class="Keyword">module</a> <a id="369" href="Data.Nat.PseudoRandom.LCG.html" class="Module">Data.Nat.PseudoRandom.LCG</a> <a id="395" class="Keyword">where</a>

<a id="402" class="Keyword">open</a> <a id="407" class="Keyword">import</a> <a id="414" href="Codata.Stream.html" class="Module">Codata.Stream</a> <a id="428" class="Keyword">using</a> <a id="434" class="Symbol">(</a><a id="435" href="Codata.Stream.html#907" class="Datatype">Stream</a><a id="441" class="Symbol">;</a> <a id="443" href="Codata.Stream.html#1284" class="Function">unfold</a><a id="449" class="Symbol">)</a>
<a id="451" class="Keyword">open</a> <a id="456" class="Keyword">import</a> <a id="463" href="Data.Nat.html" class="Module">Data.Nat</a> <a id="472" class="Keyword">using</a> <a id="478" class="Symbol">(</a><a id="479" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="480" class="Symbol">;</a> <a id="482" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a><a id="486" class="Symbol">;</a> <a id="488" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a><a id="491" class="Symbol">;</a> <a id="493" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">_+_</a><a id="496" class="Symbol">;</a> <a id="498" href="Agda.Builtin.Nat.html#528" class="Primitive Operator">_*_</a><a id="501" class="Symbol">;</a> <a id="503" href="Data.Nat.Base.html#3471" class="Function Operator">_^_</a><a id="506" class="Symbol">;</a> <a id="508" href="Data.Nat.Properties.html#2529" class="Function Operator">_≟_</a><a id="511" class="Symbol">)</a>
<a id="513" class="Keyword">open</a> <a id="518" class="Keyword">import</a> <a id="525" href="Data.Nat.DivMod.html" class="Module">Data.Nat.DivMod</a> <a id="541" class="Keyword">using</a> <a id="547" class="Symbol">(</a><a id="548" href="Data.Nat.DivMod.html#1564" class="Function Operator">_%_</a><a id="551" class="Symbol">)</a>
<a id="553" class="Keyword">open</a> <a id="558" class="Keyword">import</a> <a id="565" href="Data.Product.html" class="Module">Data.Product</a> <a id="578" class="Keyword">using</a> <a id="584" class="Symbol">(</a><a id="585" href="Data.Product.html#2313" class="Function Operator">&lt;_,_&gt;</a><a id="590" class="Symbol">)</a>
<a id="592" class="Keyword">open</a> <a id="597" class="Keyword">import</a> <a id="604" href="Data.List.Base.html" class="Module">Data.List.Base</a> <a id="619" class="Keyword">using</a> <a id="625" class="Symbol">(</a><a id="626" href="Agda.Builtin.List.html#148" class="Datatype">List</a><a id="630" class="Symbol">;</a> <a id="632" href="Data.List.Base.html#10383" class="InductiveConstructor">[]</a><a id="634" class="Symbol">;</a> <a id="636" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">_∷_</a><a id="639" class="Symbol">)</a>
<a id="641" class="Keyword">open</a> <a id="646" class="Keyword">import</a> <a id="653" href="Function.Base.html" class="Module">Function.Base</a> <a id="667" class="Keyword">using</a> <a id="673" class="Symbol">(</a><a id="674" href="Function.Base.html#615" class="Function">id</a><a id="676" class="Symbol">)</a>
<a id="678" class="Keyword">open</a> <a id="683" class="Keyword">import</a> <a id="690" href="Relation.Nullary.Decidable.html" class="Module">Relation.Nullary.Decidable</a> <a id="717" class="Keyword">using</a> <a id="723" class="Symbol">(</a><a id="724" href="Relation.Nullary.Decidable.Core.html#1406" class="Function">False</a><a id="729" class="Symbol">)</a>

<a id="732" class="Comment">------------------------------------------------------------------------</a>
<a id="805" class="Comment">-- Type and generator</a>

<a id="828" class="Keyword">record</a> <a id="Generator"></a><a id="835" href="Data.Nat.PseudoRandom.LCG.html#835" class="Record">Generator</a> <a id="845" class="Symbol">:</a> <a id="847" class="PrimitiveType">Set</a> <a id="851" class="Keyword">where</a>
  <a id="859" class="Keyword">field</a> <a id="Generator.multiplier"></a><a id="865" href="Data.Nat.PseudoRandom.LCG.html#865" class="Field">multiplier</a>  <a id="877" class="Symbol">:</a> <a id="879" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
        <a id="Generator.increment"></a><a id="889" href="Data.Nat.PseudoRandom.LCG.html#889" class="Field">increment</a>   <a id="901" class="Symbol">:</a> <a id="903" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
        <a id="Generator.modulus"></a><a id="913" href="Data.Nat.PseudoRandom.LCG.html#913" class="Field">modulus</a>     <a id="925" class="Symbol">:</a> <a id="927" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
        <a id="937" class="Symbol">{</a><a id="Generator.modulus≢0"></a><a id="938" href="Data.Nat.PseudoRandom.LCG.html#938" class="Field">modulus≢0</a><a id="947" class="Symbol">}</a> <a id="949" class="Symbol">:</a> <a id="951" href="Relation.Nullary.Decidable.Core.html#1406" class="Function">False</a> <a id="957" class="Symbol">(</a><a id="958" href="Data.Nat.PseudoRandom.LCG.html#913" class="Field">modulus</a> <a id="966" href="Data.Nat.Properties.html#2529" class="Function Operator">≟</a> <a id="968" class="Number">0</a><a id="969" class="Symbol">)</a>

<a id="step"></a><a id="972" href="Data.Nat.PseudoRandom.LCG.html#972" class="Function">step</a> <a id="977" class="Symbol">:</a> <a id="979" href="Data.Nat.PseudoRandom.LCG.html#835" class="Record">Generator</a> <a id="989" class="Symbol">→</a> <a id="991" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="993" class="Symbol">→</a> <a id="995" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
<a id="997" href="Data.Nat.PseudoRandom.LCG.html#972" class="Function">step</a> <a id="1002" href="Data.Nat.PseudoRandom.LCG.html#1002" class="Bound">gen</a> <a id="1006" href="Data.Nat.PseudoRandom.LCG.html#1006" class="Bound">x</a> <a id="1008" class="Symbol">=</a>
  <a id="1012" class="Keyword">let</a> <a id="1016" class="Keyword">open</a> <a id="1021" href="Data.Nat.PseudoRandom.LCG.html#835" class="Module">Generator</a> <a id="1031" href="Data.Nat.PseudoRandom.LCG.html#1002" class="Bound">gen</a> <a id="1035" class="Keyword">in</a>
  <a id="1040" class="Symbol">((</a><a id="1042" href="Data.Nat.PseudoRandom.LCG.html#865" class="Function">multiplier</a> <a id="1053" href="Agda.Builtin.Nat.html#528" class="Primitive Operator">*</a> <a id="1055" href="Data.Nat.PseudoRandom.LCG.html#1006" class="Bound">x</a> <a id="1057" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="1059" href="Data.Nat.PseudoRandom.LCG.html#889" class="Function">increment</a><a id="1068" class="Symbol">)</a> <a id="1070" href="Data.Nat.DivMod.html#1564" class="Function Operator">%</a> <a id="1072" href="Data.Nat.PseudoRandom.LCG.html#913" class="Function">modulus</a><a id="1079" class="Symbol">)</a> <a id="1081" class="Symbol">{</a><a id="1082" href="Data.Nat.PseudoRandom.LCG.html#938" class="Function">modulus≢0</a><a id="1091" class="Symbol">}</a>

<a id="stream"></a><a id="1094" href="Data.Nat.PseudoRandom.LCG.html#1094" class="Function">stream</a> <a id="1101" class="Symbol">:</a> <a id="1103" href="Data.Nat.PseudoRandom.LCG.html#835" class="Record">Generator</a> <a id="1113" class="Symbol">→</a> <a id="1115" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="1117" class="Symbol">→</a> <a id="1119" href="Codata.Stream.html#907" class="Datatype">Stream</a> <a id="1126" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="1128" class="Symbol">_</a>
<a id="1130" href="Data.Nat.PseudoRandom.LCG.html#1094" class="Function">stream</a> <a id="1137" href="Data.Nat.PseudoRandom.LCG.html#1137" class="Bound">gen</a> <a id="1141" class="Symbol">=</a> <a id="1143" href="Codata.Stream.html#1284" class="Function">unfold</a> <a id="1150" href="Data.Product.html#2313" class="Function Operator">&lt;</a> <a id="1152" href="Data.Nat.PseudoRandom.LCG.html#972" class="Function">step</a> <a id="1157" href="Data.Nat.PseudoRandom.LCG.html#1137" class="Bound">gen</a> <a id="1161" href="Data.Product.html#2313" class="Function Operator">,</a> <a id="1163" href="Function.Base.html#615" class="Function">id</a> <a id="1166" href="Data.Product.html#2313" class="Function Operator">&gt;</a>

<a id="list"></a><a id="1169" href="Data.Nat.PseudoRandom.LCG.html#1169" class="Function">list</a> <a id="1174" class="Symbol">:</a> <a id="1176" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="1178" class="Symbol">→</a> <a id="1180" href="Data.Nat.PseudoRandom.LCG.html#835" class="Record">Generator</a> <a id="1190" class="Symbol">→</a> <a id="1192" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="1194" class="Symbol">→</a> <a id="1196" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="1201" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
<a id="1203" href="Data.Nat.PseudoRandom.LCG.html#1169" class="Function">list</a> <a id="1208" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a>    <a id="1216" href="Data.Nat.PseudoRandom.LCG.html#1216" class="Bound">gen</a> <a id="1220" href="Data.Nat.PseudoRandom.LCG.html#1220" class="Bound">x</a> <a id="1222" class="Symbol">=</a> <a id="1224" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>
<a id="1227" href="Data.Nat.PseudoRandom.LCG.html#1169" class="Function">list</a> <a id="1232" class="Symbol">(</a><a id="1233" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="1237" href="Data.Nat.PseudoRandom.LCG.html#1237" class="Bound">k</a><a id="1238" class="Symbol">)</a> <a id="1240" href="Data.Nat.PseudoRandom.LCG.html#1240" class="Bound">gen</a> <a id="1244" href="Data.Nat.PseudoRandom.LCG.html#1244" class="Bound">x</a> <a id="1246" class="Symbol">=</a> <a id="1248" href="Data.Nat.PseudoRandom.LCG.html#1244" class="Bound">x</a> <a id="1250" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="1252" href="Data.Nat.PseudoRandom.LCG.html#1169" class="Function">list</a> <a id="1257" href="Data.Nat.PseudoRandom.LCG.html#1237" class="Bound">k</a> <a id="1259" href="Data.Nat.PseudoRandom.LCG.html#1240" class="Bound">gen</a> <a id="1263" class="Symbol">(</a><a id="1264" href="Data.Nat.PseudoRandom.LCG.html#972" class="Function">step</a> <a id="1269" href="Data.Nat.PseudoRandom.LCG.html#1240" class="Bound">gen</a> <a id="1273" href="Data.Nat.PseudoRandom.LCG.html#1244" class="Bound">x</a><a id="1274" class="Symbol">)</a>

<a id="1277" class="Comment">------------------------------------------------------------------------</a>
<a id="1350" class="Comment">-- Examples of parameters</a>
<a id="1376" class="Comment">-- Taken from https://en.wikipedia.org/wiki/Linear_congruential_generator</a>

<a id="1451" class="Comment">-- /!\ As explained in that wikipedia entry, none of these are claimed to</a>
<a id="1525" class="Comment">-- be good parameters.</a>

<a id="1549" class="Comment">-- Note also that if you need your output to have good properties you may</a>
<a id="1623" class="Comment">-- need to postprocess the stream of values to only use some of the bits of</a>
<a id="1699" class="Comment">-- the output!</a>

<a id="glibc"></a><a id="1715" href="Data.Nat.PseudoRandom.LCG.html#1715" class="Function">glibc</a> <a id="1721" class="Symbol">:</a> <a id="1723" href="Data.Nat.PseudoRandom.LCG.html#835" class="Record">Generator</a>
<a id="1733" href="Data.Nat.PseudoRandom.LCG.html#1715" class="Function">glibc</a> <a id="1739" class="Symbol">=</a> <a id="1741" class="Keyword">record</a>
  <a id="1750" class="Symbol">{</a> <a id="1752" href="Data.Nat.PseudoRandom.LCG.html#865" class="Field">multiplier</a> <a id="1763" class="Symbol">=</a> <a id="1765" class="Number">1103515245</a>
  <a id="1778" class="Symbol">;</a> <a id="1780" href="Data.Nat.PseudoRandom.LCG.html#889" class="Field">increment</a>  <a id="1791" class="Symbol">=</a> <a id="1793" class="Number">12345</a>
  <a id="1801" class="Symbol">;</a> <a id="1803" href="Data.Nat.PseudoRandom.LCG.html#913" class="Field">modulus</a>    <a id="1814" class="Symbol">=</a> <a id="1816" class="Number">2</a> <a id="1818" href="Data.Nat.Base.html#3471" class="Function Operator">^</a> <a id="1820" class="Number">31</a>
  <a id="1825" class="Symbol">}</a>

<a id="random0"></a><a id="1828" href="Data.Nat.PseudoRandom.LCG.html#1828" class="Function">random0</a> <a id="1836" class="Symbol">:</a> <a id="1838" href="Data.Nat.PseudoRandom.LCG.html#835" class="Record">Generator</a>
<a id="1848" href="Data.Nat.PseudoRandom.LCG.html#1828" class="Function">random0</a> <a id="1856" class="Symbol">=</a> <a id="1858" class="Keyword">record</a>
  <a id="1867" class="Symbol">{</a> <a id="1869" href="Data.Nat.PseudoRandom.LCG.html#865" class="Field">multiplier</a> <a id="1880" class="Symbol">=</a> <a id="1882" class="Number">8121</a>
  <a id="1889" class="Symbol">;</a> <a id="1891" href="Data.Nat.PseudoRandom.LCG.html#889" class="Field">increment</a>  <a id="1902" class="Symbol">=</a> <a id="1904" class="Number">28411</a>
  <a id="1912" class="Symbol">;</a> <a id="1914" href="Data.Nat.PseudoRandom.LCG.html#913" class="Field">modulus</a>    <a id="1925" class="Symbol">=</a> <a id="1927" class="Number">134456</a>
  <a id="1936" class="Symbol">}</a>
</pre></body></html>