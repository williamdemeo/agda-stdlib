<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Data.Product.Properties.WithK</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- The Agda standard library</a>
<a id="103" class="Comment">--</a>
<a id="106" class="Comment">-- Properties, related to products, that rely on the K rule</a>
<a id="166" class="Comment">------------------------------------------------------------------------</a>

<a id="240" class="Symbol">{-#</a> <a id="244" class="Keyword">OPTIONS</a> <a id="252" class="Pragma">--with-K</a> <a id="261" class="Pragma">--safe</a> <a id="268" class="Symbol">#-}</a>

<a id="273" class="Keyword">module</a> <a id="280" href="Data.Product.Properties.WithK.html" class="Module">Data.Product.Properties.WithK</a> <a id="310" class="Keyword">where</a>

<a id="317" class="Keyword">open</a> <a id="322" class="Keyword">import</a> <a id="329" href="Data.Bool.Base.html" class="Module">Data.Bool.Base</a>
<a id="344" class="Keyword">open</a> <a id="349" class="Keyword">import</a> <a id="356" href="Data.Product.html" class="Module">Data.Product</a>
<a id="369" class="Keyword">open</a> <a id="374" class="Keyword">import</a> <a id="381" href="Data.Product.Properties.html" class="Module">Data.Product.Properties</a> <a id="405" class="Keyword">using</a> <a id="411" class="Symbol">(</a><a id="412" href="Data.Product.Properties.html#663" class="Function">,-injectiveˡ</a><a id="424" class="Symbol">)</a>
<a id="426" class="Keyword">open</a> <a id="431" class="Keyword">import</a> <a id="438" href="Function.html" class="Module">Function</a>
<a id="447" class="Keyword">open</a> <a id="452" class="Keyword">import</a> <a id="459" href="Relation.Binary.html" class="Module">Relation.Binary</a> <a id="475" class="Keyword">using</a> <a id="481" class="Symbol">(</a><a id="482" href="Relation.Binary.Definitions.html#4575" class="Function">Decidable</a><a id="491" class="Symbol">)</a>
<a id="493" class="Keyword">open</a> <a id="498" class="Keyword">import</a> <a id="505" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a>
<a id="543" class="Keyword">open</a> <a id="548" class="Keyword">import</a> <a id="555" href="Relation.Nullary.Reflects.html" class="Module">Relation.Nullary.Reflects</a>
<a id="581" class="Keyword">open</a> <a id="586" class="Keyword">import</a> <a id="593" href="Relation.Nullary.html" class="Module">Relation.Nullary</a> <a id="610" class="Keyword">using</a> <a id="616" class="Symbol">(</a><a id="617" href="Relation.Nullary.html#1508" class="Record">Dec</a><a id="620" class="Symbol">;</a> <a id="622" href="Relation.Nullary.html#1556" class="InductiveConstructor Operator">_because_</a><a id="631" class="Symbol">;</a> <a id="633" href="Relation.Nullary.html#1645" class="InductiveConstructor">yes</a><a id="636" class="Symbol">;</a> <a id="638" href="Relation.Nullary.html#1682" class="InductiveConstructor">no</a><a id="640" class="Symbol">)</a>
<a id="642" class="Keyword">open</a> <a id="647" class="Keyword">import</a> <a id="654" href="Relation.Nullary.Decidable.html" class="Module">Relation.Nullary.Decidable</a> <a id="681" class="Keyword">using</a> <a id="687" class="Symbol">(</a><a id="688" href="Relation.Nullary.Decidable.Core.html#3636" class="Function">map′</a><a id="692" class="Symbol">)</a>

<a id="695" class="Comment">------------------------------------------------------------------------</a>
<a id="768" class="Comment">-- Equality</a>

<a id="781" class="Keyword">module</a> <a id="788" href="Data.Product.Properties.WithK.html#788" class="Module">_</a> <a id="790" class="Symbol">{</a><a id="791" href="Data.Product.Properties.WithK.html#791" class="Bound">a</a> <a id="793" href="Data.Product.Properties.WithK.html#793" class="Bound">b</a><a id="794" class="Symbol">}</a> <a id="796" class="Symbol">{</a><a id="797" href="Data.Product.Properties.WithK.html#797" class="Bound">A</a> <a id="799" class="Symbol">:</a> <a id="801" class="PrimitiveType">Set</a> <a id="805" href="Data.Product.Properties.WithK.html#791" class="Bound">a</a><a id="806" class="Symbol">}</a> <a id="808" class="Symbol">{</a><a id="809" href="Data.Product.Properties.WithK.html#809" class="Bound">B</a> <a id="811" class="Symbol">:</a> <a id="813" class="PrimitiveType">Set</a> <a id="817" href="Data.Product.Properties.WithK.html#793" class="Bound">b</a><a id="818" class="Symbol">}</a> <a id="820" class="Keyword">where</a>

  <a id="829" href="Data.Product.Properties.WithK.html#829" class="Function">,-injective</a> <a id="841" class="Symbol">:</a> <a id="843" class="Symbol">∀</a> <a id="845" class="Symbol">{</a><a id="846" href="Data.Product.Properties.WithK.html#846" class="Bound">a</a> <a id="848" href="Data.Product.Properties.WithK.html#848" class="Bound">c</a> <a id="850" class="Symbol">:</a> <a id="852" href="Data.Product.Properties.WithK.html#797" class="Bound">A</a><a id="853" class="Symbol">}</a> <a id="855" class="Symbol">{</a><a id="856" href="Data.Product.Properties.WithK.html#856" class="Bound">b</a> <a id="858" href="Data.Product.Properties.WithK.html#858" class="Bound">d</a> <a id="860" class="Symbol">:</a> <a id="862" href="Data.Product.Properties.WithK.html#809" class="Bound">B</a><a id="863" class="Symbol">}</a> <a id="865" class="Symbol">→</a> <a id="867" class="Symbol">(</a><a id="868" href="Data.Product.Properties.WithK.html#846" class="Bound">a</a> <a id="870" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="872" href="Data.Product.Properties.WithK.html#856" class="Bound">b</a><a id="873" class="Symbol">)</a> <a id="875" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="877" class="Symbol">(</a><a id="878" href="Data.Product.Properties.WithK.html#848" class="Bound">c</a> <a id="880" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="882" href="Data.Product.Properties.WithK.html#858" class="Bound">d</a><a id="883" class="Symbol">)</a> <a id="885" class="Symbol">→</a> <a id="887" href="Data.Product.Properties.WithK.html#846" class="Bound">a</a> <a id="889" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="891" href="Data.Product.Properties.WithK.html#848" class="Bound">c</a> <a id="893" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="895" href="Data.Product.Properties.WithK.html#856" class="Bound">b</a> <a id="897" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="899" href="Data.Product.Properties.WithK.html#858" class="Bound">d</a>
  <a id="903" href="Data.Product.Properties.WithK.html#829" class="Function">,-injective</a> <a id="915" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="920" class="Symbol">=</a> <a id="922" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="927" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="929" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

<a id="935" class="Keyword">module</a> <a id="942" href="Data.Product.Properties.WithK.html#942" class="Module">_</a> <a id="944" class="Symbol">{</a><a id="945" href="Data.Product.Properties.WithK.html#945" class="Bound">a</a> <a id="947" href="Data.Product.Properties.WithK.html#947" class="Bound">b</a><a id="948" class="Symbol">}</a> <a id="950" class="Symbol">{</a><a id="951" href="Data.Product.Properties.WithK.html#951" class="Bound">A</a> <a id="953" class="Symbol">:</a> <a id="955" class="PrimitiveType">Set</a> <a id="959" href="Data.Product.Properties.WithK.html#945" class="Bound">a</a><a id="960" class="Symbol">}</a> <a id="962" class="Symbol">{</a><a id="963" href="Data.Product.Properties.WithK.html#963" class="Bound">B</a> <a id="965" class="Symbol">:</a> <a id="967" href="Data.Product.Properties.WithK.html#951" class="Bound">A</a> <a id="969" class="Symbol">→</a> <a id="971" class="PrimitiveType">Set</a> <a id="975" href="Data.Product.Properties.WithK.html#947" class="Bound">b</a><a id="976" class="Symbol">}</a> <a id="978" class="Keyword">where</a>

  <a id="987" href="Data.Product.Properties.WithK.html#987" class="Function">,-injectiveʳ</a> <a id="1000" class="Symbol">:</a> <a id="1002" class="Symbol">∀</a> <a id="1004" class="Symbol">{</a><a id="1005" href="Data.Product.Properties.WithK.html#1005" class="Bound">a</a><a id="1006" class="Symbol">}</a> <a id="1008" class="Symbol">{</a><a id="1009" href="Data.Product.Properties.WithK.html#1009" class="Bound">b</a> <a id="1011" href="Data.Product.Properties.WithK.html#1011" class="Bound">c</a> <a id="1013" class="Symbol">:</a> <a id="1015" href="Data.Product.Properties.WithK.html#963" class="Bound">B</a> <a id="1017" href="Data.Product.Properties.WithK.html#1005" class="Bound">a</a><a id="1018" class="Symbol">}</a> <a id="1020" class="Symbol">→</a> <a id="1022" class="Symbol">(</a><a id="1023" href="Agda.Builtin.Sigma.html#166" class="Record">Σ</a> <a id="1025" href="Data.Product.Properties.WithK.html#951" class="Bound">A</a> <a id="1027" href="Data.Product.Properties.WithK.html#963" class="Bound">B</a> <a id="1029" href="Function.Base.html#4269" class="Function Operator">∋</a> <a id="1031" class="Symbol">(</a><a id="1032" href="Data.Product.Properties.WithK.html#1005" class="Bound">a</a> <a id="1034" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1036" href="Data.Product.Properties.WithK.html#1009" class="Bound">b</a><a id="1037" class="Symbol">))</a> <a id="1040" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="1042" class="Symbol">(</a><a id="1043" href="Data.Product.Properties.WithK.html#1005" class="Bound">a</a> <a id="1045" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1047" href="Data.Product.Properties.WithK.html#1011" class="Bound">c</a><a id="1048" class="Symbol">)</a> <a id="1050" class="Symbol">→</a> <a id="1052" href="Data.Product.Properties.WithK.html#1009" class="Bound">b</a> <a id="1054" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="1056" href="Data.Product.Properties.WithK.html#1011" class="Bound">c</a>
  <a id="1060" href="Data.Product.Properties.WithK.html#987" class="Function">,-injectiveʳ</a> <a id="1073" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="1078" class="Symbol">=</a> <a id="1080" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

  <a id="1088" class="Comment">-- Note: this is not an instance of `_×-dec_`, because we need `x` and `y`</a>
  <a id="1165" class="Comment">-- to have the same type before we can test them for equality.</a>
  <a id="1230" href="Data.Product.Properties.WithK.html#1230" class="Function">≡-dec</a> <a id="1236" class="Symbol">:</a> <a id="1238" href="Relation.Binary.Definitions.html#4575" class="Function">Decidable</a> <a id="1248" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">_≡_</a> <a id="1252" class="Symbol">→</a> <a id="1254" class="Symbol">(∀</a> <a id="1257" class="Symbol">{</a><a id="1258" href="Data.Product.Properties.WithK.html#1258" class="Bound">a</a><a id="1259" class="Symbol">}</a> <a id="1261" class="Symbol">→</a> <a id="1263" href="Relation.Binary.Definitions.html#4575" class="Function">Decidable</a> <a id="1273" class="Symbol">{</a><a id="1274" class="Argument">A</a> <a id="1276" class="Symbol">=</a> <a id="1278" href="Data.Product.Properties.WithK.html#963" class="Bound">B</a> <a id="1280" href="Data.Product.Properties.WithK.html#1258" class="Bound">a</a><a id="1281" class="Symbol">}</a> <a id="1283" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">_≡_</a><a id="1286" class="Symbol">)</a> <a id="1288" class="Symbol">→</a>
          <a id="1300" href="Relation.Binary.Definitions.html#4575" class="Function">Decidable</a> <a id="1310" class="Symbol">{</a><a id="1311" class="Argument">A</a> <a id="1313" class="Symbol">=</a> <a id="1315" href="Agda.Builtin.Sigma.html#166" class="Record">Σ</a> <a id="1317" href="Data.Product.Properties.WithK.html#951" class="Bound">A</a> <a id="1319" href="Data.Product.Properties.WithK.html#963" class="Bound">B</a><a id="1320" class="Symbol">}</a> <a id="1322" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">_≡_</a>
  <a id="1328" href="Data.Product.Properties.WithK.html#1230" class="Function">≡-dec</a> <a id="1334" href="Data.Product.Properties.WithK.html#1334" class="Bound">dec₁</a> <a id="1339" href="Data.Product.Properties.WithK.html#1339" class="Bound">dec₂</a> <a id="1344" class="Symbol">(</a><a id="1345" href="Data.Product.Properties.WithK.html#1345" class="Bound">a</a> <a id="1347" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1349" href="Data.Product.Properties.WithK.html#1349" class="Bound">x</a><a id="1350" class="Symbol">)</a> <a id="1352" class="Symbol">(</a><a id="1353" href="Data.Product.Properties.WithK.html#1353" class="Bound">b</a> <a id="1355" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1357" href="Data.Product.Properties.WithK.html#1357" class="Bound">y</a><a id="1358" class="Symbol">)</a> <a id="1360" class="Keyword">with</a> <a id="1365" href="Data.Product.Properties.WithK.html#1334" class="Bound">dec₁</a> <a id="1370" href="Data.Product.Properties.WithK.html#1345" class="Bound">a</a> <a id="1372" href="Data.Product.Properties.WithK.html#1353" class="Bound">b</a>
  <a id="1376" class="Symbol">...</a> <a id="1380" class="Symbol">|</a> <a id="1382" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">false</a> <a id="1388" href="Relation.Nullary.html#1556" class="InductiveConstructor Operator">because</a> <a id="1396" href="Data.Product.Properties.WithK.html#1396" class="Bound">[a≢b]</a> <a id="1402" class="Symbol">=</a> <a id="1404" href="Relation.Nullary.html#1682" class="InductiveConstructor">no</a> <a id="1407" class="Symbol">(</a><a id="1408" href="Relation.Nullary.Reflects.html#1031" class="Function">invert</a> <a id="1415" href="Data.Product.Properties.WithK.html#1396" class="Bound">[a≢b]</a> <a id="1421" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="1423" href="Data.Product.Properties.html#663" class="Function">,-injectiveˡ</a><a id="1435" class="Symbol">)</a>
  <a id="1439" class="Symbol">...</a> <a id="1443" class="Symbol">|</a> <a id="1445" href="Relation.Nullary.html#1645" class="InductiveConstructor">yes</a> <a id="1449" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="1454" class="Symbol">=</a> <a id="1456" href="Relation.Nullary.Decidable.Core.html#3636" class="Function">map′</a> <a id="1461" class="Symbol">(</a><a id="1462" href="Relation.Binary.PropositionalEquality.Core.html#1131" class="Function">cong</a> <a id="1467" class="Symbol">(</a><a id="1468" class="Bound">a</a> <a id="1470" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,_</a><a id="1472" class="Symbol">))</a> <a id="1475" href="Data.Product.Properties.WithK.html#987" class="Function">,-injectiveʳ</a> <a id="1488" class="Symbol">(</a><a id="1489" class="Bound">dec₂</a> <a id="1494" class="Bound">x</a> <a id="1496" class="Bound">y</a><a id="1497" class="Symbol">)</a>
</pre></body></html>