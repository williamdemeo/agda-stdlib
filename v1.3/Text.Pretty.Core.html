<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Text.Pretty.Core</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- The Agda standard library</a>
<a id="103" class="Comment">--</a>
<a id="106" class="Comment">-- Pretty Printing</a>
<a id="125" class="Comment">-- This module is based on Jean-Philippe Bernardy&#39;s functional pearl</a>
<a id="194" class="Comment">-- &quot;A Pretty But Not Greedy Printer&quot;</a>
<a id="231" class="Comment">------------------------------------------------------------------------</a>

<a id="305" class="Symbol">{-#</a> <a id="309" class="Keyword">OPTIONS</a> <a id="317" class="Pragma">--with-K</a> <a id="326" class="Symbol">#-}</a>

<a id="331" class="Keyword">module</a> <a id="338" href="Text.Pretty.Core.html" class="Module">Text.Pretty.Core</a> <a id="355" class="Keyword">where</a>

<a id="362" class="Keyword">import</a> <a id="369" href="Level.html" class="Module">Level</a>

<a id="376" class="Keyword">open</a> <a id="381" class="Keyword">import</a> <a id="388" href="Data.Bool.Base.html" class="Module">Data.Bool.Base</a> <a id="403" class="Keyword">using</a> <a id="409" class="Symbol">(</a><a id="410" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a><a id="414" class="Symbol">)</a>
<a id="416" class="Keyword">open</a> <a id="421" class="Keyword">import</a> <a id="428" href="Data.Erased.html" class="Module">Data.Erased</a>    <a id="443" class="Symbol">as</a> <a id="446" class="Module">Erased</a> <a id="453" class="Keyword">using</a> <a id="459" class="Symbol">(</a><a id="460" href="Data.Erased.html#650" class="Record">Erased</a><a id="466" class="Symbol">)</a> <a id="468" class="Keyword">hiding</a> <a id="475" class="Symbol">(</a><a id="476" class="Keyword">module</a> <a id="483" href="Data.Erased.html#650" class="Module">Erased</a><a id="489" class="Symbol">)</a>
<a id="491" class="Keyword">open</a> <a id="496" class="Keyword">import</a> <a id="503" href="Data.List.Base.html" class="Module">Data.List.Base</a> <a id="518" class="Symbol">as</a> <a id="521" class="Module">List</a>   <a id="528" class="Keyword">using</a> <a id="534" class="Symbol">(</a><a id="535" href="Agda.Builtin.List.html#148" class="Datatype">List</a><a id="539" class="Symbol">;</a> <a id="541" href="Data.List.Base.html#9701" class="InductiveConstructor">[]</a><a id="543" class="Symbol">;</a> <a id="545" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">_∷_</a><a id="548" class="Symbol">)</a>
<a id="550" class="Keyword">open</a> <a id="555" class="Keyword">import</a> <a id="562" href="Data.Nat.Base.html" class="Module">Data.Nat.Base</a>            <a id="587" class="Keyword">using</a> <a id="593" class="Symbol">(</a><a id="594" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="595" class="Symbol">;</a> <a id="597" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a><a id="601" class="Symbol">;</a> <a id="603" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a><a id="606" class="Symbol">;</a> <a id="608" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">_+_</a><a id="611" class="Symbol">;</a> <a id="613" href="Data.Nat.Base.html#1640" class="Function Operator">_⊔_</a><a id="616" class="Symbol">;</a> <a id="618" href="Data.Nat.Base.html#937" class="Datatype Operator">_≤_</a><a id="621" class="Symbol">;</a> <a id="623" href="Data.Nat.Base.html#960" class="InductiveConstructor">z≤n</a><a id="626" class="Symbol">)</a>
<a id="628" class="Keyword">open</a> <a id="633" class="Keyword">import</a> <a id="640" href="Data.Nat.Properties.html" class="Module">Data.Nat.Properties</a>
<a id="660" class="Keyword">open</a> <a id="665" class="Keyword">import</a> <a id="672" href="Data.Product.html" class="Module">Data.Product</a> <a id="685" class="Symbol">as</a> <a id="688" class="Module">Prod</a> <a id="693" class="Keyword">using</a> <a id="699" class="Symbol">(</a><a id="700" href="Data.Product.html#1167" class="Function Operator">_×_</a><a id="703" class="Symbol">;</a> <a id="705" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">_,_</a><a id="708" class="Symbol">;</a> <a id="710" href="Data.Product.html#3103" class="Function">uncurry</a><a id="717" class="Symbol">;</a> <a id="719" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a><a id="724" class="Symbol">;</a> <a id="726" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a><a id="731" class="Symbol">)</a>
<a id="733" class="Keyword">import</a> <a id="740" href="Data.Product.Relation.Unary.All.html" class="Module">Data.Product.Relation.Unary.All</a> <a id="772" class="Symbol">as</a> <a id="775" class="Module">Allᴾ</a>

<a id="781" class="Keyword">open</a> <a id="786" class="Keyword">import</a> <a id="793" href="Data.Tree.Binary.html" class="Module">Data.Tree.Binary</a> <a id="810" class="Symbol">as</a> <a id="813" class="Module">Tree</a> <a id="818" class="Keyword">using</a> <a id="824" class="Symbol">(</a><a id="825" href="Data.Tree.Binary.html#620" class="Datatype">Tree</a><a id="829" class="Symbol">;</a> <a id="831" href="Data.Tree.Binary.html#653" class="InductiveConstructor">leaf</a><a id="835" class="Symbol">;</a> <a id="837" href="Data.Tree.Binary.html#669" class="InductiveConstructor">node</a><a id="841" class="Symbol">)</a>
<a id="843" class="Keyword">open</a> <a id="848" class="Keyword">import</a> <a id="855" href="Data.Tree.Binary.Relation.Unary.All.html" class="Module">Data.Tree.Binary.Relation.Unary.All</a> <a id="891" class="Symbol">as</a> <a id="894" class="Module">Allᵀ</a> <a id="899" class="Keyword">using</a> <a id="905" class="Symbol">(</a><a id="906" href="Data.Tree.Binary.Relation.Unary.All.html#563" class="InductiveConstructor">leaf</a><a id="910" class="Symbol">;</a> <a id="912" href="Data.Tree.Binary.Relation.Unary.All.html#583" class="InductiveConstructor">node</a><a id="916" class="Symbol">)</a>
<a id="918" class="Keyword">import</a> <a id="925" href="Data.Tree.Binary.Relation.Unary.All.Properties.html" class="Module">Data.Tree.Binary.Relation.Unary.All.Properties</a> <a id="972" class="Symbol">as</a> <a id="975" class="Module">Allᵀₚ</a>
<a id="981" class="Keyword">import</a> <a id="988" href="Data.Tree.Binary.Properties.html" class="Module">Data.Tree.Binary.Properties</a> <a id="1016" class="Symbol">as</a> <a id="1019" class="Module">Treeₚ</a>

<a id="1026" class="Keyword">open</a> <a id="1031" class="Keyword">import</a> <a id="1038" href="Data.Maybe.Base.html" class="Module">Data.Maybe.Base</a> <a id="1054" class="Symbol">as</a> <a id="1057" class="Module">Maybe</a> <a id="1063" class="Keyword">using</a> <a id="1069" class="Symbol">(</a><a id="1070" href="Data.Maybe.Base.html#838" class="Datatype">Maybe</a><a id="1075" class="Symbol">;</a> <a id="1077" href="Data.Maybe.Base.html#872" class="InductiveConstructor">nothing</a><a id="1084" class="Symbol">;</a> <a id="1086" href="Data.Maybe.Base.html#892" class="InductiveConstructor">just</a><a id="1090" class="Symbol">;</a> <a id="1092" href="Data.Maybe.Base.html#1573" class="Function">maybe′</a><a id="1098" class="Symbol">)</a>
<a id="1100" class="Keyword">open</a> <a id="1105" class="Keyword">import</a> <a id="1112" href="Data.Maybe.Relation.Unary.All.html" class="Module">Data.Maybe.Relation.Unary.All</a> <a id="1142" class="Symbol">as</a> <a id="1145" class="Module">Allᴹ</a> <a id="1150" class="Keyword">using</a> <a id="1156" class="Symbol">(</a><a id="1157" href="Data.Maybe.Relation.Unary.All.html#1054" class="InductiveConstructor">nothing</a><a id="1164" class="Symbol">;</a> <a id="1166" href="Data.Maybe.Relation.Unary.All.html#1013" class="InductiveConstructor">just</a><a id="1170" class="Symbol">)</a>

<a id="1173" class="Keyword">open</a> <a id="1178" class="Keyword">import</a> <a id="1185" href="Data.String.Base.html" class="Module">Data.String.Base</a> <a id="1202" class="Symbol">as</a> <a id="1205" class="Module">String</a>
<a id="1212" class="Keyword">open</a> <a id="1217" class="Keyword">import</a> <a id="1224" href="Data.String.Unsafe.html" class="Module">Data.String.Unsafe</a> <a id="1243" class="Symbol">as</a> <a id="1246" class="Module">Stringₚ</a>
<a id="1254" class="Keyword">open</a> <a id="1259" class="Keyword">import</a> <a id="1266" href="Function.Base.html" class="Module">Function.Base</a>
<a id="1280" class="Keyword">open</a> <a id="1285" class="Keyword">import</a> <a id="1292" href="Relation.Nullary.html" class="Module">Relation.Nullary</a> <a id="1309" class="Keyword">using</a> <a id="1315" class="Symbol">(</a><a id="1316" href="Relation.Nullary.html#1508" class="Record">Dec</a><a id="1319" class="Symbol">)</a>
<a id="1321" class="Keyword">open</a> <a id="1326" class="Keyword">import</a> <a id="1333" href="Relation.Unary.html" class="Module">Relation.Unary</a> <a id="1348" class="Keyword">using</a> <a id="1354" class="Symbol">(</a><a id="1355" href="Relation.Unary.html#3359" class="Function">IUniversal</a><a id="1365" class="Symbol">;</a> <a id="1367" href="Relation.Unary.html#4338" class="Function Operator">_⇒_</a><a id="1370" class="Symbol">)</a>
<a id="1372" class="Keyword">open</a> <a id="1377" class="Keyword">import</a> <a id="1384" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a>

<a id="1423" class="Keyword">open</a> <a id="1428" class="Keyword">import</a> <a id="1435" href="Data.Refinement.html" class="Module">Data.Refinement</a> <a id="1451" class="Keyword">hiding</a> <a id="1458" class="Symbol">(</a><a id="1459" href="Data.Refinement.html#1004" class="Function">map</a><a id="1462" class="Symbol">)</a>
<a id="1464" class="Keyword">import</a> <a id="1471" href="Data.Refinement.Relation.Unary.All.html" class="Module">Data.Refinement.Relation.Unary.All</a> <a id="1506" class="Symbol">as</a> <a id="1509" class="Module">Allᴿ</a>

<a id="1515" class="Comment">------------------------------------------------------------------------</a>
<a id="1588" class="Comment">-- Block of text</a>

<a id="1606" class="Comment">-- Content is a representation of the first line and the middle of the block.</a>
<a id="1684" class="Comment">-- We use a tree rather than a list for the middle of the block so that we can</a>
<a id="1763" class="Comment">-- extend it with lines on the left and on the line for free. We will ultimately</a>
<a id="1844" class="Comment">-- render the block by traversing the tree left to right in a depth-first manner.</a>

<a id="Content"></a><a id="1927" href="Text.Pretty.Core.html#1927" class="Function">Content</a> <a id="1935" class="Symbol">:</a> <a id="1937" class="PrimitiveType">Set</a>
<a id="1941" href="Text.Pretty.Core.html#1927" class="Function">Content</a> <a id="1949" class="Symbol">=</a> <a id="1951" href="Data.Maybe.Base.html#838" class="Datatype">Maybe</a> <a id="1957" class="Symbol">(</a><a id="1958" href="Agda.Builtin.String.html#274" class="Postulate">String</a> <a id="1965" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="1967" href="Data.Tree.Binary.html#620" class="Datatype">Tree</a> <a id="1972" href="Agda.Builtin.String.html#274" class="Postulate">String</a><a id="1978" class="Symbol">)</a>

<a id="size"></a><a id="1981" href="Text.Pretty.Core.html#1981" class="Function">size</a> <a id="1986" class="Symbol">:</a> <a id="1988" href="Text.Pretty.Core.html#1927" class="Function">Content</a> <a id="1996" class="Symbol">→</a> <a id="1998" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
<a id="2000" href="Text.Pretty.Core.html#1981" class="Function">size</a> <a id="2005" class="Symbol">=</a> <a id="2007" href="Data.Maybe.Base.html#1573" class="Function">maybe′</a> <a id="2014" class="Symbol">(</a><a id="2015" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="2019" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="2021" href="Data.Tree.Binary.html#817" class="Function">Tree.size</a> <a id="2031" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="2033" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a><a id="2038" class="Symbol">)</a> <a id="2040" class="Number">0</a>

<a id="All"></a><a id="2043" href="Text.Pretty.Core.html#2043" class="Function">All</a> <a id="2047" class="Symbol">:</a> <a id="2049" class="Symbol">∀</a> <a id="2051" class="Symbol">{</a><a id="2052" href="Text.Pretty.Core.html#2052" class="Bound">p</a><a id="2053" class="Symbol">}</a> <a id="2055" class="Symbol">(</a><a id="2056" href="Text.Pretty.Core.html#2056" class="Bound">P</a> <a id="2058" class="Symbol">:</a> <a id="2060" href="Agda.Builtin.String.html#274" class="Postulate">String</a> <a id="2067" class="Symbol">→</a> <a id="2069" class="PrimitiveType">Set</a> <a id="2073" href="Text.Pretty.Core.html#2052" class="Bound">p</a><a id="2074" class="Symbol">)</a> <a id="2076" class="Symbol">→</a> <a id="2078" class="Symbol">(</a><a id="2079" href="Text.Pretty.Core.html#1927" class="Function">Content</a> <a id="2087" class="Symbol">→</a> <a id="2089" class="PrimitiveType">Set</a> <a id="2093" href="Text.Pretty.Core.html#2052" class="Bound">p</a><a id="2094" class="Symbol">)</a>
<a id="2096" href="Text.Pretty.Core.html#2043" class="Function">All</a> <a id="2100" href="Text.Pretty.Core.html#2100" class="Bound">P</a> <a id="2102" class="Symbol">=</a> <a id="2104" href="Data.Maybe.Relation.Unary.All.html#943" class="Datatype">Allᴹ.All</a> <a id="2113" class="Symbol">(</a><a id="2114" href="Data.Product.Relation.Unary.All.html#456" class="Function">Allᴾ.All</a> <a id="2123" href="Text.Pretty.Core.html#2100" class="Bound">P</a> <a id="2125" class="Symbol">(</a><a id="2126" href="Data.Tree.Binary.Relation.Unary.All.html#500" class="Datatype">Allᵀ.All</a> <a id="2135" href="Text.Pretty.Core.html#2100" class="Bound">P</a><a id="2136" class="Symbol">))</a>

<a id="All≤"></a><a id="2140" href="Text.Pretty.Core.html#2140" class="Function">All≤</a> <a id="2145" class="Symbol">:</a> <a id="2147" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="2149" class="Symbol">→</a> <a id="2151" href="Text.Pretty.Core.html#1927" class="Function">Content</a> <a id="2159" class="Symbol">→</a> <a id="2161" class="PrimitiveType">Set</a>
<a id="2165" href="Text.Pretty.Core.html#2140" class="Function">All≤</a> <a id="2170" href="Text.Pretty.Core.html#2170" class="Bound">n</a> <a id="2172" class="Symbol">=</a> <a id="2174" href="Text.Pretty.Core.html#2043" class="Function">All</a> <a id="2178" class="Symbol">(λ</a> <a id="2181" href="Text.Pretty.Core.html#2181" class="Bound">s</a> <a id="2183" class="Symbol">→</a> <a id="2185" href="Data.String.Base.html#2141" class="Function">length</a> <a id="2192" href="Text.Pretty.Core.html#2181" class="Bound">s</a> <a id="2194" href="Data.Nat.Base.html#937" class="Datatype Operator">≤</a> <a id="2196" href="Text.Pretty.Core.html#2170" class="Bound">n</a><a id="2197" class="Symbol">)</a>

<a id="2200" class="Keyword">record</a> <a id="Block"></a><a id="2207" href="Text.Pretty.Core.html#2207" class="Record">Block</a> <a id="2213" class="Symbol">:</a> <a id="2215" class="PrimitiveType">Set</a> <a id="2219" class="Keyword">where</a>
  <a id="2227" class="Keyword">field</a>
    <a id="Block.height"></a><a id="2237" href="Text.Pretty.Core.html#2237" class="Field">height</a>    <a id="2247" class="Symbol">:</a> <a id="2249" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
    <a id="Block.block"></a><a id="2255" href="Text.Pretty.Core.html#2255" class="Field">block</a>     <a id="2265" class="Symbol">:</a> <a id="2267" href="Data.Refinement.html#869" class="Function">[</a> <a id="2269" href="Text.Pretty.Core.html#2269" class="Bound">xs</a> <a id="2272" href="Data.Refinement.html#869" class="Function">∈</a> <a id="2274" href="Text.Pretty.Core.html#1927" class="Function">Content</a> <a id="2282" href="Data.Refinement.html#869" class="Function">∣</a> <a id="2284" href="Text.Pretty.Core.html#1981" class="Function">size</a> <a id="2289" href="Text.Pretty.Core.html#2269" class="Bound">xs</a> <a id="2292" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="2294" href="Text.Pretty.Core.html#2237" class="Field">height</a> <a id="2301" href="Data.Refinement.html#869" class="Function">]</a>
  <a id="2305" class="Comment">-- last line</a>
    <a id="Block.lastWidth"></a><a id="2322" href="Text.Pretty.Core.html#2322" class="Field">lastWidth</a> <a id="2332" class="Symbol">:</a> <a id="2334" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
    <a id="Block.last"></a><a id="2340" href="Text.Pretty.Core.html#2340" class="Field">last</a>      <a id="2350" class="Symbol">:</a> <a id="2352" href="Data.Refinement.html#869" class="Function">[</a> <a id="2354" href="Text.Pretty.Core.html#2354" class="Bound">s</a> <a id="2356" href="Data.Refinement.html#869" class="Function">∈</a> <a id="2358" href="Agda.Builtin.String.html#274" class="Postulate">String</a> <a id="2365" href="Data.Refinement.html#869" class="Function">∣</a> <a id="2367" href="Data.String.Base.html#2141" class="Function">length</a> <a id="2374" href="Text.Pretty.Core.html#2354" class="Bound">s</a> <a id="2376" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="2378" href="Text.Pretty.Core.html#2322" class="Field">lastWidth</a> <a id="2388" href="Data.Refinement.html#869" class="Function">]</a>
  <a id="2392" class="Comment">-- max of all the widths</a>
    <a id="Block.maxWidth"></a><a id="2421" href="Text.Pretty.Core.html#2421" class="Field">maxWidth</a>  <a id="2431" class="Symbol">:</a> <a id="2433" href="Data.Refinement.html#869" class="Function">[</a> <a id="2435" href="Text.Pretty.Core.html#2435" class="Bound">n</a> <a id="2437" href="Data.Refinement.html#869" class="Function">∈</a> <a id="2439" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="2441" href="Data.Refinement.html#869" class="Function">∣</a> <a id="2443" href="Text.Pretty.Core.html#2322" class="Field">lastWidth</a> <a id="2453" href="Data.Nat.Base.html#937" class="Datatype Operator">≤</a> <a id="2455" href="Text.Pretty.Core.html#2435" class="Bound">n</a> <a id="2457" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="2459" href="Text.Pretty.Core.html#2140" class="Function">All≤</a> <a id="2464" href="Text.Pretty.Core.html#2435" class="Bound">n</a> <a id="2466" class="Symbol">(</a><a id="2467" href="Text.Pretty.Core.html#2255" class="Field">block</a> <a id="2473" class="Symbol">.</a><a id="2474" href="Data.Refinement.html#592" class="Field">value</a><a id="2479" class="Symbol">)</a> <a id="2481" href="Data.Refinement.html#869" class="Function">]</a>

<a id="2484" class="Comment">------------------------------------------------------------------------</a>
<a id="2557" class="Comment">-- Raw string</a>

<a id="text"></a><a id="2572" href="Text.Pretty.Core.html#2572" class="Function">text</a> <a id="2577" class="Symbol">:</a> <a id="2579" href="Agda.Builtin.String.html#274" class="Postulate">String</a> <a id="2586" class="Symbol">→</a> <a id="2588" href="Text.Pretty.Core.html#2207" class="Record">Block</a>
<a id="2594" href="Text.Pretty.Core.html#2572" class="Function">text</a> <a id="2599" href="Text.Pretty.Core.html#2599" class="Bound">s</a> <a id="2601" class="Symbol">=</a> <a id="2603" class="Keyword">record</a>
  <a id="2612" class="Symbol">{</a> <a id="2614" href="Text.Pretty.Core.html#2237" class="Field">height</a>    <a id="2624" class="Symbol">=</a> <a id="2626" class="Number">0</a>
  <a id="2630" class="Symbol">;</a> <a id="2632" href="Text.Pretty.Core.html#2255" class="Field">block</a>     <a id="2642" class="Symbol">=</a> <a id="2644" href="Data.Maybe.Base.html#872" class="InductiveConstructor">nothing</a> <a id="2652" href="Data.Refinement.html#580" class="InductiveConstructor Operator">,</a> <a id="2654" class="Symbol">⦇</a> <a id="2656" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="2661" class="Symbol">⦈</a>
  <a id="2665" class="Symbol">;</a> <a id="2667" href="Text.Pretty.Core.html#2322" class="Field">lastWidth</a> <a id="2677" class="Symbol">=</a> <a id="2679" href="Text.Pretty.Core.html#2771" class="Function">width</a>
  <a id="2687" class="Symbol">;</a> <a id="2689" href="Text.Pretty.Core.html#2340" class="Field">last</a>      <a id="2699" class="Symbol">=</a> <a id="2701" href="Text.Pretty.Core.html#2599" class="Bound">s</a> <a id="2703" href="Data.Refinement.html#580" class="InductiveConstructor Operator">,</a> <a id="2705" class="Symbol">⦇</a> <a id="2707" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="2712" class="Symbol">⦈</a>
  <a id="2716" class="Symbol">;</a> <a id="2718" href="Text.Pretty.Core.html#2421" class="Field">maxWidth</a>  <a id="2728" class="Symbol">=</a> <a id="2730" href="Text.Pretty.Core.html#2771" class="Function">width</a> <a id="2736" href="Data.Refinement.html#580" class="InductiveConstructor Operator">,</a> <a id="2738" class="Symbol">⦇</a> <a id="2740" class="Symbol">(</a><a id="2741" href="Data.Nat.Properties.html#3725" class="Function">≤-refl</a> <a id="2748" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2750" href="Data.Maybe.Relation.Unary.All.html#1054" class="InductiveConstructor">nothing</a><a id="2757" class="Symbol">)</a> <a id="2759" class="Symbol">⦈</a>
  <a id="2763" class="Symbol">}</a> <a id="2765" class="Keyword">where</a> <a id="2771" href="Text.Pretty.Core.html#2771" class="Function">width</a> <a id="2777" class="Symbol">=</a> <a id="2779" href="Data.String.Base.html#2141" class="Function">length</a> <a id="2786" href="Text.Pretty.Core.html#2599" class="Bound">s</a><a id="2787" class="Symbol">;</a> <a id="2789" class="Keyword">open</a> <a id="2794" href="Data.Erased.html" class="Module">Erased</a>

<a id="2802" class="Comment">------------------------------------------------------------------------</a>
<a id="2875" class="Comment">-- Empty</a>

<a id="empty"></a><a id="2885" href="Text.Pretty.Core.html#2885" class="Function">empty</a> <a id="2891" class="Symbol">:</a> <a id="2893" href="Text.Pretty.Core.html#2207" class="Record">Block</a>
<a id="2899" href="Text.Pretty.Core.html#2885" class="Function">empty</a> <a id="2905" class="Symbol">=</a> <a id="2907" href="Text.Pretty.Core.html#2572" class="Function">text</a> <a id="2912" class="String">&quot;&quot;</a>

<a id="2916" class="Comment">------------------------------------------------------------------------</a>
<a id="2989" class="Comment">-- Helper functions</a>

<a id="node?"></a><a id="3010" href="Text.Pretty.Core.html#3010" class="Function">node?</a> <a id="3016" class="Symbol">:</a> <a id="3018" href="Text.Pretty.Core.html#1927" class="Function">Content</a> <a id="3026" class="Symbol">→</a> <a id="3028" href="Agda.Builtin.String.html#274" class="Postulate">String</a> <a id="3035" class="Symbol">→</a> <a id="3037" href="Data.Tree.Binary.html#620" class="Datatype">Tree</a> <a id="3042" href="Agda.Builtin.String.html#274" class="Postulate">String</a> <a id="3049" class="Symbol">→</a> <a id="3051" href="Text.Pretty.Core.html#1927" class="Function">Content</a>
<a id="3059" href="Text.Pretty.Core.html#3010" class="Function">node?</a> <a id="3065" class="Symbol">(</a><a id="3066" href="Data.Maybe.Base.html#892" class="InductiveConstructor">just</a> <a id="3071" class="Symbol">(</a><a id="3072" href="Text.Pretty.Core.html#3072" class="Bound">x</a> <a id="3074" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3076" href="Text.Pretty.Core.html#3076" class="Bound">xs</a><a id="3078" class="Symbol">))</a> <a id="3081" href="Text.Pretty.Core.html#3081" class="Bound">y</a> <a id="3083" href="Text.Pretty.Core.html#3083" class="Bound">ys</a> <a id="3086" class="Symbol">=</a> <a id="3088" href="Data.Maybe.Base.html#892" class="InductiveConstructor">just</a> <a id="3093" class="Symbol">(</a><a id="3094" href="Text.Pretty.Core.html#3072" class="Bound">x</a> <a id="3096" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3098" href="Data.Tree.Binary.html#669" class="InductiveConstructor">node</a> <a id="3103" href="Text.Pretty.Core.html#3076" class="Bound">xs</a> <a id="3106" href="Text.Pretty.Core.html#3081" class="Bound">y</a> <a id="3108" href="Text.Pretty.Core.html#3083" class="Bound">ys</a><a id="3110" class="Symbol">)</a>
<a id="3112" href="Text.Pretty.Core.html#3010" class="Function">node?</a> <a id="3118" href="Data.Maybe.Base.html#872" class="InductiveConstructor">nothing</a>         <a id="3134" href="Text.Pretty.Core.html#3134" class="Bound">y</a> <a id="3136" href="Text.Pretty.Core.html#3136" class="Bound">ys</a> <a id="3139" class="Symbol">=</a> <a id="3141" href="Data.Maybe.Base.html#892" class="InductiveConstructor">just</a> <a id="3146" class="Symbol">(</a><a id="3147" href="Text.Pretty.Core.html#3134" class="Bound">y</a> <a id="3149" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3151" href="Text.Pretty.Core.html#3136" class="Bound">ys</a><a id="3153" class="Symbol">)</a>

<a id="∣node?∣"></a><a id="3156" href="Text.Pretty.Core.html#3156" class="Function">∣node?∣</a> <a id="3164" class="Symbol">:</a> <a id="3166" class="Symbol">∀</a> <a id="3168" href="Text.Pretty.Core.html#3168" class="Bound">b</a> <a id="3170" href="Text.Pretty.Core.html#3170" class="Bound">y</a> <a id="3172" href="Text.Pretty.Core.html#3172" class="Bound">ys</a> <a id="3175" class="Symbol">→</a> <a id="3177" href="Text.Pretty.Core.html#1981" class="Function">size</a> <a id="3182" class="Symbol">(</a><a id="3183" href="Text.Pretty.Core.html#3010" class="Function">node?</a> <a id="3189" href="Text.Pretty.Core.html#3168" class="Bound">b</a> <a id="3191" href="Text.Pretty.Core.html#3170" class="Bound">y</a> <a id="3193" href="Text.Pretty.Core.html#3172" class="Bound">ys</a><a id="3195" class="Symbol">)</a>
                   <a id="3216" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="3218" href="Text.Pretty.Core.html#1981" class="Function">size</a> <a id="3223" href="Text.Pretty.Core.html#3168" class="Bound">b</a> <a id="3225" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="3227" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="3231" class="Symbol">(</a><a id="3232" href="Data.Tree.Binary.html#817" class="Function">Tree.size</a> <a id="3242" href="Text.Pretty.Core.html#3172" class="Bound">ys</a><a id="3244" class="Symbol">)</a>
<a id="3246" href="Text.Pretty.Core.html#3156" class="Function">∣node?∣</a> <a id="3254" class="Symbol">(</a><a id="3255" href="Data.Maybe.Base.html#892" class="InductiveConstructor">just</a> <a id="3260" class="Symbol">(</a><a id="3261" href="Text.Pretty.Core.html#3261" class="Bound">x</a> <a id="3263" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3265" href="Text.Pretty.Core.html#3265" class="Bound">xs</a><a id="3267" class="Symbol">))</a> <a id="3270" href="Text.Pretty.Core.html#3270" class="Bound">y</a> <a id="3272" href="Text.Pretty.Core.html#3272" class="Bound">ys</a> <a id="3275" class="Symbol">=</a> <a id="3277" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
<a id="3282" href="Text.Pretty.Core.html#3156" class="Function">∣node?∣</a> <a id="3290" href="Data.Maybe.Base.html#872" class="InductiveConstructor">nothing</a>         <a id="3306" href="Text.Pretty.Core.html#3306" class="Bound">y</a> <a id="3308" href="Text.Pretty.Core.html#3308" class="Bound">ys</a> <a id="3311" class="Symbol">=</a> <a id="3313" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

<a id="≤-Content"></a><a id="3319" href="Text.Pretty.Core.html#3319" class="Function">≤-Content</a> <a id="3329" class="Symbol">:</a> <a id="3331" class="Symbol">∀</a> <a id="3333" class="Symbol">{</a><a id="3334" href="Text.Pretty.Core.html#3334" class="Bound">m</a> <a id="3336" href="Text.Pretty.Core.html#3336" class="Bound">n</a><a id="3337" class="Symbol">}</a> <a id="3339" class="Symbol">{</a><a id="3340" href="Text.Pretty.Core.html#3340" class="Bound">b</a> <a id="3342" class="Symbol">:</a> <a id="3344" href="Text.Pretty.Core.html#1927" class="Function">Content</a><a id="3351" class="Symbol">}</a> <a id="3353" class="Symbol">→</a> <a id="3355" href="Text.Pretty.Core.html#3334" class="Bound">m</a> <a id="3357" href="Data.Nat.Base.html#937" class="Datatype Operator">≤</a> <a id="3359" href="Text.Pretty.Core.html#3336" class="Bound">n</a> <a id="3361" class="Symbol">→</a> <a id="3363" href="Text.Pretty.Core.html#2140" class="Function">All≤</a> <a id="3368" href="Text.Pretty.Core.html#3334" class="Bound">m</a> <a id="3370" href="Text.Pretty.Core.html#3340" class="Bound">b</a> <a id="3372" class="Symbol">→</a> <a id="3374" href="Text.Pretty.Core.html#2140" class="Function">All≤</a> <a id="3379" href="Text.Pretty.Core.html#3336" class="Bound">n</a> <a id="3381" href="Text.Pretty.Core.html#3340" class="Bound">b</a>
<a id="3383" href="Text.Pretty.Core.html#3319" class="Function">≤-Content</a> <a id="3393" class="Symbol">{</a><a id="3394" href="Text.Pretty.Core.html#3394" class="Bound">m</a><a id="3395" class="Symbol">}</a> <a id="3397" class="Symbol">{</a><a id="3398" href="Text.Pretty.Core.html#3398" class="Bound">n</a><a id="3399" class="Symbol">}</a> <a id="3401" href="Text.Pretty.Core.html#3401" class="Bound">m≤n</a> <a id="3405" class="Symbol">=</a> <a id="3407" href="Data.Maybe.Relation.Unary.All.html#1394" class="Function">Allᴹ.map</a> <a id="3416" class="Symbol">(</a><a id="3417" href="Data.Product.html#2435" class="Function">Prod.map</a> <a id="3426" href="Text.Pretty.Core.html#3460" class="Function">step</a> <a id="3431" class="Symbol">(</a><a id="3432" href="Data.Tree.Binary.Relation.Unary.All.html#698" class="Function">Allᵀ.map</a> <a id="3441" href="Text.Pretty.Core.html#3460" class="Function">step</a><a id="3445" class="Symbol">))</a>

  <a id="3451" class="Keyword">where</a>

  <a id="3460" href="Text.Pretty.Core.html#3460" class="Function">step</a> <a id="3465" class="Symbol">:</a> <a id="3467" class="Symbol">∀</a> <a id="3469" class="Symbol">{</a><a id="3470" href="Text.Pretty.Core.html#3470" class="Bound">p</a><a id="3471" class="Symbol">}</a> <a id="3473" class="Symbol">→</a> <a id="3475" href="Text.Pretty.Core.html#3470" class="Bound">p</a> <a id="3477" href="Data.Nat.Base.html#937" class="Datatype Operator">≤</a> <a id="3479" href="Text.Pretty.Core.html#3394" class="Bound">m</a> <a id="3481" class="Symbol">→</a> <a id="3483" href="Text.Pretty.Core.html#3470" class="Bound">p</a> <a id="3485" href="Data.Nat.Base.html#937" class="Datatype Operator">≤</a> <a id="3487" href="Text.Pretty.Core.html#3398" class="Bound">n</a>
  <a id="3491" href="Text.Pretty.Core.html#3460" class="Function">step</a> <a id="3496" class="Symbol">=</a> <a id="3498" href="Function.Base.html#1193" class="Function">flip</a> <a id="3503" href="Data.Nat.Properties.html#3908" class="Function">≤-trans</a> <a id="3511" href="Text.Pretty.Core.html#3401" class="Bound">m≤n</a>

<a id="All≤-node?"></a><a id="3516" href="Text.Pretty.Core.html#3516" class="Function">All≤-node?</a> <a id="3527" class="Symbol">:</a> <a id="3529" class="Symbol">∀</a> <a id="3531" class="Symbol">{</a><a id="3532" href="Text.Pretty.Core.html#3532" class="Bound">l</a> <a id="3534" href="Text.Pretty.Core.html#3534" class="Bound">m</a> <a id="3536" href="Text.Pretty.Core.html#3536" class="Bound">r</a> <a id="3538" href="Text.Pretty.Core.html#3538" class="Bound">n</a><a id="3539" class="Symbol">}</a> <a id="3541" class="Symbol">→</a>
             <a id="3556" href="Text.Pretty.Core.html#2140" class="Function">All≤</a> <a id="3561" href="Text.Pretty.Core.html#3538" class="Bound">n</a> <a id="3563" href="Text.Pretty.Core.html#3532" class="Bound">l</a> <a id="3565" class="Symbol">→</a> <a id="3567" href="Data.String.Base.html#2141" class="Function">length</a> <a id="3574" href="Text.Pretty.Core.html#3534" class="Bound">m</a> <a id="3576" href="Data.Nat.Base.html#937" class="Datatype Operator">≤</a> <a id="3578" href="Text.Pretty.Core.html#3538" class="Bound">n</a> <a id="3580" class="Symbol">→</a> <a id="3582" href="Data.Tree.Binary.Relation.Unary.All.html#500" class="Datatype">Allᵀ.All</a> <a id="3591" class="Symbol">(λ</a> <a id="3594" href="Text.Pretty.Core.html#3594" class="Bound">s</a> <a id="3596" class="Symbol">→</a> <a id="3598" href="Data.String.Base.html#2141" class="Function">length</a> <a id="3605" href="Text.Pretty.Core.html#3594" class="Bound">s</a> <a id="3607" href="Data.Nat.Base.html#937" class="Datatype Operator">≤</a> <a id="3609" href="Text.Pretty.Core.html#3538" class="Bound">n</a><a id="3610" class="Symbol">)</a> <a id="3612" href="Text.Pretty.Core.html#3536" class="Bound">r</a> <a id="3614" class="Symbol">→</a>
             <a id="3629" href="Text.Pretty.Core.html#2140" class="Function">All≤</a> <a id="3634" href="Text.Pretty.Core.html#3538" class="Bound">n</a> <a id="3636" class="Symbol">(</a><a id="3637" href="Text.Pretty.Core.html#3010" class="Function">node?</a> <a id="3643" href="Text.Pretty.Core.html#3532" class="Bound">l</a> <a id="3645" href="Text.Pretty.Core.html#3534" class="Bound">m</a> <a id="3647" href="Text.Pretty.Core.html#3536" class="Bound">r</a><a id="3648" class="Symbol">)</a>
<a id="3650" href="Text.Pretty.Core.html#3516" class="Function">All≤-node?</a> <a id="3661" href="Data.Maybe.Relation.Unary.All.html#1054" class="InductiveConstructor">nothing</a>           <a id="3679" href="Text.Pretty.Core.html#3679" class="Bound">py</a> <a id="3682" href="Text.Pretty.Core.html#3682" class="Bound">pys</a> <a id="3686" class="Symbol">=</a> <a id="3688" href="Data.Maybe.Relation.Unary.All.html#1013" class="InductiveConstructor">just</a> <a id="3693" class="Symbol">(</a><a id="3694" href="Text.Pretty.Core.html#3679" class="Bound">py</a> <a id="3697" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3699" href="Text.Pretty.Core.html#3682" class="Bound">pys</a><a id="3702" class="Symbol">)</a>
<a id="3704" href="Text.Pretty.Core.html#3516" class="Function">All≤-node?</a> <a id="3715" class="Symbol">(</a><a id="3716" href="Data.Maybe.Relation.Unary.All.html#1013" class="InductiveConstructor">just</a> <a id="3721" class="Symbol">(</a><a id="3722" href="Text.Pretty.Core.html#3722" class="Bound">px</a> <a id="3725" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3727" href="Text.Pretty.Core.html#3727" class="Bound">pxs</a><a id="3730" class="Symbol">))</a> <a id="3733" href="Text.Pretty.Core.html#3733" class="Bound">py</a> <a id="3736" href="Text.Pretty.Core.html#3736" class="Bound">pys</a> <a id="3740" class="Symbol">=</a> <a id="3742" href="Data.Maybe.Relation.Unary.All.html#1013" class="InductiveConstructor">just</a> <a id="3747" class="Symbol">(</a><a id="3748" href="Text.Pretty.Core.html#3722" class="Bound">px</a> <a id="3751" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3753" href="Data.Tree.Binary.Relation.Unary.All.html#583" class="InductiveConstructor">node</a> <a id="3758" href="Text.Pretty.Core.html#3727" class="Bound">pxs</a> <a id="3762" href="Text.Pretty.Core.html#3733" class="Bound">py</a> <a id="3765" href="Text.Pretty.Core.html#3736" class="Bound">pys</a><a id="3768" class="Symbol">)</a>

<a id="3771" class="Comment">------------------------------------------------------------------------</a>
<a id="3844" class="Comment">-- Appending two documents</a>

<a id="3872" class="Keyword">private</a>
  <a id="3882" class="Keyword">module</a> <a id="append"></a><a id="3889" href="Text.Pretty.Core.html#3889" class="Module">append</a> <a id="3896" class="Symbol">(</a><a id="3897" href="Text.Pretty.Core.html#3897" class="Bound">x</a> <a id="3899" href="Text.Pretty.Core.html#3899" class="Bound">y</a> <a id="3901" class="Symbol">:</a> <a id="3903" href="Text.Pretty.Core.html#2207" class="Record">Block</a><a id="3908" class="Symbol">)</a> <a id="3910" class="Keyword">where</a>

    <a id="3921" class="Keyword">module</a> <a id="x"></a><a id="3928" href="Text.Pretty.Core.html#3928" class="Module">x</a> <a id="3930" class="Symbol">=</a> <a id="3932" href="Text.Pretty.Core.html#2207" class="Module">Block</a> <a id="3938" href="Text.Pretty.Core.html#3897" class="Bound">x</a>
    <a id="3944" class="Keyword">module</a> <a id="y"></a><a id="3951" href="Text.Pretty.Core.html#3951" class="Module">y</a> <a id="3953" class="Symbol">=</a> <a id="3955" href="Text.Pretty.Core.html#2207" class="Module">Block</a> <a id="3961" href="Text.Pretty.Core.html#3899" class="Bound">y</a>

    <a id="append.blockx"></a><a id="3968" href="Text.Pretty.Core.html#3968" class="Function">blockx</a> <a id="3975" class="Symbol">=</a> <a id="3977" href="Text.Pretty.Core.html#2255" class="Function">x.block</a> <a id="3985" class="Symbol">.</a><a id="3986" href="Data.Refinement.html#592" class="Field">value</a>
    <a id="append.blocky"></a><a id="3996" href="Text.Pretty.Core.html#3996" class="Function">blocky</a> <a id="4003" class="Symbol">=</a> <a id="4005" href="Text.Pretty.Core.html#2255" class="Field">y.block</a> <a id="4013" class="Symbol">.</a><a id="4014" href="Data.Refinement.html#592" class="Field">value</a>

    <a id="append.widthx"></a><a id="4025" href="Text.Pretty.Core.html#4025" class="Function">widthx</a> <a id="4032" class="Symbol">=</a> <a id="4034" href="Text.Pretty.Core.html#2421" class="Function">x.maxWidth</a> <a id="4045" class="Symbol">.</a><a id="4046" href="Data.Refinement.html#592" class="Field">value</a>
    <a id="append.widthy"></a><a id="4056" href="Text.Pretty.Core.html#4056" class="Function">widthy</a> <a id="4063" class="Symbol">=</a> <a id="4065" href="Text.Pretty.Core.html#2421" class="Field">y.maxWidth</a> <a id="4076" class="Symbol">.</a><a id="4077" href="Data.Refinement.html#592" class="Field">value</a>

    <a id="append.lastx"></a><a id="4088" href="Text.Pretty.Core.html#4088" class="Function">lastx</a> <a id="4094" class="Symbol">=</a> <a id="4096" href="Text.Pretty.Core.html#2340" class="Function">x.last</a> <a id="4103" class="Symbol">.</a><a id="4104" href="Data.Refinement.html#592" class="Field">value</a>
    <a id="append.lasty"></a><a id="4114" href="Text.Pretty.Core.html#4114" class="Function">lasty</a> <a id="4120" class="Symbol">=</a> <a id="4122" href="Text.Pretty.Core.html#2340" class="Field">y.last</a> <a id="4129" class="Symbol">.</a><a id="4130" href="Data.Refinement.html#592" class="Field">value</a>

    <a id="append.height"></a><a id="4141" href="Text.Pretty.Core.html#4141" class="Function">height</a> <a id="4148" class="Symbol">:</a> <a id="4150" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
    <a id="4156" href="Text.Pretty.Core.html#4141" class="Function">height</a> <a id="4163" class="Symbol">=</a> <a id="4165" class="Symbol">(</a><a id="4166" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">_+_</a> <a id="4170" href="Function.Base.html#3938" class="Function Operator">on</a> <a id="4173" href="Text.Pretty.Core.html#2237" class="Field">Block.height</a><a id="4185" class="Symbol">)</a> <a id="4187" href="Text.Pretty.Core.html#3897" class="Bound">x</a> <a id="4189" href="Text.Pretty.Core.html#3899" class="Bound">y</a>

    <a id="append.lastWidth"></a><a id="4196" href="Text.Pretty.Core.html#4196" class="Function">lastWidth</a> <a id="4206" class="Symbol">:</a> <a id="4208" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
    <a id="4214" href="Text.Pretty.Core.html#4196" class="Function">lastWidth</a> <a id="4224" class="Symbol">=</a> <a id="4226" class="Symbol">(</a><a id="4227" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">_+_</a> <a id="4231" href="Function.Base.html#3938" class="Function Operator">on</a> <a id="4234" href="Text.Pretty.Core.html#2322" class="Field">Block.lastWidth</a><a id="4249" class="Symbol">)</a> <a id="4251" href="Text.Pretty.Core.html#3897" class="Bound">x</a> <a id="4253" href="Text.Pretty.Core.html#3899" class="Bound">y</a>

    <a id="append.pad"></a><a id="4260" href="Text.Pretty.Core.html#4260" class="Function">pad</a> <a id="4264" class="Symbol">:</a> <a id="4266" href="Data.Maybe.Base.html#838" class="Datatype">Maybe</a> <a id="4272" href="Agda.Builtin.String.html#274" class="Postulate">String</a>
    <a id="4283" href="Text.Pretty.Core.html#4260" class="Function">pad</a> <a id="4287" class="Keyword">with</a> <a id="4292" href="Text.Pretty.Core.html#2322" class="Function">x.lastWidth</a>
    <a id="4308" class="Symbol">...</a> <a id="4312" class="Symbol">|</a> <a id="4314" class="Number">0</a> <a id="4316" class="Symbol">=</a> <a id="4318" href="Data.Maybe.Base.html#872" class="InductiveConstructor">nothing</a>
    <a id="4330" class="CatchallClause Symbol">...</a><a id="4333" class="CatchallClause"> </a><a id="4334" class="CatchallClause Symbol">|</a><a id="4335" class="CatchallClause"> </a><a id="4336" href="Text.Pretty.Core.html#4336" class="CatchallClause Bound">l</a> <a id="4338" class="Symbol">=</a> <a id="4340" href="Data.Maybe.Base.html#892" class="InductiveConstructor">just</a> <a id="4345" class="Symbol">(</a><a id="4346" href="Data.String.Base.html#2192" class="Function">replicate</a> <a id="4356" href="Text.Pretty.Core.html#4336" class="Bound">l</a> <a id="4358" class="String">&#39; &#39;</a><a id="4361" class="Symbol">)</a>

    <a id="append.size-pad"></a><a id="4368" href="Text.Pretty.Core.html#4368" class="Function">size-pad</a> <a id="4377" class="Symbol">:</a> <a id="4379" href="Data.Maybe.Base.html#1573" class="Function">maybe′</a> <a id="4386" href="Data.String.Base.html#2141" class="Function">length</a> <a id="4393" class="Number">0</a> <a id="4395" href="Text.Pretty.Core.html#4260" class="Function">pad</a> <a id="4399" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="4401" href="Text.Pretty.Core.html#2322" class="Function">x.lastWidth</a>
    <a id="4417" href="Text.Pretty.Core.html#4368" class="Function">size-pad</a> <a id="4426" class="Keyword">with</a> <a id="4431" href="Text.Pretty.Core.html#2322" class="Function">x.lastWidth</a>
    <a id="4447" class="Symbol">...</a> <a id="4451" class="Symbol">|</a> <a id="4453" class="Number">0</a>         <a id="4463" class="Symbol">=</a> <a id="4465" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
    <a id="4474" class="Symbol">...</a> <a id="4478" class="Symbol">|</a> <a id="4480" href="Text.Pretty.Core.html#4480" class="Bound">l</a><a id="4481" class="Symbol">@(</a><a id="4483" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="4487" class="Symbol">_)</a> <a id="4490" class="Symbol">=</a> <a id="4492" href="Data.String.Unsafe.html#1236" class="Function">length-replicate</a> <a id="4509" href="Text.Pretty.Core.html#4480" class="Bound">l</a>

    <a id="append.indent"></a><a id="4516" href="Text.Pretty.Core.html#4516" class="Function">indent</a> <a id="4523" class="Symbol">:</a> <a id="4525" href="Data.Maybe.Base.html#838" class="Datatype">Maybe</a> <a id="4531" href="Agda.Builtin.String.html#274" class="Postulate">String</a> <a id="4538" class="Symbol">→</a> <a id="4540" href="Agda.Builtin.String.html#274" class="Postulate">String</a> <a id="4547" class="Symbol">→</a> <a id="4549" href="Agda.Builtin.String.html#274" class="Postulate">String</a>
    <a id="4560" href="Text.Pretty.Core.html#4516" class="Function">indent</a> <a id="4567" class="Symbol">=</a> <a id="4569" href="Data.Maybe.Base.html#1573" class="Function">maybe′</a> <a id="4576" href="Data.String.Base.html#2077" class="Function Operator">_++_</a> <a id="4581" href="Function.Base.html#615" class="Function">id</a>

    <a id="append.size-indent"></a><a id="4589" href="Text.Pretty.Core.html#4589" class="Function">size-indent</a> <a id="4601" class="Symbol">:</a> <a id="4603" class="Symbol">∀</a> <a id="4605" href="Text.Pretty.Core.html#4605" class="Bound">ma</a> <a id="4608" href="Text.Pretty.Core.html#4608" class="Bound">str</a> <a id="4612" class="Symbol">→</a> <a id="4614" href="Data.String.Base.html#2141" class="Function">length</a> <a id="4621" class="Symbol">(</a><a id="4622" href="Text.Pretty.Core.html#4516" class="Function">indent</a> <a id="4629" href="Text.Pretty.Core.html#4605" class="Bound">ma</a> <a id="4632" href="Text.Pretty.Core.html#4608" class="Bound">str</a><a id="4635" class="Symbol">)</a>
                <a id="4653" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="4655" href="Data.Maybe.Base.html#1573" class="Function">maybe′</a> <a id="4662" href="Data.String.Base.html#2141" class="Function">length</a> <a id="4669" class="Number">0</a> <a id="4671" href="Text.Pretty.Core.html#4605" class="Bound">ma</a> <a id="4674" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="4676" href="Data.String.Base.html#2141" class="Function">length</a> <a id="4683" href="Text.Pretty.Core.html#4608" class="Bound">str</a>
    <a id="4691" href="Text.Pretty.Core.html#4589" class="Function">size-indent</a> <a id="4703" href="Data.Maybe.Base.html#872" class="InductiveConstructor">nothing</a>    <a id="4714" href="Text.Pretty.Core.html#4714" class="Bound">str</a> <a id="4718" class="Symbol">=</a> <a id="4720" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
    <a id="4729" href="Text.Pretty.Core.html#4589" class="Function">size-indent</a> <a id="4741" class="Symbol">(</a><a id="4742" href="Data.Maybe.Base.html#892" class="InductiveConstructor">just</a> <a id="4747" href="Text.Pretty.Core.html#4747" class="Bound">pad</a><a id="4750" class="Symbol">)</a> <a id="4752" href="Text.Pretty.Core.html#4752" class="Bound">str</a> <a id="4756" class="Symbol">=</a> <a id="4758" href="Data.String.Unsafe.html#911" class="Function">length-++</a> <a id="4768" href="Text.Pretty.Core.html#4747" class="Bound">pad</a> <a id="4772" href="Text.Pretty.Core.html#4752" class="Bound">str</a>

    <a id="append.indents"></a><a id="4781" href="Text.Pretty.Core.html#4781" class="Function">indents</a> <a id="4789" class="Symbol">:</a> <a id="4791" href="Data.Maybe.Base.html#838" class="Datatype">Maybe</a> <a id="4797" href="Agda.Builtin.String.html#274" class="Postulate">String</a> <a id="4804" class="Symbol">→</a> <a id="4806" href="Data.Tree.Binary.html#620" class="Datatype">Tree</a> <a id="4811" href="Agda.Builtin.String.html#274" class="Postulate">String</a> <a id="4818" class="Symbol">→</a> <a id="4820" href="Data.Tree.Binary.html#620" class="Datatype">Tree</a> <a id="4825" href="Agda.Builtin.String.html#274" class="Postulate">String</a>
    <a id="4836" href="Text.Pretty.Core.html#4781" class="Function">indents</a> <a id="4844" class="Symbol">=</a> <a id="4846" href="Data.Maybe.Base.html#1573" class="Function">maybe′</a> <a id="4853" class="Symbol">(</a><a id="4854" href="Data.Tree.Binary.html#706" class="Function">Tree.map</a> <a id="4863" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="4865" href="Data.String.Base.html#2077" class="Function Operator">_++_</a><a id="4869" class="Symbol">)</a> <a id="4871" href="Function.Base.html#615" class="Function">id</a>

    <a id="append.size-indents"></a><a id="4879" href="Text.Pretty.Core.html#4879" class="Function">size-indents</a> <a id="4892" class="Symbol">:</a> <a id="4894" class="Symbol">∀</a> <a id="4896" href="Text.Pretty.Core.html#4896" class="Bound">ma</a> <a id="4899" href="Text.Pretty.Core.html#4899" class="Bound">t</a> <a id="4901" class="Symbol">→</a> <a id="4903" href="Data.Tree.Binary.html#817" class="Function">Tree.size</a> <a id="4913" class="Symbol">(</a><a id="4914" href="Text.Pretty.Core.html#4781" class="Function">indents</a> <a id="4922" href="Text.Pretty.Core.html#4896" class="Bound">ma</a> <a id="4925" href="Text.Pretty.Core.html#4899" class="Bound">t</a><a id="4926" class="Symbol">)</a> <a id="4928" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="4930" href="Data.Tree.Binary.html#817" class="Function">Tree.size</a> <a id="4940" href="Text.Pretty.Core.html#4899" class="Bound">t</a>
    <a id="4946" href="Text.Pretty.Core.html#4879" class="Function">size-indents</a> <a id="4959" href="Data.Maybe.Base.html#872" class="InductiveConstructor">nothing</a>    <a id="4970" href="Text.Pretty.Core.html#4970" class="Bound">t</a> <a id="4972" class="Symbol">=</a> <a id="4974" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
    <a id="4983" href="Text.Pretty.Core.html#4879" class="Function">size-indents</a> <a id="4996" class="Symbol">(</a><a id="4997" href="Data.Maybe.Base.html#892" class="InductiveConstructor">just</a> <a id="5002" href="Text.Pretty.Core.html#5002" class="Bound">pad</a><a id="5005" class="Symbol">)</a> <a id="5007" href="Text.Pretty.Core.html#5007" class="Bound">t</a> <a id="5009" class="Symbol">=</a> <a id="5011" href="Data.Tree.Binary.Properties.html#533" class="Function">Treeₚ.size-map</a> <a id="5026" class="Symbol">(</a><a id="5027" href="Text.Pretty.Core.html#5002" class="Bound">pad</a> <a id="5031" href="Data.String.Base.html#2077" class="Function Operator">++_</a><a id="5034" class="Symbol">)</a> <a id="5036" href="Text.Pretty.Core.html#5007" class="Bound">t</a>

    <a id="append.unfold-indents"></a><a id="5043" href="Text.Pretty.Core.html#5043" class="Function">unfold-indents</a> <a id="5058" class="Symbol">:</a> <a id="5060" class="Symbol">∀</a> <a id="5062" href="Text.Pretty.Core.html#5062" class="Bound">ma</a> <a id="5065" href="Text.Pretty.Core.html#5065" class="Bound">t</a> <a id="5067" class="Symbol">→</a> <a id="5069" href="Text.Pretty.Core.html#4781" class="Function">indents</a> <a id="5077" href="Text.Pretty.Core.html#5062" class="Bound">ma</a> <a id="5080" href="Text.Pretty.Core.html#5065" class="Bound">t</a> <a id="5082" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="5084" href="Data.Tree.Binary.html#706" class="Function">Tree.map</a> <a id="5093" class="Symbol">(</a><a id="5094" href="Text.Pretty.Core.html#4516" class="Function">indent</a> <a id="5101" href="Text.Pretty.Core.html#5062" class="Bound">ma</a><a id="5103" class="Symbol">)</a> <a id="5105" href="Text.Pretty.Core.html#5065" class="Bound">t</a>
    <a id="5111" href="Text.Pretty.Core.html#5043" class="Function">unfold-indents</a> <a id="5126" href="Data.Maybe.Base.html#872" class="InductiveConstructor">nothing</a>    <a id="5137" href="Text.Pretty.Core.html#5137" class="Bound">t</a> <a id="5139" class="Symbol">=</a> <a id="5141" href="Relation.Binary.PropositionalEquality.Core.html#980" class="Function">sym</a> <a id="5145" class="Symbol">(</a><a id="5146" href="Data.Tree.Binary.Properties.html#702" class="Function">Treeₚ.map-id</a> <a id="5159" href="Text.Pretty.Core.html#5137" class="Bound">t</a><a id="5160" class="Symbol">)</a>
    <a id="5166" href="Text.Pretty.Core.html#5043" class="Function">unfold-indents</a> <a id="5181" class="Symbol">(</a><a id="5182" href="Data.Maybe.Base.html#892" class="InductiveConstructor">just</a> <a id="5187" href="Text.Pretty.Core.html#5187" class="Bound">pad</a><a id="5190" class="Symbol">)</a> <a id="5192" href="Text.Pretty.Core.html#5192" class="Bound">t</a> <a id="5194" class="Symbol">=</a> <a id="5196" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

    <a id="append.vContent"></a><a id="5206" href="Text.Pretty.Core.html#5206" class="Function">vContent</a> <a id="5215" class="Symbol">:</a> <a id="5217" href="Text.Pretty.Core.html#1927" class="Function">Content</a> <a id="5225" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="5227" href="Agda.Builtin.String.html#274" class="Postulate">String</a>
    <a id="5238" href="Text.Pretty.Core.html#5206" class="Function">vContent</a> <a id="5247" class="Keyword">with</a> <a id="5252" href="Text.Pretty.Core.html#3996" class="Function">blocky</a>
    <a id="5263" class="Symbol">...</a> <a id="5267" class="Symbol">|</a> <a id="5269" href="Data.Maybe.Base.html#872" class="InductiveConstructor">nothing</a>        <a id="5284" class="Symbol">=</a> <a id="5286" href="Text.Pretty.Core.html#3968" class="Function">blockx</a>
                         <a id="5318" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="5320" href="Text.Pretty.Core.html#4088" class="Function">lastx</a> <a id="5326" href="Data.String.Base.html#2077" class="Function Operator">++</a> <a id="5329" href="Text.Pretty.Core.html#4114" class="Function">lasty</a>
    <a id="5339" class="Symbol">...</a> <a id="5343" class="Symbol">|</a> <a id="5345" href="Data.Maybe.Base.html#892" class="InductiveConstructor">just</a> <a id="5350" class="Symbol">(</a><a id="5351" href="Text.Pretty.Core.html#5351" class="Bound">hd</a> <a id="5354" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="5356" href="Text.Pretty.Core.html#5356" class="Bound">tl</a><a id="5358" class="Symbol">)</a> <a id="5360" class="Symbol">=</a> <a id="5362" href="Text.Pretty.Core.html#3010" class="Function">node?</a>
      <a id="5374" class="Comment">{-,--------------,-}</a>
      <a id="5401" class="Comment">{-|-}</a> <a id="5407" href="Text.Pretty.Core.html#3968" class="Function">blockx</a>   <a id="5416" class="Comment">{-|-}</a>
      <a id="5428" class="Comment">{-|-}</a>          <a id="5443" class="Comment">{-&#39;---,-}</a>    <a id="5456" class="Comment">{-,------------------,-}</a>
      <a id="5487" class="Comment">{-|-}</a> <a id="5493" class="Symbol">(</a><a id="5494" href="Text.Pretty.Core.html#4088" class="Function">lastx</a>       <a id="5506" class="Comment">{-|-}</a> <a id="5512" href="Data.String.Base.html#2077" class="Function Operator">++</a> <a id="5515" class="Comment">{-|-}</a>  <a id="5522" href="Text.Pretty.Core.html#5351" class="Bound">hd</a><a id="5524" class="Symbol">)</a>         <a id="5534" class="Comment">{-|-}</a>
      <a id="5546" class="Comment">{-&#39;------------------&#39;-}</a>    <a id="5574" class="Comment">{-|-}</a>              <a id="5593" class="Comment">{-|-}</a>
      <a id="5605" class="Symbol">(</a><a id="5606" href="Text.Pretty.Core.html#4781" class="Function">indents</a> <a id="5614" href="Text.Pretty.Core.html#4260" class="Function">pad</a>                <a id="5633" class="Comment">{-|-}</a>  <a id="5640" href="Text.Pretty.Core.html#5356" class="Bound">tl</a><a id="5642" class="Symbol">)</a>    <a id="5647" class="Comment">{-,----&#39;-}</a>
      <a id="5664" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="5666" href="Text.Pretty.Core.html#4516" class="Function">indent</a> <a id="5673" href="Text.Pretty.Core.html#4260" class="Function">pad</a>                <a id="5692" class="Comment">{-|-}</a> <a id="5698" href="Text.Pretty.Core.html#4114" class="Function">lasty</a>   <a id="5706" class="Comment">{-|-}</a>
                                  <a id="5746" class="Comment">{-&#39;-------------&#39;-}</a>

    <a id="append.vBlock"></a><a id="5771" href="Text.Pretty.Core.html#5771" class="Function">vBlock</a> <a id="5778" class="Symbol">=</a> <a id="5780" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="5786" href="Text.Pretty.Core.html#5206" class="Function">vContent</a>
    <a id="append.vLast"></a><a id="5799" href="Text.Pretty.Core.html#5799" class="Function">vLast</a>  <a id="5806" class="Symbol">=</a> <a id="5808" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="5814" href="Text.Pretty.Core.html#5206" class="Function">vContent</a>

    <a id="append.isBlock"></a><a id="5828" href="Text.Pretty.Core.html#5828" class="Function">isBlock</a> <a id="5836" class="Symbol">:</a> <a id="5838" href="Text.Pretty.Core.html#1981" class="Function">size</a> <a id="5843" href="Text.Pretty.Core.html#3968" class="Function">blockx</a> <a id="5850" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="5852" href="Text.Pretty.Core.html#2237" class="Function">x.height</a> <a id="5861" class="Symbol">→</a> <a id="5863" href="Text.Pretty.Core.html#1981" class="Function">size</a> <a id="5868" href="Text.Pretty.Core.html#3996" class="Function">blocky</a> <a id="5875" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="5877" href="Text.Pretty.Core.html#2237" class="Field">y.height</a> <a id="5886" class="Symbol">→</a>
              <a id="5902" href="Text.Pretty.Core.html#1981" class="Function">size</a> <a id="5907" href="Text.Pretty.Core.html#5771" class="Function">vBlock</a> <a id="5914" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="5916" href="Text.Pretty.Core.html#4141" class="Function">height</a>
    <a id="5927" href="Text.Pretty.Core.html#5828" class="Function">isBlock</a> <a id="5935" href="Text.Pretty.Core.html#5935" class="Bound">∣x∣</a> <a id="5939" href="Text.Pretty.Core.html#5939" class="Bound">∣y∣</a> <a id="5943" class="Keyword">with</a> <a id="5948" href="Text.Pretty.Core.html#3996" class="Function">blocky</a>
    <a id="5959" class="Symbol">...</a> <a id="5963" class="Symbol">|</a> <a id="5965" href="Data.Maybe.Base.html#872" class="InductiveConstructor">nothing</a>        <a id="5980" class="Symbol">=</a> <a id="5982" href="Relation.Binary.PropositionalEquality.Core.html#2517" class="Function Operator">begin</a>
      <a id="5994" href="Text.Pretty.Core.html#1981" class="Function">size</a> <a id="5999" href="Text.Pretty.Core.html#3968" class="Function">blockx</a>         <a id="6014" href="Relation.Binary.PropositionalEquality.Core.html#2634" class="Function">≡⟨</a> <a id="6017" class="Bound">∣x∣</a> <a id="6021" href="Relation.Binary.PropositionalEquality.Core.html#2634" class="Function">⟩</a>
      <a id="6029" href="Text.Pretty.Core.html#2237" class="Function">x.height</a>            <a id="6049" href="Relation.Binary.PropositionalEquality.Core.html#2721" class="Function">≡˘⟨</a> <a id="6053" href="Data.Nat.Properties.html#12646" class="Function">+-identityʳ</a> <a id="6065" href="Text.Pretty.Core.html#2237" class="Function">x.height</a> <a id="6074" href="Relation.Binary.PropositionalEquality.Core.html#2721" class="Function">⟩</a>
      <a id="6082" href="Text.Pretty.Core.html#2237" class="Function">x.height</a> <a id="6091" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="6093" class="Number">0</a>        <a id="6102" href="Relation.Binary.PropositionalEquality.Core.html#2634" class="Function">≡⟨</a> <a id="6105" href="Relation.Binary.PropositionalEquality.Core.html#1131" class="Function">cong</a> <a id="6110" class="Symbol">(_</a> <a id="6113" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+_</a><a id="6115" class="Symbol">)</a> <a id="6117" class="Bound">∣y∣</a> <a id="6121" href="Relation.Binary.PropositionalEquality.Core.html#2634" class="Function">⟩</a>
      <a id="6129" href="Text.Pretty.Core.html#2237" class="Function">x.height</a> <a id="6138" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="6140" href="Text.Pretty.Core.html#2237" class="Field">y.height</a> <a id="6149" href="Relation.Binary.PropositionalEquality.Core.html#2816" class="Function Operator">∎</a> <a id="6151" class="Keyword">where</a> <a id="6157" class="Keyword">open</a> <a id="6162" href="Relation.Binary.PropositionalEquality.Core.html#2419" class="Module">≡-Reasoning</a>
    <a id="6178" class="Symbol">...</a> <a id="6182" class="Symbol">|</a> <a id="6184" href="Data.Maybe.Base.html#892" class="InductiveConstructor">just</a> <a id="6189" class="Symbol">(</a><a id="6190" href="Text.Pretty.Core.html#6190" class="Bound">hd</a> <a id="6193" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="6195" href="Text.Pretty.Core.html#6195" class="Bound">tl</a><a id="6197" class="Symbol">)</a> <a id="6199" class="Symbol">=</a> <a id="6201" href="Relation.Binary.PropositionalEquality.Core.html#2517" class="Function Operator">begin</a>
      <a id="6213" href="Text.Pretty.Core.html#6622" class="Function">∣node∣</a>                          <a id="6245" href="Relation.Binary.PropositionalEquality.Core.html#2634" class="Function">≡⟨</a> <a id="6248" href="Text.Pretty.Core.html#3156" class="Function">∣node?∣</a> <a id="6256" href="Text.Pretty.Core.html#3968" class="Function">blockx</a> <a id="6263" href="Text.Pretty.Core.html#6524" class="Function">middle</a> <a id="6270" href="Text.Pretty.Core.html#6553" class="Function">rest</a> <a id="6275" href="Relation.Binary.PropositionalEquality.Core.html#2634" class="Function">⟩</a>
      <a id="6283" href="Text.Pretty.Core.html#6495" class="Function">∣blockx∣</a> <a id="6292" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="6294" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="6298" class="Symbol">(</a><a id="6299" href="Data.Tree.Binary.html#817" class="Function">Tree.size</a> <a id="6309" href="Text.Pretty.Core.html#6553" class="Function">rest</a><a id="6313" class="Symbol">)</a> <a id="6315" href="Relation.Binary.PropositionalEquality.Core.html#2634" class="Function">≡⟨</a> <a id="6318" href="Relation.Binary.PropositionalEquality.Core.html#1131" class="Function">cong</a> <a id="6323" class="Symbol">((</a><a id="6325" href="Text.Pretty.Core.html#1981" class="Function">size</a> <a id="6330" href="Text.Pretty.Core.html#3968" class="Function">blockx</a> <a id="6337" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+_</a><a id="6339" class="Symbol">)</a> <a id="6341" href="Function.Base.html#3193" class="Function Operator">∘′</a> <a id="6344" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a><a id="6347" class="Symbol">)</a> <a id="6349" href="Text.Pretty.Core.html#6585" class="Function">∣rest∣</a> <a id="6356" href="Relation.Binary.PropositionalEquality.Core.html#2634" class="Function">⟩</a>
      <a id="6364" href="Text.Pretty.Core.html#6495" class="Function">∣blockx∣</a> <a id="6373" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="6375" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="6379" class="Symbol">(</a><a id="6380" href="Data.Tree.Binary.html#817" class="Function">Tree.size</a> <a id="6390" href="Text.Pretty.Core.html#6195" class="Bound">tl</a><a id="6392" class="Symbol">)</a>   <a id="6396" href="Relation.Binary.PropositionalEquality.Core.html#2634" class="Function">≡⟨</a> <a id="6399" href="Relation.Binary.PropositionalEquality.html#1524" class="Function">cong₂</a> <a id="6405" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">_+_</a> <a id="6409" class="Bound">∣x∣</a> <a id="6413" class="Bound">∣y∣</a> <a id="6417" href="Relation.Binary.PropositionalEquality.Core.html#2634" class="Function">⟩</a>
      <a id="6425" href="Text.Pretty.Core.html#2237" class="Function">x.height</a> <a id="6434" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="6436" href="Text.Pretty.Core.html#2237" class="Field">y.height</a>             <a id="6457" href="Relation.Binary.PropositionalEquality.Core.html#2816" class="Function Operator">∎</a> <a id="6459" class="Keyword">where</a>

      <a id="6472" class="Keyword">open</a> <a id="6477" href="Relation.Binary.PropositionalEquality.Core.html#2419" class="Module">≡-Reasoning</a>
      <a id="6495" href="Text.Pretty.Core.html#6495" class="Function">∣blockx∣</a> <a id="6504" class="Symbol">=</a> <a id="6506" href="Text.Pretty.Core.html#1981" class="Function">size</a> <a id="6511" href="Text.Pretty.Core.html#3968" class="Function">blockx</a>
      <a id="6524" href="Text.Pretty.Core.html#6524" class="Function">middle</a>   <a id="6533" class="Symbol">=</a> <a id="6535" href="Text.Pretty.Core.html#4088" class="Function">lastx</a> <a id="6541" href="Data.String.Base.html#2077" class="Function Operator">++</a> <a id="6544" href="Text.Pretty.Core.html#6190" class="Bound">hd</a>
      <a id="6553" href="Text.Pretty.Core.html#6553" class="Function">rest</a>     <a id="6562" class="Symbol">=</a> <a id="6564" href="Text.Pretty.Core.html#4781" class="Function">indents</a> <a id="6572" href="Text.Pretty.Core.html#4260" class="Function">pad</a> <a id="6576" href="Text.Pretty.Core.html#6195" class="Bound">tl</a>
      <a id="6585" href="Text.Pretty.Core.html#6585" class="Function">∣rest∣</a>   <a id="6594" class="Symbol">=</a> <a id="6596" href="Text.Pretty.Core.html#4879" class="Function">size-indents</a> <a id="6609" href="Text.Pretty.Core.html#4260" class="Function">pad</a> <a id="6613" href="Text.Pretty.Core.html#6195" class="Bound">tl</a>
      <a id="6622" href="Text.Pretty.Core.html#6622" class="Function">∣node∣</a>   <a id="6631" class="Symbol">=</a> <a id="6633" href="Text.Pretty.Core.html#1981" class="Function">size</a> <a id="6638" class="Symbol">(</a><a id="6639" href="Text.Pretty.Core.html#3010" class="Function">node?</a> <a id="6645" href="Text.Pretty.Core.html#3968" class="Function">blockx</a> <a id="6652" href="Text.Pretty.Core.html#6524" class="Function">middle</a> <a id="6659" href="Text.Pretty.Core.html#6553" class="Function">rest</a><a id="6663" class="Symbol">)</a>

    <a id="append.block"></a><a id="6670" href="Text.Pretty.Core.html#6670" class="Function">block</a> <a id="6676" class="Symbol">:</a> <a id="6678" href="Data.Refinement.html#869" class="Function">[</a> <a id="6680" href="Text.Pretty.Core.html#6680" class="Bound">xs</a> <a id="6683" href="Data.Refinement.html#869" class="Function">∈</a> <a id="6685" href="Text.Pretty.Core.html#1927" class="Function">Content</a> <a id="6693" href="Data.Refinement.html#869" class="Function">∣</a> <a id="6695" href="Text.Pretty.Core.html#1981" class="Function">size</a> <a id="6700" href="Text.Pretty.Core.html#6680" class="Bound">xs</a> <a id="6703" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="6705" href="Text.Pretty.Core.html#4141" class="Function">height</a> <a id="6712" href="Data.Refinement.html#869" class="Function">]</a>
    <a id="6718" href="Text.Pretty.Core.html#6670" class="Function">block</a> <a id="6724" class="Symbol">.</a><a id="6725" href="Data.Refinement.html#592" class="Field">value</a> <a id="6731" class="Symbol">=</a> <a id="6733" href="Text.Pretty.Core.html#5771" class="Function">vBlock</a>
    <a id="6744" href="Text.Pretty.Core.html#6670" class="Function">block</a> <a id="6750" class="Symbol">.</a><a id="6751" href="Data.Refinement.html#610" class="Field">proof</a> <a id="6757" class="Symbol">=</a> <a id="6759" class="Symbol">⦇</a> <a id="6761" href="Text.Pretty.Core.html#5828" class="Function">isBlock</a> <a id="6769" class="Symbol">(</a><a id="6770" href="Text.Pretty.Core.html#2255" class="Field">Block.block</a> <a id="6782" href="Text.Pretty.Core.html#3897" class="Bound">x</a> <a id="6784" class="Symbol">.</a><a id="6785" href="Data.Refinement.html#610" class="Field">proof</a><a id="6790" class="Symbol">)</a> <a id="6792" class="Symbol">(</a><a id="6793" href="Text.Pretty.Core.html#2255" class="Field">Block.block</a> <a id="6805" href="Text.Pretty.Core.html#3899" class="Bound">y</a> <a id="6807" class="Symbol">.</a><a id="6808" href="Data.Refinement.html#610" class="Field">proof</a><a id="6813" class="Symbol">)</a> <a id="6815" class="Symbol">⦈</a>
      <a id="6823" class="Keyword">where</a> <a id="6829" class="Keyword">open</a> <a id="6834" href="Data.Erased.html" class="Module">Erased</a>

    <a id="append.isLastLine"></a><a id="6846" href="Text.Pretty.Core.html#6846" class="Function">isLastLine</a> <a id="6857" class="Symbol">:</a> <a id="6859" href="Data.String.Base.html#2141" class="Function">length</a> <a id="6866" href="Text.Pretty.Core.html#4088" class="Function">lastx</a> <a id="6872" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="6874" href="Text.Pretty.Core.html#2322" class="Function">x.lastWidth</a> <a id="6886" class="Symbol">→</a>
                 <a id="6905" href="Data.String.Base.html#2141" class="Function">length</a> <a id="6912" href="Text.Pretty.Core.html#4114" class="Function">lasty</a> <a id="6918" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="6920" href="Text.Pretty.Core.html#2322" class="Field">y.lastWidth</a> <a id="6932" class="Symbol">→</a>
                 <a id="6951" href="Data.String.Base.html#2141" class="Function">length</a> <a id="6958" href="Text.Pretty.Core.html#5799" class="Function">vLast</a> <a id="6964" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="6966" href="Text.Pretty.Core.html#4196" class="Function">lastWidth</a>
    <a id="6980" href="Text.Pretty.Core.html#6846" class="Function">isLastLine</a> <a id="6991" href="Text.Pretty.Core.html#6991" class="Bound">∣x∣</a> <a id="6995" href="Text.Pretty.Core.html#6995" class="Bound">∣y∣</a> <a id="6999" class="Keyword">with</a> <a id="7004" href="Text.Pretty.Core.html#3996" class="Function">blocky</a>
    <a id="7015" class="Symbol">...</a> <a id="7019" class="Symbol">|</a> <a id="7021" href="Data.Maybe.Base.html#872" class="InductiveConstructor">nothing</a>        <a id="7036" class="Symbol">=</a> <a id="7038" href="Relation.Binary.PropositionalEquality.Core.html#2517" class="Function Operator">begin</a>
      <a id="7050" href="Data.String.Base.html#2141" class="Function">length</a> <a id="7057" class="Symbol">(</a><a id="7058" href="Text.Pretty.Core.html#4088" class="Function">lastx</a> <a id="7064" href="Data.String.Base.html#2077" class="Function Operator">++</a> <a id="7067" href="Text.Pretty.Core.html#4114" class="Function">lasty</a><a id="7072" class="Symbol">)</a>       <a id="7080" href="Relation.Binary.PropositionalEquality.Core.html#2634" class="Function">≡⟨</a> <a id="7083" href="Data.String.Unsafe.html#911" class="Function">length-++</a> <a id="7093" href="Text.Pretty.Core.html#4088" class="Function">lastx</a> <a id="7099" href="Text.Pretty.Core.html#4114" class="Function">lasty</a> <a id="7105" href="Relation.Binary.PropositionalEquality.Core.html#2634" class="Function">⟩</a>
      <a id="7113" href="Data.String.Base.html#2141" class="Function">length</a> <a id="7120" href="Text.Pretty.Core.html#4088" class="Function">lastx</a> <a id="7126" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="7128" href="Data.String.Base.html#2141" class="Function">length</a> <a id="7135" href="Text.Pretty.Core.html#4114" class="Function">lasty</a>   <a id="7143" href="Relation.Binary.PropositionalEquality.Core.html#2634" class="Function">≡⟨</a> <a id="7146" href="Relation.Binary.PropositionalEquality.html#1524" class="Function">cong₂</a> <a id="7152" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">_+_</a> <a id="7156" class="Bound">∣x∣</a> <a id="7160" class="Bound">∣y∣</a> <a id="7164" href="Relation.Binary.PropositionalEquality.Core.html#2634" class="Function">⟩</a>
      <a id="7172" href="Text.Pretty.Core.html#2322" class="Function">x.lastWidth</a> <a id="7184" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="7186" href="Text.Pretty.Core.html#2322" class="Field">y.lastWidth</a>     <a id="7202" href="Relation.Binary.PropositionalEquality.Core.html#2816" class="Function Operator">∎</a> <a id="7204" class="Keyword">where</a> <a id="7210" class="Keyword">open</a> <a id="7215" href="Relation.Binary.PropositionalEquality.Core.html#2419" class="Module">≡-Reasoning</a>
    <a id="7231" class="Symbol">...</a> <a id="7235" class="Symbol">|</a> <a id="7237" href="Data.Maybe.Base.html#892" class="InductiveConstructor">just</a> <a id="7242" class="Symbol">(</a><a id="7243" href="Text.Pretty.Core.html#7243" class="Bound">hd</a> <a id="7246" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7248" href="Text.Pretty.Core.html#7248" class="Bound">tl</a><a id="7250" class="Symbol">)</a> <a id="7252" class="Symbol">=</a> <a id="7254" href="Relation.Binary.PropositionalEquality.Core.html#2517" class="Function Operator">begin</a>
      <a id="7266" href="Data.String.Base.html#2141" class="Function">length</a> <a id="7273" class="Symbol">(</a><a id="7274" href="Text.Pretty.Core.html#4516" class="Function">indent</a> <a id="7281" href="Text.Pretty.Core.html#4260" class="Function">pad</a> <a id="7285" href="Text.Pretty.Core.html#4114" class="Function">lasty</a><a id="7290" class="Symbol">)</a>          <a id="7301" href="Relation.Binary.PropositionalEquality.Core.html#2634" class="Function">≡⟨</a> <a id="7304" href="Text.Pretty.Core.html#4589" class="Function">size-indent</a> <a id="7316" href="Text.Pretty.Core.html#4260" class="Function">pad</a> <a id="7320" href="Text.Pretty.Core.html#4114" class="Function">lasty</a> <a id="7326" href="Relation.Binary.PropositionalEquality.Core.html#2634" class="Function">⟩</a>
      <a id="7334" href="Data.Maybe.Base.html#1573" class="Function">maybe′</a> <a id="7341" href="Data.String.Base.html#2141" class="Function">length</a> <a id="7348" class="Number">0</a> <a id="7350" href="Text.Pretty.Core.html#4260" class="Function">pad</a> <a id="7354" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="7356" href="Data.String.Base.html#2141" class="Function">length</a> <a id="7363" href="Text.Pretty.Core.html#4114" class="Function">lasty</a> <a id="7369" href="Relation.Binary.PropositionalEquality.Core.html#2634" class="Function">≡⟨</a> <a id="7372" href="Relation.Binary.PropositionalEquality.html#1524" class="Function">cong₂</a> <a id="7378" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">_+_</a> <a id="7382" href="Text.Pretty.Core.html#4368" class="Function">size-pad</a> <a id="7391" class="Bound">∣y∣</a> <a id="7395" href="Relation.Binary.PropositionalEquality.Core.html#2634" class="Function">⟩</a>
      <a id="7403" href="Text.Pretty.Core.html#2322" class="Function">x.lastWidth</a> <a id="7415" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="7417" href="Text.Pretty.Core.html#2322" class="Field">y.lastWidth</a>          <a id="7438" href="Relation.Binary.PropositionalEquality.Core.html#2816" class="Function Operator">∎</a> <a id="7440" class="Keyword">where</a> <a id="7446" class="Keyword">open</a> <a id="7451" href="Relation.Binary.PropositionalEquality.Core.html#2419" class="Module">≡-Reasoning</a>

    <a id="append.last"></a><a id="7468" href="Text.Pretty.Core.html#7468" class="Function">last</a> <a id="7473" class="Symbol">:</a> <a id="7475" href="Data.Refinement.html#869" class="Function">[</a> <a id="7477" href="Text.Pretty.Core.html#7477" class="Bound">s</a> <a id="7479" href="Data.Refinement.html#869" class="Function">∈</a> <a id="7481" href="Agda.Builtin.String.html#274" class="Postulate">String</a> <a id="7488" href="Data.Refinement.html#869" class="Function">∣</a> <a id="7490" href="Data.String.Base.html#2141" class="Function">length</a> <a id="7497" href="Text.Pretty.Core.html#7477" class="Bound">s</a> <a id="7499" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="7501" href="Text.Pretty.Core.html#4196" class="Function">lastWidth</a> <a id="7511" href="Data.Refinement.html#869" class="Function">]</a>
    <a id="7517" href="Text.Pretty.Core.html#7468" class="Function">last</a> <a id="7522" class="Symbol">.</a><a id="7523" href="Data.Refinement.html#592" class="Field">value</a> <a id="7529" class="Symbol">=</a> <a id="7531" href="Text.Pretty.Core.html#5799" class="Function">vLast</a>
    <a id="7541" href="Text.Pretty.Core.html#7468" class="Function">last</a> <a id="7546" class="Symbol">.</a><a id="7547" href="Data.Refinement.html#610" class="Field">proof</a> <a id="7553" class="Symbol">=</a> <a id="7555" class="Symbol">⦇</a> <a id="7557" href="Text.Pretty.Core.html#6846" class="Function">isLastLine</a> <a id="7568" class="Symbol">(</a><a id="7569" href="Text.Pretty.Core.html#2340" class="Field">Block.last</a> <a id="7580" href="Text.Pretty.Core.html#3897" class="Bound">x</a> <a id="7582" class="Symbol">.</a><a id="7583" href="Data.Refinement.html#610" class="Field">proof</a><a id="7588" class="Symbol">)</a> <a id="7590" class="Symbol">(</a><a id="7591" href="Text.Pretty.Core.html#2340" class="Field">Block.last</a> <a id="7602" href="Text.Pretty.Core.html#3899" class="Bound">y</a> <a id="7604" class="Symbol">.</a><a id="7605" href="Data.Refinement.html#610" class="Field">proof</a><a id="7610" class="Symbol">)</a> <a id="7612" class="Symbol">⦈</a>
      <a id="7620" class="Keyword">where</a> <a id="7626" class="Keyword">open</a> <a id="7631" href="Data.Erased.html" class="Module">Erased</a>

    <a id="append.vMaxWidth"></a><a id="7643" href="Text.Pretty.Core.html#7643" class="Function">vMaxWidth</a> <a id="7653" class="Symbol">:</a> <a id="7655" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
    <a id="7661" href="Text.Pretty.Core.html#7643" class="Function">vMaxWidth</a> <a id="7671" class="Symbol">=</a> <a id="7673" href="Text.Pretty.Core.html#4025" class="Function">widthx</a> <a id="7680" href="Data.Nat.Base.html#1640" class="Function Operator">⊔</a> <a id="7682" class="Symbol">(</a><a id="7683" href="Text.Pretty.Core.html#2322" class="Function">x.lastWidth</a> <a id="7695" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="7697" href="Text.Pretty.Core.html#4056" class="Function">widthy</a><a id="7703" class="Symbol">)</a>

    <a id="append.isMaxWidth₁"></a><a id="7710" href="Text.Pretty.Core.html#7710" class="Function">isMaxWidth₁</a> <a id="7722" class="Symbol">:</a> <a id="7724" href="Text.Pretty.Core.html#2322" class="Field">y.lastWidth</a> <a id="7736" href="Data.Nat.Base.html#937" class="Datatype Operator">≤</a> <a id="7738" href="Text.Pretty.Core.html#4056" class="Function">widthy</a> <a id="7745" class="Symbol">→</a> <a id="7747" href="Text.Pretty.Core.html#4196" class="Function">lastWidth</a> <a id="7757" href="Data.Nat.Base.html#937" class="Datatype Operator">≤</a> <a id="7759" href="Text.Pretty.Core.html#7643" class="Function">vMaxWidth</a>
    <a id="7773" href="Text.Pretty.Core.html#7710" class="Function">isMaxWidth₁</a> <a id="7785" href="Text.Pretty.Core.html#7785" class="Bound">p</a> <a id="7787" class="Symbol">=</a> <a id="7789" href="Relation.Binary.Reasoning.Base.Triple.html#3005" class="Function Operator">begin</a>
      <a id="7801" href="Text.Pretty.Core.html#4196" class="Function">lastWidth</a>            <a id="7822" href="Relation.Binary.Reasoning.Base.Triple.html#3740" class="Function">≤⟨</a> <a id="7825" href="Data.Nat.Properties.html#17410" class="Function">+-monoʳ-≤</a> <a id="7835" href="Text.Pretty.Core.html#2322" class="Function">x.lastWidth</a> <a id="7847" href="Text.Pretty.Core.html#7785" class="Bound">p</a> <a id="7849" href="Relation.Binary.Reasoning.Base.Triple.html#3740" class="Function">⟩</a>
      <a id="7857" href="Text.Pretty.Core.html#2322" class="Function">x.lastWidth</a> <a id="7869" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="7871" href="Text.Pretty.Core.html#4056" class="Function">widthy</a> <a id="7878" href="Relation.Binary.Reasoning.Base.Triple.html#3740" class="Function">≤⟨</a> <a id="7881" href="Data.Nat.Properties.html#30841" class="Function">n≤m⊔n</a> <a id="7887" class="Symbol">_</a> <a id="7889" class="Symbol">_</a> <a id="7891" href="Relation.Binary.Reasoning.Base.Triple.html#3740" class="Function">⟩</a>
      <a id="7899" href="Text.Pretty.Core.html#7643" class="Function">vMaxWidth</a>            <a id="7920" href="Relation.Binary.Reasoning.Base.Triple.html#5114" class="Function Operator">∎</a> <a id="7922" class="Keyword">where</a> <a id="7928" class="Keyword">open</a> <a id="7933" href="Data.Nat.Properties.html#11242" class="Module">≤-Reasoning</a>

    <a id="append.isMaxWidth₂"></a><a id="7950" href="Text.Pretty.Core.html#7950" class="Function">isMaxWidth₂</a> <a id="7962" class="Symbol">:</a> <a id="7964" href="Data.String.Base.html#2141" class="Function">length</a> <a id="7971" href="Text.Pretty.Core.html#4088" class="Function">lastx</a> <a id="7977" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="7979" href="Text.Pretty.Core.html#2322" class="Function">x.lastWidth</a> <a id="7991" class="Symbol">→</a>
                  <a id="8011" href="Text.Pretty.Core.html#2322" class="Function">x.lastWidth</a> <a id="8023" href="Data.Nat.Base.html#937" class="Datatype Operator">≤</a> <a id="8025" href="Text.Pretty.Core.html#4025" class="Function">widthx</a> <a id="8032" class="Symbol">→</a>
                  <a id="8052" href="Text.Pretty.Core.html#2140" class="Function">All≤</a> <a id="8057" href="Text.Pretty.Core.html#4025" class="Function">widthx</a> <a id="8064" href="Text.Pretty.Core.html#3968" class="Function">blockx</a> <a id="8071" class="Symbol">→</a>
                  <a id="8091" href="Text.Pretty.Core.html#2140" class="Function">All≤</a> <a id="8096" href="Text.Pretty.Core.html#4056" class="Function">widthy</a> <a id="8103" href="Text.Pretty.Core.html#3996" class="Function">blocky</a> <a id="8110" class="Symbol">→</a>
                  <a id="8130" href="Text.Pretty.Core.html#2140" class="Function">All≤</a> <a id="8135" href="Text.Pretty.Core.html#7643" class="Function">vMaxWidth</a> <a id="8145" href="Text.Pretty.Core.html#5771" class="Function">vBlock</a>
    <a id="8156" href="Text.Pretty.Core.html#7950" class="Function">isMaxWidth₂</a> <a id="8168" href="Text.Pretty.Core.html#8168" class="Bound">∣x∣≡</a> <a id="8173" href="Text.Pretty.Core.html#8173" class="Bound">∣x∣≤</a> <a id="8178" href="Text.Pretty.Core.html#8178" class="Bound">∣xs∣</a> <a id="8183" href="Text.Pretty.Core.html#8183" class="Bound">∣ys∣</a> <a id="8188" class="Keyword">with</a> <a id="8193" href="Text.Pretty.Core.html#3996" class="Function">blocky</a>
    <a id="8204" class="Symbol">...</a> <a id="8208" class="Symbol">|</a> <a id="8210" href="Data.Maybe.Base.html#872" class="InductiveConstructor">nothing</a>        <a id="8225" class="Symbol">=</a> <a id="8227" href="Text.Pretty.Core.html#3319" class="Function">≤-Content</a> <a id="8237" class="Symbol">(</a><a id="8238" href="Data.Nat.Properties.html#30715" class="Function">m≤m⊔n</a> <a id="8244" class="Symbol">_</a> <a id="8246" class="Symbol">_)</a> <a id="8249" class="Bound">∣xs∣</a>
    <a id="8258" href="Text.Pretty.Core.html#7950" class="Function">isMaxWidth₂</a> <a id="8270" href="Text.Pretty.Core.html#8270" class="Bound">∣x∣≡</a> <a id="8275" href="Text.Pretty.Core.html#8275" class="Bound">∣x∣≤</a> <a id="8280" href="Text.Pretty.Core.html#8280" class="Bound">∣xs∣</a> <a id="8285" class="Symbol">(</a><a id="8286" href="Data.Maybe.Relation.Unary.All.html#1013" class="InductiveConstructor">just</a> <a id="8291" class="Symbol">(</a><a id="8292" href="Text.Pretty.Core.html#8292" class="Bound">∣hd∣</a> <a id="8297" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="8299" href="Text.Pretty.Core.html#8299" class="Bound">∣tl∣</a><a id="8303" class="Symbol">))</a>
        <a id="8314" class="Symbol">|</a> <a id="8316" href="Data.Maybe.Base.html#892" class="InductiveConstructor">just</a> <a id="8321" class="Symbol">(</a><a id="8322" href="Text.Pretty.Core.html#8322" class="Bound">hd</a> <a id="8325" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="8327" href="Text.Pretty.Core.html#8327" class="Bound">tl</a><a id="8329" class="Symbol">)</a> <a id="8331" class="Symbol">=</a>
      <a id="8339" href="Text.Pretty.Core.html#3516" class="Function">All≤-node?</a> <a id="8350" class="Symbol">(</a><a id="8351" href="Text.Pretty.Core.html#3319" class="Function">≤-Content</a> <a id="8361" class="Symbol">(</a><a id="8362" href="Data.Nat.Properties.html#30715" class="Function">m≤m⊔n</a> <a id="8368" class="Symbol">_</a> <a id="8370" class="Symbol">_)</a> <a id="8373" href="Text.Pretty.Core.html#8280" class="Bound">∣xs∣</a><a id="8377" class="Symbol">)</a>
                 <a id="8396" href="Text.Pretty.Core.html#8562" class="Function">middle</a>
                 <a id="8420" class="Symbol">(</a><a id="8421" href="Relation.Binary.PropositionalEquality.Core.html#1076" class="Function">subst</a> <a id="8427" class="Symbol">(</a><a id="8428" href="Data.Tree.Binary.Relation.Unary.All.html#500" class="Datatype">Allᵀ.All</a> <a id="8437" class="Symbol">_)</a> <a id="8440" class="Symbol">(</a><a id="8441" href="Relation.Binary.PropositionalEquality.Core.html#980" class="Function">sym</a> <a id="8445" href="Function.Base.html#1538" class="Function Operator">$</a> <a id="8447" href="Text.Pretty.Core.html#5043" class="Function">unfold-indents</a> <a id="8462" href="Text.Pretty.Core.html#4260" class="Function">pad</a> <a id="8466" href="Text.Pretty.Core.html#8327" class="Bound">tl</a><a id="8468" class="Symbol">)</a>
                 <a id="8487" href="Function.Base.html#1538" class="Function Operator">$</a> <a id="8489" href="Data.Tree.Binary.Relation.Unary.All.Properties.html#606" class="Function">Allᵀₚ.map⁺</a> <a id="8500" class="Symbol">(</a><a id="8501" href="Text.Pretty.Core.html#4516" class="Function">indent</a> <a id="8508" href="Text.Pretty.Core.html#4260" class="Function">pad</a><a id="8511" class="Symbol">)</a> <a id="8513" class="Symbol">(</a><a id="8514" href="Data.Tree.Binary.Relation.Unary.All.html#698" class="Function">Allᵀ.map</a> <a id="8523" class="Symbol">(</a><a id="8524" href="Text.Pretty.Core.html#8915" class="Function">indented</a> <a id="8533" class="Symbol">_)</a> <a id="8536" href="Text.Pretty.Core.html#8299" class="Bound">∣tl∣</a><a id="8540" class="Symbol">))</a>
      <a id="8549" class="Keyword">where</a>

      <a id="8562" href="Text.Pretty.Core.html#8562" class="Function">middle</a> <a id="8569" class="Symbol">:</a> <a id="8571" href="Data.String.Base.html#2141" class="Function">length</a> <a id="8578" class="Symbol">(</a><a id="8579" href="Text.Pretty.Core.html#4088" class="Function">lastx</a> <a id="8585" href="Data.String.Base.html#2077" class="Function Operator">++</a> <a id="8588" href="Text.Pretty.Core.html#8322" class="Bound">hd</a><a id="8590" class="Symbol">)</a> <a id="8592" href="Data.Nat.Base.html#937" class="Datatype Operator">≤</a> <a id="8594" href="Text.Pretty.Core.html#7643" class="Function">vMaxWidth</a>
      <a id="8610" href="Text.Pretty.Core.html#8562" class="Function">middle</a> <a id="8617" class="Symbol">=</a> <a id="8619" href="Relation.Binary.Reasoning.Base.Triple.html#3005" class="Function Operator">begin</a>
        <a id="8633" href="Data.String.Base.html#2141" class="Function">length</a> <a id="8640" class="Symbol">(</a><a id="8641" href="Text.Pretty.Core.html#4088" class="Function">lastx</a> <a id="8647" href="Data.String.Base.html#2077" class="Function Operator">++</a> <a id="8650" href="Text.Pretty.Core.html#8322" class="Bound">hd</a><a id="8652" class="Symbol">)</a>     <a id="8658" href="Relation.Binary.Reasoning.Base.Triple.html#4513" class="Function">≡⟨</a> <a id="8661" href="Data.String.Unsafe.html#911" class="Function">length-++</a> <a id="8671" href="Text.Pretty.Core.html#4088" class="Function">lastx</a> <a id="8677" href="Text.Pretty.Core.html#8322" class="Bound">hd</a> <a id="8680" href="Relation.Binary.Reasoning.Base.Triple.html#4513" class="Function">⟩</a>
        <a id="8690" href="Data.String.Base.html#2141" class="Function">length</a> <a id="8697" href="Text.Pretty.Core.html#4088" class="Function">lastx</a> <a id="8703" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="8705" href="Data.String.Base.html#2141" class="Function">length</a> <a id="8712" href="Text.Pretty.Core.html#8322" class="Bound">hd</a> <a id="8715" href="Relation.Binary.Reasoning.Base.Triple.html#4513" class="Function">≡⟨</a> <a id="8718" href="Relation.Binary.PropositionalEquality.Core.html#1131" class="Function">cong</a> <a id="8723" class="Symbol">(</a><a id="8724" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">_+</a> <a id="8727" class="Symbol">_)</a> <a id="8730" href="Text.Pretty.Core.html#8270" class="Bound">∣x∣≡</a> <a id="8735" href="Relation.Binary.Reasoning.Base.Triple.html#4513" class="Function">⟩</a>
        <a id="8745" href="Text.Pretty.Core.html#2322" class="Function">x.lastWidth</a> <a id="8757" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="8759" href="Data.String.Base.html#2141" class="Function">length</a> <a id="8766" href="Text.Pretty.Core.html#8322" class="Bound">hd</a>  <a id="8770" href="Relation.Binary.Reasoning.Base.Triple.html#3740" class="Function">≤⟨</a> <a id="8773" href="Data.Nat.Properties.html#17410" class="Function">+-monoʳ-≤</a> <a id="8783" href="Text.Pretty.Core.html#2322" class="Function">x.lastWidth</a> <a id="8795" href="Text.Pretty.Core.html#8292" class="Bound">∣hd∣</a> <a id="8800" href="Relation.Binary.Reasoning.Base.Triple.html#3740" class="Function">⟩</a>
        <a id="8810" href="Text.Pretty.Core.html#2322" class="Function">x.lastWidth</a> <a id="8822" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="8824" href="Text.Pretty.Core.html#4056" class="Function">widthy</a>     <a id="8835" href="Relation.Binary.Reasoning.Base.Triple.html#3740" class="Function">≤⟨</a> <a id="8838" href="Data.Nat.Properties.html#30841" class="Function">n≤m⊔n</a> <a id="8844" class="Symbol">_</a> <a id="8846" class="Symbol">_</a> <a id="8848" href="Relation.Binary.Reasoning.Base.Triple.html#3740" class="Function">⟩</a>
        <a id="8858" href="Text.Pretty.Core.html#7643" class="Function">vMaxWidth</a>                <a id="8883" href="Relation.Binary.Reasoning.Base.Triple.html#5114" class="Function Operator">∎</a> <a id="8885" class="Keyword">where</a> <a id="8891" class="Keyword">open</a> <a id="8896" href="Data.Nat.Properties.html#11242" class="Module">≤-Reasoning</a>

      <a id="8915" href="Text.Pretty.Core.html#8915" class="Function">indented</a> <a id="8924" class="Symbol">:</a> <a id="8926" class="Symbol">∀</a> <a id="8928" href="Text.Pretty.Core.html#8928" class="Bound">s</a> <a id="8930" class="Symbol">→</a> <a id="8932" href="Data.String.Base.html#2141" class="Function">length</a> <a id="8939" href="Text.Pretty.Core.html#8928" class="Bound">s</a> <a id="8941" href="Data.Nat.Base.html#937" class="Datatype Operator">≤</a> <a id="8943" href="Text.Pretty.Core.html#4056" class="Function">widthy</a> <a id="8950" class="Symbol">→</a>
                 <a id="8969" href="Data.String.Base.html#2141" class="Function">length</a> <a id="8976" class="Symbol">(</a><a id="8977" href="Text.Pretty.Core.html#4516" class="Function">indent</a> <a id="8984" href="Text.Pretty.Core.html#4260" class="Function">pad</a> <a id="8988" href="Text.Pretty.Core.html#8928" class="Bound">s</a><a id="8989" class="Symbol">)</a> <a id="8991" href="Data.Nat.Base.html#937" class="Datatype Operator">≤</a> <a id="8993" href="Text.Pretty.Core.html#7643" class="Function">vMaxWidth</a>
      <a id="9009" href="Text.Pretty.Core.html#8915" class="Function">indented</a> <a id="9018" href="Text.Pretty.Core.html#9018" class="Bound">s</a> <a id="9020" href="Text.Pretty.Core.html#9020" class="Bound">∣s∣</a> <a id="9024" class="Symbol">=</a> <a id="9026" href="Relation.Binary.Reasoning.Base.Triple.html#3005" class="Function Operator">begin</a>
        <a id="9040" href="Data.String.Base.html#2141" class="Function">length</a> <a id="9047" class="Symbol">(</a><a id="9048" href="Text.Pretty.Core.html#4516" class="Function">indent</a> <a id="9055" href="Text.Pretty.Core.html#4260" class="Function">pad</a> <a id="9059" href="Text.Pretty.Core.html#9018" class="Bound">s</a><a id="9060" class="Symbol">)</a>          <a id="9071" href="Relation.Binary.Reasoning.Base.Triple.html#4513" class="Function">≡⟨</a> <a id="9074" href="Text.Pretty.Core.html#4589" class="Function">size-indent</a> <a id="9086" href="Text.Pretty.Core.html#4260" class="Function">pad</a> <a id="9090" href="Text.Pretty.Core.html#9018" class="Bound">s</a> <a id="9092" href="Relation.Binary.Reasoning.Base.Triple.html#4513" class="Function">⟩</a>
        <a id="9102" href="Data.Maybe.Base.html#1573" class="Function">maybe′</a> <a id="9109" href="Data.String.Base.html#2141" class="Function">length</a> <a id="9116" class="Number">0</a> <a id="9118" href="Text.Pretty.Core.html#4260" class="Function">pad</a> <a id="9122" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="9124" href="Data.String.Base.html#2141" class="Function">length</a> <a id="9131" href="Text.Pretty.Core.html#9018" class="Bound">s</a> <a id="9133" href="Relation.Binary.Reasoning.Base.Triple.html#4513" class="Function">≡⟨</a> <a id="9136" href="Relation.Binary.PropositionalEquality.Core.html#1131" class="Function">cong</a> <a id="9141" class="Symbol">(</a><a id="9142" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">_+</a> <a id="9145" class="Symbol">_)</a> <a id="9148" href="Text.Pretty.Core.html#4368" class="Function">size-pad</a> <a id="9157" href="Relation.Binary.Reasoning.Base.Triple.html#4513" class="Function">⟩</a>
        <a id="9167" href="Text.Pretty.Core.html#2322" class="Function">x.lastWidth</a> <a id="9179" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="9181" href="Data.String.Base.html#2141" class="Function">length</a> <a id="9188" href="Text.Pretty.Core.html#9018" class="Bound">s</a>         <a id="9198" href="Relation.Binary.Reasoning.Base.Triple.html#3740" class="Function">≤⟨</a> <a id="9201" href="Data.Nat.Properties.html#17410" class="Function">+-monoʳ-≤</a> <a id="9211" href="Text.Pretty.Core.html#2322" class="Function">x.lastWidth</a> <a id="9223" href="Text.Pretty.Core.html#9020" class="Bound">∣s∣</a> <a id="9227" href="Relation.Binary.Reasoning.Base.Triple.html#3740" class="Function">⟩</a>
        <a id="9237" href="Text.Pretty.Core.html#2322" class="Function">x.lastWidth</a> <a id="9249" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="9251" href="Text.Pretty.Core.html#4056" class="Function">widthy</a>           <a id="9268" href="Relation.Binary.Reasoning.Base.Triple.html#3740" class="Function">≤⟨</a> <a id="9271" href="Data.Nat.Properties.html#30841" class="Function">n≤m⊔n</a> <a id="9277" class="Symbol">(</a><a id="9278" href="Text.Pretty.Core.html#4025" class="Function">widthx</a><a id="9284" class="Symbol">)</a> <a id="9286" class="Symbol">_</a> <a id="9288" href="Relation.Binary.Reasoning.Base.Triple.html#3740" class="Function">⟩</a>
        <a id="9298" href="Text.Pretty.Core.html#7643" class="Function">vMaxWidth</a>                      <a id="9329" href="Relation.Binary.Reasoning.Base.Triple.html#5114" class="Function Operator">∎</a> <a id="9331" class="Keyword">where</a> <a id="9337" class="Keyword">open</a> <a id="9342" href="Data.Nat.Properties.html#11242" class="Module">≤-Reasoning</a>

    <a id="append.maxWidth"></a><a id="9359" href="Text.Pretty.Core.html#9359" class="Function">maxWidth</a> <a id="9368" class="Symbol">:</a> <a id="9370" href="Data.Refinement.html#869" class="Function">[</a> <a id="9372" href="Text.Pretty.Core.html#9372" class="Bound">n</a> <a id="9374" href="Data.Refinement.html#869" class="Function">∈</a> <a id="9376" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="9378" href="Data.Refinement.html#869" class="Function">∣</a> <a id="9380" href="Text.Pretty.Core.html#4196" class="Function">lastWidth</a> <a id="9390" href="Data.Nat.Base.html#937" class="Datatype Operator">≤</a> <a id="9392" href="Text.Pretty.Core.html#9372" class="Bound">n</a> <a id="9394" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="9396" href="Text.Pretty.Core.html#2140" class="Function">All≤</a> <a id="9401" href="Text.Pretty.Core.html#9372" class="Bound">n</a> <a id="9403" href="Text.Pretty.Core.html#5771" class="Function">vBlock</a> <a id="9410" href="Data.Refinement.html#869" class="Function">]</a>
    <a id="9416" href="Text.Pretty.Core.html#9359" class="Function">maxWidth</a> <a id="9425" class="Symbol">.</a><a id="9426" href="Data.Refinement.html#592" class="Field">value</a> <a id="9432" class="Symbol">=</a> <a id="9434" href="Text.Pretty.Core.html#7643" class="Function">vMaxWidth</a>
    <a id="9448" href="Text.Pretty.Core.html#9359" class="Function">maxWidth</a> <a id="9457" class="Symbol">.</a><a id="9458" href="Data.Refinement.html#610" class="Field">proof</a> <a id="9464" class="Symbol">=</a>
      <a id="9472" class="Symbol">⦇</a> <a id="9474" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">_,_</a> <a id="9478" class="Symbol">⦇</a> <a id="9480" href="Text.Pretty.Core.html#7710" class="Function">isMaxWidth₁</a> <a id="9492" class="Symbol">(</a><a id="9493" href="Data.Erased.html#876" class="Function">map</a> <a id="9497" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="9503" class="Symbol">(</a><a id="9504" href="Text.Pretty.Core.html#2421" class="Field">Block.maxWidth</a> <a id="9519" href="Text.Pretty.Core.html#3899" class="Bound">y</a> <a id="9521" class="Symbol">.</a><a id="9522" href="Data.Refinement.html#610" class="Field">proof</a><a id="9527" class="Symbol">))</a> <a id="9530" class="Symbol">⦈</a>
            <a id="9544" class="Symbol">⦇</a> <a id="9546" href="Text.Pretty.Core.html#7950" class="Function">isMaxWidth₂</a> <a id="9558" class="Symbol">(</a><a id="9559" href="Text.Pretty.Core.html#2340" class="Field">Block.last</a> <a id="9570" href="Text.Pretty.Core.html#3897" class="Bound">x</a> <a id="9572" class="Symbol">.</a><a id="9573" href="Data.Refinement.html#610" class="Field">proof</a><a id="9578" class="Symbol">)</a>
                          <a id="9606" class="Symbol">(</a><a id="9607" href="Data.Erased.html#876" class="Function">map</a> <a id="9611" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="9617" class="Symbol">(</a><a id="9618" href="Text.Pretty.Core.html#2421" class="Field">Block.maxWidth</a> <a id="9633" href="Text.Pretty.Core.html#3897" class="Bound">x</a> <a id="9635" class="Symbol">.</a><a id="9636" href="Data.Refinement.html#610" class="Field">proof</a><a id="9641" class="Symbol">))</a>
                          <a id="9670" class="Symbol">(</a><a id="9671" href="Data.Erased.html#876" class="Function">map</a> <a id="9675" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="9681" class="Symbol">(</a><a id="9682" href="Text.Pretty.Core.html#2421" class="Field">Block.maxWidth</a> <a id="9697" href="Text.Pretty.Core.html#3897" class="Bound">x</a> <a id="9699" class="Symbol">.</a><a id="9700" href="Data.Refinement.html#610" class="Field">proof</a><a id="9705" class="Symbol">))</a>
                          <a id="9734" class="Symbol">(</a><a id="9735" href="Data.Erased.html#876" class="Function">map</a> <a id="9739" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="9745" class="Symbol">(</a><a id="9746" href="Text.Pretty.Core.html#2421" class="Field">Block.maxWidth</a> <a id="9761" href="Text.Pretty.Core.html#3899" class="Bound">y</a> <a id="9763" class="Symbol">.</a><a id="9764" href="Data.Refinement.html#610" class="Field">proof</a><a id="9769" class="Symbol">))</a>
            <a id="9784" class="Symbol">⦈</a>
      <a id="9792" class="Symbol">⦈</a> <a id="9794" class="Keyword">where</a> <a id="9800" class="Keyword">open</a> <a id="9805" href="Data.Erased.html" class="Module">Erased</a>

<a id="9813" class="Keyword">infixl</a> <a id="9820" class="Number">4</a> <a id="9822" href="Text.Pretty.Core.html#9827" class="Function Operator">_&lt;&gt;_</a>
<a id="_&lt;&gt;_"></a><a id="9827" href="Text.Pretty.Core.html#9827" class="Function Operator">_&lt;&gt;_</a> <a id="9832" class="Symbol">:</a> <a id="9834" href="Text.Pretty.Core.html#2207" class="Record">Block</a> <a id="9840" class="Symbol">→</a> <a id="9842" href="Text.Pretty.Core.html#2207" class="Record">Block</a> <a id="9848" class="Symbol">→</a> <a id="9850" href="Text.Pretty.Core.html#2207" class="Record">Block</a>
<a id="9856" href="Text.Pretty.Core.html#9856" class="Bound">x</a> <a id="9858" href="Text.Pretty.Core.html#9827" class="Function Operator">&lt;&gt;</a> <a id="9861" href="Text.Pretty.Core.html#9861" class="Bound">y</a> <a id="9863" class="Symbol">=</a> <a id="9865" class="Keyword">record</a> <a id="9872" class="Symbol">{</a> <a id="9874" href="Text.Pretty.Core.html#9874" class="Module">append</a> <a id="9881" href="Text.Pretty.Core.html#9856" class="Bound">x</a> <a id="9883" href="Text.Pretty.Core.html#9861" class="Bound">y</a> <a id="9885" class="Symbol">}</a>

<a id="9888" class="Comment">------------------------------------------------------------------------</a>
<a id="9961" class="Comment">-- Flush (introduces a new line)</a>

<a id="9995" class="Keyword">private</a>
  <a id="10005" class="Keyword">module</a> <a id="flush"></a><a id="10012" href="Text.Pretty.Core.html#10012" class="Module">flush</a> <a id="10018" class="Symbol">(</a><a id="10019" href="Text.Pretty.Core.html#10019" class="Bound">x</a> <a id="10021" class="Symbol">:</a> <a id="10023" href="Text.Pretty.Core.html#2207" class="Record">Block</a><a id="10028" class="Symbol">)</a> <a id="10030" class="Keyword">where</a>

    <a id="10041" class="Keyword">module</a> <a id="x"></a><a id="10048" href="Text.Pretty.Core.html#10048" class="Module">x</a> <a id="10050" class="Symbol">=</a> <a id="10052" href="Text.Pretty.Core.html#2207" class="Module">Block</a> <a id="10058" href="Text.Pretty.Core.html#10019" class="Bound">x</a>
    <a id="flush.blockx"></a><a id="10064" href="Text.Pretty.Core.html#10064" class="Function">blockx</a>  <a id="10072" class="Symbol">=</a> <a id="10074" href="Text.Pretty.Core.html#2255" class="Field">x.block</a> <a id="10082" class="Symbol">.</a><a id="10083" href="Data.Refinement.html#592" class="Field">value</a>
    <a id="flush.lastx"></a><a id="10093" href="Text.Pretty.Core.html#10093" class="Function">lastx</a>   <a id="10101" class="Symbol">=</a> <a id="10103" href="Text.Pretty.Core.html#2340" class="Field">x.last</a> <a id="10110" class="Symbol">.</a><a id="10111" href="Data.Refinement.html#592" class="Field">value</a>
    <a id="flush.widthx"></a><a id="10121" href="Text.Pretty.Core.html#10121" class="Function">widthx</a>  <a id="10129" class="Symbol">=</a> <a id="10131" href="Text.Pretty.Core.html#2421" class="Field">x.maxWidth</a> <a id="10142" class="Symbol">.</a><a id="10143" href="Data.Refinement.html#592" class="Field">value</a>
    <a id="flush.heightx"></a><a id="10153" href="Text.Pretty.Core.html#10153" class="Function">heightx</a> <a id="10161" class="Symbol">=</a> <a id="10163" href="Text.Pretty.Core.html#2237" class="Field">x.height</a>

    <a id="flush.height"></a><a id="10177" href="Text.Pretty.Core.html#10177" class="Function">height</a>    <a id="10187" class="Symbol">=</a> <a id="10189" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="10193" href="Text.Pretty.Core.html#10153" class="Function">heightx</a>
    <a id="flush.lastWidth"></a><a id="10205" href="Text.Pretty.Core.html#10205" class="Function">lastWidth</a> <a id="10215" class="Symbol">=</a> <a id="10217" class="Number">0</a>
    <a id="flush.vMaxWidth"></a><a id="10223" href="Text.Pretty.Core.html#10223" class="Function">vMaxWidth</a> <a id="10233" class="Symbol">=</a> <a id="10235" href="Text.Pretty.Core.html#10121" class="Function">widthx</a>

    <a id="flush.last"></a><a id="10247" href="Text.Pretty.Core.html#10247" class="Function">last</a> <a id="10252" class="Symbol">:</a> <a id="10254" href="Data.Refinement.html#869" class="Function">[</a> <a id="10256" href="Text.Pretty.Core.html#10256" class="Bound">s</a> <a id="10258" href="Data.Refinement.html#869" class="Function">∈</a> <a id="10260" href="Agda.Builtin.String.html#274" class="Postulate">String</a> <a id="10267" href="Data.Refinement.html#869" class="Function">∣</a> <a id="10269" href="Data.String.Base.html#2141" class="Function">length</a> <a id="10276" href="Text.Pretty.Core.html#10256" class="Bound">s</a> <a id="10278" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="10280" href="Text.Pretty.Core.html#10205" class="Function">lastWidth</a> <a id="10290" href="Data.Refinement.html#869" class="Function">]</a>
    <a id="10296" href="Text.Pretty.Core.html#10247" class="Function">last</a> <a id="10301" class="Symbol">=</a> <a id="10303" class="String">&quot;&quot;</a> <a id="10306" href="Data.Refinement.html#580" class="InductiveConstructor Operator">,</a> <a id="10308" class="Symbol">⦇</a> <a id="10310" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="10315" class="Symbol">⦈</a> <a id="10317" class="Keyword">where</a> <a id="10323" class="Keyword">open</a> <a id="10328" href="Data.Erased.html" class="Module">Erased</a>

    <a id="flush.vContent"></a><a id="10340" href="Text.Pretty.Core.html#10340" class="Function">vContent</a> <a id="10349" class="Symbol">=</a> <a id="10351" href="Text.Pretty.Core.html#3010" class="Function">node?</a> <a id="10357" href="Text.Pretty.Core.html#10064" class="Function">blockx</a> <a id="10364" href="Text.Pretty.Core.html#10093" class="Function">lastx</a> <a id="10370" href="Data.Tree.Binary.html#653" class="InductiveConstructor">leaf</a>

    <a id="flush.isBlock"></a><a id="10380" href="Text.Pretty.Core.html#10380" class="Function">isBlock</a> <a id="10388" class="Symbol">:</a> <a id="10390" href="Text.Pretty.Core.html#1981" class="Function">size</a> <a id="10395" href="Text.Pretty.Core.html#10064" class="Function">blockx</a> <a id="10402" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="10404" href="Text.Pretty.Core.html#10153" class="Function">heightx</a> <a id="10412" class="Symbol">→</a> <a id="10414" href="Text.Pretty.Core.html#1981" class="Function">size</a> <a id="10419" href="Text.Pretty.Core.html#10340" class="Function">vContent</a> <a id="10428" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a>  <a id="10431" href="Text.Pretty.Core.html#10177" class="Function">height</a>
    <a id="10442" href="Text.Pretty.Core.html#10380" class="Function">isBlock</a> <a id="10450" href="Text.Pretty.Core.html#10450" class="Bound">∣x∣</a> <a id="10454" class="Symbol">=</a> <a id="10456" href="Relation.Binary.PropositionalEquality.Core.html#2517" class="Function Operator">begin</a>
      <a id="10468" href="Text.Pretty.Core.html#1981" class="Function">size</a> <a id="10473" href="Text.Pretty.Core.html#10340" class="Function">vContent</a>   <a id="10484" href="Relation.Binary.PropositionalEquality.Core.html#2634" class="Function">≡⟨</a> <a id="10487" href="Text.Pretty.Core.html#3156" class="Function">∣node?∣</a> <a id="10495" href="Text.Pretty.Core.html#10064" class="Function">blockx</a> <a id="10502" href="Text.Pretty.Core.html#10093" class="Function">lastx</a> <a id="10508" href="Data.Tree.Binary.html#653" class="InductiveConstructor">leaf</a> <a id="10513" href="Relation.Binary.PropositionalEquality.Core.html#2634" class="Function">⟩</a>
      <a id="10521" href="Text.Pretty.Core.html#1981" class="Function">size</a> <a id="10526" href="Text.Pretty.Core.html#10064" class="Function">blockx</a> <a id="10533" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="10535" class="Number">1</a> <a id="10537" href="Relation.Binary.PropositionalEquality.Core.html#2634" class="Function">≡⟨</a> <a id="10540" href="Relation.Binary.PropositionalEquality.Core.html#1131" class="Function">cong</a> <a id="10545" class="Symbol">(</a><a id="10546" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">_+</a> <a id="10549" class="Number">1</a><a id="10550" class="Symbol">)</a> <a id="10552" href="Text.Pretty.Core.html#10450" class="Bound">∣x∣</a> <a id="10556" href="Relation.Binary.PropositionalEquality.Core.html#2634" class="Function">⟩</a>
      <a id="10564" href="Text.Pretty.Core.html#10153" class="Function">heightx</a> <a id="10572" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="10574" class="Number">1</a>     <a id="10580" href="Relation.Binary.PropositionalEquality.Core.html#2634" class="Function">≡⟨</a> <a id="10583" href="Data.Nat.Properties.html#12823" class="Function">+-comm</a> <a id="10590" href="Text.Pretty.Core.html#10153" class="Function">heightx</a> <a id="10598" class="Number">1</a> <a id="10600" href="Relation.Binary.PropositionalEquality.Core.html#2634" class="Function">⟩</a>
      <a id="10608" href="Text.Pretty.Core.html#10177" class="Function">height</a>          <a id="10624" href="Relation.Binary.PropositionalEquality.Core.html#2816" class="Function Operator">∎</a> <a id="10626" class="Keyword">where</a> <a id="10632" class="Keyword">open</a> <a id="10637" href="Relation.Binary.PropositionalEquality.Core.html#2419" class="Module">≡-Reasoning</a>

    <a id="flush.block"></a><a id="10654" href="Text.Pretty.Core.html#10654" class="Function">block</a> <a id="10660" class="Symbol">:</a> <a id="10662" href="Data.Refinement.html#869" class="Function">[</a> <a id="10664" href="Text.Pretty.Core.html#10664" class="Bound">xs</a> <a id="10667" href="Data.Refinement.html#869" class="Function">∈</a> <a id="10669" href="Text.Pretty.Core.html#1927" class="Function">Content</a> <a id="10677" href="Data.Refinement.html#869" class="Function">∣</a> <a id="10679" href="Text.Pretty.Core.html#1981" class="Function">size</a> <a id="10684" href="Text.Pretty.Core.html#10664" class="Bound">xs</a> <a id="10687" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="10689" href="Text.Pretty.Core.html#10177" class="Function">height</a> <a id="10696" href="Data.Refinement.html#869" class="Function">]</a>
    <a id="10702" href="Text.Pretty.Core.html#10654" class="Function">block</a> <a id="10708" class="Symbol">.</a><a id="10709" href="Data.Refinement.html#592" class="Field">value</a> <a id="10715" class="Symbol">=</a> <a id="10717" href="Text.Pretty.Core.html#10340" class="Function">vContent</a>
    <a id="10730" href="Text.Pretty.Core.html#10654" class="Function">block</a> <a id="10736" class="Symbol">.</a><a id="10737" href="Data.Refinement.html#610" class="Field">proof</a> <a id="10743" class="Symbol">=</a> <a id="10745" href="Data.Erased.html#876" class="Function">Erased.map</a> <a id="10756" href="Text.Pretty.Core.html#10380" class="Function">isBlock</a> <a id="10764" href="Function.Base.html#1538" class="Function Operator">$</a> <a id="10766" href="Text.Pretty.Core.html#2255" class="Field">Block.block</a> <a id="10778" href="Text.Pretty.Core.html#10019" class="Bound">x</a> <a id="10780" class="Symbol">.</a><a id="10781" href="Data.Refinement.html#610" class="Field">proof</a>

    <a id="flush.maxWidth"></a><a id="10792" href="Text.Pretty.Core.html#10792" class="Function">maxWidth</a> <a id="10801" class="Symbol">:</a> <a id="10803" href="Data.Refinement.html#869" class="Function">[</a> <a id="10805" href="Text.Pretty.Core.html#10805" class="Bound">n</a> <a id="10807" href="Data.Refinement.html#869" class="Function">∈</a> <a id="10809" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="10811" href="Data.Refinement.html#869" class="Function">∣</a> <a id="10813" href="Text.Pretty.Core.html#10205" class="Function">lastWidth</a> <a id="10823" href="Data.Nat.Base.html#937" class="Datatype Operator">≤</a> <a id="10825" href="Text.Pretty.Core.html#10805" class="Bound">n</a> <a id="10827" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="10829" href="Text.Pretty.Core.html#2140" class="Function">All≤</a> <a id="10834" href="Text.Pretty.Core.html#10805" class="Bound">n</a> <a id="10836" href="Text.Pretty.Core.html#10340" class="Function">vContent</a> <a id="10845" href="Data.Refinement.html#869" class="Function">]</a>
    <a id="10851" href="Text.Pretty.Core.html#10792" class="Function">maxWidth</a> <a id="10860" class="Symbol">.</a><a id="10861" href="Data.Refinement.html#592" class="Field">value</a> <a id="10867" class="Symbol">=</a> <a id="10869" href="Text.Pretty.Core.html#10121" class="Function">widthx</a>
    <a id="10880" href="Text.Pretty.Core.html#10792" class="Function">maxWidth</a> <a id="10889" class="Symbol">.</a><a id="10890" href="Data.Refinement.html#610" class="Field">proof</a> <a id="10896" class="Symbol">=</a> <a id="10898" href="Data.Erased.html#876" class="Function">map</a> <a id="10902" class="Symbol">(</a><a id="10903" href="Data.Nat.Base.html#960" class="InductiveConstructor">z≤n</a> <a id="10907" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,_</a><a id="10909" class="Symbol">)</a>
      <a id="10917" class="Symbol">⦇</a> <a id="10919" href="Text.Pretty.Core.html#3516" class="Function">All≤-node?</a> <a id="10930" class="Symbol">⦇</a> <a id="10932" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="10938" class="Symbol">(</a><a id="10939" href="Text.Pretty.Core.html#2421" class="Field">Block.maxWidth</a> <a id="10954" href="Text.Pretty.Core.html#10019" class="Bound">x</a> <a id="10956" class="Symbol">.</a><a id="10957" href="Data.Refinement.html#610" class="Field">proof</a><a id="10962" class="Symbol">)</a> <a id="10964" class="Symbol">⦈</a>
                   <a id="10985" class="Symbol">⦇</a> <a id="10987" href="Text.Pretty.Core.html#11125" class="Function">middle</a> <a id="10994" class="Symbol">(</a><a id="10995" href="Text.Pretty.Core.html#2340" class="Field">Block.last</a> <a id="11006" href="Text.Pretty.Core.html#10019" class="Bound">x</a> <a id="11008" class="Symbol">.</a><a id="11009" href="Data.Refinement.html#610" class="Field">proof</a><a id="11014" class="Symbol">)</a> <a id="11016" class="Symbol">⦇</a> <a id="11018" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="11024" class="Symbol">(</a><a id="11025" href="Text.Pretty.Core.html#2421" class="Field">Block.maxWidth</a> <a id="11040" href="Text.Pretty.Core.html#10019" class="Bound">x</a> <a id="11042" class="Symbol">.</a><a id="11043" href="Data.Refinement.html#610" class="Field">proof</a><a id="11048" class="Symbol">)</a> <a id="11050" class="Symbol">⦈</a> <a id="11052" class="Symbol">⦈</a>
                   <a id="11073" class="Symbol">(</a><a id="11074" href="Data.Erased.html#935" class="Function">pure</a> <a id="11079" href="Data.Tree.Binary.Relation.Unary.All.html#563" class="InductiveConstructor">leaf</a><a id="11083" class="Symbol">)</a>
      <a id="11091" class="Symbol">⦈</a> <a id="11093" class="Keyword">where</a>

      <a id="11106" class="Keyword">open</a> <a id="11111" href="Data.Erased.html" class="Module">Erased</a>

      <a id="11125" href="Text.Pretty.Core.html#11125" class="Function">middle</a> <a id="11132" class="Symbol">:</a> <a id="11134" href="Data.String.Base.html#2141" class="Function">length</a> <a id="11141" href="Text.Pretty.Core.html#10093" class="Function">lastx</a> <a id="11147" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="11149" href="Text.Pretty.Core.html#2322" class="Field">x.lastWidth</a> <a id="11161" class="Symbol">→</a> <a id="11163" href="Text.Pretty.Core.html#2322" class="Field">x.lastWidth</a> <a id="11175" href="Data.Nat.Base.html#937" class="Datatype Operator">≤</a> <a id="11177" href="Text.Pretty.Core.html#10223" class="Function">vMaxWidth</a> <a id="11187" class="Symbol">→</a>
               <a id="11204" href="Data.String.Base.html#2141" class="Function">length</a> <a id="11211" href="Text.Pretty.Core.html#10093" class="Function">lastx</a> <a id="11217" href="Data.Nat.Base.html#937" class="Datatype Operator">≤</a> <a id="11219" href="Text.Pretty.Core.html#10223" class="Function">vMaxWidth</a>
      <a id="11235" href="Text.Pretty.Core.html#11125" class="Function">middle</a> <a id="11242" href="Text.Pretty.Core.html#11242" class="Bound">p</a> <a id="11244" href="Text.Pretty.Core.html#11244" class="Bound">q</a> <a id="11246" class="Symbol">=</a> <a id="11248" href="Relation.Binary.Reasoning.Base.Triple.html#3005" class="Function Operator">begin</a>
        <a id="11262" href="Data.String.Base.html#2141" class="Function">length</a> <a id="11269" href="Text.Pretty.Core.html#10093" class="Function">lastx</a> <a id="11275" href="Relation.Binary.Reasoning.Base.Triple.html#4513" class="Function">≡⟨</a> <a id="11278" href="Text.Pretty.Core.html#11242" class="Bound">p</a> <a id="11280" href="Relation.Binary.Reasoning.Base.Triple.html#4513" class="Function">⟩</a>
        <a id="11290" href="Text.Pretty.Core.html#2322" class="Field">x.lastWidth</a>  <a id="11303" href="Relation.Binary.Reasoning.Base.Triple.html#3740" class="Function">≤⟨</a> <a id="11306" href="Text.Pretty.Core.html#11244" class="Bound">q</a> <a id="11308" href="Relation.Binary.Reasoning.Base.Triple.html#3740" class="Function">⟩</a>
        <a id="11318" href="Text.Pretty.Core.html#10223" class="Function">vMaxWidth</a>    <a id="11331" href="Relation.Binary.Reasoning.Base.Triple.html#5114" class="Function Operator">∎</a> <a id="11333" class="Keyword">where</a> <a id="11339" class="Keyword">open</a> <a id="11344" href="Data.Nat.Properties.html#11242" class="Module">≤-Reasoning</a>

<a id="flush"></a><a id="11357" href="Text.Pretty.Core.html#11357" class="Function">flush</a> <a id="11363" class="Symbol">:</a> <a id="11365" href="Text.Pretty.Core.html#2207" class="Record">Block</a> <a id="11371" class="Symbol">→</a> <a id="11373" href="Text.Pretty.Core.html#2207" class="Record">Block</a>
<a id="11379" href="Text.Pretty.Core.html#11357" class="Function">flush</a> <a id="11385" href="Text.Pretty.Core.html#11385" class="Bound">x</a> <a id="11387" class="Symbol">=</a> <a id="11389" class="Keyword">record</a> <a id="11396" class="Symbol">{</a> <a id="11398" href="Text.Pretty.Core.html#11398" class="Module">flush</a> <a id="11404" href="Text.Pretty.Core.html#11385" class="Bound">x</a> <a id="11406" class="Symbol">}</a>

<a id="11409" class="Comment">------------------------------------------------------------------------</a>
<a id="11482" class="Comment">-- Other functions</a>

<a id="render"></a><a id="11502" href="Text.Pretty.Core.html#11502" class="Function">render</a> <a id="11509" class="Symbol">:</a> <a id="11511" href="Text.Pretty.Core.html#2207" class="Record">Block</a> <a id="11517" class="Symbol">→</a> <a id="11519" href="Agda.Builtin.String.html#274" class="Postulate">String</a>
<a id="11526" href="Text.Pretty.Core.html#11502" class="Function">render</a> <a id="11533" href="Text.Pretty.Core.html#11533" class="Bound">x</a> <a id="11535" class="Symbol">=</a> <a id="11537" href="Data.String.Base.html#2450" class="Function">unlines</a>
  <a id="11547" href="Function.Base.html#1538" class="Function Operator">$</a> <a id="11549" href="Data.Maybe.Base.html#1573" class="Function">maybe′</a> <a id="11556" class="Symbol">(</a><a id="11557" href="Data.Product.html#3103" class="Function">uncurry</a> <a id="11565" class="Symbol">(λ</a> <a id="11568" href="Text.Pretty.Core.html#11568" class="Bound">hd</a> <a id="11571" href="Text.Pretty.Core.html#11571" class="Bound">tl</a> <a id="11574" class="Symbol">→</a> <a id="11576" href="Text.Pretty.Core.html#11568" class="Bound">hd</a> <a id="11579" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="11581" href="Data.Tree.Binary.html#1443" class="Function">Tree.Infix.toList</a> <a id="11599" href="Text.Pretty.Core.html#11571" class="Bound">tl</a><a id="11601" class="Symbol">))</a> <a id="11604" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>
  <a id="11609" href="Function.Base.html#1538" class="Function Operator">$</a> <a id="11611" href="Text.Pretty.Core.html#3010" class="Function">node?</a> <a id="11617" class="Symbol">(</a><a id="11618" href="Text.Pretty.Core.html#2255" class="Field">Block.block</a> <a id="11630" href="Text.Pretty.Core.html#11533" class="Bound">x</a> <a id="11632" class="Symbol">.</a><a id="11633" href="Data.Refinement.html#592" class="Field">value</a><a id="11638" class="Symbol">)</a> <a id="11640" class="Symbol">(</a><a id="11641" href="Text.Pretty.Core.html#2340" class="Field">Block.last</a> <a id="11652" href="Text.Pretty.Core.html#11533" class="Bound">x</a> <a id="11654" class="Symbol">.</a><a id="11655" href="Data.Refinement.html#592" class="Field">value</a><a id="11660" class="Symbol">)</a> <a id="11662" href="Data.Tree.Binary.html#653" class="InductiveConstructor">leaf</a>

<a id="valid"></a><a id="11668" href="Text.Pretty.Core.html#11668" class="Function">valid</a> <a id="11674" class="Symbol">:</a> <a id="11676" class="Symbol">(</a><a id="11677" href="Text.Pretty.Core.html#11677" class="Bound">width</a> <a id="11683" class="Symbol">:</a> <a id="11685" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="11686" class="Symbol">)</a> <a id="11688" class="Symbol">(</a><a id="11689" href="Text.Pretty.Core.html#11689" class="Bound">b</a> <a id="11691" class="Symbol">:</a> <a id="11693" href="Text.Pretty.Core.html#2207" class="Record">Block</a><a id="11698" class="Symbol">)</a> <a id="11700" class="Symbol">→</a> <a id="11702" href="Relation.Nullary.html#1508" class="Record">Dec</a> <a id="11706" class="Symbol">(</a><a id="11707" href="Text.Pretty.Core.html#2421" class="Field">Block.maxWidth</a> <a id="11722" href="Text.Pretty.Core.html#11689" class="Bound">b</a> <a id="11724" class="Symbol">.</a><a id="11725" href="Data.Refinement.html#592" class="Field">value</a> <a id="11731" href="Data.Nat.Base.html#937" class="Datatype Operator">≤</a> <a id="11733" href="Text.Pretty.Core.html#11677" class="Bound">width</a><a id="11738" class="Symbol">)</a>
<a id="11740" href="Text.Pretty.Core.html#11668" class="Function">valid</a> <a id="11746" href="Text.Pretty.Core.html#11746" class="Bound">width</a> <a id="11752" href="Text.Pretty.Core.html#11752" class="Bound">b</a> <a id="11754" class="Symbol">=</a> <a id="11756" href="Text.Pretty.Core.html#2421" class="Field">Block.maxWidth</a> <a id="11771" href="Text.Pretty.Core.html#11752" class="Bound">b</a> <a id="11773" class="Symbol">.</a><a id="11774" href="Data.Refinement.html#592" class="Field">value</a> <a id="11780" href="Data.Nat.Properties.html#4678" class="Function Operator">≤?</a> <a id="11783" href="Text.Pretty.Core.html#11746" class="Bound">width</a>
</pre></body></html>