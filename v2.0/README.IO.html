<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>README.IO</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- The Agda standard library</a>
<a id="103" class="Comment">--</a>
<a id="106" class="Comment">-- Simple examples of programs using IO</a>
<a id="146" class="Comment">------------------------------------------------------------------------</a>

<a id="220" class="Symbol">{-#</a> <a id="224" class="Keyword">OPTIONS</a> <a id="232" class="Pragma">--guardedness</a> <a id="246" class="Symbol">#-}</a>

<a id="251" class="Keyword">module</a> <a id="258" href="README.IO.html" class="Module">README.IO</a> <a id="268" class="Keyword">where</a>

<a id="275" class="Keyword">open</a> <a id="280" class="Keyword">import</a> <a id="287" href="Level.html" class="Module">Level</a>
<a id="293" class="Keyword">open</a> <a id="298" class="Keyword">import</a> <a id="305" href="Data.Nat.Base.html" class="Module">Data.Nat.Base</a>
<a id="319" class="Keyword">open</a> <a id="324" class="Keyword">import</a> <a id="331" href="Data.Nat.Show.html" class="Module">Data.Nat.Show</a> <a id="345" class="Keyword">using</a> <a id="351" class="Symbol">(</a><a id="352" href="Data.Nat.Show.html#1962" class="Function">show</a><a id="356" class="Symbol">)</a>
<a id="358" class="Keyword">open</a> <a id="363" class="Keyword">import</a> <a id="370" href="Data.String.Base.html" class="Module">Data.String.Base</a> <a id="387" class="Keyword">using</a> <a id="393" class="Symbol">(</a><a id="394" href="Agda.Builtin.String.html#335" class="Postulate">String</a><a id="400" class="Symbol">;</a> <a id="402" href="Data.String.Base.html#2404" class="Function Operator">_++_</a><a id="406" class="Symbol">;</a> <a id="408" href="Data.String.Base.html#5080" class="Function">lines</a><a id="413" class="Symbol">)</a>
<a id="415" class="Keyword">open</a> <a id="420" class="Keyword">import</a> <a id="427" href="Data.Unit.Polymorphic.html" class="Module">Data.Unit.Polymorphic</a>
<a id="449" class="Keyword">open</a> <a id="454" class="Keyword">import</a> <a id="461" href="IO.html" class="Module">IO</a>

<a id="465" class="Comment">------------------------------------------------------------------------</a>
<a id="538" class="Comment">-- Basic programs</a>
<a id="556" class="Comment">------------------------------------------------------------------------</a>

<a id="630" class="Comment">------------------------------------------------------------------------</a>
<a id="703" class="Comment">-- Hello World!</a>

<a id="720" class="Comment">-- Minimal example of an IO program.</a>
<a id="757" class="Comment">-- * The entrypoint of the executable is given type `Main`</a>
<a id="816" class="Comment">-- * It is implemented using `run`, a function that converts a description</a>
<a id="891" class="Comment">--   of an IO-computation into a computation that actually invokes the magic</a>
<a id="968" class="Comment">--   primitives that will perform the side effects.</a>

<a id="helloWorld"></a><a id="1021" href="README.IO.html#1021" class="Function">helloWorld</a> <a id="1032" class="Symbol">:</a> <a id="1034" href="IO.Base.html#2978" class="Function">Main</a>
<a id="1039" href="README.IO.html#1021" class="Function">helloWorld</a> <a id="1050" class="Symbol">=</a> <a id="1052" href="IO.Base.html#2669" class="Function">run</a> <a id="1056" class="Symbol">(</a><a id="1057" href="IO.Finite.html#1506" class="Function">putStrLn</a> <a id="1066" class="String">&quot;Hello World!&quot;</a><a id="1080" class="Symbol">)</a>

<a id="1083" class="Comment">------------------------------------------------------------------------</a>
<a id="1156" class="Comment">-- Hello {{name}}!</a>

<a id="1176" class="Comment">-- We can of course write little auxiliary functions that may be used in</a>
<a id="1249" class="Comment">-- larger IO programs. Here we are going to first write a function displaying</a>
<a id="1327" class="Comment">-- &quot;Hello {{name}}!&quot; when {{name}} is passed as an argument.</a>

<a id="1389" class="Comment">-- `IO` primitives whose sole purpose is generating side effects (e.g.</a>
<a id="1460" class="Comment">-- printing a string on the screen) are typically given a level polymorphic</a>
<a id="1536" class="Comment">-- type which means we may need to add explicit level annotations.</a>
<a id="1603" class="Comment">-- Here we state that the `IO` computation will be at level zero (`0ℓ`).</a>

<a id="sayHello"></a><a id="1677" href="README.IO.html#1677" class="Function">sayHello</a> <a id="1686" class="Symbol">:</a> <a id="1688" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="1695" class="Symbol">→</a> <a id="1697" href="IO.Base.html#1180" class="Datatype">IO</a> <a id="1700" class="Symbol">{</a><a id="1701" href="Level.html#521" class="Function">0ℓ</a><a id="1703" class="Symbol">}</a> <a id="1705" href="Data.Unit.Polymorphic.Base.html#489" class="Function">⊤</a>
<a id="1707" href="README.IO.html#1677" class="Function">sayHello</a> <a id="1716" href="README.IO.html#1716" class="Bound">name</a> <a id="1721" class="Symbol">=</a> <a id="1723" href="IO.Finite.html#1506" class="Function">putStrLn</a> <a id="1732" class="Symbol">(</a><a id="1733" class="String">&quot;Hello &quot;</a> <a id="1742" href="Data.String.Base.html#2404" class="Function Operator">++</a> <a id="1745" href="README.IO.html#1716" class="Bound">name</a> <a id="1750" href="Data.String.Base.html#2404" class="Function Operator">++</a> <a id="1753" class="String">&quot;!&quot;</a><a id="1756" class="Symbol">)</a>

<a id="1759" class="Comment">-- Functions can be sequenced using monadic combinators or `do` notations.</a>
<a id="1834" class="Comment">-- The two following definitions are equivalent. They start by asking the</a>
<a id="1908" class="Comment">-- user what their name is, listen for an answer and respond by saying hello</a>
<a id="1985" class="Comment">-- using the `sayHello` auxiliary function we just defined.</a>

<a id="helloName"></a><a id="2046" href="README.IO.html#2046" class="Function">helloName</a> <a id="2056" class="Symbol">:</a> <a id="2058" href="IO.Base.html#2978" class="Function">Main</a>
<a id="2063" href="README.IO.html#2046" class="Function">helloName</a> <a id="2073" class="Symbol">=</a> <a id="2075" href="IO.Base.html#2669" class="Function">run</a> <a id="2079" class="Symbol">(</a><a id="2080" href="IO.Finite.html#1506" class="Function">putStrLn</a> <a id="2089" class="String">&quot;What is your name?&quot;</a> <a id="2110" href="IO.Base.html#2212" class="Function Operator">&gt;&gt;</a> <a id="2113" href="IO.Finite.html#1045" class="Function">getLine</a> <a id="2121" href="IO.Base.html#2084" class="Function Operator">&gt;&gt;=</a> <a id="2125" href="README.IO.html#1677" class="Function">sayHello</a><a id="2133" class="Symbol">)</a>

<a id="doHelloName"></a><a id="2136" href="README.IO.html#2136" class="Function">doHelloName</a> <a id="2148" class="Symbol">:</a> <a id="2150" href="IO.Base.html#2978" class="Function">Main</a>
<a id="2155" href="README.IO.html#2136" class="Function">doHelloName</a> <a id="2167" class="Symbol">=</a> <a id="2169" href="IO.Base.html#2669" class="Function">run</a> <a id="2173" class="Keyword">do</a>
  <a id="2178" href="IO.Finite.html#1506" class="Function">putStrLn</a> <a id="2187" class="String">&quot;What is your name?&quot;</a>
  <a id="2210" href="README.IO.html#2210" class="Bound">name</a> <a id="2215" href="IO.Base.html#2084" class="Function Operator">←</a> <a id="2217" href="IO.Finite.html#1045" class="Function">getLine</a>
  <a id="2227" href="README.IO.html#1677" class="Function">sayHello</a> <a id="2236" href="README.IO.html#2210" class="Bound">name</a>

<a id="2242" class="Comment">------------------------------------------------------------------------</a>
<a id="2315" class="Comment">-- (Co)Recursive programs</a>
<a id="2341" class="Comment">------------------------------------------------------------------------</a>

<a id="2415" class="Comment">------------------------------------------------------------------------</a>
<a id="2488" class="Comment">-- NO GUARDEDNESS</a>

<a id="2507" class="Comment">-- If you do not need to rely on guardedness for the function to be seen as</a>
<a id="2583" class="Comment">-- terminating (for instance because it is structural in an inductive argument)</a>
<a id="2663" class="Comment">-- then you can use `do` notations to write fairly readable programs.</a>

<a id="2734" class="Comment">-- Countdown to explosion</a>
<a id="countdown"></a><a id="2760" href="README.IO.html#2760" class="Function">countdown</a> <a id="2770" class="Symbol">:</a> <a id="2772" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="2774" class="Symbol">→</a> <a id="2776" href="IO.Base.html#1180" class="Datatype">IO</a> <a id="2779" class="Symbol">{</a><a id="2780" href="Level.html#521" class="Function">0ℓ</a><a id="2782" class="Symbol">}</a> <a id="2784" class="Symbol">_</a>
<a id="2786" href="README.IO.html#2760" class="Function">countdown</a> <a id="2796" href="Agda.Builtin.Nat.html#221" class="InductiveConstructor">zero</a>      <a id="2806" class="Symbol">=</a> <a id="2808" href="IO.Finite.html#1506" class="Function">putStrLn</a> <a id="2817" class="String">&quot;BOOM!&quot;</a>
<a id="2825" href="README.IO.html#2760" class="Function">countdown</a> <a id="2835" href="README.IO.html#2835" class="Bound">m</a><a id="2836" class="Symbol">@(</a><a id="2838" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="2842" href="README.IO.html#2842" class="Bound">n</a><a id="2843" class="Symbol">)</a> <a id="2845" class="Symbol">=</a> <a id="2847" class="Keyword">do</a>
  <a id="2852" class="Keyword">let</a> <a id="2856" href="README.IO.html#2856" class="Bound">str</a> <a id="2860" class="Symbol">=</a> <a id="2862" href="Data.Nat.Show.html#1962" class="Function">show</a> <a id="2867" href="README.IO.html#2835" class="Bound">m</a>
  <a id="2871" href="IO.Finite.html#1506" class="Function">putStrLn</a> <a id="2880" href="README.IO.html#2856" class="Bound">str</a>
  <a id="2886" href="README.IO.html#2760" class="Function">countdown</a> <a id="2896" href="README.IO.html#2842" class="Bound">n</a>

<a id="2899" class="Comment">-- cat the content of a finite file</a>
<a id="cat"></a><a id="2935" href="README.IO.html#2935" class="Function">cat</a> <a id="2939" class="Symbol">:</a> <a id="2941" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="2948" class="Symbol">→</a> <a id="2950" href="IO.Base.html#1180" class="Datatype">IO</a> <a id="2953" class="Symbol">_</a>
<a id="2955" href="README.IO.html#2935" class="Function">cat</a> <a id="2959" href="README.IO.html#2959" class="Bound">fp</a> <a id="2962" class="Symbol">=</a> <a id="2964" class="Keyword">do</a>
  <a id="2969" href="README.IO.html#2969" class="Bound">content</a> <a id="2977" href="IO.Base.html#2084" class="Function Operator">←</a> <a id="2979" href="IO.html#2873" class="Function">readFiniteFile</a> <a id="2994" href="README.IO.html#2959" class="Bound">fp</a>
  <a id="2999" class="Keyword">let</a> <a id="3003" href="README.IO.html#3003" class="Bound">ls</a> <a id="3006" class="Symbol">=</a> <a id="3008" href="Data.String.Base.html#5080" class="Function">lines</a> <a id="3014" href="README.IO.html#2969" class="Bound">content</a>
  <a id="3024" href="IO.html#2117" class="Function">List.mapM′</a> <a id="3035" href="IO.Finite.html#1506" class="Function">putStrLn</a> <a id="3044" href="README.IO.html#3003" class="Bound">ls</a>

<a id="3048" class="Keyword">open</a> <a id="3053" class="Keyword">import</a> <a id="3060" href="Codata.Musical.Notation.html" class="Module">Codata.Musical.Notation</a>
<a id="3084" class="Keyword">open</a> <a id="3089" class="Keyword">import</a> <a id="3096" href="Codata.Musical.Colist.html" class="Module">Codata.Musical.Colist</a>
<a id="3118" class="Keyword">open</a> <a id="3123" class="Keyword">import</a> <a id="3130" href="Data.Bool.html" class="Module">Data.Bool</a>
<a id="3140" class="Keyword">open</a> <a id="3145" class="Keyword">import</a> <a id="3152" href="Data.Unit.Polymorphic.Base.html" class="Module">Data.Unit.Polymorphic.Base</a>

<a id="3180" class="Comment">------------------------------------------------------------------------</a>
<a id="3253" class="Comment">-- GUARDEDNESS</a>

<a id="3269" class="Comment">-- If you are performing coinduction on a potentially infinite piece of codata</a>
<a id="3348" class="Comment">-- then you need to rely on guardedness. That is to say that the coinductive</a>
<a id="3425" class="Comment">-- call needs to be obviously under a coinductive constructor and guarded by a</a>
<a id="3504" class="Comment">-- sharp (♯_).</a>
<a id="3519" class="Comment">-- In this case you cannot use the convenient combinators that make `do`-notations</a>
<a id="3602" class="Comment">-- and have to revert back to the underlying coinductive constructors.</a>


<a id="3675" class="Comment">-- Whether a colist is finite is semi decidable: just let the user wait until</a>
<a id="3753" class="Comment">-- you reach the end!</a>
<a id="isFinite"></a><a id="3775" href="README.IO.html#3775" class="Function">isFinite</a> <a id="3784" class="Symbol">:</a> <a id="3786" class="Symbol">∀</a> <a id="3788" class="Symbol">{</a><a id="3789" href="README.IO.html#3789" class="Bound">a</a><a id="3790" class="Symbol">}</a> <a id="3792" class="Symbol">{</a><a id="3793" href="README.IO.html#3793" class="Bound">A</a> <a id="3795" class="Symbol">:</a> <a id="3797" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="3801" href="README.IO.html#3789" class="Bound">a</a><a id="3802" class="Symbol">}</a> <a id="3804" class="Symbol">→</a> <a id="3806" href="Codata.Musical.Colist.Base.html#879" class="Datatype">Colist</a> <a id="3813" href="README.IO.html#3793" class="Bound">A</a> <a id="3815" class="Symbol">→</a> <a id="3817" href="IO.Base.html#1180" class="Datatype">IO</a> <a id="3820" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
<a id="3825" href="README.IO.html#3775" class="Function">isFinite</a> <a id="3834" href="Codata.Musical.Colist.Base.html#914" class="InductiveConstructor">[]</a>       <a id="3843" class="Symbol">=</a> <a id="3845" href="IO.Base.html#1249" class="InductiveConstructor">pure</a> <a id="3850" href="Agda.Builtin.Bool.html#198" class="InductiveConstructor">true</a>
<a id="3855" href="README.IO.html#3775" class="Function">isFinite</a> <a id="3864" class="Symbol">(</a><a id="3865" href="README.IO.html#3865" class="Bound">x</a> <a id="3867" href="Codata.Musical.Colist.Base.html#931" class="InductiveConstructor Operator">∷</a> <a id="3869" href="README.IO.html#3869" class="Bound">xs</a><a id="3871" class="Symbol">)</a> <a id="3873" class="Symbol">=</a> <a id="3875" href="IO.Base.html#1341" class="InductiveConstructor">seq</a> <a id="3879" class="Symbol">(</a><a id="3880" href="Agda.Builtin.Coinduction.html#229" class="CoinductiveConstructor Operator">♯</a> <a id="3882" href="IO.Base.html#1249" class="InductiveConstructor">pure</a> <a id="3887" href="Data.Unit.Polymorphic.Base.html#533" class="Function">tt</a><a id="3889" class="Symbol">)</a> <a id="3891" class="Symbol">(</a><a id="3892" href="Agda.Builtin.Coinduction.html#229" class="CoinductiveConstructor Operator">♯</a> <a id="3894" href="README.IO.html#3775" class="Function">isFinite</a> <a id="3903" class="Symbol">(</a><a id="3904" href="Agda.Builtin.Coinduction.html#264" class="Field">♭</a> <a id="3906" href="README.IO.html#3869" class="Bound">xs</a><a id="3908" class="Symbol">))</a>
</pre></body></html>