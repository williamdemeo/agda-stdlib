<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Algebra.Solver.CommutativeMonoid</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- The Agda standard library</a>
<a id="103" class="Comment">--</a>
<a id="106" class="Comment">-- Solver for equations in commutative monoids</a>
<a id="153" class="Comment">--</a>
<a id="156" class="Comment">-- Adapted from Algebra.Solver.Monoid</a>
<a id="194" class="Comment">------------------------------------------------------------------------</a>

<a id="268" class="Symbol">{-#</a> <a id="272" class="Keyword">OPTIONS</a> <a id="280" class="Pragma">--cubical-compatible</a> <a id="301" class="Pragma">--safe</a> <a id="308" class="Symbol">#-}</a>

<a id="313" class="Keyword">open</a> <a id="318" class="Keyword">import</a> <a id="325" href="Algebra.html" class="Module">Algebra</a>

<a id="334" class="Keyword">module</a> <a id="341" href="Algebra.Solver.CommutativeMonoid.html" class="Module">Algebra.Solver.CommutativeMonoid</a> <a id="374" class="Symbol">{</a><a id="375" href="Algebra.Solver.CommutativeMonoid.html#375" class="Bound">m₁</a> <a id="378" href="Algebra.Solver.CommutativeMonoid.html#378" class="Bound">m₂</a><a id="380" class="Symbol">}</a> <a id="382" class="Symbol">(</a><a id="383" href="Algebra.Solver.CommutativeMonoid.html#383" class="Bound">M</a> <a id="385" class="Symbol">:</a> <a id="387" href="Algebra.Bundles.html#6622" class="Record">CommutativeMonoid</a> <a id="405" href="Algebra.Solver.CommutativeMonoid.html#375" class="Bound">m₁</a> <a id="408" href="Algebra.Solver.CommutativeMonoid.html#378" class="Bound">m₂</a><a id="410" class="Symbol">)</a> <a id="412" class="Keyword">where</a>

<a id="419" class="Keyword">open</a> <a id="424" class="Keyword">import</a> <a id="431" href="Data.Fin.Base.html" class="Module">Data.Fin.Base</a> <a id="445" class="Keyword">using</a> <a id="451" class="Symbol">(</a><a id="452" href="Data.Fin.Base.html#1154" class="Datatype">Fin</a><a id="455" class="Symbol">;</a> <a id="457" href="Data.Fin.Base.html#1176" class="InductiveConstructor">zero</a><a id="461" class="Symbol">;</a> <a id="463" href="Data.Fin.Base.html#1197" class="InductiveConstructor">suc</a><a id="466" class="Symbol">)</a>
<a id="468" class="Keyword">open</a> <a id="473" class="Keyword">import</a> <a id="480" href="Data.Maybe.Base.html" class="Module">Data.Maybe.Base</a> <a id="496" class="Symbol">as</a> <a id="499" class="Module">Maybe</a>
  <a id="507" class="Keyword">using</a> <a id="513" class="Symbol">(</a><a id="514" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a><a id="519" class="Symbol">;</a> <a id="521" href="Data.Maybe.Base.html#1241" class="Function">decToMaybe</a><a id="531" class="Symbol">;</a> <a id="533" href="Data.Maybe.Base.html#1847" class="Function">From-just</a><a id="542" class="Symbol">;</a> <a id="544" href="Data.Maybe.Base.html#1935" class="Function">from-just</a><a id="553" class="Symbol">)</a>
<a id="555" class="Keyword">open</a> <a id="560" class="Keyword">import</a> <a id="567" href="Data.Nat.html" class="Module">Data.Nat</a> <a id="576" class="Symbol">as</a> <a id="579" class="Module">ℕ</a> <a id="581" class="Keyword">using</a> <a id="587" class="Symbol">(</a><a id="588" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="589" class="Symbol">;</a> <a id="591" href="Agda.Builtin.Nat.html#221" class="InductiveConstructor">zero</a><a id="595" class="Symbol">;</a> <a id="597" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a><a id="600" class="Symbol">;</a> <a id="602" href="Agda.Builtin.Nat.html#336" class="Primitive Operator">_+_</a><a id="605" class="Symbol">)</a>
<a id="607" class="Keyword">open</a> <a id="612" class="Keyword">import</a> <a id="619" href="Data.Nat.GeneralisedArithmetic.html" class="Module">Data.Nat.GeneralisedArithmetic</a> <a id="650" class="Keyword">using</a> <a id="656" class="Symbol">(</a><a id="657" href="Data.Nat.GeneralisedArithmetic.html#573" class="Function">fold</a><a id="661" class="Symbol">)</a>
<a id="663" class="Keyword">open</a> <a id="668" class="Keyword">import</a> <a id="675" href="Data.Product.Base.html" class="Module">Data.Product.Base</a> <a id="693" class="Keyword">using</a> <a id="699" class="Symbol">(</a><a id="700" href="Data.Product.Base.html#1618" class="Function Operator">_×_</a><a id="703" class="Symbol">;</a> <a id="705" href="Data.Product.Base.html#3109" class="Function">uncurry</a><a id="712" class="Symbol">)</a>
<a id="714" class="Keyword">open</a> <a id="719" class="Keyword">import</a> <a id="726" href="Data.Vec.Base.html" class="Module">Data.Vec.Base</a> <a id="740" class="Keyword">using</a> <a id="746" class="Symbol">(</a><a id="747" href="Data.Vec.Base.html#1111" class="Datatype">Vec</a><a id="750" class="Symbol">;</a> <a id="752" href="Data.Vec.Base.html#1147" class="InductiveConstructor">[]</a><a id="754" class="Symbol">;</a> <a id="756" href="Data.Vec.Base.html#1166" class="InductiveConstructor Operator">_∷_</a><a id="759" class="Symbol">;</a> <a id="761" href="Data.Vec.Base.html#1668" class="Function">lookup</a><a id="767" class="Symbol">;</a> <a id="769" href="Data.Vec.Base.html#6509" class="Function">replicate</a><a id="778" class="Symbol">)</a>

<a id="781" class="Keyword">open</a> <a id="786" class="Keyword">import</a> <a id="793" href="Function.Base.html" class="Module">Function.Base</a> <a id="807" class="Keyword">using</a> <a id="813" class="Symbol">(</a><a id="814" href="Function.Base.html#1115" class="Function Operator">_∘_</a><a id="817" class="Symbol">)</a>

<a id="820" class="Keyword">import</a> <a id="827" href="Relation.Binary.Reasoning.Setoid.html" class="Module">Relation.Binary.Reasoning.Setoid</a> <a id="860" class="Symbol">as</a> <a id="863" class="Module">EqReasoning</a>
<a id="875" class="Keyword">import</a> <a id="882" href="Relation.Binary.Reflection.html" class="Module">Relation.Binary.Reflection</a> <a id="909" class="Symbol">as</a> <a id="912" class="Module">Reflection</a>
<a id="923" class="Keyword">import</a> <a id="930" href="Relation.Nullary.Decidable.html" class="Module">Relation.Nullary.Decidable</a> <a id="957" class="Symbol">as</a> <a id="960" class="Module">Dec</a>
<a id="964" class="Keyword">import</a> <a id="971" href="Data.Vec.Relation.Binary.Pointwise.Inductive.html" class="Module">Data.Vec.Relation.Binary.Pointwise.Inductive</a> <a id="1016" class="Symbol">as</a> <a id="1019" class="Module">Pointwise</a>

<a id="1030" class="Keyword">open</a> <a id="1035" class="Keyword">import</a> <a id="1042" href="Relation.Binary.PropositionalEquality.Core.html" class="Module">Relation.Binary.PropositionalEquality.Core</a> <a id="1085" class="Symbol">as</a> <a id="1088" class="Module">P</a> <a id="1090" class="Keyword">using</a> <a id="1096" class="Symbol">(</a><a id="1097" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">_≡_</a><a id="1100" class="Symbol">)</a>
<a id="1102" class="Keyword">open</a> <a id="1107" class="Keyword">import</a> <a id="1114" href="Relation.Nullary.Decidable.html" class="Module">Relation.Nullary.Decidable</a> <a id="1141" class="Keyword">using</a> <a id="1147" class="Symbol">(</a><a id="1148" href="Relation.Nullary.Decidable.Core.html#1485" class="Record">Dec</a><a id="1151" class="Symbol">)</a>

<a id="1154" class="Keyword">open</a> <a id="1159" href="Algebra.Bundles.html#6622" class="Module">CommutativeMonoid</a> <a id="1177" href="Algebra.Solver.CommutativeMonoid.html#383" class="Bound">M</a>
<a id="1179" class="Keyword">open</a> <a id="1184" href="Relation.Binary.Reasoning.Setoid.html" class="Module">EqReasoning</a> <a id="1196" href="Algebra.Structures.html#1390" class="Function">setoid</a>

<a id="1204" class="Keyword">private</a>
  <a id="1214" class="Keyword">variable</a>
    <a id="1227" href="Algebra.Solver.CommutativeMonoid.html#1227" class="Generalizable">n</a> <a id="1229" class="Symbol">:</a> <a id="1231" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a>

<a id="1234" class="Comment">------------------------------------------------------------------------</a>
<a id="1307" class="Comment">-- Monoid expressions</a>

<a id="1330" class="Comment">-- There is one constructor for every operation, plus one for</a>
<a id="1392" class="Comment">-- variables; there may be at most n variables.</a>

<a id="1441" class="Keyword">infixr</a> <a id="1448" class="Number">5</a> <a id="1450" href="Algebra.Solver.CommutativeMonoid.html#1539" class="InductiveConstructor Operator">_⊕_</a>
<a id="1454" class="Keyword">infixr</a> <a id="1461" class="Number">10</a> <a id="1464" href="Algebra.Solver.CommutativeMonoid.html#2481" class="Function Operator">_•_</a>

<a id="1469" class="Keyword">data</a> <a id="Expr"></a><a id="1474" href="Algebra.Solver.CommutativeMonoid.html#1474" class="Datatype">Expr</a> <a id="1479" class="Symbol">(</a><a id="1480" href="Algebra.Solver.CommutativeMonoid.html#1480" class="Bound">n</a> <a id="1482" class="Symbol">:</a> <a id="1484" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="1485" class="Symbol">)</a> <a id="1487" class="Symbol">:</a> <a id="1489" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="1493" class="Keyword">where</a>
  <a id="Expr.var"></a><a id="1501" href="Algebra.Solver.CommutativeMonoid.html#1501" class="InductiveConstructor">var</a> <a id="1505" class="Symbol">:</a> <a id="1507" href="Data.Fin.Base.html#1154" class="Datatype">Fin</a> <a id="1511" href="Algebra.Solver.CommutativeMonoid.html#1480" class="Bound">n</a> <a id="1513" class="Symbol">→</a> <a id="1515" href="Algebra.Solver.CommutativeMonoid.html#1474" class="Datatype">Expr</a> <a id="1520" href="Algebra.Solver.CommutativeMonoid.html#1480" class="Bound">n</a>
  <a id="Expr.id"></a><a id="1524" href="Algebra.Solver.CommutativeMonoid.html#1524" class="InductiveConstructor">id</a>  <a id="1528" class="Symbol">:</a> <a id="1530" href="Algebra.Solver.CommutativeMonoid.html#1474" class="Datatype">Expr</a> <a id="1535" href="Algebra.Solver.CommutativeMonoid.html#1480" class="Bound">n</a>
  <a id="Expr._⊕_"></a><a id="1539" href="Algebra.Solver.CommutativeMonoid.html#1539" class="InductiveConstructor Operator">_⊕_</a> <a id="1543" class="Symbol">:</a> <a id="1545" href="Algebra.Solver.CommutativeMonoid.html#1474" class="Datatype">Expr</a> <a id="1550" href="Algebra.Solver.CommutativeMonoid.html#1480" class="Bound">n</a> <a id="1552" class="Symbol">→</a> <a id="1554" href="Algebra.Solver.CommutativeMonoid.html#1474" class="Datatype">Expr</a> <a id="1559" href="Algebra.Solver.CommutativeMonoid.html#1480" class="Bound">n</a> <a id="1561" class="Symbol">→</a> <a id="1563" href="Algebra.Solver.CommutativeMonoid.html#1474" class="Datatype">Expr</a> <a id="1568" href="Algebra.Solver.CommutativeMonoid.html#1480" class="Bound">n</a>

<a id="1571" class="Comment">-- An environment contains one value for every variable.</a>

<a id="Env"></a><a id="1629" href="Algebra.Solver.CommutativeMonoid.html#1629" class="Function">Env</a> <a id="1633" class="Symbol">:</a> <a id="1635" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="1637" class="Symbol">→</a> <a id="1639" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="1643" class="Symbol">_</a>
<a id="1645" href="Algebra.Solver.CommutativeMonoid.html#1629" class="Function">Env</a> <a id="1649" href="Algebra.Solver.CommutativeMonoid.html#1649" class="Bound">n</a> <a id="1651" class="Symbol">=</a> <a id="1653" href="Data.Vec.Base.html#1111" class="Datatype">Vec</a> <a id="1657" href="Algebra.Bundles.html#6712" class="Field">Carrier</a> <a id="1665" href="Algebra.Solver.CommutativeMonoid.html#1649" class="Bound">n</a>

<a id="1668" class="Comment">-- The semantics of an expression is a function from an environment to</a>
<a id="1739" class="Comment">-- a value.</a>

<a id="⟦_⟧"></a><a id="1752" href="Algebra.Solver.CommutativeMonoid.html#1752" class="Function Operator">⟦_⟧</a> <a id="1756" class="Symbol">:</a> <a id="1758" href="Algebra.Solver.CommutativeMonoid.html#1474" class="Datatype">Expr</a> <a id="1763" href="Algebra.Solver.CommutativeMonoid.html#1227" class="Generalizable">n</a> <a id="1765" class="Symbol">→</a> <a id="1767" href="Algebra.Solver.CommutativeMonoid.html#1629" class="Function">Env</a> <a id="1771" href="Algebra.Solver.CommutativeMonoid.html#1227" class="Generalizable">n</a> <a id="1773" class="Symbol">→</a> <a id="1775" href="Algebra.Bundles.html#6712" class="Field">Carrier</a>
<a id="1783" href="Algebra.Solver.CommutativeMonoid.html#1752" class="Function Operator">⟦</a> <a id="1785" href="Algebra.Solver.CommutativeMonoid.html#1501" class="InductiveConstructor">var</a> <a id="1789" href="Algebra.Solver.CommutativeMonoid.html#1789" class="Bound">x</a>   <a id="1793" href="Algebra.Solver.CommutativeMonoid.html#1752" class="Function Operator">⟧</a> <a id="1795" href="Algebra.Solver.CommutativeMonoid.html#1795" class="Bound">ρ</a> <a id="1797" class="Symbol">=</a> <a id="1799" href="Data.Vec.Base.html#1668" class="Function">lookup</a> <a id="1806" href="Algebra.Solver.CommutativeMonoid.html#1795" class="Bound">ρ</a> <a id="1808" href="Algebra.Solver.CommutativeMonoid.html#1789" class="Bound">x</a>
<a id="1810" href="Algebra.Solver.CommutativeMonoid.html#1752" class="Function Operator">⟦</a> <a id="1812" href="Algebra.Solver.CommutativeMonoid.html#1524" class="InductiveConstructor">id</a>      <a id="1820" href="Algebra.Solver.CommutativeMonoid.html#1752" class="Function Operator">⟧</a> <a id="1822" href="Algebra.Solver.CommutativeMonoid.html#1822" class="Bound">ρ</a> <a id="1824" class="Symbol">=</a> <a id="1826" href="Algebra.Bundles.html#6822" class="Field">ε</a>
<a id="1828" href="Algebra.Solver.CommutativeMonoid.html#1752" class="Function Operator">⟦</a> <a id="1830" href="Algebra.Solver.CommutativeMonoid.html#1830" class="Bound">e₁</a> <a id="1833" href="Algebra.Solver.CommutativeMonoid.html#1539" class="InductiveConstructor Operator">⊕</a> <a id="1835" href="Algebra.Solver.CommutativeMonoid.html#1835" class="Bound">e₂</a> <a id="1838" href="Algebra.Solver.CommutativeMonoid.html#1752" class="Function Operator">⟧</a> <a id="1840" href="Algebra.Solver.CommutativeMonoid.html#1840" class="Bound">ρ</a> <a id="1842" class="Symbol">=</a> <a id="1844" href="Algebra.Solver.CommutativeMonoid.html#1752" class="Function Operator">⟦</a> <a id="1846" href="Algebra.Solver.CommutativeMonoid.html#1830" class="Bound">e₁</a> <a id="1849" href="Algebra.Solver.CommutativeMonoid.html#1752" class="Function Operator">⟧</a> <a id="1851" href="Algebra.Solver.CommutativeMonoid.html#1840" class="Bound">ρ</a> <a id="1853" href="Algebra.Bundles.html#6784" class="Field Operator">∙</a> <a id="1855" href="Algebra.Solver.CommutativeMonoid.html#1752" class="Function Operator">⟦</a> <a id="1857" href="Algebra.Solver.CommutativeMonoid.html#1835" class="Bound">e₂</a> <a id="1860" href="Algebra.Solver.CommutativeMonoid.html#1752" class="Function Operator">⟧</a> <a id="1862" href="Algebra.Solver.CommutativeMonoid.html#1840" class="Bound">ρ</a>

<a id="1865" class="Comment">------------------------------------------------------------------------</a>
<a id="1938" class="Comment">-- Normal forms</a>

<a id="1955" class="Comment">-- A normal form is a vector of multiplicities (a bag).</a>

<a id="Normal"></a><a id="2012" href="Algebra.Solver.CommutativeMonoid.html#2012" class="Function">Normal</a> <a id="2019" class="Symbol">:</a> <a id="2021" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="2023" class="Symbol">→</a> <a id="2025" href="Agda.Primitive.html#388" class="Primitive">Set</a>
<a id="2029" href="Algebra.Solver.CommutativeMonoid.html#2012" class="Function">Normal</a> <a id="2036" href="Algebra.Solver.CommutativeMonoid.html#2036" class="Bound">n</a> <a id="2038" class="Symbol">=</a> <a id="2040" href="Data.Vec.Base.html#1111" class="Datatype">Vec</a> <a id="2044" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="2046" href="Algebra.Solver.CommutativeMonoid.html#2036" class="Bound">n</a>

<a id="2049" class="Comment">-- The semantics of a normal form.</a>

<a id="⟦_⟧⇓"></a><a id="2085" href="Algebra.Solver.CommutativeMonoid.html#2085" class="Function Operator">⟦_⟧⇓</a> <a id="2090" class="Symbol">:</a> <a id="2092" href="Algebra.Solver.CommutativeMonoid.html#2012" class="Function">Normal</a> <a id="2099" href="Algebra.Solver.CommutativeMonoid.html#1227" class="Generalizable">n</a> <a id="2101" class="Symbol">→</a> <a id="2103" href="Algebra.Solver.CommutativeMonoid.html#1629" class="Function">Env</a> <a id="2107" href="Algebra.Solver.CommutativeMonoid.html#1227" class="Generalizable">n</a> <a id="2109" class="Symbol">→</a> <a id="2111" href="Algebra.Bundles.html#6712" class="Field">Carrier</a>
<a id="2119" href="Algebra.Solver.CommutativeMonoid.html#2085" class="Function Operator">⟦</a> <a id="2121" href="Data.Vec.Base.html#1147" class="InductiveConstructor">[]</a>    <a id="2127" href="Algebra.Solver.CommutativeMonoid.html#2085" class="Function Operator">⟧⇓</a> <a id="2130" class="Symbol">_</a> <a id="2132" class="Symbol">=</a> <a id="2134" href="Algebra.Bundles.html#6822" class="Field">ε</a>
<a id="2136" href="Algebra.Solver.CommutativeMonoid.html#2085" class="Function Operator">⟦</a> <a id="2138" href="Algebra.Solver.CommutativeMonoid.html#2138" class="Bound">n</a> <a id="2140" href="Data.Vec.Base.html#1166" class="InductiveConstructor Operator">∷</a> <a id="2142" href="Algebra.Solver.CommutativeMonoid.html#2142" class="Bound">v</a> <a id="2144" href="Algebra.Solver.CommutativeMonoid.html#2085" class="Function Operator">⟧⇓</a> <a id="2147" class="Symbol">(</a><a id="2148" href="Algebra.Solver.CommutativeMonoid.html#2148" class="Bound">a</a> <a id="2150" href="Data.Vec.Base.html#1166" class="InductiveConstructor Operator">∷</a> <a id="2152" href="Algebra.Solver.CommutativeMonoid.html#2152" class="Bound">ρ</a><a id="2153" class="Symbol">)</a> <a id="2155" class="Symbol">=</a> <a id="2157" href="Data.Nat.GeneralisedArithmetic.html#573" class="Function">fold</a> <a id="2162" class="Symbol">(</a><a id="2163" href="Algebra.Solver.CommutativeMonoid.html#2085" class="Function Operator">⟦</a> <a id="2165" href="Algebra.Solver.CommutativeMonoid.html#2142" class="Bound">v</a> <a id="2167" href="Algebra.Solver.CommutativeMonoid.html#2085" class="Function Operator">⟧⇓</a> <a id="2170" href="Algebra.Solver.CommutativeMonoid.html#2152" class="Bound">ρ</a><a id="2171" class="Symbol">)</a> <a id="2173" class="Symbol">(</a><a id="2174" href="Algebra.Solver.CommutativeMonoid.html#2148" class="Bound">a</a> <a id="2176" href="Algebra.Bundles.html#6784" class="Field Operator">∙_</a><a id="2178" class="Symbol">)</a> <a id="2180" href="Algebra.Solver.CommutativeMonoid.html#2138" class="Bound">n</a>

<a id="2183" class="Comment">------------------------------------------------------------------------</a>
<a id="2256" class="Comment">-- Constructions on normal forms</a>

<a id="2290" class="Comment">-- The empty bag.</a>

<a id="empty"></a><a id="2309" href="Algebra.Solver.CommutativeMonoid.html#2309" class="Function">empty</a> <a id="2315" class="Symbol">:</a> <a id="2317" href="Algebra.Solver.CommutativeMonoid.html#2012" class="Function">Normal</a> <a id="2324" href="Algebra.Solver.CommutativeMonoid.html#1227" class="Generalizable">n</a>
<a id="2326" href="Algebra.Solver.CommutativeMonoid.html#2309" class="Function">empty</a> <a id="2332" class="Symbol">=</a> <a id="2334" href="Data.Vec.Base.html#6509" class="Function">replicate</a> <a id="2344" class="Symbol">_</a> <a id="2346" class="Number">0</a>

<a id="2349" class="Comment">-- A singleton bag.</a>

<a id="sg"></a><a id="2370" href="Algebra.Solver.CommutativeMonoid.html#2370" class="Function">sg</a> <a id="2373" class="Symbol">:</a> <a id="2375" class="Symbol">(</a><a id="2376" href="Algebra.Solver.CommutativeMonoid.html#2376" class="Bound">i</a> <a id="2378" class="Symbol">:</a> <a id="2380" href="Data.Fin.Base.html#1154" class="Datatype">Fin</a> <a id="2384" href="Algebra.Solver.CommutativeMonoid.html#1227" class="Generalizable">n</a><a id="2385" class="Symbol">)</a> <a id="2387" class="Symbol">→</a> <a id="2389" href="Algebra.Solver.CommutativeMonoid.html#2012" class="Function">Normal</a> <a id="2396" href="Algebra.Solver.CommutativeMonoid.html#1227" class="Generalizable">n</a>
<a id="2398" href="Algebra.Solver.CommutativeMonoid.html#2370" class="Function">sg</a> <a id="2401" href="Data.Fin.Base.html#1176" class="InductiveConstructor">zero</a>    <a id="2409" class="Symbol">=</a> <a id="2411" class="Number">1</a> <a id="2413" href="Data.Vec.Base.html#1166" class="InductiveConstructor Operator">∷</a> <a id="2415" href="Algebra.Solver.CommutativeMonoid.html#2309" class="Function">empty</a>
<a id="2421" href="Algebra.Solver.CommutativeMonoid.html#2370" class="Function">sg</a> <a id="2424" class="Symbol">(</a><a id="2425" href="Data.Fin.Base.html#1197" class="InductiveConstructor">suc</a> <a id="2429" href="Algebra.Solver.CommutativeMonoid.html#2429" class="Bound">i</a><a id="2430" class="Symbol">)</a> <a id="2432" class="Symbol">=</a> <a id="2434" class="Number">0</a> <a id="2436" href="Data.Vec.Base.html#1166" class="InductiveConstructor Operator">∷</a> <a id="2438" href="Algebra.Solver.CommutativeMonoid.html#2370" class="Function">sg</a> <a id="2441" href="Algebra.Solver.CommutativeMonoid.html#2429" class="Bound">i</a>

<a id="2444" class="Comment">-- The composition of normal forms.</a>

<a id="_•_"></a><a id="2481" href="Algebra.Solver.CommutativeMonoid.html#2481" class="Function Operator">_•_</a>  <a id="2486" class="Symbol">:</a> <a id="2488" class="Symbol">(</a><a id="2489" href="Algebra.Solver.CommutativeMonoid.html#2489" class="Bound">v</a> <a id="2491" href="Algebra.Solver.CommutativeMonoid.html#2491" class="Bound">w</a> <a id="2493" class="Symbol">:</a> <a id="2495" href="Algebra.Solver.CommutativeMonoid.html#2012" class="Function">Normal</a> <a id="2502" href="Algebra.Solver.CommutativeMonoid.html#1227" class="Generalizable">n</a><a id="2503" class="Symbol">)</a> <a id="2505" class="Symbol">→</a> <a id="2507" href="Algebra.Solver.CommutativeMonoid.html#2012" class="Function">Normal</a> <a id="2514" href="Algebra.Solver.CommutativeMonoid.html#1227" class="Generalizable">n</a>
<a id="2516" href="Data.Vec.Base.html#1147" class="InductiveConstructor">[]</a>      <a id="2524" href="Algebra.Solver.CommutativeMonoid.html#2481" class="Function Operator">•</a> <a id="2526" href="Data.Vec.Base.html#1147" class="InductiveConstructor">[]</a>      <a id="2534" class="Symbol">=</a> <a id="2536" href="Data.Vec.Base.html#1147" class="InductiveConstructor">[]</a>
<a id="2539" class="Symbol">(</a><a id="2540" href="Algebra.Solver.CommutativeMonoid.html#2540" class="Bound">l</a> <a id="2542" href="Data.Vec.Base.html#1166" class="InductiveConstructor Operator">∷</a> <a id="2544" href="Algebra.Solver.CommutativeMonoid.html#2544" class="Bound">v</a><a id="2545" class="Symbol">)</a> <a id="2547" href="Algebra.Solver.CommutativeMonoid.html#2481" class="Function Operator">•</a> <a id="2549" class="Symbol">(</a><a id="2550" href="Algebra.Solver.CommutativeMonoid.html#2550" class="Bound">m</a> <a id="2552" href="Data.Vec.Base.html#1166" class="InductiveConstructor Operator">∷</a> <a id="2554" href="Algebra.Solver.CommutativeMonoid.html#2554" class="Bound">w</a><a id="2555" class="Symbol">)</a> <a id="2557" class="Symbol">=</a> <a id="2559" href="Algebra.Solver.CommutativeMonoid.html#2540" class="Bound">l</a> <a id="2561" href="Agda.Builtin.Nat.html#336" class="Primitive Operator">+</a> <a id="2563" href="Algebra.Solver.CommutativeMonoid.html#2550" class="Bound">m</a> <a id="2565" href="Data.Vec.Base.html#1166" class="InductiveConstructor Operator">∷</a> <a id="2567" href="Algebra.Solver.CommutativeMonoid.html#2544" class="Bound">v</a> <a id="2569" href="Algebra.Solver.CommutativeMonoid.html#2481" class="Function Operator">•</a> <a id="2571" href="Algebra.Solver.CommutativeMonoid.html#2554" class="Bound">w</a>

<a id="2574" class="Comment">------------------------------------------------------------------------</a>
<a id="2647" class="Comment">-- Correctness of the constructions on normal forms</a>

<a id="2700" class="Comment">-- The empty bag stands for the unit ε.</a>

<a id="empty-correct"></a><a id="2741" href="Algebra.Solver.CommutativeMonoid.html#2741" class="Function">empty-correct</a> <a id="2755" class="Symbol">:</a> <a id="2757" class="Symbol">(</a><a id="2758" href="Algebra.Solver.CommutativeMonoid.html#2758" class="Bound">ρ</a> <a id="2760" class="Symbol">:</a> <a id="2762" href="Algebra.Solver.CommutativeMonoid.html#1629" class="Function">Env</a> <a id="2766" href="Algebra.Solver.CommutativeMonoid.html#1227" class="Generalizable">n</a><a id="2767" class="Symbol">)</a> <a id="2769" class="Symbol">→</a> <a id="2771" href="Algebra.Solver.CommutativeMonoid.html#2085" class="Function Operator">⟦</a> <a id="2773" href="Algebra.Solver.CommutativeMonoid.html#2309" class="Function">empty</a> <a id="2779" href="Algebra.Solver.CommutativeMonoid.html#2085" class="Function Operator">⟧⇓</a> <a id="2782" href="Algebra.Solver.CommutativeMonoid.html#2758" class="Bound">ρ</a> <a id="2784" href="Algebra.Bundles.html#6744" class="Field Operator">≈</a> <a id="2786" href="Algebra.Bundles.html#6822" class="Field">ε</a>
<a id="2788" href="Algebra.Solver.CommutativeMonoid.html#2741" class="Function">empty-correct</a> <a id="2802" href="Data.Vec.Base.html#1147" class="InductiveConstructor">[]</a> <a id="2805" class="Symbol">=</a> <a id="2807" href="Relation.Binary.Structures.html#1596" class="Function">refl</a>
<a id="2812" href="Algebra.Solver.CommutativeMonoid.html#2741" class="Function">empty-correct</a> <a id="2826" class="Symbol">(</a><a id="2827" href="Algebra.Solver.CommutativeMonoid.html#2827" class="Bound">a</a> <a id="2829" href="Data.Vec.Base.html#1166" class="InductiveConstructor Operator">∷</a> <a id="2831" href="Algebra.Solver.CommutativeMonoid.html#2831" class="Bound">ρ</a><a id="2832" class="Symbol">)</a> <a id="2834" class="Symbol">=</a> <a id="2836" href="Algebra.Solver.CommutativeMonoid.html#2741" class="Function">empty-correct</a> <a id="2850" href="Algebra.Solver.CommutativeMonoid.html#2831" class="Bound">ρ</a>

<a id="2853" class="Comment">-- The singleton bag stands for a single variable.</a>

<a id="sg-correct"></a><a id="2905" href="Algebra.Solver.CommutativeMonoid.html#2905" class="Function">sg-correct</a> <a id="2916" class="Symbol">:</a> <a id="2918" class="Symbol">(</a><a id="2919" href="Algebra.Solver.CommutativeMonoid.html#2919" class="Bound">x</a> <a id="2921" class="Symbol">:</a> <a id="2923" href="Data.Fin.Base.html#1154" class="Datatype">Fin</a> <a id="2927" href="Algebra.Solver.CommutativeMonoid.html#1227" class="Generalizable">n</a><a id="2928" class="Symbol">)</a> <a id="2930" class="Symbol">(</a><a id="2931" href="Algebra.Solver.CommutativeMonoid.html#2931" class="Bound">ρ</a> <a id="2933" class="Symbol">:</a> <a id="2935" href="Algebra.Solver.CommutativeMonoid.html#1629" class="Function">Env</a> <a id="2939" href="Algebra.Solver.CommutativeMonoid.html#1227" class="Generalizable">n</a><a id="2940" class="Symbol">)</a> <a id="2942" class="Symbol">→</a>  <a id="2945" href="Algebra.Solver.CommutativeMonoid.html#2085" class="Function Operator">⟦</a> <a id="2947" href="Algebra.Solver.CommutativeMonoid.html#2370" class="Function">sg</a> <a id="2950" href="Algebra.Solver.CommutativeMonoid.html#2919" class="Bound">x</a> <a id="2952" href="Algebra.Solver.CommutativeMonoid.html#2085" class="Function Operator">⟧⇓</a> <a id="2955" href="Algebra.Solver.CommutativeMonoid.html#2931" class="Bound">ρ</a> <a id="2957" href="Algebra.Bundles.html#6744" class="Field Operator">≈</a> <a id="2959" href="Data.Vec.Base.html#1668" class="Function">lookup</a> <a id="2966" href="Algebra.Solver.CommutativeMonoid.html#2931" class="Bound">ρ</a> <a id="2968" href="Algebra.Solver.CommutativeMonoid.html#2919" class="Bound">x</a>
<a id="2970" href="Algebra.Solver.CommutativeMonoid.html#2905" class="Function">sg-correct</a> <a id="2981" href="Data.Fin.Base.html#1176" class="InductiveConstructor">zero</a> <a id="2986" class="Symbol">(</a><a id="2987" href="Algebra.Solver.CommutativeMonoid.html#2987" class="Bound">x</a> <a id="2989" href="Data.Vec.Base.html#1166" class="InductiveConstructor Operator">∷</a> <a id="2991" href="Algebra.Solver.CommutativeMonoid.html#2991" class="Bound">ρ</a><a id="2992" class="Symbol">)</a> <a id="2994" class="Symbol">=</a> <a id="2996" href="Relation.Binary.Reasoning.Syntax.html#1510" class="Function Operator">begin</a>
    <a id="3006" href="Algebra.Solver.CommutativeMonoid.html#2987" class="Bound">x</a> <a id="3008" href="Algebra.Bundles.html#6784" class="Field Operator">∙</a> <a id="3010" href="Algebra.Solver.CommutativeMonoid.html#2085" class="Function Operator">⟦</a> <a id="3012" href="Algebra.Solver.CommutativeMonoid.html#2309" class="Function">empty</a> <a id="3018" href="Algebra.Solver.CommutativeMonoid.html#2085" class="Function Operator">⟧⇓</a> <a id="3021" href="Algebra.Solver.CommutativeMonoid.html#2991" class="Bound">ρ</a>   <a id="3025" href="Relation.Binary.Reasoning.Syntax.html#7049" class="Function">≈⟨</a> <a id="3028" href="Algebra.Structures.html#1465" class="Function">∙-congˡ</a> <a id="3036" class="Symbol">(</a><a id="3037" href="Algebra.Solver.CommutativeMonoid.html#2741" class="Function">empty-correct</a> <a id="3051" href="Algebra.Solver.CommutativeMonoid.html#2991" class="Bound">ρ</a><a id="3052" class="Symbol">)</a> <a id="3054" href="Relation.Binary.Reasoning.Syntax.html#7049" class="Function">⟩</a>
    <a id="3060" href="Algebra.Solver.CommutativeMonoid.html#2987" class="Bound">x</a> <a id="3062" href="Algebra.Bundles.html#6784" class="Field Operator">∙</a> <a id="3064" href="Algebra.Bundles.html#6822" class="Field">ε</a>              <a id="3079" href="Relation.Binary.Reasoning.Syntax.html#7049" class="Function">≈⟨</a> <a id="3082" href="Algebra.Structures.html#4197" class="Function">identityʳ</a> <a id="3092" class="Symbol">_</a> <a id="3094" href="Relation.Binary.Reasoning.Syntax.html#7049" class="Function">⟩</a>
    <a id="3100" href="Algebra.Solver.CommutativeMonoid.html#2987" class="Bound">x</a>                  <a id="3119" href="Relation.Binary.Reasoning.Syntax.html#12283" class="Function Operator">∎</a>
<a id="3121" href="Algebra.Solver.CommutativeMonoid.html#2905" class="Function">sg-correct</a> <a id="3132" class="Symbol">(</a><a id="3133" href="Data.Fin.Base.html#1197" class="InductiveConstructor">suc</a> <a id="3137" href="Algebra.Solver.CommutativeMonoid.html#3137" class="Bound">x</a><a id="3138" class="Symbol">)</a> <a id="3140" class="Symbol">(</a><a id="3141" href="Algebra.Solver.CommutativeMonoid.html#3141" class="Bound">m</a> <a id="3143" href="Data.Vec.Base.html#1166" class="InductiveConstructor Operator">∷</a> <a id="3145" href="Algebra.Solver.CommutativeMonoid.html#3145" class="Bound">ρ</a><a id="3146" class="Symbol">)</a> <a id="3148" class="Symbol">=</a> <a id="3150" href="Algebra.Solver.CommutativeMonoid.html#2905" class="Function">sg-correct</a> <a id="3161" href="Algebra.Solver.CommutativeMonoid.html#3137" class="Bound">x</a> <a id="3163" href="Algebra.Solver.CommutativeMonoid.html#3145" class="Bound">ρ</a>

<a id="3166" class="Comment">-- Normal form composition corresponds to the composition of the monoid.</a>

<a id="comp-correct"></a><a id="3240" href="Algebra.Solver.CommutativeMonoid.html#3240" class="Function">comp-correct</a> <a id="3253" class="Symbol">:</a> <a id="3255" class="Symbol">(</a><a id="3256" href="Algebra.Solver.CommutativeMonoid.html#3256" class="Bound">v</a> <a id="3258" href="Algebra.Solver.CommutativeMonoid.html#3258" class="Bound">w</a> <a id="3260" class="Symbol">:</a> <a id="3262" href="Algebra.Solver.CommutativeMonoid.html#2012" class="Function">Normal</a> <a id="3269" href="Algebra.Solver.CommutativeMonoid.html#1227" class="Generalizable">n</a><a id="3270" class="Symbol">)</a> <a id="3272" class="Symbol">(</a><a id="3273" href="Algebra.Solver.CommutativeMonoid.html#3273" class="Bound">ρ</a> <a id="3275" class="Symbol">:</a> <a id="3277" href="Algebra.Solver.CommutativeMonoid.html#1629" class="Function">Env</a> <a id="3281" href="Algebra.Solver.CommutativeMonoid.html#1227" class="Generalizable">n</a><a id="3282" class="Symbol">)</a> <a id="3284" class="Symbol">→</a>
              <a id="3300" href="Algebra.Solver.CommutativeMonoid.html#2085" class="Function Operator">⟦</a> <a id="3302" href="Algebra.Solver.CommutativeMonoid.html#3256" class="Bound">v</a> <a id="3304" href="Algebra.Solver.CommutativeMonoid.html#2481" class="Function Operator">•</a> <a id="3306" href="Algebra.Solver.CommutativeMonoid.html#3258" class="Bound">w</a> <a id="3308" href="Algebra.Solver.CommutativeMonoid.html#2085" class="Function Operator">⟧⇓</a> <a id="3311" href="Algebra.Solver.CommutativeMonoid.html#3273" class="Bound">ρ</a> <a id="3313" href="Algebra.Bundles.html#6744" class="Field Operator">≈</a> <a id="3315" class="Symbol">(</a><a id="3316" href="Algebra.Solver.CommutativeMonoid.html#2085" class="Function Operator">⟦</a> <a id="3318" href="Algebra.Solver.CommutativeMonoid.html#3256" class="Bound">v</a> <a id="3320" href="Algebra.Solver.CommutativeMonoid.html#2085" class="Function Operator">⟧⇓</a> <a id="3323" href="Algebra.Solver.CommutativeMonoid.html#3273" class="Bound">ρ</a> <a id="3325" href="Algebra.Bundles.html#6784" class="Field Operator">∙</a> <a id="3327" href="Algebra.Solver.CommutativeMonoid.html#2085" class="Function Operator">⟦</a> <a id="3329" href="Algebra.Solver.CommutativeMonoid.html#3258" class="Bound">w</a> <a id="3331" href="Algebra.Solver.CommutativeMonoid.html#2085" class="Function Operator">⟧⇓</a> <a id="3334" href="Algebra.Solver.CommutativeMonoid.html#3273" class="Bound">ρ</a><a id="3335" class="Symbol">)</a>
<a id="3337" href="Algebra.Solver.CommutativeMonoid.html#3240" class="Function">comp-correct</a> <a id="3350" href="Data.Vec.Base.html#1147" class="InductiveConstructor">[]</a> <a id="3353" href="Data.Vec.Base.html#1147" class="InductiveConstructor">[]</a> <a id="3356" href="Algebra.Solver.CommutativeMonoid.html#3356" class="Bound">ρ</a> <a id="3358" class="Symbol">=</a>  <a id="3361" href="Relation.Binary.Structures.html#1622" class="Function">sym</a> <a id="3365" class="Symbol">(</a><a id="3366" href="Algebra.Structures.html#4136" class="Function">identityˡ</a> <a id="3376" class="Symbol">_)</a>
<a id="3379" href="Algebra.Solver.CommutativeMonoid.html#3240" class="Function">comp-correct</a> <a id="3392" class="Symbol">(</a><a id="3393" href="Algebra.Solver.CommutativeMonoid.html#3393" class="Bound">l</a> <a id="3395" href="Data.Vec.Base.html#1166" class="InductiveConstructor Operator">∷</a> <a id="3397" href="Algebra.Solver.CommutativeMonoid.html#3397" class="Bound">v</a><a id="3398" class="Symbol">)</a> <a id="3400" class="Symbol">(</a><a id="3401" href="Algebra.Solver.CommutativeMonoid.html#3401" class="Bound">m</a> <a id="3403" href="Data.Vec.Base.html#1166" class="InductiveConstructor Operator">∷</a> <a id="3405" href="Algebra.Solver.CommutativeMonoid.html#3405" class="Bound">w</a><a id="3406" class="Symbol">)</a> <a id="3408" class="Symbol">(</a><a id="3409" href="Algebra.Solver.CommutativeMonoid.html#3409" class="Bound">a</a> <a id="3411" href="Data.Vec.Base.html#1166" class="InductiveConstructor Operator">∷</a> <a id="3413" href="Algebra.Solver.CommutativeMonoid.html#3413" class="Bound">ρ</a><a id="3414" class="Symbol">)</a> <a id="3416" class="Symbol">=</a> <a id="3418" href="Algebra.Solver.CommutativeMonoid.html#3685" class="Function">lemma</a> <a id="3424" href="Algebra.Solver.CommutativeMonoid.html#3393" class="Bound">l</a> <a id="3426" href="Algebra.Solver.CommutativeMonoid.html#3401" class="Bound">m</a> <a id="3428" class="Symbol">(</a><a id="3429" href="Algebra.Solver.CommutativeMonoid.html#3240" class="Function">comp-correct</a> <a id="3442" href="Algebra.Solver.CommutativeMonoid.html#3397" class="Bound">v</a> <a id="3444" href="Algebra.Solver.CommutativeMonoid.html#3405" class="Bound">w</a> <a id="3446" href="Algebra.Solver.CommutativeMonoid.html#3413" class="Bound">ρ</a><a id="3447" class="Symbol">)</a>
  <a id="3451" class="Keyword">where</a>
    <a id="3461" href="Algebra.Solver.CommutativeMonoid.html#3461" class="Function">flip12</a> <a id="3468" class="Symbol">:</a> <a id="3470" class="Symbol">∀</a> <a id="3472" href="Algebra.Solver.CommutativeMonoid.html#3472" class="Bound">a</a> <a id="3474" href="Algebra.Solver.CommutativeMonoid.html#3474" class="Bound">b</a> <a id="3476" href="Algebra.Solver.CommutativeMonoid.html#3476" class="Bound">c</a> <a id="3478" class="Symbol">→</a> <a id="3480" href="Algebra.Solver.CommutativeMonoid.html#3472" class="Bound">a</a> <a id="3482" href="Algebra.Bundles.html#6784" class="Field Operator">∙</a> <a id="3484" class="Symbol">(</a><a id="3485" href="Algebra.Solver.CommutativeMonoid.html#3474" class="Bound">b</a> <a id="3487" href="Algebra.Bundles.html#6784" class="Field Operator">∙</a> <a id="3489" href="Algebra.Solver.CommutativeMonoid.html#3476" class="Bound">c</a><a id="3490" class="Symbol">)</a> <a id="3492" href="Algebra.Bundles.html#6744" class="Field Operator">≈</a> <a id="3494" href="Algebra.Solver.CommutativeMonoid.html#3474" class="Bound">b</a> <a id="3496" href="Algebra.Bundles.html#6784" class="Field Operator">∙</a> <a id="3498" class="Symbol">(</a><a id="3499" href="Algebra.Solver.CommutativeMonoid.html#3472" class="Bound">a</a> <a id="3501" href="Algebra.Bundles.html#6784" class="Field Operator">∙</a> <a id="3503" href="Algebra.Solver.CommutativeMonoid.html#3476" class="Bound">c</a><a id="3504" class="Symbol">)</a>
    <a id="3510" href="Algebra.Solver.CommutativeMonoid.html#3461" class="Function">flip12</a> <a id="3517" href="Algebra.Solver.CommutativeMonoid.html#3517" class="Bound">a</a> <a id="3519" href="Algebra.Solver.CommutativeMonoid.html#3519" class="Bound">b</a> <a id="3521" href="Algebra.Solver.CommutativeMonoid.html#3521" class="Bound">c</a> <a id="3523" class="Symbol">=</a> <a id="3525" href="Relation.Binary.Reasoning.Syntax.html#1510" class="Function Operator">begin</a>
        <a id="3539" href="Algebra.Solver.CommutativeMonoid.html#3517" class="Bound">a</a> <a id="3541" href="Algebra.Bundles.html#6784" class="Field Operator">∙</a> <a id="3543" class="Symbol">(</a><a id="3544" href="Algebra.Solver.CommutativeMonoid.html#3519" class="Bound">b</a> <a id="3546" href="Algebra.Bundles.html#6784" class="Field Operator">∙</a> <a id="3548" href="Algebra.Solver.CommutativeMonoid.html#3521" class="Bound">c</a><a id="3549" class="Symbol">)</a>  <a id="3552" href="Relation.Binary.Reasoning.Syntax.html#7049" class="Function">≈⟨</a> <a id="3555" href="Relation.Binary.Structures.html#1622" class="Function">sym</a> <a id="3559" class="Symbol">(</a><a id="3560" href="Algebra.Structures.html#2977" class="Function">assoc</a> <a id="3566" class="Symbol">_</a> <a id="3568" class="Symbol">_</a> <a id="3570" class="Symbol">_)</a> <a id="3573" href="Relation.Binary.Reasoning.Syntax.html#7049" class="Function">⟩</a>
        <a id="3583" class="Symbol">(</a><a id="3584" href="Algebra.Solver.CommutativeMonoid.html#3517" class="Bound">a</a> <a id="3586" href="Algebra.Bundles.html#6784" class="Field Operator">∙</a> <a id="3588" href="Algebra.Solver.CommutativeMonoid.html#3519" class="Bound">b</a><a id="3589" class="Symbol">)</a> <a id="3591" href="Algebra.Bundles.html#6784" class="Field Operator">∙</a> <a id="3593" href="Algebra.Solver.CommutativeMonoid.html#3521" class="Bound">c</a>  <a id="3596" href="Relation.Binary.Reasoning.Syntax.html#7049" class="Function">≈⟨</a> <a id="3599" href="Algebra.Structures.html#1526" class="Function">∙-congʳ</a> <a id="3607" class="Symbol">(</a><a id="3608" href="Algebra.Structures.html#4484" class="Function">comm</a> <a id="3613" class="Symbol">_</a> <a id="3615" class="Symbol">_)</a> <a id="3618" href="Relation.Binary.Reasoning.Syntax.html#7049" class="Function">⟩</a>
        <a id="3628" class="Symbol">(</a><a id="3629" href="Algebra.Solver.CommutativeMonoid.html#3519" class="Bound">b</a> <a id="3631" href="Algebra.Bundles.html#6784" class="Field Operator">∙</a> <a id="3633" href="Algebra.Solver.CommutativeMonoid.html#3517" class="Bound">a</a><a id="3634" class="Symbol">)</a> <a id="3636" href="Algebra.Bundles.html#6784" class="Field Operator">∙</a> <a id="3638" href="Algebra.Solver.CommutativeMonoid.html#3521" class="Bound">c</a>  <a id="3641" href="Relation.Binary.Reasoning.Syntax.html#7049" class="Function">≈⟨</a> <a id="3644" href="Algebra.Structures.html#2977" class="Function">assoc</a> <a id="3650" class="Symbol">_</a> <a id="3652" class="Symbol">_</a> <a id="3654" class="Symbol">_</a> <a id="3656" href="Relation.Binary.Reasoning.Syntax.html#7049" class="Function">⟩</a>
        <a id="3666" href="Algebra.Solver.CommutativeMonoid.html#3519" class="Bound">b</a> <a id="3668" href="Algebra.Bundles.html#6784" class="Field Operator">∙</a> <a id="3670" class="Symbol">(</a><a id="3671" href="Algebra.Solver.CommutativeMonoid.html#3517" class="Bound">a</a> <a id="3673" href="Algebra.Bundles.html#6784" class="Field Operator">∙</a> <a id="3675" href="Algebra.Solver.CommutativeMonoid.html#3521" class="Bound">c</a><a id="3676" class="Symbol">)</a>  <a id="3679" href="Relation.Binary.Reasoning.Syntax.html#12283" class="Function Operator">∎</a>
    <a id="3685" href="Algebra.Solver.CommutativeMonoid.html#3685" class="Function">lemma</a> <a id="3691" class="Symbol">:</a> <a id="3693" class="Symbol">∀</a> <a id="3695" href="Algebra.Solver.CommutativeMonoid.html#3695" class="Bound">l</a> <a id="3697" href="Algebra.Solver.CommutativeMonoid.html#3697" class="Bound">m</a> <a id="3699" class="Symbol">{</a><a id="3700" href="Algebra.Solver.CommutativeMonoid.html#3700" class="Bound">d</a> <a id="3702" href="Algebra.Solver.CommutativeMonoid.html#3702" class="Bound">b</a> <a id="3704" href="Algebra.Solver.CommutativeMonoid.html#3704" class="Bound">c</a><a id="3705" class="Symbol">}</a> <a id="3707" class="Symbol">(</a><a id="3708" href="Algebra.Solver.CommutativeMonoid.html#3708" class="Bound">p</a> <a id="3710" class="Symbol">:</a> <a id="3712" href="Algebra.Solver.CommutativeMonoid.html#3700" class="Bound">d</a> <a id="3714" href="Algebra.Bundles.html#6744" class="Field Operator">≈</a> <a id="3716" href="Algebra.Solver.CommutativeMonoid.html#3702" class="Bound">b</a> <a id="3718" href="Algebra.Bundles.html#6784" class="Field Operator">∙</a> <a id="3720" href="Algebra.Solver.CommutativeMonoid.html#3704" class="Bound">c</a><a id="3721" class="Symbol">)</a> <a id="3723" class="Symbol">→</a>
      <a id="3731" href="Data.Nat.GeneralisedArithmetic.html#573" class="Function">fold</a> <a id="3736" href="Algebra.Solver.CommutativeMonoid.html#3700" class="Bound">d</a> <a id="3738" class="Symbol">(</a><a id="3739" href="Algebra.Solver.CommutativeMonoid.html#3409" class="Bound">a</a> <a id="3741" href="Algebra.Bundles.html#6784" class="Field Operator">∙_</a><a id="3743" class="Symbol">)</a> <a id="3745" class="Symbol">(</a><a id="3746" href="Algebra.Solver.CommutativeMonoid.html#3695" class="Bound">l</a> <a id="3748" href="Agda.Builtin.Nat.html#336" class="Primitive Operator">+</a> <a id="3750" href="Algebra.Solver.CommutativeMonoid.html#3697" class="Bound">m</a><a id="3751" class="Symbol">)</a> <a id="3753" href="Algebra.Bundles.html#6744" class="Field Operator">≈</a> <a id="3755" href="Data.Nat.GeneralisedArithmetic.html#573" class="Function">fold</a> <a id="3760" href="Algebra.Solver.CommutativeMonoid.html#3702" class="Bound">b</a> <a id="3762" class="Symbol">(</a><a id="3763" href="Algebra.Solver.CommutativeMonoid.html#3409" class="Bound">a</a> <a id="3765" href="Algebra.Bundles.html#6784" class="Field Operator">∙_</a><a id="3767" class="Symbol">)</a> <a id="3769" href="Algebra.Solver.CommutativeMonoid.html#3695" class="Bound">l</a> <a id="3771" href="Algebra.Bundles.html#6784" class="Field Operator">∙</a> <a id="3773" href="Data.Nat.GeneralisedArithmetic.html#573" class="Function">fold</a> <a id="3778" href="Algebra.Solver.CommutativeMonoid.html#3704" class="Bound">c</a> <a id="3780" class="Symbol">(</a><a id="3781" href="Algebra.Solver.CommutativeMonoid.html#3409" class="Bound">a</a> <a id="3783" href="Algebra.Bundles.html#6784" class="Field Operator">∙_</a><a id="3785" class="Symbol">)</a> <a id="3787" href="Algebra.Solver.CommutativeMonoid.html#3697" class="Bound">m</a>
    <a id="3793" href="Algebra.Solver.CommutativeMonoid.html#3685" class="Function">lemma</a> <a id="3799" href="Agda.Builtin.Nat.html#221" class="InductiveConstructor">zero</a> <a id="3804" href="Agda.Builtin.Nat.html#221" class="InductiveConstructor">zero</a> <a id="3809" href="Algebra.Solver.CommutativeMonoid.html#3809" class="Bound">p</a> <a id="3811" class="Symbol">=</a> <a id="3813" href="Algebra.Solver.CommutativeMonoid.html#3809" class="Bound">p</a>
    <a id="3819" href="Algebra.Solver.CommutativeMonoid.html#3685" class="Function">lemma</a> <a id="3825" href="Agda.Builtin.Nat.html#221" class="InductiveConstructor">zero</a> <a id="3830" class="Symbol">(</a><a id="3831" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="3835" href="Algebra.Solver.CommutativeMonoid.html#3835" class="Bound">m</a><a id="3836" class="Symbol">)</a> <a id="3838" href="Algebra.Solver.CommutativeMonoid.html#3838" class="Bound">p</a> <a id="3840" class="Symbol">=</a> <a id="3842" href="Relation.Binary.Structures.html#1648" class="Function">trans</a> <a id="3848" class="Symbol">(</a><a id="3849" href="Algebra.Structures.html#1465" class="Function">∙-congˡ</a> <a id="3857" class="Symbol">(</a><a id="3858" href="Algebra.Solver.CommutativeMonoid.html#3685" class="Function">lemma</a> <a id="3864" href="Agda.Builtin.Nat.html#221" class="InductiveConstructor">zero</a> <a id="3869" href="Algebra.Solver.CommutativeMonoid.html#3835" class="Bound">m</a> <a id="3871" href="Algebra.Solver.CommutativeMonoid.html#3838" class="Bound">p</a><a id="3872" class="Symbol">))</a> <a id="3875" class="Symbol">(</a><a id="3876" href="Algebra.Solver.CommutativeMonoid.html#3461" class="Function">flip12</a> <a id="3883" class="Symbol">_</a> <a id="3885" class="Symbol">_</a> <a id="3887" class="Symbol">_)</a>
    <a id="3894" href="Algebra.Solver.CommutativeMonoid.html#3685" class="Function">lemma</a> <a id="3900" class="Symbol">(</a><a id="3901" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="3905" href="Algebra.Solver.CommutativeMonoid.html#3905" class="Bound">l</a><a id="3906" class="Symbol">)</a> <a id="3908" href="Algebra.Solver.CommutativeMonoid.html#3908" class="Bound">m</a> <a id="3910" href="Algebra.Solver.CommutativeMonoid.html#3910" class="Bound">p</a> <a id="3912" class="Symbol">=</a> <a id="3914" href="Relation.Binary.Structures.html#1648" class="Function">trans</a> <a id="3920" class="Symbol">(</a><a id="3921" href="Algebra.Structures.html#1465" class="Function">∙-congˡ</a> <a id="3929" class="Symbol">(</a><a id="3930" href="Algebra.Solver.CommutativeMonoid.html#3685" class="Function">lemma</a> <a id="3936" href="Algebra.Solver.CommutativeMonoid.html#3905" class="Bound">l</a> <a id="3938" href="Algebra.Solver.CommutativeMonoid.html#3908" class="Bound">m</a> <a id="3940" href="Algebra.Solver.CommutativeMonoid.html#3910" class="Bound">p</a><a id="3941" class="Symbol">))</a> <a id="3944" class="Symbol">(</a><a id="3945" href="Relation.Binary.Structures.html#1622" class="Function">sym</a> <a id="3949" class="Symbol">(</a><a id="3950" href="Algebra.Structures.html#2977" class="Function">assoc</a> <a id="3956" href="Algebra.Solver.CommutativeMonoid.html#3409" class="Bound">a</a> <a id="3958" class="Symbol">_</a> <a id="3960" class="Symbol">_))</a>

<a id="3965" class="Comment">------------------------------------------------------------------------</a>
<a id="4038" class="Comment">-- Normalization</a>

<a id="4056" class="Comment">-- A normaliser.</a>

<a id="normalise"></a><a id="4074" href="Algebra.Solver.CommutativeMonoid.html#4074" class="Function">normalise</a> <a id="4084" class="Symbol">:</a> <a id="4086" href="Algebra.Solver.CommutativeMonoid.html#1474" class="Datatype">Expr</a> <a id="4091" href="Algebra.Solver.CommutativeMonoid.html#1227" class="Generalizable">n</a> <a id="4093" class="Symbol">→</a> <a id="4095" href="Algebra.Solver.CommutativeMonoid.html#2012" class="Function">Normal</a> <a id="4102" href="Algebra.Solver.CommutativeMonoid.html#1227" class="Generalizable">n</a>
<a id="4104" href="Algebra.Solver.CommutativeMonoid.html#4074" class="Function">normalise</a> <a id="4114" class="Symbol">(</a><a id="4115" href="Algebra.Solver.CommutativeMonoid.html#1501" class="InductiveConstructor">var</a> <a id="4119" href="Algebra.Solver.CommutativeMonoid.html#4119" class="Bound">x</a><a id="4120" class="Symbol">)</a>   <a id="4124" class="Symbol">=</a> <a id="4126" href="Algebra.Solver.CommutativeMonoid.html#2370" class="Function">sg</a> <a id="4129" href="Algebra.Solver.CommutativeMonoid.html#4119" class="Bound">x</a>
<a id="4131" href="Algebra.Solver.CommutativeMonoid.html#4074" class="Function">normalise</a> <a id="4141" href="Algebra.Solver.CommutativeMonoid.html#1524" class="InductiveConstructor">id</a>        <a id="4151" class="Symbol">=</a> <a id="4153" href="Algebra.Solver.CommutativeMonoid.html#2309" class="Function">empty</a>
<a id="4159" href="Algebra.Solver.CommutativeMonoid.html#4074" class="Function">normalise</a> <a id="4169" class="Symbol">(</a><a id="4170" href="Algebra.Solver.CommutativeMonoid.html#4170" class="Bound">e₁</a> <a id="4173" href="Algebra.Solver.CommutativeMonoid.html#1539" class="InductiveConstructor Operator">⊕</a> <a id="4175" href="Algebra.Solver.CommutativeMonoid.html#4175" class="Bound">e₂</a><a id="4177" class="Symbol">)</a> <a id="4179" class="Symbol">=</a> <a id="4181" href="Algebra.Solver.CommutativeMonoid.html#4074" class="Function">normalise</a> <a id="4191" href="Algebra.Solver.CommutativeMonoid.html#4170" class="Bound">e₁</a> <a id="4194" href="Algebra.Solver.CommutativeMonoid.html#2481" class="Function Operator">•</a> <a id="4196" href="Algebra.Solver.CommutativeMonoid.html#4074" class="Function">normalise</a> <a id="4206" href="Algebra.Solver.CommutativeMonoid.html#4175" class="Bound">e₂</a>

<a id="4210" class="Comment">-- The normaliser preserves the semantics of the expression.</a>

<a id="normalise-correct"></a><a id="4272" href="Algebra.Solver.CommutativeMonoid.html#4272" class="Function">normalise-correct</a> <a id="4290" class="Symbol">:</a> <a id="4292" class="Symbol">(</a><a id="4293" href="Algebra.Solver.CommutativeMonoid.html#4293" class="Bound">e</a> <a id="4295" class="Symbol">:</a> <a id="4297" href="Algebra.Solver.CommutativeMonoid.html#1474" class="Datatype">Expr</a> <a id="4302" href="Algebra.Solver.CommutativeMonoid.html#1227" class="Generalizable">n</a><a id="4303" class="Symbol">)</a> <a id="4305" class="Symbol">(</a><a id="4306" href="Algebra.Solver.CommutativeMonoid.html#4306" class="Bound">ρ</a> <a id="4308" class="Symbol">:</a> <a id="4310" href="Algebra.Solver.CommutativeMonoid.html#1629" class="Function">Env</a> <a id="4314" href="Algebra.Solver.CommutativeMonoid.html#1227" class="Generalizable">n</a><a id="4315" class="Symbol">)</a> <a id="4317" class="Symbol">→</a>
    <a id="4323" href="Algebra.Solver.CommutativeMonoid.html#2085" class="Function Operator">⟦</a> <a id="4325" href="Algebra.Solver.CommutativeMonoid.html#4074" class="Function">normalise</a> <a id="4335" href="Algebra.Solver.CommutativeMonoid.html#4293" class="Bound">e</a> <a id="4337" href="Algebra.Solver.CommutativeMonoid.html#2085" class="Function Operator">⟧⇓</a> <a id="4340" href="Algebra.Solver.CommutativeMonoid.html#4306" class="Bound">ρ</a> <a id="4342" href="Algebra.Bundles.html#6744" class="Field Operator">≈</a> <a id="4344" href="Algebra.Solver.CommutativeMonoid.html#1752" class="Function Operator">⟦</a> <a id="4346" href="Algebra.Solver.CommutativeMonoid.html#4293" class="Bound">e</a> <a id="4348" href="Algebra.Solver.CommutativeMonoid.html#1752" class="Function Operator">⟧</a> <a id="4350" href="Algebra.Solver.CommutativeMonoid.html#4306" class="Bound">ρ</a>
<a id="4352" href="Algebra.Solver.CommutativeMonoid.html#4272" class="Function">normalise-correct</a> <a id="4370" class="Symbol">(</a><a id="4371" href="Algebra.Solver.CommutativeMonoid.html#1501" class="InductiveConstructor">var</a> <a id="4375" href="Algebra.Solver.CommutativeMonoid.html#4375" class="Bound">x</a><a id="4376" class="Symbol">)</a>   <a id="4380" href="Algebra.Solver.CommutativeMonoid.html#4380" class="Bound">ρ</a> <a id="4382" class="Symbol">=</a> <a id="4384" href="Algebra.Solver.CommutativeMonoid.html#2905" class="Function">sg-correct</a> <a id="4395" href="Algebra.Solver.CommutativeMonoid.html#4375" class="Bound">x</a> <a id="4397" href="Algebra.Solver.CommutativeMonoid.html#4380" class="Bound">ρ</a>
<a id="4399" href="Algebra.Solver.CommutativeMonoid.html#4272" class="Function">normalise-correct</a> <a id="4417" href="Algebra.Solver.CommutativeMonoid.html#1524" class="InductiveConstructor">id</a>        <a id="4427" href="Algebra.Solver.CommutativeMonoid.html#4427" class="Bound">ρ</a> <a id="4429" class="Symbol">=</a> <a id="4431" href="Algebra.Solver.CommutativeMonoid.html#2741" class="Function">empty-correct</a> <a id="4445" href="Algebra.Solver.CommutativeMonoid.html#4427" class="Bound">ρ</a>
<a id="4447" href="Algebra.Solver.CommutativeMonoid.html#4272" class="Function">normalise-correct</a> <a id="4465" class="Symbol">(</a><a id="4466" href="Algebra.Solver.CommutativeMonoid.html#4466" class="Bound">e₁</a> <a id="4469" href="Algebra.Solver.CommutativeMonoid.html#1539" class="InductiveConstructor Operator">⊕</a> <a id="4471" href="Algebra.Solver.CommutativeMonoid.html#4471" class="Bound">e₂</a><a id="4473" class="Symbol">)</a> <a id="4475" href="Algebra.Solver.CommutativeMonoid.html#4475" class="Bound">ρ</a> <a id="4477" class="Symbol">=</a>  <a id="4480" href="Relation.Binary.Reasoning.Syntax.html#1510" class="Function Operator">begin</a>

    <a id="4491" href="Algebra.Solver.CommutativeMonoid.html#2085" class="Function Operator">⟦</a> <a id="4493" href="Algebra.Solver.CommutativeMonoid.html#4074" class="Function">normalise</a> <a id="4503" href="Algebra.Solver.CommutativeMonoid.html#4466" class="Bound">e₁</a> <a id="4506" href="Algebra.Solver.CommutativeMonoid.html#2481" class="Function Operator">•</a> <a id="4508" href="Algebra.Solver.CommutativeMonoid.html#4074" class="Function">normalise</a> <a id="4518" href="Algebra.Solver.CommutativeMonoid.html#4471" class="Bound">e₂</a> <a id="4521" href="Algebra.Solver.CommutativeMonoid.html#2085" class="Function Operator">⟧⇓</a> <a id="4524" href="Algebra.Solver.CommutativeMonoid.html#4475" class="Bound">ρ</a>

  <a id="4529" href="Relation.Binary.Reasoning.Syntax.html#7049" class="Function">≈⟨</a> <a id="4532" href="Algebra.Solver.CommutativeMonoid.html#3240" class="Function">comp-correct</a> <a id="4545" class="Symbol">(</a><a id="4546" href="Algebra.Solver.CommutativeMonoid.html#4074" class="Function">normalise</a> <a id="4556" href="Algebra.Solver.CommutativeMonoid.html#4466" class="Bound">e₁</a><a id="4558" class="Symbol">)</a> <a id="4560" class="Symbol">(</a><a id="4561" href="Algebra.Solver.CommutativeMonoid.html#4074" class="Function">normalise</a> <a id="4571" href="Algebra.Solver.CommutativeMonoid.html#4471" class="Bound">e₂</a><a id="4573" class="Symbol">)</a> <a id="4575" href="Algebra.Solver.CommutativeMonoid.html#4475" class="Bound">ρ</a> <a id="4577" href="Relation.Binary.Reasoning.Syntax.html#7049" class="Function">⟩</a>

    <a id="4584" href="Algebra.Solver.CommutativeMonoid.html#2085" class="Function Operator">⟦</a> <a id="4586" href="Algebra.Solver.CommutativeMonoid.html#4074" class="Function">normalise</a> <a id="4596" href="Algebra.Solver.CommutativeMonoid.html#4466" class="Bound">e₁</a> <a id="4599" href="Algebra.Solver.CommutativeMonoid.html#2085" class="Function Operator">⟧⇓</a> <a id="4602" href="Algebra.Solver.CommutativeMonoid.html#4475" class="Bound">ρ</a> <a id="4604" href="Algebra.Bundles.html#6784" class="Field Operator">∙</a> <a id="4606" href="Algebra.Solver.CommutativeMonoid.html#2085" class="Function Operator">⟦</a> <a id="4608" href="Algebra.Solver.CommutativeMonoid.html#4074" class="Function">normalise</a> <a id="4618" href="Algebra.Solver.CommutativeMonoid.html#4471" class="Bound">e₂</a> <a id="4621" href="Algebra.Solver.CommutativeMonoid.html#2085" class="Function Operator">⟧⇓</a> <a id="4624" href="Algebra.Solver.CommutativeMonoid.html#4475" class="Bound">ρ</a>

  <a id="4629" href="Relation.Binary.Reasoning.Syntax.html#7049" class="Function">≈⟨</a> <a id="4632" href="Algebra.Structures.html#1315" class="Function">∙-cong</a> <a id="4639" class="Symbol">(</a><a id="4640" href="Algebra.Solver.CommutativeMonoid.html#4272" class="Function">normalise-correct</a> <a id="4658" href="Algebra.Solver.CommutativeMonoid.html#4466" class="Bound">e₁</a> <a id="4661" href="Algebra.Solver.CommutativeMonoid.html#4475" class="Bound">ρ</a><a id="4662" class="Symbol">)</a> <a id="4664" class="Symbol">(</a><a id="4665" href="Algebra.Solver.CommutativeMonoid.html#4272" class="Function">normalise-correct</a> <a id="4683" href="Algebra.Solver.CommutativeMonoid.html#4471" class="Bound">e₂</a> <a id="4686" href="Algebra.Solver.CommutativeMonoid.html#4475" class="Bound">ρ</a><a id="4687" class="Symbol">)</a> <a id="4689" href="Relation.Binary.Reasoning.Syntax.html#7049" class="Function">⟩</a>

    <a id="4696" href="Algebra.Solver.CommutativeMonoid.html#1752" class="Function Operator">⟦</a> <a id="4698" href="Algebra.Solver.CommutativeMonoid.html#4466" class="Bound">e₁</a> <a id="4701" href="Algebra.Solver.CommutativeMonoid.html#1752" class="Function Operator">⟧</a> <a id="4703" href="Algebra.Solver.CommutativeMonoid.html#4475" class="Bound">ρ</a> <a id="4705" href="Algebra.Bundles.html#6784" class="Field Operator">∙</a> <a id="4707" href="Algebra.Solver.CommutativeMonoid.html#1752" class="Function Operator">⟦</a> <a id="4709" href="Algebra.Solver.CommutativeMonoid.html#4471" class="Bound">e₂</a> <a id="4712" href="Algebra.Solver.CommutativeMonoid.html#1752" class="Function Operator">⟧</a> <a id="4714" href="Algebra.Solver.CommutativeMonoid.html#4475" class="Bound">ρ</a>
  <a id="4718" href="Relation.Binary.Reasoning.Syntax.html#12283" class="Function Operator">∎</a>

<a id="4721" class="Comment">------------------------------------------------------------------------</a>
<a id="4794" class="Comment">-- &quot;Tactic.</a>

<a id="4807" class="Keyword">open</a> <a id="4812" class="Keyword">module</a> <a id="R"></a><a id="4819" href="Algebra.Solver.CommutativeMonoid.html#4819" class="Module">R</a> <a id="4821" class="Symbol">=</a> <a id="4823" href="Relation.Binary.Reflection.html" class="Module">Reflection</a>
                  <a id="4852" href="Algebra.Structures.html#1390" class="Function">setoid</a> <a id="4859" href="Algebra.Solver.CommutativeMonoid.html#1501" class="InductiveConstructor">var</a> <a id="4863" href="Algebra.Solver.CommutativeMonoid.html#1752" class="Function Operator">⟦_⟧</a> <a id="4867" class="Symbol">(</a><a id="4868" href="Algebra.Solver.CommutativeMonoid.html#2085" class="Function Operator">⟦_⟧⇓</a> <a id="4873" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="4875" href="Algebra.Solver.CommutativeMonoid.html#4074" class="Function">normalise</a><a id="4884" class="Symbol">)</a> <a id="4886" href="Algebra.Solver.CommutativeMonoid.html#4272" class="Function">normalise-correct</a>
  <a id="4906" class="Keyword">public</a> <a id="4913" class="Keyword">using</a> <a id="4919" class="Symbol">(</a><a id="4920" href="Relation.Binary.Reflection.html#2542" class="Function">solve</a><a id="4925" class="Symbol">;</a> <a id="4927" href="Relation.Binary.Reflection.html#3647" class="Function Operator">_⊜_</a><a id="4930" class="Symbol">)</a>

<a id="4933" class="Comment">-- We can decide if two normal forms are /syntactically/ equal.</a>

<a id="4998" class="Keyword">infix</a> <a id="5004" class="Number">5</a> <a id="5006" href="Algebra.Solver.CommutativeMonoid.html#5011" class="Function Operator">_≟_</a>

<a id="_≟_"></a><a id="5011" href="Algebra.Solver.CommutativeMonoid.html#5011" class="Function Operator">_≟_</a> <a id="5015" class="Symbol">:</a> <a id="5017" class="Symbol">(</a><a id="5018" href="Algebra.Solver.CommutativeMonoid.html#5018" class="Bound">nf₁</a> <a id="5022" href="Algebra.Solver.CommutativeMonoid.html#5022" class="Bound">nf₂</a> <a id="5026" class="Symbol">:</a> <a id="5028" href="Algebra.Solver.CommutativeMonoid.html#2012" class="Function">Normal</a> <a id="5035" href="Algebra.Solver.CommutativeMonoid.html#1227" class="Generalizable">n</a><a id="5036" class="Symbol">)</a> <a id="5038" class="Symbol">→</a> <a id="5040" href="Relation.Nullary.Decidable.Core.html#1485" class="Record">Dec</a> <a id="5044" class="Symbol">(</a><a id="5045" href="Algebra.Solver.CommutativeMonoid.html#5018" class="Bound">nf₁</a> <a id="5049" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="5051" href="Algebra.Solver.CommutativeMonoid.html#5022" class="Bound">nf₂</a><a id="5054" class="Symbol">)</a>
<a id="5056" href="Algebra.Solver.CommutativeMonoid.html#5056" class="Bound">nf₁</a> <a id="5060" href="Algebra.Solver.CommutativeMonoid.html#5011" class="Function Operator">≟</a> <a id="5062" href="Algebra.Solver.CommutativeMonoid.html#5062" class="Bound">nf₂</a> <a id="5066" class="Symbol">=</a> <a id="5068" href="Relation.Nullary.Decidable.html#1218" class="Function">Dec.map</a> <a id="5076" href="Data.Vec.Relation.Binary.Pointwise.Inductive.html#9718" class="Function">Pointwise-≡↔≡</a> <a id="5090" class="Symbol">(</a><a id="5091" href="Data.Vec.Relation.Binary.Pointwise.Inductive.html#3736" class="Function">decidable</a> <a id="5101" href="Data.Nat.Properties.html#3311" class="Function Operator">ℕ._≟_</a> <a id="5107" href="Algebra.Solver.CommutativeMonoid.html#5056" class="Bound">nf₁</a> <a id="5111" href="Algebra.Solver.CommutativeMonoid.html#5062" class="Bound">nf₂</a><a id="5114" class="Symbol">)</a>
  <a id="5118" class="Keyword">where</a> <a id="5124" class="Keyword">open</a> <a id="5129" href="Data.Vec.Relation.Binary.Pointwise.Inductive.html" class="Module">Pointwise</a>

<a id="5140" class="Comment">-- We can also give a sound, but not necessarily complete, procedure</a>
<a id="5209" class="Comment">-- for determining if two expressions have the same semantics.</a>

<a id="prove′"></a><a id="5273" href="Algebra.Solver.CommutativeMonoid.html#5273" class="Function">prove′</a> <a id="5280" class="Symbol">:</a> <a id="5282" class="Symbol">(</a><a id="5283" href="Algebra.Solver.CommutativeMonoid.html#5283" class="Bound">e₁</a> <a id="5286" href="Algebra.Solver.CommutativeMonoid.html#5286" class="Bound">e₂</a> <a id="5289" class="Symbol">:</a> <a id="5291" href="Algebra.Solver.CommutativeMonoid.html#1474" class="Datatype">Expr</a> <a id="5296" href="Algebra.Solver.CommutativeMonoid.html#1227" class="Generalizable">n</a><a id="5297" class="Symbol">)</a> <a id="5299" class="Symbol">→</a> <a id="5301" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="5307" class="Symbol">(∀</a> <a id="5310" href="Algebra.Solver.CommutativeMonoid.html#5310" class="Bound">ρ</a> <a id="5312" class="Symbol">→</a> <a id="5314" href="Algebra.Solver.CommutativeMonoid.html#1752" class="Function Operator">⟦</a> <a id="5316" href="Algebra.Solver.CommutativeMonoid.html#5283" class="Bound">e₁</a> <a id="5319" href="Algebra.Solver.CommutativeMonoid.html#1752" class="Function Operator">⟧</a> <a id="5321" href="Algebra.Solver.CommutativeMonoid.html#5310" class="Bound">ρ</a> <a id="5323" href="Algebra.Bundles.html#6744" class="Field Operator">≈</a> <a id="5325" href="Algebra.Solver.CommutativeMonoid.html#1752" class="Function Operator">⟦</a> <a id="5327" href="Algebra.Solver.CommutativeMonoid.html#5286" class="Bound">e₂</a> <a id="5330" href="Algebra.Solver.CommutativeMonoid.html#1752" class="Function Operator">⟧</a> <a id="5332" href="Algebra.Solver.CommutativeMonoid.html#5310" class="Bound">ρ</a><a id="5333" class="Symbol">)</a>
<a id="5335" href="Algebra.Solver.CommutativeMonoid.html#5273" class="Function">prove′</a> <a id="5342" href="Algebra.Solver.CommutativeMonoid.html#5342" class="Bound">e₁</a> <a id="5345" href="Algebra.Solver.CommutativeMonoid.html#5345" class="Bound">e₂</a> <a id="5348" class="Symbol">=</a>
  <a id="5352" href="Data.Maybe.Base.html#2049" class="Function">Maybe.map</a> <a id="5362" href="Algebra.Solver.CommutativeMonoid.html#5421" class="Function">lemma</a> <a id="5368" class="Symbol">(</a><a id="5369" href="Data.Maybe.Base.html#1241" class="Function">decToMaybe</a> <a id="5380" class="Symbol">(</a><a id="5381" href="Algebra.Solver.CommutativeMonoid.html#4074" class="Function">normalise</a> <a id="5391" href="Algebra.Solver.CommutativeMonoid.html#5342" class="Bound">e₁</a> <a id="5394" href="Algebra.Solver.CommutativeMonoid.html#5011" class="Function Operator">≟</a> <a id="5396" href="Algebra.Solver.CommutativeMonoid.html#4074" class="Function">normalise</a> <a id="5406" href="Algebra.Solver.CommutativeMonoid.html#5345" class="Bound">e₂</a><a id="5408" class="Symbol">))</a>
  <a id="5413" class="Keyword">where</a>
  <a id="5421" href="Algebra.Solver.CommutativeMonoid.html#5421" class="Function">lemma</a> <a id="5427" class="Symbol">:</a> <a id="5429" href="Algebra.Solver.CommutativeMonoid.html#4074" class="Function">normalise</a> <a id="5439" href="Algebra.Solver.CommutativeMonoid.html#5342" class="Bound">e₁</a> <a id="5442" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="5444" href="Algebra.Solver.CommutativeMonoid.html#4074" class="Function">normalise</a> <a id="5454" href="Algebra.Solver.CommutativeMonoid.html#5345" class="Bound">e₂</a> <a id="5457" class="Symbol">→</a> <a id="5459" class="Symbol">∀</a> <a id="5461" href="Algebra.Solver.CommutativeMonoid.html#5461" class="Bound">ρ</a> <a id="5463" class="Symbol">→</a> <a id="5465" href="Algebra.Solver.CommutativeMonoid.html#1752" class="Function Operator">⟦</a> <a id="5467" href="Algebra.Solver.CommutativeMonoid.html#5342" class="Bound">e₁</a> <a id="5470" href="Algebra.Solver.CommutativeMonoid.html#1752" class="Function Operator">⟧</a> <a id="5472" href="Algebra.Solver.CommutativeMonoid.html#5461" class="Bound">ρ</a> <a id="5474" href="Algebra.Bundles.html#6744" class="Field Operator">≈</a> <a id="5476" href="Algebra.Solver.CommutativeMonoid.html#1752" class="Function Operator">⟦</a> <a id="5478" href="Algebra.Solver.CommutativeMonoid.html#5345" class="Bound">e₂</a> <a id="5481" href="Algebra.Solver.CommutativeMonoid.html#1752" class="Function Operator">⟧</a> <a id="5483" href="Algebra.Solver.CommutativeMonoid.html#5461" class="Bound">ρ</a>
  <a id="5487" href="Algebra.Solver.CommutativeMonoid.html#5421" class="Function">lemma</a> <a id="5493" href="Algebra.Solver.CommutativeMonoid.html#5493" class="Bound">eq</a> <a id="5496" href="Algebra.Solver.CommutativeMonoid.html#5496" class="Bound">ρ</a> <a id="5498" class="Symbol">=</a>
    <a id="5504" href="Relation.Binary.Reflection.html#1856" class="Function">R.prove</a> <a id="5512" href="Algebra.Solver.CommutativeMonoid.html#5496" class="Bound">ρ</a> <a id="5514" href="Algebra.Solver.CommutativeMonoid.html#5342" class="Bound">e₁</a> <a id="5517" href="Algebra.Solver.CommutativeMonoid.html#5345" class="Bound">e₂</a> <a id="5520" class="Symbol">(</a><a id="5521" href="Relation.Binary.Reasoning.Syntax.html#1510" class="Function Operator">begin</a>
      <a id="5533" href="Algebra.Solver.CommutativeMonoid.html#2085" class="Function Operator">⟦</a> <a id="5535" href="Algebra.Solver.CommutativeMonoid.html#4074" class="Function">normalise</a> <a id="5545" href="Algebra.Solver.CommutativeMonoid.html#5342" class="Bound">e₁</a> <a id="5548" href="Algebra.Solver.CommutativeMonoid.html#2085" class="Function Operator">⟧⇓</a> <a id="5551" href="Algebra.Solver.CommutativeMonoid.html#5496" class="Bound">ρ</a>  <a id="5554" href="Relation.Binary.Reasoning.Syntax.html#10986" class="Function">≡⟨</a> <a id="5557" href="Relation.Binary.PropositionalEquality.Core.html#1158" class="Function">P.cong</a> <a id="5564" class="Symbol">(λ</a> <a id="5567" href="Algebra.Solver.CommutativeMonoid.html#5567" class="Bound">e</a> <a id="5569" class="Symbol">→</a> <a id="5571" href="Algebra.Solver.CommutativeMonoid.html#2085" class="Function Operator">⟦</a> <a id="5573" href="Algebra.Solver.CommutativeMonoid.html#5567" class="Bound">e</a> <a id="5575" href="Algebra.Solver.CommutativeMonoid.html#2085" class="Function Operator">⟧⇓</a> <a id="5578" href="Algebra.Solver.CommutativeMonoid.html#5496" class="Bound">ρ</a><a id="5579" class="Symbol">)</a> <a id="5581" href="Algebra.Solver.CommutativeMonoid.html#5493" class="Bound">eq</a> <a id="5584" href="Relation.Binary.Reasoning.Syntax.html#10986" class="Function">⟩</a>
      <a id="5592" href="Algebra.Solver.CommutativeMonoid.html#2085" class="Function Operator">⟦</a> <a id="5594" href="Algebra.Solver.CommutativeMonoid.html#4074" class="Function">normalise</a> <a id="5604" href="Algebra.Solver.CommutativeMonoid.html#5345" class="Bound">e₂</a> <a id="5607" href="Algebra.Solver.CommutativeMonoid.html#2085" class="Function Operator">⟧⇓</a> <a id="5610" href="Algebra.Solver.CommutativeMonoid.html#5496" class="Bound">ρ</a>  <a id="5613" href="Relation.Binary.Reasoning.Syntax.html#12283" class="Function Operator">∎</a><a id="5614" class="Symbol">)</a>

<a id="5617" class="Comment">-- This procedure can be combined with from-just.</a>

<a id="prove"></a><a id="5668" href="Algebra.Solver.CommutativeMonoid.html#5668" class="Function">prove</a> <a id="5674" class="Symbol">:</a> <a id="5676" class="Symbol">∀</a> <a id="5678" href="Algebra.Solver.CommutativeMonoid.html#5678" class="Bound">n</a> <a id="5680" class="Symbol">(</a><a id="5681" href="Algebra.Solver.CommutativeMonoid.html#5681" class="Bound">e₁</a> <a id="5684" href="Algebra.Solver.CommutativeMonoid.html#5684" class="Bound">e₂</a> <a id="5687" class="Symbol">:</a> <a id="5689" href="Algebra.Solver.CommutativeMonoid.html#1474" class="Datatype">Expr</a> <a id="5694" href="Algebra.Solver.CommutativeMonoid.html#5678" class="Bound">n</a><a id="5695" class="Symbol">)</a> <a id="5697" class="Symbol">→</a> <a id="5699" href="Data.Maybe.Base.html#1847" class="Function">From-just</a> <a id="5709" class="Symbol">(</a><a id="5710" href="Algebra.Solver.CommutativeMonoid.html#5273" class="Function">prove′</a> <a id="5717" href="Algebra.Solver.CommutativeMonoid.html#5681" class="Bound">e₁</a> <a id="5720" href="Algebra.Solver.CommutativeMonoid.html#5684" class="Bound">e₂</a><a id="5722" class="Symbol">)</a>
<a id="5724" href="Algebra.Solver.CommutativeMonoid.html#5668" class="Function">prove</a> <a id="5730" class="Symbol">_</a> <a id="5732" href="Algebra.Solver.CommutativeMonoid.html#5732" class="Bound">e₁</a> <a id="5735" href="Algebra.Solver.CommutativeMonoid.html#5735" class="Bound">e₂</a> <a id="5738" class="Symbol">=</a> <a id="5740" href="Data.Maybe.Base.html#1935" class="Function">from-just</a> <a id="5750" class="Symbol">(</a><a id="5751" href="Algebra.Solver.CommutativeMonoid.html#5273" class="Function">prove′</a> <a id="5758" href="Algebra.Solver.CommutativeMonoid.html#5732" class="Bound">e₁</a> <a id="5761" href="Algebra.Solver.CommutativeMonoid.html#5735" class="Bound">e₂</a><a id="5763" class="Symbol">)</a>

<a id="5766" class="Comment">-- prove : ∀ n (es : Expr n × Expr n) →</a>
<a id="5806" class="Comment">--         From-just (uncurry prove′ es)</a>
<a id="5847" class="Comment">-- prove _ = from-just ∘ uncurry prove′</a>
</pre></body></html>