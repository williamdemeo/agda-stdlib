<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Data.Nat.DivMod.WithK</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- The Agda standard library</a>
<a id="103" class="Comment">--</a>
<a id="106" class="Comment">-- More efficient mod and divMod operations (require the K axiom)</a>
<a id="172" class="Comment">------------------------------------------------------------------------</a>

<a id="246" class="Symbol">{-#</a> <a id="250" class="Keyword">OPTIONS</a> <a id="258" class="Pragma">--with-K</a> <a id="267" class="Pragma">--safe</a> <a id="274" class="Symbol">#-}</a>

<a id="279" class="Keyword">module</a> <a id="286" href="Data.Nat.DivMod.WithK.html" class="Module">Data.Nat.DivMod.WithK</a> <a id="308" class="Keyword">where</a>

<a id="315" class="Keyword">open</a> <a id="320" class="Keyword">import</a> <a id="327" href="Data.Nat.html" class="Module">Data.Nat</a> <a id="336" class="Keyword">using</a> <a id="342" class="Symbol">(</a><a id="343" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="344" class="Symbol">;</a> <a id="346" href="Data.Nat.Base.html#3260" class="Record">NonZero</a><a id="353" class="Symbol">;</a> <a id="355" href="Agda.Builtin.Nat.html#336" class="Primitive Operator">_+_</a><a id="358" class="Symbol">;</a> <a id="360" href="Agda.Builtin.Nat.html#539" class="Primitive Operator">_*_</a><a id="363" class="Symbol">)</a>
<a id="365" class="Keyword">open</a> <a id="370" class="Keyword">import</a> <a id="377" href="Data.Nat.DivMod.html" class="Module">Data.Nat.DivMod</a> <a id="393" class="Keyword">hiding</a> <a id="400" class="Symbol">(</a><a id="401" href="Data.Nat.DivMod.html#18976" class="Function Operator">_mod_</a><a id="406" class="Symbol">;</a> <a id="408" href="Data.Nat.DivMod.html#19076" class="Function Operator">_divMod_</a><a id="416" class="Symbol">)</a>
<a id="418" class="Keyword">open</a> <a id="423" class="Keyword">import</a> <a id="430" href="Data.Nat.Properties.html" class="Module">Data.Nat.Properties</a> <a id="450" class="Keyword">using</a> <a id="456" class="Symbol">(</a><a id="457" href="Data.Nat.Properties.html#64932" class="Function">≤⇒≤″</a><a id="461" class="Symbol">)</a>
<a id="463" class="Keyword">open</a> <a id="468" class="Keyword">import</a> <a id="475" href="Data.Nat.WithK.html" class="Module">Data.Nat.WithK</a>
<a id="490" class="Keyword">open</a> <a id="495" class="Keyword">import</a> <a id="502" href="Data.Fin.Base.html" class="Module">Data.Fin.Base</a> <a id="516" class="Keyword">using</a> <a id="522" class="Symbol">(</a><a id="523" href="Data.Fin.Base.html#1154" class="Datatype">Fin</a><a id="526" class="Symbol">;</a> <a id="528" href="Data.Fin.Base.html#1262" class="Function">toℕ</a><a id="531" class="Symbol">;</a> <a id="533" href="Data.Fin.Base.html#2095" class="Function">fromℕ&lt;″</a><a id="540" class="Symbol">)</a>
<a id="542" class="Keyword">open</a> <a id="547" class="Keyword">import</a> <a id="554" href="Data.Fin.Properties.html" class="Module">Data.Fin.Properties</a> <a id="574" class="Keyword">using</a> <a id="580" class="Symbol">(</a><a id="581" href="Data.Fin.Properties.html#9052" class="Function">toℕ-fromℕ&lt;″</a><a id="592" class="Symbol">)</a>
<a id="594" class="Keyword">open</a> <a id="599" class="Keyword">import</a> <a id="606" href="Function.Base.html" class="Module">Function.Base</a> <a id="620" class="Keyword">using</a> <a id="626" class="Symbol">(</a><a id="627" href="Function.Base.html#1974" class="Function Operator">_$_</a><a id="630" class="Symbol">)</a>
<a id="632" class="Keyword">open</a> <a id="637" class="Keyword">import</a> <a id="644" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a>
  <a id="684" class="Keyword">using</a> <a id="690" class="Symbol">(</a><a id="691" href="Relation.Binary.PropositionalEquality.Core.html#1158" class="Function">cong</a><a id="695" class="Symbol">;</a> <a id="697" class="Keyword">module</a> <a id="704" href="Relation.Binary.PropositionalEquality.Properties.html#6744" class="Module">≡-Reasoning</a><a id="715" class="Symbol">)</a>
<a id="717" class="Keyword">open</a> <a id="722" class="Keyword">import</a> <a id="729" href="Relation.Binary.PropositionalEquality.WithK.html" class="Module">Relation.Binary.PropositionalEquality.WithK</a>

<a id="774" class="Keyword">open</a> <a id="779" href="Relation.Binary.PropositionalEquality.Properties.html#6744" class="Module">≡-Reasoning</a>

<a id="792" class="Keyword">infixl</a> <a id="799" class="Number">7</a> <a id="801" href="Data.Nat.DivMod.WithK.html#912" class="Function Operator">_mod_</a> <a id="807" href="Data.Nat.DivMod.WithK.html#1179" class="Function Operator">_divMod_</a>

<a id="817" class="Comment">------------------------------------------------------------------------</a>
<a id="890" class="Comment">-- Certified modulus</a>

<a id="_mod_"></a><a id="912" href="Data.Nat.DivMod.WithK.html#912" class="Function Operator">_mod_</a> <a id="918" class="Symbol">:</a> <a id="920" class="Symbol">(</a><a id="921" href="Data.Nat.DivMod.WithK.html#921" class="Bound">dividend</a> <a id="930" href="Data.Nat.DivMod.WithK.html#930" class="Bound">divisor</a> <a id="938" class="Symbol">:</a> <a id="940" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="941" class="Symbol">)</a> <a id="943" class="Symbol">→</a> <a id="945" class="Symbol">.{{</a> <a id="949" href="Data.Nat.DivMod.WithK.html#949" class="Bound">_</a> <a id="951" class="Symbol">:</a> <a id="953" href="Data.Nat.Base.html#3260" class="Record">NonZero</a> <a id="961" href="Data.Nat.DivMod.WithK.html#930" class="Bound">divisor</a> <a id="969" class="Symbol">}}</a> <a id="972" class="Symbol">→</a> <a id="974" href="Data.Fin.Base.html#1154" class="Datatype">Fin</a> <a id="978" href="Data.Nat.DivMod.WithK.html#930" class="Bound">divisor</a>
<a id="986" href="Data.Nat.DivMod.WithK.html#986" class="Bound">m</a> <a id="988" href="Data.Nat.DivMod.WithK.html#912" class="Function Operator">mod</a> <a id="992" href="Data.Nat.DivMod.WithK.html#992" class="Bound">n</a> <a id="994" class="Symbol">=</a> <a id="996" href="Data.Fin.Base.html#2095" class="Function">fromℕ&lt;″</a> <a id="1004" class="Symbol">(</a><a id="1005" href="Data.Nat.DivMod.WithK.html#986" class="Bound">m</a> <a id="1007" href="Data.Nat.Base.html#7279" class="Function Operator">%</a> <a id="1009" href="Data.Nat.DivMod.WithK.html#992" class="Bound">n</a><a id="1010" class="Symbol">)</a> <a id="1012" class="Symbol">(</a><a id="1013" href="Data.Nat.WithK.html#387" class="Function">≤″-erase</a> <a id="1022" class="Symbol">(</a><a id="1023" href="Data.Nat.Properties.html#64932" class="Function">≤⇒≤″</a> <a id="1028" class="Symbol">(</a><a id="1029" href="Data.Nat.DivMod.html#3880" class="Function">m%n&lt;n</a> <a id="1035" href="Data.Nat.DivMod.WithK.html#986" class="Bound">m</a> <a id="1037" href="Data.Nat.DivMod.WithK.html#992" class="Bound">n</a><a id="1038" class="Symbol">)))</a>

<a id="1043" class="Comment">------------------------------------------------------------------------</a>
<a id="1116" class="Comment">-- Returns modulus and division result with correctness proof</a>

<a id="_divMod_"></a><a id="1179" href="Data.Nat.DivMod.WithK.html#1179" class="Function Operator">_divMod_</a> <a id="1188" class="Symbol">:</a> <a id="1190" class="Symbol">(</a><a id="1191" href="Data.Nat.DivMod.WithK.html#1191" class="Bound">dividend</a> <a id="1200" href="Data.Nat.DivMod.WithK.html#1200" class="Bound">divisor</a> <a id="1208" class="Symbol">:</a> <a id="1210" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="1211" class="Symbol">)</a> <a id="1213" class="Symbol">→</a> <a id="1215" class="Symbol">.{{</a> <a id="1219" href="Data.Nat.Base.html#3260" class="Record">NonZero</a> <a id="1227" href="Data.Nat.DivMod.WithK.html#1200" class="Bound">divisor</a> <a id="1235" class="Symbol">}}</a> <a id="1238" class="Symbol">→</a>
           <a id="1251" href="Data.Nat.DivMod.html#18692" class="Record">DivMod</a> <a id="1258" href="Data.Nat.DivMod.WithK.html#1191" class="Bound">dividend</a> <a id="1267" href="Data.Nat.DivMod.WithK.html#1200" class="Bound">divisor</a>
<a id="1275" href="Data.Nat.DivMod.WithK.html#1275" class="Bound">m</a> <a id="1277" href="Data.Nat.DivMod.WithK.html#1179" class="Function Operator">divMod</a> <a id="1284" href="Data.Nat.DivMod.WithK.html#1284" class="Bound">n</a> <a id="1286" class="Symbol">=</a> <a id="1288" href="Data.Nat.DivMod.html#18748" class="InductiveConstructor">result</a> <a id="1295" class="Symbol">(</a><a id="1296" href="Data.Nat.DivMod.WithK.html#1275" class="Bound">m</a> <a id="1298" href="Data.Nat.Base.html#7096" class="Function Operator">/</a> <a id="1300" href="Data.Nat.DivMod.WithK.html#1284" class="Bound">n</a><a id="1301" class="Symbol">)</a> <a id="1303" class="Symbol">(</a><a id="1304" href="Data.Nat.DivMod.WithK.html#1275" class="Bound">m</a> <a id="1306" href="Data.Nat.DivMod.WithK.html#912" class="Function Operator">mod</a> <a id="1310" href="Data.Nat.DivMod.WithK.html#1284" class="Bound">n</a><a id="1311" class="Symbol">)</a> <a id="1313" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="1315" href="Relation.Binary.PropositionalEquality.WithK.html#896" class="Primitive">≡-erase</a> <a id="1323" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="1325" href="Relation.Binary.Reasoning.Syntax.html#1510" class="Function Operator">begin</a>
  <a id="1333" href="Data.Nat.DivMod.WithK.html#1275" class="Bound">m</a>                                 <a id="1367" href="Relation.Binary.Reasoning.Syntax.html#10986" class="Function">≡⟨</a> <a id="1370" href="Data.Nat.DivMod.html#1065" class="Function">m≡m%n+[m/n]*n</a> <a id="1384" href="Data.Nat.DivMod.WithK.html#1275" class="Bound">m</a> <a id="1386" href="Data.Nat.DivMod.WithK.html#1284" class="Bound">n</a> <a id="1388" href="Relation.Binary.Reasoning.Syntax.html#10986" class="Function">⟩</a>
  <a id="1392" href="Data.Nat.DivMod.WithK.html#1275" class="Bound">m</a> <a id="1394" href="Data.Nat.Base.html#7279" class="Function Operator">%</a> <a id="1396" href="Data.Nat.DivMod.WithK.html#1284" class="Bound">n</a>                  <a id="1415" href="Agda.Builtin.Nat.html#336" class="Primitive Operator">+</a> <a id="1417" href="Data.Nat.DivMod.WithK.html#1516" class="Function">[m/n]*n</a>  <a id="1426" href="Relation.Binary.Reasoning.Syntax.html#11078" class="Function">≡⟨</a> <a id="1429" href="Relation.Binary.PropositionalEquality.Core.html#1158" class="Function">cong</a> <a id="1434" class="Symbol">(</a><a id="1435" href="Agda.Builtin.Nat.html#336" class="Primitive Operator">_+</a> <a id="1438" href="Data.Nat.DivMod.WithK.html#1516" class="Function">[m/n]*n</a><a id="1445" class="Symbol">)</a> <a id="1447" class="Symbol">(</a><a id="1448" href="Data.Fin.Properties.html#9052" class="Function">toℕ-fromℕ&lt;″</a> <a id="1460" href="Data.Nat.DivMod.WithK.html#1538" class="Function">lemma″</a><a id="1466" class="Symbol">)</a> <a id="1468" href="Relation.Binary.Reasoning.Syntax.html#11078" class="Function">⟨</a>
  <a id="1472" href="Data.Fin.Base.html#1262" class="Function">toℕ</a> <a id="1476" class="Symbol">(</a><a id="1477" href="Data.Fin.Base.html#2095" class="Function">fromℕ&lt;″</a> <a id="1485" class="Symbol">_</a> <a id="1487" href="Data.Nat.DivMod.WithK.html#1538" class="Function">lemma″</a><a id="1493" class="Symbol">)</a> <a id="1495" href="Agda.Builtin.Nat.html#336" class="Primitive Operator">+</a> <a id="1497" href="Data.Nat.DivMod.WithK.html#1516" class="Function">[m/n]*n</a>  <a id="1506" href="Relation.Binary.Reasoning.Syntax.html#12283" class="Function Operator">∎</a>
  <a id="1510" class="Keyword">where</a> <a id="1516" href="Data.Nat.DivMod.WithK.html#1516" class="Function">[m/n]*n</a> <a id="1524" class="Symbol">=</a> <a id="1526" href="Data.Nat.DivMod.WithK.html#1275" class="Bound">m</a> <a id="1528" href="Data.Nat.Base.html#7096" class="Function Operator">/</a> <a id="1530" href="Data.Nat.DivMod.WithK.html#1284" class="Bound">n</a> <a id="1532" href="Agda.Builtin.Nat.html#539" class="Primitive Operator">*</a> <a id="1534" href="Data.Nat.DivMod.WithK.html#1284" class="Bound">n</a> <a id="1536" class="Symbol">;</a> <a id="1538" href="Data.Nat.DivMod.WithK.html#1538" class="Function">lemma″</a> <a id="1545" class="Symbol">=</a> <a id="1547" href="Data.Nat.WithK.html#387" class="Function">≤″-erase</a> <a id="1556" class="Symbol">(</a><a id="1557" href="Data.Nat.Properties.html#64932" class="Function">≤⇒≤″</a> <a id="1562" class="Symbol">(</a><a id="1563" href="Data.Nat.DivMod.html#3880" class="Function">m%n&lt;n</a> <a id="1569" href="Data.Nat.DivMod.WithK.html#1275" class="Bound">m</a> <a id="1571" href="Data.Nat.DivMod.WithK.html#1284" class="Bound">n</a><a id="1572" class="Symbol">))</a>
</pre></body></html>