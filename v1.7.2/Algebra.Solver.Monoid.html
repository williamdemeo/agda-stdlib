<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Algebra.Solver.Monoid</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- The Agda standard library</a>
<a id="103" class="Comment">--</a>
<a id="106" class="Comment">-- A solver for equations over monoids</a>
<a id="145" class="Comment">------------------------------------------------------------------------</a>

<a id="219" class="Symbol">{-#</a> <a id="223" class="Keyword">OPTIONS</a> <a id="231" class="Pragma">--cubical-compatible</a> <a id="252" class="Pragma">--safe</a> <a id="259" class="Symbol">#-}</a>

<a id="264" class="Keyword">open</a> <a id="269" class="Keyword">import</a> <a id="276" href="Algebra.html" class="Module">Algebra</a>

<a id="285" class="Keyword">module</a> <a id="292" href="Algebra.Solver.Monoid.html" class="Module">Algebra.Solver.Monoid</a> <a id="314" class="Symbol">{</a><a id="315" href="Algebra.Solver.Monoid.html#315" class="Bound">m₁</a> <a id="318" href="Algebra.Solver.Monoid.html#318" class="Bound">m₂</a><a id="320" class="Symbol">}</a> <a id="322" class="Symbol">(</a><a id="323" href="Algebra.Solver.Monoid.html#323" class="Bound">M</a> <a id="325" class="Symbol">:</a> <a id="327" href="Algebra.Bundles.html#4430" class="Record">Monoid</a> <a id="334" href="Algebra.Solver.Monoid.html#315" class="Bound">m₁</a> <a id="337" href="Algebra.Solver.Monoid.html#318" class="Bound">m₂</a><a id="339" class="Symbol">)</a> <a id="341" class="Keyword">where</a>

<a id="348" class="Keyword">open</a> <a id="353" class="Keyword">import</a> <a id="360" href="Data.Fin.Base.html" class="Module">Data.Fin.Base</a> <a id="374" class="Symbol">as</a> <a id="377" class="Module">Fin</a>
<a id="381" class="Keyword">import</a> <a id="388" href="Data.Fin.Properties.html" class="Module">Data.Fin.Properties</a> <a id="408" class="Symbol">as</a> <a id="411" class="Module">Fin</a>
<a id="415" class="Keyword">open</a> <a id="420" class="Keyword">import</a> <a id="427" href="Data.List.Base.html" class="Module">Data.List.Base</a> <a id="442" class="Keyword">hiding</a> <a id="449" class="Symbol">(</a><a id="450" href="Data.List.Base.html#6115" class="Function">lookup</a><a id="456" class="Symbol">)</a>
<a id="458" class="Keyword">import</a> <a id="465" href="Data.List.Relation.Binary.Equality.DecPropositional.html" class="Module">Data.List.Relation.Binary.Equality.DecPropositional</a> <a id="517" class="Symbol">as</a> <a id="520" class="Module">ListEq</a>
<a id="527" class="Keyword">open</a> <a id="532" class="Keyword">import</a> <a id="539" href="Data.Maybe.Base.html" class="Module">Data.Maybe.Base</a> <a id="555" class="Symbol">as</a> <a id="558" class="Module">Maybe</a>
  <a id="566" class="Keyword">using</a> <a id="572" class="Symbol">(</a><a id="573" href="Agda.Builtin.Maybe.html#118" class="Datatype">Maybe</a><a id="578" class="Symbol">;</a> <a id="580" href="Data.Maybe.Base.html#1221" class="Function">decToMaybe</a><a id="590" class="Symbol">;</a> <a id="592" href="Data.Maybe.Base.html#1827" class="Function">From-just</a><a id="601" class="Symbol">;</a> <a id="603" href="Data.Maybe.Base.html#1915" class="Function">from-just</a><a id="612" class="Symbol">)</a>
<a id="614" class="Keyword">open</a> <a id="619" class="Keyword">import</a> <a id="626" href="Data.Nat.Base.html" class="Module">Data.Nat.Base</a> <a id="640" class="Keyword">using</a> <a id="646" class="Symbol">(</a><a id="647" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a><a id="648" class="Symbol">)</a>
<a id="650" class="Keyword">open</a> <a id="655" class="Keyword">import</a> <a id="662" href="Data.Product.html" class="Module">Data.Product</a>
<a id="675" class="Keyword">open</a> <a id="680" class="Keyword">import</a> <a id="687" href="Data.Vec.Base.html" class="Module">Data.Vec.Base</a> <a id="701" class="Keyword">using</a> <a id="707" class="Symbol">(</a><a id="708" href="Data.Vec.Base.html#1007" class="Datatype">Vec</a><a id="711" class="Symbol">;</a> <a id="713" href="Data.Vec.Base.html#1614" class="Function">lookup</a><a id="719" class="Symbol">)</a>
<a id="721" class="Keyword">open</a> <a id="726" class="Keyword">import</a> <a id="733" href="Function.Base.html" class="Module">Function.Base</a> <a id="747" class="Keyword">using</a> <a id="753" class="Symbol">(</a><a id="754" href="Function.Base.html#1040" class="Function Operator">_∘_</a><a id="757" class="Symbol">;</a> <a id="759" href="Function.Base.html#1928" class="Function Operator">_$_</a><a id="762" class="Symbol">)</a>
<a id="764" class="Keyword">open</a> <a id="769" class="Keyword">import</a> <a id="776" href="Relation.Binary.html" class="Module">Relation.Binary</a> <a id="792" class="Keyword">using</a> <a id="798" class="Symbol">(</a><a id="799" href="Relation.Binary.Definitions.html#4584" class="Function">Decidable</a><a id="808" class="Symbol">)</a>

<a id="811" class="Keyword">open</a> <a id="816" class="Keyword">import</a> <a id="823" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a> <a id="861" class="Symbol">as</a> <a id="864" class="Module">P</a> <a id="866" class="Keyword">using</a> <a id="872" class="Symbol">(</a><a id="873" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">_≡_</a><a id="876" class="Symbol">)</a>
<a id="878" class="Keyword">import</a> <a id="885" href="Relation.Binary.Reflection.html" class="Module">Relation.Binary.Reflection</a>
<a id="912" class="Keyword">open</a> <a id="917" class="Keyword">import</a> <a id="924" href="Relation.Nullary.html" class="Module">Relation.Nullary</a>
<a id="941" class="Keyword">import</a> <a id="948" href="Relation.Nullary.Decidable.html" class="Module">Relation.Nullary.Decidable</a> <a id="975" class="Symbol">as</a> <a id="978" class="Module">Dec</a>

<a id="983" class="Keyword">open</a> <a id="988" href="Algebra.Bundles.html#4430" class="Module">Monoid</a> <a id="995" href="Algebra.Solver.Monoid.html#323" class="Bound">M</a>
<a id="997" class="Keyword">open</a> <a id="1002" class="Keyword">import</a> <a id="1009" href="Relation.Binary.Reasoning.Setoid.html" class="Module">Relation.Binary.Reasoning.Setoid</a> <a id="1042" href="Algebra.Structures.html#1294" class="Function">setoid</a>

<a id="1050" class="Comment">------------------------------------------------------------------------</a>
<a id="1123" class="Comment">-- Monoid expressions</a>

<a id="1146" class="Comment">-- There is one constructor for every operation, plus one for</a>
<a id="1208" class="Comment">-- variables; there may be at most n variables.</a>

<a id="1257" class="Keyword">infixr</a> <a id="1264" class="Number">5</a> <a id="1266" href="Algebra.Solver.Monoid.html#1341" class="InductiveConstructor Operator">_⊕_</a>

<a id="1271" class="Keyword">data</a> <a id="Expr"></a><a id="1276" href="Algebra.Solver.Monoid.html#1276" class="Datatype">Expr</a> <a id="1281" class="Symbol">(</a><a id="1282" href="Algebra.Solver.Monoid.html#1282" class="Bound">n</a> <a id="1284" class="Symbol">:</a> <a id="1286" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a><a id="1287" class="Symbol">)</a> <a id="1289" class="Symbol">:</a> <a id="1291" href="Agda.Primitive.html#320" class="Primitive">Set</a> <a id="1295" class="Keyword">where</a>
  <a id="Expr.var"></a><a id="1303" href="Algebra.Solver.Monoid.html#1303" class="InductiveConstructor">var</a> <a id="1307" class="Symbol">:</a> <a id="1309" href="Data.Fin.Base.html#1135" class="Datatype">Fin</a> <a id="1313" href="Algebra.Solver.Monoid.html#1282" class="Bound">n</a> <a id="1315" class="Symbol">→</a> <a id="1317" href="Algebra.Solver.Monoid.html#1276" class="Datatype">Expr</a> <a id="1322" href="Algebra.Solver.Monoid.html#1282" class="Bound">n</a>
  <a id="Expr.id"></a><a id="1326" href="Algebra.Solver.Monoid.html#1326" class="InductiveConstructor">id</a>  <a id="1330" class="Symbol">:</a> <a id="1332" href="Algebra.Solver.Monoid.html#1276" class="Datatype">Expr</a> <a id="1337" href="Algebra.Solver.Monoid.html#1282" class="Bound">n</a>
  <a id="Expr._⊕_"></a><a id="1341" href="Algebra.Solver.Monoid.html#1341" class="InductiveConstructor Operator">_⊕_</a> <a id="1345" class="Symbol">:</a> <a id="1347" href="Algebra.Solver.Monoid.html#1276" class="Datatype">Expr</a> <a id="1352" href="Algebra.Solver.Monoid.html#1282" class="Bound">n</a> <a id="1354" class="Symbol">→</a> <a id="1356" href="Algebra.Solver.Monoid.html#1276" class="Datatype">Expr</a> <a id="1361" href="Algebra.Solver.Monoid.html#1282" class="Bound">n</a> <a id="1363" class="Symbol">→</a> <a id="1365" href="Algebra.Solver.Monoid.html#1276" class="Datatype">Expr</a> <a id="1370" href="Algebra.Solver.Monoid.html#1282" class="Bound">n</a>

<a id="1373" class="Comment">-- An environment contains one value for every variable.</a>

<a id="Env"></a><a id="1431" href="Algebra.Solver.Monoid.html#1431" class="Function">Env</a> <a id="1435" class="Symbol">:</a> <a id="1437" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a> <a id="1439" class="Symbol">→</a> <a id="1441" href="Agda.Primitive.html#320" class="Primitive">Set</a> <a id="1445" class="Symbol">_</a>
<a id="1447" href="Algebra.Solver.Monoid.html#1431" class="Function">Env</a> <a id="1451" href="Algebra.Solver.Monoid.html#1451" class="Bound">n</a> <a id="1453" class="Symbol">=</a> <a id="1455" href="Data.Vec.Base.html#1007" class="Datatype">Vec</a> <a id="1459" href="Algebra.Bundles.html#4509" class="Field">Carrier</a> <a id="1467" href="Algebra.Solver.Monoid.html#1451" class="Bound">n</a>

<a id="1470" class="Comment">-- The semantics of an expression is a function from an environment to</a>
<a id="1541" class="Comment">-- a value.</a>

<a id="⟦_⟧"></a><a id="1554" href="Algebra.Solver.Monoid.html#1554" class="Function Operator">⟦_⟧</a> <a id="1558" class="Symbol">:</a> <a id="1560" class="Symbol">∀</a> <a id="1562" class="Symbol">{</a><a id="1563" href="Algebra.Solver.Monoid.html#1563" class="Bound">n</a><a id="1564" class="Symbol">}</a> <a id="1566" class="Symbol">→</a> <a id="1568" href="Algebra.Solver.Monoid.html#1276" class="Datatype">Expr</a> <a id="1573" href="Algebra.Solver.Monoid.html#1563" class="Bound">n</a> <a id="1575" class="Symbol">→</a> <a id="1577" href="Algebra.Solver.Monoid.html#1431" class="Function">Env</a> <a id="1581" href="Algebra.Solver.Monoid.html#1563" class="Bound">n</a> <a id="1583" class="Symbol">→</a> <a id="1585" href="Algebra.Bundles.html#4509" class="Field">Carrier</a>
<a id="1593" href="Algebra.Solver.Monoid.html#1554" class="Function Operator">⟦</a> <a id="1595" href="Algebra.Solver.Monoid.html#1303" class="InductiveConstructor">var</a> <a id="1599" href="Algebra.Solver.Monoid.html#1599" class="Bound">x</a>   <a id="1603" href="Algebra.Solver.Monoid.html#1554" class="Function Operator">⟧</a> <a id="1605" href="Algebra.Solver.Monoid.html#1605" class="Bound">ρ</a> <a id="1607" class="Symbol">=</a> <a id="1609" href="Data.Vec.Base.html#1614" class="Function">lookup</a> <a id="1616" href="Algebra.Solver.Monoid.html#1605" class="Bound">ρ</a> <a id="1618" href="Algebra.Solver.Monoid.html#1599" class="Bound">x</a>
<a id="1620" href="Algebra.Solver.Monoid.html#1554" class="Function Operator">⟦</a> <a id="1622" href="Algebra.Solver.Monoid.html#1326" class="InductiveConstructor">id</a>      <a id="1630" href="Algebra.Solver.Monoid.html#1554" class="Function Operator">⟧</a> <a id="1632" href="Algebra.Solver.Monoid.html#1632" class="Bound">ρ</a> <a id="1634" class="Symbol">=</a> <a id="1636" href="Algebra.Bundles.html#4586" class="Field">ε</a>
<a id="1638" href="Algebra.Solver.Monoid.html#1554" class="Function Operator">⟦</a> <a id="1640" href="Algebra.Solver.Monoid.html#1640" class="Bound">e₁</a> <a id="1643" href="Algebra.Solver.Monoid.html#1341" class="InductiveConstructor Operator">⊕</a> <a id="1645" href="Algebra.Solver.Monoid.html#1645" class="Bound">e₂</a> <a id="1648" href="Algebra.Solver.Monoid.html#1554" class="Function Operator">⟧</a> <a id="1650" href="Algebra.Solver.Monoid.html#1650" class="Bound">ρ</a> <a id="1652" class="Symbol">=</a> <a id="1654" href="Algebra.Solver.Monoid.html#1554" class="Function Operator">⟦</a> <a id="1656" href="Algebra.Solver.Monoid.html#1640" class="Bound">e₁</a> <a id="1659" href="Algebra.Solver.Monoid.html#1554" class="Function Operator">⟧</a> <a id="1661" href="Algebra.Solver.Monoid.html#1650" class="Bound">ρ</a> <a id="1663" href="Algebra.Bundles.html#4559" class="Field Operator">∙</a> <a id="1665" href="Algebra.Solver.Monoid.html#1554" class="Function Operator">⟦</a> <a id="1667" href="Algebra.Solver.Monoid.html#1645" class="Bound">e₂</a> <a id="1670" href="Algebra.Solver.Monoid.html#1554" class="Function Operator">⟧</a> <a id="1672" href="Algebra.Solver.Monoid.html#1650" class="Bound">ρ</a>

<a id="1675" class="Comment">------------------------------------------------------------------------</a>
<a id="1748" class="Comment">-- Normal forms</a>

<a id="1765" class="Comment">-- A normal form is a list of variables.</a>

<a id="Normal"></a><a id="1807" href="Algebra.Solver.Monoid.html#1807" class="Function">Normal</a> <a id="1814" class="Symbol">:</a> <a id="1816" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a> <a id="1818" class="Symbol">→</a> <a id="1820" href="Agda.Primitive.html#320" class="Primitive">Set</a>
<a id="1824" href="Algebra.Solver.Monoid.html#1807" class="Function">Normal</a> <a id="1831" href="Algebra.Solver.Monoid.html#1831" class="Bound">n</a> <a id="1833" class="Symbol">=</a> <a id="1835" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="1840" class="Symbol">(</a><a id="1841" href="Data.Fin.Base.html#1135" class="Datatype">Fin</a> <a id="1845" href="Algebra.Solver.Monoid.html#1831" class="Bound">n</a><a id="1846" class="Symbol">)</a>

<a id="1849" class="Comment">-- The semantics of a normal form.</a>

<a id="⟦_⟧⇓"></a><a id="1885" href="Algebra.Solver.Monoid.html#1885" class="Function Operator">⟦_⟧⇓</a> <a id="1890" class="Symbol">:</a> <a id="1892" class="Symbol">∀</a> <a id="1894" class="Symbol">{</a><a id="1895" href="Algebra.Solver.Monoid.html#1895" class="Bound">n</a><a id="1896" class="Symbol">}</a> <a id="1898" class="Symbol">→</a> <a id="1900" href="Algebra.Solver.Monoid.html#1807" class="Function">Normal</a> <a id="1907" href="Algebra.Solver.Monoid.html#1895" class="Bound">n</a> <a id="1909" class="Symbol">→</a> <a id="1911" href="Algebra.Solver.Monoid.html#1431" class="Function">Env</a> <a id="1915" href="Algebra.Solver.Monoid.html#1895" class="Bound">n</a> <a id="1917" class="Symbol">→</a> <a id="1919" href="Algebra.Bundles.html#4509" class="Field">Carrier</a>
<a id="1927" href="Algebra.Solver.Monoid.html#1885" class="Function Operator">⟦</a> <a id="1929" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a>     <a id="1936" href="Algebra.Solver.Monoid.html#1885" class="Function Operator">⟧⇓</a> <a id="1939" href="Algebra.Solver.Monoid.html#1939" class="Bound">ρ</a> <a id="1941" class="Symbol">=</a> <a id="1943" href="Algebra.Bundles.html#4586" class="Field">ε</a>
<a id="1945" href="Algebra.Solver.Monoid.html#1885" class="Function Operator">⟦</a> <a id="1947" href="Algebra.Solver.Monoid.html#1947" class="Bound">x</a> <a id="1949" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="1951" href="Algebra.Solver.Monoid.html#1951" class="Bound">nf</a> <a id="1954" href="Algebra.Solver.Monoid.html#1885" class="Function Operator">⟧⇓</a> <a id="1957" href="Algebra.Solver.Monoid.html#1957" class="Bound">ρ</a> <a id="1959" class="Symbol">=</a> <a id="1961" href="Data.Vec.Base.html#1614" class="Function">lookup</a> <a id="1968" href="Algebra.Solver.Monoid.html#1957" class="Bound">ρ</a> <a id="1970" href="Algebra.Solver.Monoid.html#1947" class="Bound">x</a> <a id="1972" href="Algebra.Bundles.html#4559" class="Field Operator">∙</a> <a id="1974" href="Algebra.Solver.Monoid.html#1885" class="Function Operator">⟦</a> <a id="1976" href="Algebra.Solver.Monoid.html#1951" class="Bound">nf</a> <a id="1979" href="Algebra.Solver.Monoid.html#1885" class="Function Operator">⟧⇓</a> <a id="1982" href="Algebra.Solver.Monoid.html#1957" class="Bound">ρ</a>

<a id="1985" class="Comment">-- A normaliser.</a>

<a id="normalise"></a><a id="2003" href="Algebra.Solver.Monoid.html#2003" class="Function">normalise</a> <a id="2013" class="Symbol">:</a> <a id="2015" class="Symbol">∀</a> <a id="2017" class="Symbol">{</a><a id="2018" href="Algebra.Solver.Monoid.html#2018" class="Bound">n</a><a id="2019" class="Symbol">}</a> <a id="2021" class="Symbol">→</a> <a id="2023" href="Algebra.Solver.Monoid.html#1276" class="Datatype">Expr</a> <a id="2028" href="Algebra.Solver.Monoid.html#2018" class="Bound">n</a> <a id="2030" class="Symbol">→</a> <a id="2032" href="Algebra.Solver.Monoid.html#1807" class="Function">Normal</a> <a id="2039" href="Algebra.Solver.Monoid.html#2018" class="Bound">n</a>
<a id="2041" href="Algebra.Solver.Monoid.html#2003" class="Function">normalise</a> <a id="2051" class="Symbol">(</a><a id="2052" href="Algebra.Solver.Monoid.html#1303" class="InductiveConstructor">var</a> <a id="2056" href="Algebra.Solver.Monoid.html#2056" class="Bound">x</a><a id="2057" class="Symbol">)</a>   <a id="2061" class="Symbol">=</a> <a id="2063" href="Algebra.Solver.Monoid.html#2056" class="Bound">x</a> <a id="2065" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="2067" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a>
<a id="2070" href="Algebra.Solver.Monoid.html#2003" class="Function">normalise</a> <a id="2080" href="Algebra.Solver.Monoid.html#1326" class="InductiveConstructor">id</a>        <a id="2090" class="Symbol">=</a> <a id="2092" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a>
<a id="2095" href="Algebra.Solver.Monoid.html#2003" class="Function">normalise</a> <a id="2105" class="Symbol">(</a><a id="2106" href="Algebra.Solver.Monoid.html#2106" class="Bound">e₁</a> <a id="2109" href="Algebra.Solver.Monoid.html#1341" class="InductiveConstructor Operator">⊕</a> <a id="2111" href="Algebra.Solver.Monoid.html#2111" class="Bound">e₂</a><a id="2113" class="Symbol">)</a> <a id="2115" class="Symbol">=</a> <a id="2117" href="Algebra.Solver.Monoid.html#2003" class="Function">normalise</a> <a id="2127" href="Algebra.Solver.Monoid.html#2106" class="Bound">e₁</a> <a id="2130" href="Data.List.Base.html#1819" class="Function Operator">++</a> <a id="2133" href="Algebra.Solver.Monoid.html#2003" class="Function">normalise</a> <a id="2143" href="Algebra.Solver.Monoid.html#2111" class="Bound">e₂</a>

<a id="2147" class="Comment">-- The normaliser is homomorphic with respect to _++_/_∙_.</a>

<a id="homomorphic"></a><a id="2207" href="Algebra.Solver.Monoid.html#2207" class="Function">homomorphic</a> <a id="2219" class="Symbol">:</a> <a id="2221" class="Symbol">∀</a> <a id="2223" class="Symbol">{</a><a id="2224" href="Algebra.Solver.Monoid.html#2224" class="Bound">n</a><a id="2225" class="Symbol">}</a> <a id="2227" class="Symbol">(</a><a id="2228" href="Algebra.Solver.Monoid.html#2228" class="Bound">nf₁</a> <a id="2232" href="Algebra.Solver.Monoid.html#2232" class="Bound">nf₂</a> <a id="2236" class="Symbol">:</a> <a id="2238" href="Algebra.Solver.Monoid.html#1807" class="Function">Normal</a> <a id="2245" href="Algebra.Solver.Monoid.html#2224" class="Bound">n</a><a id="2246" class="Symbol">)</a> <a id="2248" class="Symbol">(</a><a id="2249" href="Algebra.Solver.Monoid.html#2249" class="Bound">ρ</a> <a id="2251" class="Symbol">:</a> <a id="2253" href="Algebra.Solver.Monoid.html#1431" class="Function">Env</a> <a id="2257" href="Algebra.Solver.Monoid.html#2224" class="Bound">n</a><a id="2258" class="Symbol">)</a> <a id="2260" class="Symbol">→</a>
              <a id="2276" href="Algebra.Solver.Monoid.html#1885" class="Function Operator">⟦</a> <a id="2278" href="Algebra.Solver.Monoid.html#2228" class="Bound">nf₁</a> <a id="2282" href="Data.List.Base.html#1819" class="Function Operator">++</a> <a id="2285" href="Algebra.Solver.Monoid.html#2232" class="Bound">nf₂</a> <a id="2289" href="Algebra.Solver.Monoid.html#1885" class="Function Operator">⟧⇓</a> <a id="2292" href="Algebra.Solver.Monoid.html#2249" class="Bound">ρ</a> <a id="2294" href="Algebra.Bundles.html#4530" class="Field Operator">≈</a> <a id="2296" class="Symbol">(</a><a id="2297" href="Algebra.Solver.Monoid.html#1885" class="Function Operator">⟦</a> <a id="2299" href="Algebra.Solver.Monoid.html#2228" class="Bound">nf₁</a> <a id="2303" href="Algebra.Solver.Monoid.html#1885" class="Function Operator">⟧⇓</a> <a id="2306" href="Algebra.Solver.Monoid.html#2249" class="Bound">ρ</a> <a id="2308" href="Algebra.Bundles.html#4559" class="Field Operator">∙</a> <a id="2310" href="Algebra.Solver.Monoid.html#1885" class="Function Operator">⟦</a> <a id="2312" href="Algebra.Solver.Monoid.html#2232" class="Bound">nf₂</a> <a id="2316" href="Algebra.Solver.Monoid.html#1885" class="Function Operator">⟧⇓</a> <a id="2319" href="Algebra.Solver.Monoid.html#2249" class="Bound">ρ</a><a id="2320" class="Symbol">)</a>
<a id="2322" href="Algebra.Solver.Monoid.html#2207" class="Function">homomorphic</a> <a id="2334" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a> <a id="2337" href="Algebra.Solver.Monoid.html#2337" class="Bound">nf₂</a> <a id="2341" href="Algebra.Solver.Monoid.html#2341" class="Bound">ρ</a> <a id="2343" class="Symbol">=</a> <a id="2345" href="Relation.Binary.Reasoning.Base.Single.html#1925" class="Function Operator">begin</a>
  <a id="2353" href="Algebra.Solver.Monoid.html#1885" class="Function Operator">⟦</a> <a id="2355" href="Algebra.Solver.Monoid.html#2337" class="Bound">nf₂</a> <a id="2359" href="Algebra.Solver.Monoid.html#1885" class="Function Operator">⟧⇓</a> <a id="2362" href="Algebra.Solver.Monoid.html#2341" class="Bound">ρ</a>      <a id="2369" href="Relation.Binary.Reasoning.Setoid.html#1061" class="Function">≈⟨</a> <a id="2372" href="Relation.Binary.Structures.html#1603" class="Function">sym</a> <a id="2376" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="2378" href="Algebra.Structures.html#2972" class="Function">identityˡ</a> <a id="2388" class="Symbol">_</a> <a id="2390" href="Relation.Binary.Reasoning.Setoid.html#1061" class="Function">⟩</a>
  <a id="2394" href="Algebra.Bundles.html#4586" class="Field">ε</a> <a id="2396" href="Algebra.Bundles.html#4559" class="Field Operator">∙</a> <a id="2398" href="Algebra.Solver.Monoid.html#1885" class="Function Operator">⟦</a> <a id="2400" href="Algebra.Solver.Monoid.html#2337" class="Bound">nf₂</a> <a id="2404" href="Algebra.Solver.Monoid.html#1885" class="Function Operator">⟧⇓</a> <a id="2407" href="Algebra.Solver.Monoid.html#2341" class="Bound">ρ</a>  <a id="2410" href="Relation.Binary.Reasoning.Base.Single.html#2564" class="Function Operator">∎</a>
<a id="2412" href="Algebra.Solver.Monoid.html#2207" class="Function">homomorphic</a> <a id="2424" class="Symbol">(</a><a id="2425" href="Algebra.Solver.Monoid.html#2425" class="Bound">x</a> <a id="2427" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="2429" href="Algebra.Solver.Monoid.html#2429" class="Bound">nf₁</a><a id="2432" class="Symbol">)</a> <a id="2434" href="Algebra.Solver.Monoid.html#2434" class="Bound">nf₂</a> <a id="2438" href="Algebra.Solver.Monoid.html#2438" class="Bound">ρ</a> <a id="2440" class="Symbol">=</a> <a id="2442" href="Relation.Binary.Reasoning.Base.Single.html#1925" class="Function Operator">begin</a>
  <a id="2450" href="Data.Vec.Base.html#1614" class="Function">lookup</a> <a id="2457" href="Algebra.Solver.Monoid.html#2438" class="Bound">ρ</a> <a id="2459" href="Algebra.Solver.Monoid.html#2425" class="Bound">x</a> <a id="2461" href="Algebra.Bundles.html#4559" class="Field Operator">∙</a> <a id="2463" href="Algebra.Solver.Monoid.html#1885" class="Function Operator">⟦</a> <a id="2465" href="Algebra.Solver.Monoid.html#2429" class="Bound">nf₁</a> <a id="2469" href="Data.List.Base.html#1819" class="Function Operator">++</a> <a id="2472" href="Algebra.Solver.Monoid.html#2434" class="Bound">nf₂</a> <a id="2476" href="Algebra.Solver.Monoid.html#1885" class="Function Operator">⟧⇓</a> <a id="2479" href="Algebra.Solver.Monoid.html#2438" class="Bound">ρ</a>          <a id="2490" href="Relation.Binary.Reasoning.Setoid.html#1061" class="Function">≈⟨</a> <a id="2493" href="Algebra.Structures.html#1369" class="Function">∙-congˡ</a> <a id="2501" class="Symbol">(</a><a id="2502" href="Algebra.Solver.Monoid.html#2207" class="Function">homomorphic</a> <a id="2514" href="Algebra.Solver.Monoid.html#2429" class="Bound">nf₁</a> <a id="2518" href="Algebra.Solver.Monoid.html#2434" class="Bound">nf₂</a> <a id="2522" href="Algebra.Solver.Monoid.html#2438" class="Bound">ρ</a><a id="2523" class="Symbol">)</a> <a id="2525" href="Relation.Binary.Reasoning.Setoid.html#1061" class="Function">⟩</a>
  <a id="2529" href="Data.Vec.Base.html#1614" class="Function">lookup</a> <a id="2536" href="Algebra.Solver.Monoid.html#2438" class="Bound">ρ</a> <a id="2538" href="Algebra.Solver.Monoid.html#2425" class="Bound">x</a> <a id="2540" href="Algebra.Bundles.html#4559" class="Field Operator">∙</a> <a id="2542" class="Symbol">(</a><a id="2543" href="Algebra.Solver.Monoid.html#1885" class="Function Operator">⟦</a> <a id="2545" href="Algebra.Solver.Monoid.html#2429" class="Bound">nf₁</a> <a id="2549" href="Algebra.Solver.Monoid.html#1885" class="Function Operator">⟧⇓</a> <a id="2552" href="Algebra.Solver.Monoid.html#2438" class="Bound">ρ</a> <a id="2554" href="Algebra.Bundles.html#4559" class="Field Operator">∙</a> <a id="2556" href="Algebra.Solver.Monoid.html#1885" class="Function Operator">⟦</a> <a id="2558" href="Algebra.Solver.Monoid.html#2434" class="Bound">nf₂</a> <a id="2562" href="Algebra.Solver.Monoid.html#1885" class="Function Operator">⟧⇓</a> <a id="2565" href="Algebra.Solver.Monoid.html#2438" class="Bound">ρ</a><a id="2566" class="Symbol">)</a>  <a id="2569" href="Relation.Binary.Reasoning.Setoid.html#1061" class="Function">≈⟨</a> <a id="2572" href="Relation.Binary.Structures.html#1603" class="Function">sym</a> <a id="2576" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="2578" href="Algebra.Structures.html#1876" class="Function">assoc</a> <a id="2584" class="Symbol">_</a> <a id="2586" class="Symbol">_</a> <a id="2588" class="Symbol">_</a> <a id="2590" href="Relation.Binary.Reasoning.Setoid.html#1061" class="Function">⟩</a>
  <a id="2594" href="Data.Vec.Base.html#1614" class="Function">lookup</a> <a id="2601" href="Algebra.Solver.Monoid.html#2438" class="Bound">ρ</a> <a id="2603" href="Algebra.Solver.Monoid.html#2425" class="Bound">x</a> <a id="2605" href="Algebra.Bundles.html#4559" class="Field Operator">∙</a> <a id="2607" href="Algebra.Solver.Monoid.html#1885" class="Function Operator">⟦</a> <a id="2609" href="Algebra.Solver.Monoid.html#2429" class="Bound">nf₁</a> <a id="2613" href="Algebra.Solver.Monoid.html#1885" class="Function Operator">⟧⇓</a> <a id="2616" href="Algebra.Solver.Monoid.html#2438" class="Bound">ρ</a> <a id="2618" href="Algebra.Bundles.html#4559" class="Field Operator">∙</a> <a id="2620" href="Algebra.Solver.Monoid.html#1885" class="Function Operator">⟦</a> <a id="2622" href="Algebra.Solver.Monoid.html#2434" class="Bound">nf₂</a> <a id="2626" href="Algebra.Solver.Monoid.html#1885" class="Function Operator">⟧⇓</a> <a id="2629" href="Algebra.Solver.Monoid.html#2438" class="Bound">ρ</a>    <a id="2634" href="Relation.Binary.Reasoning.Base.Single.html#2564" class="Function Operator">∎</a>

<a id="2637" class="Comment">-- The normaliser preserves the semantics of the expression.</a>

<a id="normalise-correct"></a><a id="2699" href="Algebra.Solver.Monoid.html#2699" class="Function">normalise-correct</a> <a id="2717" class="Symbol">:</a>
  <a id="2721" class="Symbol">∀</a> <a id="2723" class="Symbol">{</a><a id="2724" href="Algebra.Solver.Monoid.html#2724" class="Bound">n</a><a id="2725" class="Symbol">}</a> <a id="2727" class="Symbol">(</a><a id="2728" href="Algebra.Solver.Monoid.html#2728" class="Bound">e</a> <a id="2730" class="Symbol">:</a> <a id="2732" href="Algebra.Solver.Monoid.html#1276" class="Datatype">Expr</a> <a id="2737" href="Algebra.Solver.Monoid.html#2724" class="Bound">n</a><a id="2738" class="Symbol">)</a> <a id="2740" class="Symbol">(</a><a id="2741" href="Algebra.Solver.Monoid.html#2741" class="Bound">ρ</a> <a id="2743" class="Symbol">:</a> <a id="2745" href="Algebra.Solver.Monoid.html#1431" class="Function">Env</a> <a id="2749" href="Algebra.Solver.Monoid.html#2724" class="Bound">n</a><a id="2750" class="Symbol">)</a> <a id="2752" class="Symbol">→</a> <a id="2754" href="Algebra.Solver.Monoid.html#1885" class="Function Operator">⟦</a> <a id="2756" href="Algebra.Solver.Monoid.html#2003" class="Function">normalise</a> <a id="2766" href="Algebra.Solver.Monoid.html#2728" class="Bound">e</a> <a id="2768" href="Algebra.Solver.Monoid.html#1885" class="Function Operator">⟧⇓</a> <a id="2771" href="Algebra.Solver.Monoid.html#2741" class="Bound">ρ</a> <a id="2773" href="Algebra.Bundles.html#4530" class="Field Operator">≈</a> <a id="2775" href="Algebra.Solver.Monoid.html#1554" class="Function Operator">⟦</a> <a id="2777" href="Algebra.Solver.Monoid.html#2728" class="Bound">e</a> <a id="2779" href="Algebra.Solver.Monoid.html#1554" class="Function Operator">⟧</a> <a id="2781" href="Algebra.Solver.Monoid.html#2741" class="Bound">ρ</a>
<a id="2783" href="Algebra.Solver.Monoid.html#2699" class="Function">normalise-correct</a> <a id="2801" class="Symbol">(</a><a id="2802" href="Algebra.Solver.Monoid.html#1303" class="InductiveConstructor">var</a> <a id="2806" href="Algebra.Solver.Monoid.html#2806" class="Bound">x</a><a id="2807" class="Symbol">)</a> <a id="2809" href="Algebra.Solver.Monoid.html#2809" class="Bound">ρ</a> <a id="2811" class="Symbol">=</a> <a id="2813" href="Relation.Binary.Reasoning.Base.Single.html#1925" class="Function Operator">begin</a>
  <a id="2821" href="Data.Vec.Base.html#1614" class="Function">lookup</a> <a id="2828" href="Algebra.Solver.Monoid.html#2809" class="Bound">ρ</a> <a id="2830" href="Algebra.Solver.Monoid.html#2806" class="Bound">x</a> <a id="2832" href="Algebra.Bundles.html#4559" class="Field Operator">∙</a> <a id="2834" href="Algebra.Bundles.html#4586" class="Field">ε</a>  <a id="2837" href="Relation.Binary.Reasoning.Setoid.html#1061" class="Function">≈⟨</a> <a id="2840" href="Algebra.Structures.html#3033" class="Function">identityʳ</a> <a id="2850" class="Symbol">_</a> <a id="2852" href="Relation.Binary.Reasoning.Setoid.html#1061" class="Function">⟩</a>
  <a id="2856" href="Data.Vec.Base.html#1614" class="Function">lookup</a> <a id="2863" href="Algebra.Solver.Monoid.html#2809" class="Bound">ρ</a> <a id="2865" href="Algebra.Solver.Monoid.html#2806" class="Bound">x</a>      <a id="2872" href="Relation.Binary.Reasoning.Base.Single.html#2564" class="Function Operator">∎</a>
<a id="2874" href="Algebra.Solver.Monoid.html#2699" class="Function">normalise-correct</a> <a id="2892" href="Algebra.Solver.Monoid.html#1326" class="InductiveConstructor">id</a> <a id="2895" href="Algebra.Solver.Monoid.html#2895" class="Bound">ρ</a> <a id="2897" class="Symbol">=</a> <a id="2899" href="Relation.Binary.Reasoning.Base.Single.html#1925" class="Function Operator">begin</a>
  <a id="2907" href="Algebra.Bundles.html#4586" class="Field">ε</a>  <a id="2910" href="Relation.Binary.Reasoning.Base.Single.html#2564" class="Function Operator">∎</a>
<a id="2912" href="Algebra.Solver.Monoid.html#2699" class="Function">normalise-correct</a> <a id="2930" class="Symbol">(</a><a id="2931" href="Algebra.Solver.Monoid.html#2931" class="Bound">e₁</a> <a id="2934" href="Algebra.Solver.Monoid.html#1341" class="InductiveConstructor Operator">⊕</a> <a id="2936" href="Algebra.Solver.Monoid.html#2936" class="Bound">e₂</a><a id="2938" class="Symbol">)</a> <a id="2940" href="Algebra.Solver.Monoid.html#2940" class="Bound">ρ</a> <a id="2942" class="Symbol">=</a> <a id="2944" href="Relation.Binary.Reasoning.Base.Single.html#1925" class="Function Operator">begin</a>
  <a id="2952" href="Algebra.Solver.Monoid.html#1885" class="Function Operator">⟦</a> <a id="2954" href="Algebra.Solver.Monoid.html#2003" class="Function">normalise</a> <a id="2964" href="Algebra.Solver.Monoid.html#2931" class="Bound">e₁</a> <a id="2967" href="Data.List.Base.html#1819" class="Function Operator">++</a> <a id="2970" href="Algebra.Solver.Monoid.html#2003" class="Function">normalise</a> <a id="2980" href="Algebra.Solver.Monoid.html#2936" class="Bound">e₂</a> <a id="2983" href="Algebra.Solver.Monoid.html#1885" class="Function Operator">⟧⇓</a> <a id="2986" href="Algebra.Solver.Monoid.html#2940" class="Bound">ρ</a>        <a id="2995" href="Relation.Binary.Reasoning.Setoid.html#1061" class="Function">≈⟨</a> <a id="2998" href="Algebra.Solver.Monoid.html#2207" class="Function">homomorphic</a> <a id="3010" class="Symbol">(</a><a id="3011" href="Algebra.Solver.Monoid.html#2003" class="Function">normalise</a> <a id="3021" href="Algebra.Solver.Monoid.html#2931" class="Bound">e₁</a><a id="3023" class="Symbol">)</a> <a id="3025" class="Symbol">(</a><a id="3026" href="Algebra.Solver.Monoid.html#2003" class="Function">normalise</a> <a id="3036" href="Algebra.Solver.Monoid.html#2936" class="Bound">e₂</a><a id="3038" class="Symbol">)</a> <a id="3040" href="Algebra.Solver.Monoid.html#2940" class="Bound">ρ</a> <a id="3042" href="Relation.Binary.Reasoning.Setoid.html#1061" class="Function">⟩</a>
  <a id="3046" href="Algebra.Solver.Monoid.html#1885" class="Function Operator">⟦</a> <a id="3048" href="Algebra.Solver.Monoid.html#2003" class="Function">normalise</a> <a id="3058" href="Algebra.Solver.Monoid.html#2931" class="Bound">e₁</a> <a id="3061" href="Algebra.Solver.Monoid.html#1885" class="Function Operator">⟧⇓</a> <a id="3064" href="Algebra.Solver.Monoid.html#2940" class="Bound">ρ</a> <a id="3066" href="Algebra.Bundles.html#4559" class="Field Operator">∙</a> <a id="3068" href="Algebra.Solver.Monoid.html#1885" class="Function Operator">⟦</a> <a id="3070" href="Algebra.Solver.Monoid.html#2003" class="Function">normalise</a> <a id="3080" href="Algebra.Solver.Monoid.html#2936" class="Bound">e₂</a> <a id="3083" href="Algebra.Solver.Monoid.html#1885" class="Function Operator">⟧⇓</a> <a id="3086" href="Algebra.Solver.Monoid.html#2940" class="Bound">ρ</a>  <a id="3089" href="Relation.Binary.Reasoning.Setoid.html#1061" class="Function">≈⟨</a> <a id="3092" href="Algebra.Structures.html#1219" class="Function">∙-cong</a> <a id="3099" class="Symbol">(</a><a id="3100" href="Algebra.Solver.Monoid.html#2699" class="Function">normalise-correct</a> <a id="3118" href="Algebra.Solver.Monoid.html#2931" class="Bound">e₁</a> <a id="3121" href="Algebra.Solver.Monoid.html#2940" class="Bound">ρ</a><a id="3122" class="Symbol">)</a> <a id="3124" class="Symbol">(</a><a id="3125" href="Algebra.Solver.Monoid.html#2699" class="Function">normalise-correct</a> <a id="3143" href="Algebra.Solver.Monoid.html#2936" class="Bound">e₂</a> <a id="3146" href="Algebra.Solver.Monoid.html#2940" class="Bound">ρ</a><a id="3147" class="Symbol">)</a> <a id="3149" href="Relation.Binary.Reasoning.Setoid.html#1061" class="Function">⟩</a>
  <a id="3153" href="Algebra.Solver.Monoid.html#1554" class="Function Operator">⟦</a> <a id="3155" href="Algebra.Solver.Monoid.html#2931" class="Bound">e₁</a> <a id="3158" href="Algebra.Solver.Monoid.html#1554" class="Function Operator">⟧</a> <a id="3160" href="Algebra.Solver.Monoid.html#2940" class="Bound">ρ</a> <a id="3162" href="Algebra.Bundles.html#4559" class="Field Operator">∙</a> <a id="3164" href="Algebra.Solver.Monoid.html#1554" class="Function Operator">⟦</a> <a id="3166" href="Algebra.Solver.Monoid.html#2936" class="Bound">e₂</a> <a id="3169" href="Algebra.Solver.Monoid.html#1554" class="Function Operator">⟧</a> <a id="3171" href="Algebra.Solver.Monoid.html#2940" class="Bound">ρ</a>                        <a id="3196" href="Relation.Binary.Reasoning.Base.Single.html#2564" class="Function Operator">∎</a>

<a id="3199" class="Comment">------------------------------------------------------------------------</a>
<a id="3272" class="Comment">-- &quot;Tactic.</a>

<a id="3285" class="Keyword">open</a> <a id="3290" class="Keyword">module</a> <a id="R"></a><a id="3297" href="Algebra.Solver.Monoid.html#3297" class="Module">R</a> <a id="3299" class="Symbol">=</a> <a id="3301" href="Relation.Binary.Reflection.html" class="Module">Relation.Binary.Reflection</a>
                  <a id="3346" href="Algebra.Structures.html#1294" class="Function">setoid</a> <a id="3353" href="Algebra.Solver.Monoid.html#1303" class="InductiveConstructor">var</a> <a id="3357" href="Algebra.Solver.Monoid.html#1554" class="Function Operator">⟦_⟧</a> <a id="3361" class="Symbol">(</a><a id="3362" href="Algebra.Solver.Monoid.html#1885" class="Function Operator">⟦_⟧⇓</a> <a id="3367" href="Function.Base.html#1040" class="Function Operator">∘</a> <a id="3369" href="Algebra.Solver.Monoid.html#2003" class="Function">normalise</a><a id="3378" class="Symbol">)</a> <a id="3380" href="Algebra.Solver.Monoid.html#2699" class="Function">normalise-correct</a>
  <a id="3400" class="Keyword">public</a> <a id="3407" class="Keyword">using</a> <a id="3413" class="Symbol">(</a><a id="3414" href="Relation.Binary.Reflection.html#2452" class="Function">solve</a><a id="3419" class="Symbol">;</a> <a id="3421" href="Relation.Binary.Reflection.html#3561" class="Function Operator">_⊜_</a><a id="3424" class="Symbol">)</a>

<a id="3427" class="Comment">-- We can decide if two normal forms are /syntactically/ equal.</a>

<a id="3492" class="Keyword">infix</a> <a id="3498" class="Number">5</a> <a id="3500" href="Algebra.Solver.Monoid.html#3505" class="Function Operator">_≟_</a>

<a id="_≟_"></a><a id="3505" href="Algebra.Solver.Monoid.html#3505" class="Function Operator">_≟_</a> <a id="3509" class="Symbol">:</a> <a id="3511" class="Symbol">∀</a> <a id="3513" class="Symbol">{</a><a id="3514" href="Algebra.Solver.Monoid.html#3514" class="Bound">n</a><a id="3515" class="Symbol">}</a> <a id="3517" class="Symbol">→</a> <a id="3519" href="Relation.Binary.Definitions.html#4584" class="Function">Decidable</a> <a id="3529" class="Symbol">{</a><a id="3530" class="Argument">A</a> <a id="3532" class="Symbol">=</a> <a id="3534" href="Algebra.Solver.Monoid.html#1807" class="Function">Normal</a> <a id="3541" href="Algebra.Solver.Monoid.html#3514" class="Bound">n</a><a id="3542" class="Symbol">}</a> <a id="3544" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">_≡_</a>
<a id="3548" href="Algebra.Solver.Monoid.html#3548" class="Bound">nf₁</a> <a id="3552" href="Algebra.Solver.Monoid.html#3505" class="Function Operator">≟</a> <a id="3554" href="Algebra.Solver.Monoid.html#3554" class="Bound">nf₂</a> <a id="3558" class="Symbol">=</a> <a id="3560" href="Relation.Nullary.Decidable.Core.html#3645" class="Function">Dec.map′</a> <a id="3569" href="Data.List.Relation.Binary.Equality.Propositional.html#957" class="Function">≋⇒≡</a> <a id="3573" href="Data.List.Relation.Binary.Equality.Propositional.html#1053" class="Function">≡⇒≋</a> <a id="3577" class="Symbol">(</a><a id="3578" href="Algebra.Solver.Monoid.html#3548" class="Bound">nf₁</a> <a id="3582" href="Data.List.Relation.Binary.Equality.DecSetoid.html#887" class="Function Operator">≋?</a> <a id="3585" href="Algebra.Solver.Monoid.html#3554" class="Bound">nf₂</a><a id="3588" class="Symbol">)</a>
  <a id="3592" class="Keyword">where</a> <a id="3598" class="Keyword">open</a> <a id="3603" href="Data.List.Relation.Binary.Equality.DecPropositional.html" class="Module">ListEq</a> <a id="3610" href="Data.Fin.Properties.html#2551" class="Function Operator">Fin._≟_</a>

<a id="3619" class="Comment">-- We can also give a sound, but not necessarily complete, procedure</a>
<a id="3688" class="Comment">-- for determining if two expressions have the same semantics.</a>

<a id="prove′"></a><a id="3752" href="Algebra.Solver.Monoid.html#3752" class="Function">prove′</a> <a id="3759" class="Symbol">:</a> <a id="3761" class="Symbol">∀</a> <a id="3763" class="Symbol">{</a><a id="3764" href="Algebra.Solver.Monoid.html#3764" class="Bound">n</a><a id="3765" class="Symbol">}</a> <a id="3767" class="Symbol">(</a><a id="3768" href="Algebra.Solver.Monoid.html#3768" class="Bound">e₁</a> <a id="3771" href="Algebra.Solver.Monoid.html#3771" class="Bound">e₂</a> <a id="3774" class="Symbol">:</a> <a id="3776" href="Algebra.Solver.Monoid.html#1276" class="Datatype">Expr</a> <a id="3781" href="Algebra.Solver.Monoid.html#3764" class="Bound">n</a><a id="3782" class="Symbol">)</a> <a id="3784" class="Symbol">→</a> <a id="3786" href="Agda.Builtin.Maybe.html#118" class="Datatype">Maybe</a> <a id="3792" class="Symbol">(∀</a> <a id="3795" href="Algebra.Solver.Monoid.html#3795" class="Bound">ρ</a> <a id="3797" class="Symbol">→</a> <a id="3799" href="Algebra.Solver.Monoid.html#1554" class="Function Operator">⟦</a> <a id="3801" href="Algebra.Solver.Monoid.html#3768" class="Bound">e₁</a> <a id="3804" href="Algebra.Solver.Monoid.html#1554" class="Function Operator">⟧</a> <a id="3806" href="Algebra.Solver.Monoid.html#3795" class="Bound">ρ</a> <a id="3808" href="Algebra.Bundles.html#4530" class="Field Operator">≈</a> <a id="3810" href="Algebra.Solver.Monoid.html#1554" class="Function Operator">⟦</a> <a id="3812" href="Algebra.Solver.Monoid.html#3771" class="Bound">e₂</a> <a id="3815" href="Algebra.Solver.Monoid.html#1554" class="Function Operator">⟧</a> <a id="3817" href="Algebra.Solver.Monoid.html#3795" class="Bound">ρ</a><a id="3818" class="Symbol">)</a>
<a id="3820" href="Algebra.Solver.Monoid.html#3752" class="Function">prove′</a> <a id="3827" href="Algebra.Solver.Monoid.html#3827" class="Bound">e₁</a> <a id="3830" href="Algebra.Solver.Monoid.html#3830" class="Bound">e₂</a> <a id="3833" class="Symbol">=</a>
  <a id="3837" href="Data.Maybe.Base.html#2029" class="Function">Maybe.map</a> <a id="3847" href="Algebra.Solver.Monoid.html#3906" class="Function">lemma</a> <a id="3853" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="3855" href="Data.Maybe.Base.html#1221" class="Function">decToMaybe</a> <a id="3866" class="Symbol">(</a><a id="3867" href="Algebra.Solver.Monoid.html#2003" class="Function">normalise</a> <a id="3877" href="Algebra.Solver.Monoid.html#3827" class="Bound">e₁</a> <a id="3880" href="Algebra.Solver.Monoid.html#3505" class="Function Operator">≟</a> <a id="3882" href="Algebra.Solver.Monoid.html#2003" class="Function">normalise</a> <a id="3892" href="Algebra.Solver.Monoid.html#3830" class="Bound">e₂</a><a id="3894" class="Symbol">)</a>
  <a id="3898" class="Keyword">where</a>
  <a id="3906" href="Algebra.Solver.Monoid.html#3906" class="Function">lemma</a> <a id="3912" class="Symbol">:</a> <a id="3914" href="Algebra.Solver.Monoid.html#2003" class="Function">normalise</a> <a id="3924" href="Algebra.Solver.Monoid.html#3827" class="Bound">e₁</a> <a id="3927" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="3929" href="Algebra.Solver.Monoid.html#2003" class="Function">normalise</a> <a id="3939" href="Algebra.Solver.Monoid.html#3830" class="Bound">e₂</a> <a id="3942" class="Symbol">→</a> <a id="3944" class="Symbol">∀</a> <a id="3946" href="Algebra.Solver.Monoid.html#3946" class="Bound">ρ</a> <a id="3948" class="Symbol">→</a> <a id="3950" href="Algebra.Solver.Monoid.html#1554" class="Function Operator">⟦</a> <a id="3952" href="Algebra.Solver.Monoid.html#3827" class="Bound">e₁</a> <a id="3955" href="Algebra.Solver.Monoid.html#1554" class="Function Operator">⟧</a> <a id="3957" href="Algebra.Solver.Monoid.html#3946" class="Bound">ρ</a> <a id="3959" href="Algebra.Bundles.html#4530" class="Field Operator">≈</a> <a id="3961" href="Algebra.Solver.Monoid.html#1554" class="Function Operator">⟦</a> <a id="3963" href="Algebra.Solver.Monoid.html#3830" class="Bound">e₂</a> <a id="3966" href="Algebra.Solver.Monoid.html#1554" class="Function Operator">⟧</a> <a id="3968" href="Algebra.Solver.Monoid.html#3946" class="Bound">ρ</a>
  <a id="3972" href="Algebra.Solver.Monoid.html#3906" class="Function">lemma</a> <a id="3978" href="Algebra.Solver.Monoid.html#3978" class="Bound">eq</a> <a id="3981" href="Algebra.Solver.Monoid.html#3981" class="Bound">ρ</a> <a id="3983" class="Symbol">=</a>
    <a id="3989" href="Relation.Binary.Reflection.html#1766" class="Function">R.prove</a> <a id="3997" href="Algebra.Solver.Monoid.html#3981" class="Bound">ρ</a> <a id="3999" href="Algebra.Solver.Monoid.html#3827" class="Bound">e₁</a> <a id="4002" href="Algebra.Solver.Monoid.html#3830" class="Bound">e₂</a> <a id="4005" class="Symbol">(</a><a id="4006" href="Relation.Binary.Reasoning.Base.Single.html#1925" class="Function Operator">begin</a>
      <a id="4018" href="Algebra.Solver.Monoid.html#1885" class="Function Operator">⟦</a> <a id="4020" href="Algebra.Solver.Monoid.html#2003" class="Function">normalise</a> <a id="4030" href="Algebra.Solver.Monoid.html#3827" class="Bound">e₁</a> <a id="4033" href="Algebra.Solver.Monoid.html#1885" class="Function Operator">⟧⇓</a> <a id="4036" href="Algebra.Solver.Monoid.html#3981" class="Bound">ρ</a>  <a id="4039" href="Relation.Binary.Reasoning.Base.Single.html#2191" class="Function">≡⟨</a> <a id="4042" href="Relation.Binary.PropositionalEquality.Core.html#1139" class="Function">P.cong</a> <a id="4049" class="Symbol">(λ</a> <a id="4052" href="Algebra.Solver.Monoid.html#4052" class="Bound">e</a> <a id="4054" class="Symbol">→</a> <a id="4056" href="Algebra.Solver.Monoid.html#1885" class="Function Operator">⟦</a> <a id="4058" href="Algebra.Solver.Monoid.html#4052" class="Bound">e</a> <a id="4060" href="Algebra.Solver.Monoid.html#1885" class="Function Operator">⟧⇓</a> <a id="4063" href="Algebra.Solver.Monoid.html#3981" class="Bound">ρ</a><a id="4064" class="Symbol">)</a> <a id="4066" href="Algebra.Solver.Monoid.html#3978" class="Bound">eq</a> <a id="4069" href="Relation.Binary.Reasoning.Base.Single.html#2191" class="Function">⟩</a>
      <a id="4077" href="Algebra.Solver.Monoid.html#1885" class="Function Operator">⟦</a> <a id="4079" href="Algebra.Solver.Monoid.html#2003" class="Function">normalise</a> <a id="4089" href="Algebra.Solver.Monoid.html#3830" class="Bound">e₂</a> <a id="4092" href="Algebra.Solver.Monoid.html#1885" class="Function Operator">⟧⇓</a> <a id="4095" href="Algebra.Solver.Monoid.html#3981" class="Bound">ρ</a>  <a id="4098" href="Relation.Binary.Reasoning.Base.Single.html#2564" class="Function Operator">∎</a><a id="4099" class="Symbol">)</a>

<a id="4102" class="Comment">-- This procedure can be combined with from-just.</a>

<a id="prove"></a><a id="4153" href="Algebra.Solver.Monoid.html#4153" class="Function">prove</a> <a id="4159" class="Symbol">:</a> <a id="4161" class="Symbol">∀</a> <a id="4163" href="Algebra.Solver.Monoid.html#4163" class="Bound">n</a> <a id="4165" class="Symbol">(</a><a id="4166" href="Algebra.Solver.Monoid.html#4166" class="Bound">es</a> <a id="4169" class="Symbol">:</a> <a id="4171" href="Algebra.Solver.Monoid.html#1276" class="Datatype">Expr</a> <a id="4176" href="Algebra.Solver.Monoid.html#4163" class="Bound">n</a> <a id="4178" href="Data.Product.html#1176" class="Function Operator">×</a> <a id="4180" href="Algebra.Solver.Monoid.html#1276" class="Datatype">Expr</a> <a id="4185" href="Algebra.Solver.Monoid.html#4163" class="Bound">n</a><a id="4186" class="Symbol">)</a> <a id="4188" class="Symbol">→</a>
        <a id="4198" href="Data.Maybe.Base.html#1827" class="Function">From-just</a> <a id="4208" class="Symbol">(</a><a id="4209" href="Data.Product.html#3431" class="Function">uncurry</a> <a id="4217" href="Algebra.Solver.Monoid.html#3752" class="Function">prove′</a> <a id="4224" href="Algebra.Solver.Monoid.html#4166" class="Bound">es</a><a id="4226" class="Symbol">)</a>
<a id="4228" href="Algebra.Solver.Monoid.html#4153" class="Function">prove</a> <a id="4234" class="Symbol">_</a> <a id="4236" class="Symbol">=</a> <a id="4238" href="Data.Maybe.Base.html#1915" class="Function">from-just</a> <a id="4248" href="Function.Base.html#1040" class="Function Operator">∘</a> <a id="4250" href="Data.Product.html#3431" class="Function">uncurry</a> <a id="4258" href="Algebra.Solver.Monoid.html#3752" class="Function">prove′</a>
</pre></body></html>