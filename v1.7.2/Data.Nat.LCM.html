<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Data.Nat.LCM</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- The Agda standard library</a>
<a id="103" class="Comment">--</a>
<a id="106" class="Comment">-- Least common multiple</a>
<a id="131" class="Comment">------------------------------------------------------------------------</a>

<a id="205" class="Symbol">{-#</a> <a id="209" class="Keyword">OPTIONS</a> <a id="217" class="Pragma">--cubical-compatible</a> <a id="238" class="Pragma">--safe</a> <a id="245" class="Symbol">#-}</a>

<a id="250" class="Keyword">module</a> <a id="257" href="Data.Nat.LCM.html" class="Module">Data.Nat.LCM</a> <a id="270" class="Keyword">where</a>

<a id="277" class="Keyword">open</a> <a id="282" class="Keyword">import</a> <a id="289" href="Algebra.html" class="Module">Algebra</a>
<a id="297" class="Keyword">open</a> <a id="302" class="Keyword">import</a> <a id="309" href="Data.Nat.Base.html" class="Module">Data.Nat.Base</a>
<a id="323" class="Keyword">open</a> <a id="328" class="Keyword">import</a> <a id="335" href="Data.Nat.Coprimality.html" class="Module">Data.Nat.Coprimality</a> <a id="356" class="Keyword">using</a> <a id="362" class="Symbol">(</a><a id="363" href="Data.Nat.Coprimality.html#1263" class="Function">Coprime</a><a id="370" class="Symbol">)</a>
<a id="372" class="Keyword">open</a> <a id="377" class="Keyword">import</a> <a id="384" href="Data.Nat.Divisibility.html" class="Module">Data.Nat.Divisibility</a>
<a id="406" class="Keyword">open</a> <a id="411" class="Keyword">import</a> <a id="418" href="Data.Nat.DivMod.html" class="Module">Data.Nat.DivMod</a>
<a id="434" class="Keyword">open</a> <a id="439" class="Keyword">import</a> <a id="446" href="Data.Nat.Properties.html" class="Module">Data.Nat.Properties</a>
<a id="466" class="Keyword">open</a> <a id="471" class="Keyword">import</a> <a id="478" href="Data.Nat.Solver.html" class="Module">Data.Nat.Solver</a>
<a id="494" class="Keyword">open</a> <a id="499" class="Keyword">import</a> <a id="506" href="Data.Nat.GCD.html" class="Module">Data.Nat.GCD</a>
<a id="519" class="Keyword">open</a> <a id="524" class="Keyword">import</a> <a id="531" href="Data.Product.html" class="Module">Data.Product</a>
<a id="544" class="Keyword">open</a> <a id="549" class="Keyword">import</a> <a id="556" href="Data.Sum.Base.html" class="Module">Data.Sum.Base</a> <a id="570" class="Keyword">using</a> <a id="576" class="Symbol">(</a><a id="577" href="Data.Sum.Base.html#743" class="Datatype Operator">_⊎_</a><a id="580" class="Symbol">;</a> <a id="582" href="Data.Sum.Base.html#793" class="InductiveConstructor">inj₁</a><a id="586" class="Symbol">;</a> <a id="588" href="Data.Sum.Base.html#818" class="InductiveConstructor">inj₂</a><a id="592" class="Symbol">)</a>
<a id="594" class="Keyword">open</a> <a id="599" class="Keyword">import</a> <a id="606" href="Function.html" class="Module">Function</a>
<a id="615" class="Keyword">open</a> <a id="620" class="Keyword">import</a> <a id="627" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a> <a id="665" class="Symbol">as</a> <a id="668" class="Module">P</a>
  <a id="672" class="Keyword">using</a> <a id="678" class="Symbol">(</a><a id="679" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">_≡_</a><a id="682" class="Symbol">;</a> <a id="684" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a><a id="688" class="Symbol">;</a> <a id="690" href="Relation.Binary.PropositionalEquality.Core.html#1693" class="Function">sym</a><a id="693" class="Symbol">;</a> <a id="695" href="Relation.Binary.PropositionalEquality.Core.html#1738" class="Function">trans</a><a id="700" class="Symbol">;</a> <a id="702" href="Relation.Binary.PropositionalEquality.Core.html#1139" class="Function">cong</a><a id="706" class="Symbol">;</a> <a id="708" href="Relation.Binary.PropositionalEquality.Core.html#1376" class="Function">cong₂</a><a id="713" class="Symbol">;</a> <a id="715" class="Keyword">module</a> <a id="722" href="Relation.Binary.PropositionalEquality.Core.html#2717" class="Module">≡-Reasoning</a><a id="733" class="Symbol">)</a>
<a id="735" class="Keyword">open</a> <a id="740" class="Keyword">import</a> <a id="747" href="Relation.Binary.html" class="Module">Relation.Binary</a>
<a id="763" class="Keyword">open</a> <a id="768" class="Keyword">import</a> <a id="775" href="Relation.Nullary.Decidable.html" class="Module">Relation.Nullary.Decidable</a> <a id="802" class="Keyword">using</a> <a id="808" class="Symbol">(</a><a id="809" href="Relation.Nullary.Decidable.Core.html#1415" class="Function">False</a><a id="814" class="Symbol">;</a> <a id="816" href="Relation.Nullary.Decidable.Core.html#1970" class="Function">fromWitnessFalse</a><a id="832" class="Symbol">)</a>

<a id="835" class="Keyword">open</a> <a id="840" href="Data.Nat.Solver.html#667" class="Module">+-*-Solver</a>

<a id="852" class="Keyword">private</a>
  <a id="gcd≢0′"></a><a id="862" href="Data.Nat.LCM.html#862" class="Function">gcd≢0′</a> <a id="869" class="Symbol">:</a> <a id="871" class="Symbol">∀</a> <a id="873" href="Data.Nat.LCM.html#873" class="Bound">m</a> <a id="875" href="Data.Nat.LCM.html#875" class="Bound">n</a> <a id="877" class="Symbol">→</a> <a id="879" href="Relation.Nullary.Decidable.Core.html#1415" class="Function">False</a> <a id="885" class="Symbol">(</a><a id="886" href="Data.Nat.GCD.html#1573" class="Function">gcd</a> <a id="890" class="Symbol">(</a><a id="891" href="Agda.Builtin.Nat.html#217" class="InductiveConstructor">suc</a> <a id="895" href="Data.Nat.LCM.html#873" class="Bound">m</a><a id="896" class="Symbol">)</a> <a id="898" href="Data.Nat.LCM.html#875" class="Bound">n</a> <a id="900" href="Data.Nat.Properties.html#2538" class="Function Operator">≟</a> <a id="902" class="Number">0</a><a id="903" class="Symbol">)</a>
  <a id="907" href="Data.Nat.LCM.html#862" class="Function">gcd≢0′</a> <a id="914" href="Data.Nat.LCM.html#914" class="Bound">m</a> <a id="916" href="Data.Nat.LCM.html#916" class="Bound">n</a> <a id="918" class="Symbol">=</a> <a id="920" href="Relation.Nullary.Decidable.Core.html#1970" class="Function">fromWitnessFalse</a> <a id="937" class="Symbol">(</a><a id="938" href="Data.Nat.GCD.html#3387" class="Function">gcd[m,n]≢0</a> <a id="949" class="Symbol">(</a><a id="950" href="Agda.Builtin.Nat.html#217" class="InductiveConstructor">suc</a> <a id="954" href="Data.Nat.LCM.html#914" class="Bound">m</a><a id="955" class="Symbol">)</a> <a id="957" href="Data.Nat.LCM.html#916" class="Bound">n</a> <a id="959" class="Symbol">(</a><a id="960" href="Data.Sum.Base.html#793" class="InductiveConstructor">inj₁</a> <a id="965" class="Symbol">(λ())))</a>

<a id="974" class="Comment">------------------------------------------------------------------------</a>
<a id="1047" class="Comment">-- Definition</a>

<a id="lcm"></a><a id="1062" href="Data.Nat.LCM.html#1062" class="Function">lcm</a> <a id="1066" class="Symbol">:</a> <a id="1068" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a> <a id="1070" class="Symbol">→</a> <a id="1072" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a> <a id="1074" class="Symbol">→</a> <a id="1076" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a>
<a id="1078" href="Data.Nat.LCM.html#1062" class="Function">lcm</a> <a id="1082" href="Agda.Builtin.Nat.html#204" class="InductiveConstructor">zero</a>        <a id="1094" href="Data.Nat.LCM.html#1094" class="Bound">n</a> <a id="1096" class="Symbol">=</a> <a id="1098" href="Agda.Builtin.Nat.html#204" class="InductiveConstructor">zero</a>
<a id="1103" href="Data.Nat.LCM.html#1062" class="Function">lcm</a> <a id="1107" href="Data.Nat.LCM.html#1107" class="Bound">m</a><a id="1108" class="Symbol">@(</a><a id="1110" href="Agda.Builtin.Nat.html#217" class="InductiveConstructor">suc</a> <a id="1114" href="Data.Nat.LCM.html#1114" class="Bound">m-1</a><a id="1117" class="Symbol">)</a> <a id="1119" href="Data.Nat.LCM.html#1119" class="Bound">n</a> <a id="1121" class="Symbol">=</a> <a id="1123" href="Data.Nat.LCM.html#1107" class="Bound">m</a> <a id="1125" href="Agda.Builtin.Nat.html#522" class="Primitive Operator">*</a> <a id="1127" class="Symbol">(</a><a id="1128" href="Data.Nat.LCM.html#1119" class="Bound">n</a> <a id="1130" href="Data.Nat.DivMod.html#1449" class="Function Operator">/</a> <a id="1132" href="Data.Nat.GCD.html#1573" class="Function">gcd</a> <a id="1136" href="Data.Nat.LCM.html#1107" class="Bound">m</a> <a id="1138" href="Data.Nat.LCM.html#1119" class="Bound">n</a><a id="1139" class="Symbol">)</a> <a id="1141" class="Symbol">{</a><a id="1142" href="Data.Nat.LCM.html#862" class="Function">gcd≢0′</a> <a id="1149" href="Data.Nat.LCM.html#1114" class="Bound">m-1</a> <a id="1153" href="Data.Nat.LCM.html#1119" class="Bound">n</a><a id="1154" class="Symbol">}</a>

<a id="1157" class="Comment">------------------------------------------------------------------------</a>
<a id="1230" class="Comment">-- Core properties</a>

<a id="1250" class="Keyword">private</a>
  <a id="rearrange"></a><a id="1260" href="Data.Nat.LCM.html#1260" class="Function">rearrange</a> <a id="1270" class="Symbol">:</a> <a id="1272" class="Symbol">∀</a> <a id="1274" href="Data.Nat.LCM.html#1274" class="Bound">m-1</a> <a id="1278" href="Data.Nat.LCM.html#1278" class="Bound">n</a> <a id="1280" class="Symbol">→</a> <a id="1282" href="Data.Nat.LCM.html#1062" class="Function">lcm</a> <a id="1286" class="Symbol">(</a><a id="1287" href="Agda.Builtin.Nat.html#217" class="InductiveConstructor">suc</a> <a id="1291" href="Data.Nat.LCM.html#1274" class="Bound">m-1</a><a id="1294" class="Symbol">)</a> <a id="1296" href="Data.Nat.LCM.html#1278" class="Bound">n</a> <a id="1298" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="1300" class="Symbol">((</a><a id="1302" href="Agda.Builtin.Nat.html#217" class="InductiveConstructor">suc</a> <a id="1306" href="Data.Nat.LCM.html#1274" class="Bound">m-1</a><a id="1309" class="Symbol">)</a> <a id="1311" href="Agda.Builtin.Nat.html#522" class="Primitive Operator">*</a> <a id="1313" href="Data.Nat.LCM.html#1278" class="Bound">n</a> <a id="1315" href="Data.Nat.DivMod.html#1449" class="Function Operator">/</a> <a id="1317" href="Data.Nat.GCD.html#1573" class="Function">gcd</a> <a id="1321" class="Symbol">(</a><a id="1322" href="Agda.Builtin.Nat.html#217" class="InductiveConstructor">suc</a> <a id="1326" href="Data.Nat.LCM.html#1274" class="Bound">m-1</a><a id="1329" class="Symbol">)</a> <a id="1331" href="Data.Nat.LCM.html#1278" class="Bound">n</a><a id="1332" class="Symbol">)</a> <a id="1334" class="Symbol">{</a><a id="1335" href="Data.Nat.LCM.html#862" class="Function">gcd≢0′</a> <a id="1342" href="Data.Nat.LCM.html#1274" class="Bound">m-1</a> <a id="1346" href="Data.Nat.LCM.html#1278" class="Bound">n</a><a id="1347" class="Symbol">}</a>
  <a id="1351" href="Data.Nat.LCM.html#1260" class="Function">rearrange</a> <a id="1361" href="Data.Nat.LCM.html#1361" class="Bound">m-1</a> <a id="1365" href="Data.Nat.LCM.html#1365" class="Bound">n</a> <a id="1367" class="Symbol">=</a> <a id="1369" href="Relation.Binary.PropositionalEquality.Core.html#1693" class="Function">sym</a> <a id="1373" class="Symbol">(</a><a id="1374" href="Data.Nat.DivMod.html#11197" class="Function">*-/-assoc</a> <a id="1384" href="Data.Nat.LCM.html#1443" class="Function">m</a> <a id="1386" class="Symbol">{</a><a id="1387" href="Data.Nat.LCM.html#1365" class="Bound">n</a><a id="1388" class="Symbol">}</a> <a id="1390" class="Symbol">{</a><a id="1391" href="Data.Nat.GCD.html#1573" class="Function">gcd</a> <a id="1395" href="Data.Nat.LCM.html#1443" class="Function">m</a> <a id="1397" href="Data.Nat.LCM.html#1365" class="Bound">n</a><a id="1398" class="Symbol">}</a> <a id="1400" class="Symbol">{</a><a id="1401" href="Data.Nat.LCM.html#862" class="Function">gcd≢0′</a> <a id="1408" href="Data.Nat.LCM.html#1361" class="Bound">m-1</a> <a id="1412" href="Data.Nat.LCM.html#1365" class="Bound">n</a><a id="1413" class="Symbol">}</a> <a id="1415" class="Symbol">(</a><a id="1416" href="Data.Nat.GCD.html#2671" class="Function">gcd[m,n]∣n</a> <a id="1427" href="Data.Nat.LCM.html#1443" class="Function">m</a> <a id="1429" href="Data.Nat.LCM.html#1365" class="Bound">n</a><a id="1430" class="Symbol">))</a>
    <a id="1437" class="Keyword">where</a> <a id="1443" href="Data.Nat.LCM.html#1443" class="Function">m</a> <a id="1445" class="Symbol">=</a> <a id="1447" href="Agda.Builtin.Nat.html#217" class="InductiveConstructor">suc</a> <a id="1451" href="Data.Nat.LCM.html#1361" class="Bound">m-1</a>

<a id="m∣lcm[m,n]"></a><a id="1456" href="Data.Nat.LCM.html#1456" class="Function">m∣lcm[m,n]</a> <a id="1467" class="Symbol">:</a> <a id="1469" class="Symbol">∀</a> <a id="1471" href="Data.Nat.LCM.html#1471" class="Bound">m</a> <a id="1473" href="Data.Nat.LCM.html#1473" class="Bound">n</a> <a id="1475" class="Symbol">→</a> <a id="1477" href="Data.Nat.LCM.html#1471" class="Bound">m</a> <a id="1479" href="Data.Nat.Divisibility.Core.html#1146" class="Record Operator">∣</a> <a id="1481" href="Data.Nat.LCM.html#1062" class="Function">lcm</a> <a id="1485" href="Data.Nat.LCM.html#1471" class="Bound">m</a> <a id="1487" href="Data.Nat.LCM.html#1473" class="Bound">n</a>
<a id="1489" href="Data.Nat.LCM.html#1456" class="Function">m∣lcm[m,n]</a> <a id="1500" href="Agda.Builtin.Nat.html#204" class="InductiveConstructor">zero</a>      <a id="1510" href="Data.Nat.LCM.html#1510" class="Bound">n</a> <a id="1512" class="Symbol">=</a> <a id="1514" class="Number">0</a> <a id="1516" href="Data.Nat.Divisibility.html#3878" class="Function Operator">∣0</a>
<a id="1519" href="Data.Nat.LCM.html#1456" class="Function">m∣lcm[m,n]</a> <a id="1530" href="Data.Nat.LCM.html#1530" class="Bound">m</a><a id="1531" class="Symbol">@(</a><a id="1533" href="Agda.Builtin.Nat.html#217" class="InductiveConstructor">suc</a> <a id="1537" class="Symbol">_)</a> <a id="1540" href="Data.Nat.LCM.html#1540" class="Bound">n</a> <a id="1542" class="Symbol">=</a> <a id="1544" href="Data.Nat.Divisibility.html#4872" class="Function">m∣m*n</a> <a id="1550" class="Symbol">(</a><a id="1551" href="Data.Nat.LCM.html#1540" class="Bound">n</a> <a id="1553" href="Data.Nat.DivMod.html#1449" class="Function Operator">/</a> <a id="1555" href="Data.Nat.GCD.html#1573" class="Function">gcd</a> <a id="1559" href="Data.Nat.LCM.html#1530" class="Bound">m</a> <a id="1561" href="Data.Nat.LCM.html#1540" class="Bound">n</a><a id="1562" class="Symbol">)</a>

<a id="n∣lcm[m,n]"></a><a id="1565" href="Data.Nat.LCM.html#1565" class="Function">n∣lcm[m,n]</a> <a id="1576" class="Symbol">:</a> <a id="1578" class="Symbol">∀</a> <a id="1580" href="Data.Nat.LCM.html#1580" class="Bound">m</a> <a id="1582" href="Data.Nat.LCM.html#1582" class="Bound">n</a> <a id="1584" class="Symbol">→</a> <a id="1586" href="Data.Nat.LCM.html#1582" class="Bound">n</a> <a id="1588" href="Data.Nat.Divisibility.Core.html#1146" class="Record Operator">∣</a> <a id="1590" href="Data.Nat.LCM.html#1062" class="Function">lcm</a> <a id="1594" href="Data.Nat.LCM.html#1580" class="Bound">m</a> <a id="1596" href="Data.Nat.LCM.html#1582" class="Bound">n</a>
<a id="1598" href="Data.Nat.LCM.html#1565" class="Function">n∣lcm[m,n]</a> <a id="1609" href="Agda.Builtin.Nat.html#204" class="InductiveConstructor">zero</a>        <a id="1621" href="Data.Nat.LCM.html#1621" class="Bound">n</a> <a id="1623" class="Symbol">=</a> <a id="1625" href="Data.Nat.LCM.html#1621" class="Bound">n</a> <a id="1627" href="Data.Nat.Divisibility.html#3878" class="Function Operator">∣0</a>
<a id="1630" href="Data.Nat.LCM.html#1565" class="Function">n∣lcm[m,n]</a> <a id="1641" href="Data.Nat.LCM.html#1641" class="Bound">m</a><a id="1642" class="Symbol">@(</a><a id="1644" href="Agda.Builtin.Nat.html#217" class="InductiveConstructor">suc</a> <a id="1648" href="Data.Nat.LCM.html#1648" class="Bound">m-1</a><a id="1651" class="Symbol">)</a> <a id="1653" href="Data.Nat.LCM.html#1653" class="Bound">n</a> <a id="1655" class="Symbol">=</a> <a id="1657" href="Relation.Binary.Reasoning.Base.Double.html#2222" class="Function Operator">begin</a>
  <a id="1665" href="Data.Nat.LCM.html#1653" class="Bound">n</a>                 <a id="1683" href="Data.Nat.Divisibility.html#3635" class="Function">∣⟨</a> <a id="1686" href="Data.Nat.Divisibility.html#4872" class="Function">m∣m*n</a> <a id="1692" class="Symbol">(</a><a id="1693" href="Data.Nat.LCM.html#1641" class="Bound">m</a> <a id="1695" href="Data.Nat.DivMod.html#1449" class="Function Operator">/</a> <a id="1697" href="Data.Nat.GCD.html#1573" class="Function">gcd</a> <a id="1701" href="Data.Nat.LCM.html#1641" class="Bound">m</a> <a id="1703" href="Data.Nat.LCM.html#1653" class="Bound">n</a><a id="1704" class="Symbol">)</a> <a id="1706" href="Data.Nat.Divisibility.html#3635" class="Function">⟩</a>
  <a id="1710" href="Data.Nat.LCM.html#1653" class="Bound">n</a> <a id="1712" href="Agda.Builtin.Nat.html#522" class="Primitive Operator">*</a> <a id="1714" class="Symbol">(</a><a id="1715" href="Data.Nat.LCM.html#1641" class="Bound">m</a> <a id="1717" href="Data.Nat.DivMod.html#1449" class="Function Operator">/</a> <a id="1719" href="Data.Nat.GCD.html#1573" class="Function">gcd</a> <a id="1723" href="Data.Nat.LCM.html#1641" class="Bound">m</a> <a id="1725" href="Data.Nat.LCM.html#1653" class="Bound">n</a><a id="1726" class="Symbol">)</a> <a id="1728" href="Relation.Binary.Reasoning.Base.Double.html#3132" class="Function">≡⟨</a> <a id="1731" href="Relation.Binary.PropositionalEquality.Core.html#1693" class="Function">sym</a> <a id="1735" class="Symbol">(</a><a id="1736" href="Data.Nat.DivMod.html#11197" class="Function">*-/-assoc</a> <a id="1746" href="Data.Nat.LCM.html#1653" class="Bound">n</a> <a id="1748" class="Symbol">{</a><a id="1749" class="Argument">≢0</a> <a id="1752" class="Symbol">=</a> <a id="1754" href="Data.Nat.LCM.html#862" class="Function">gcd≢0′</a> <a id="1761" href="Data.Nat.LCM.html#1648" class="Bound">m-1</a> <a id="1765" href="Data.Nat.LCM.html#1653" class="Bound">n</a><a id="1766" class="Symbol">}</a> <a id="1768" class="Symbol">(</a><a id="1769" href="Data.Nat.GCD.html#2469" class="Function">gcd[m,n]∣m</a> <a id="1780" href="Data.Nat.LCM.html#1641" class="Bound">m</a> <a id="1782" href="Data.Nat.LCM.html#1653" class="Bound">n</a><a id="1783" class="Symbol">))</a> <a id="1786" href="Relation.Binary.Reasoning.Base.Double.html#3132" class="Function">⟩</a>
  <a id="1790" href="Data.Nat.LCM.html#1653" class="Bound">n</a> <a id="1792" href="Agda.Builtin.Nat.html#522" class="Primitive Operator">*</a> <a id="1794" href="Data.Nat.LCM.html#1641" class="Bound">m</a> <a id="1796" href="Data.Nat.DivMod.html#1449" class="Function Operator">/</a> <a id="1798" href="Data.Nat.GCD.html#1573" class="Function">gcd</a> <a id="1802" href="Data.Nat.LCM.html#1641" class="Bound">m</a> <a id="1804" href="Data.Nat.LCM.html#1653" class="Bound">n</a>   <a id="1808" href="Relation.Binary.Reasoning.Base.Double.html#3132" class="Function">≡⟨</a> <a id="1811" href="Relation.Binary.PropositionalEquality.Core.html#1139" class="Function">cong</a> <a id="1816" class="Symbol">(λ</a> <a id="1819" href="Data.Nat.LCM.html#1819" class="Bound">v</a> <a id="1821" class="Symbol">→</a> <a id="1823" class="Symbol">(</a><a id="1824" href="Data.Nat.LCM.html#1819" class="Bound">v</a> <a id="1826" href="Data.Nat.DivMod.html#1449" class="Function Operator">/</a> <a id="1828" href="Data.Nat.GCD.html#1573" class="Function">gcd</a> <a id="1832" href="Data.Nat.LCM.html#1641" class="Bound">m</a> <a id="1834" href="Data.Nat.LCM.html#1653" class="Bound">n</a><a id="1835" class="Symbol">)</a> <a id="1837" class="Symbol">{</a><a id="1838" href="Data.Nat.LCM.html#862" class="Function">gcd≢0′</a> <a id="1845" href="Data.Nat.LCM.html#1648" class="Bound">m-1</a> <a id="1849" href="Data.Nat.LCM.html#1653" class="Bound">n</a><a id="1850" class="Symbol">})</a> <a id="1853" class="Symbol">(</a><a id="1854" href="Data.Nat.Properties.html#20365" class="Function">*-comm</a> <a id="1861" href="Data.Nat.LCM.html#1653" class="Bound">n</a> <a id="1863" href="Data.Nat.LCM.html#1641" class="Bound">m</a><a id="1864" class="Symbol">)</a> <a id="1866" href="Relation.Binary.Reasoning.Base.Double.html#3132" class="Function">⟩</a>
  <a id="1870" href="Data.Nat.LCM.html#1641" class="Bound">m</a> <a id="1872" href="Agda.Builtin.Nat.html#522" class="Primitive Operator">*</a> <a id="1874" href="Data.Nat.LCM.html#1653" class="Bound">n</a> <a id="1876" href="Data.Nat.DivMod.html#1449" class="Function Operator">/</a> <a id="1878" href="Data.Nat.GCD.html#1573" class="Function">gcd</a> <a id="1882" href="Data.Nat.LCM.html#1641" class="Bound">m</a> <a id="1884" href="Data.Nat.LCM.html#1653" class="Bound">n</a>   <a id="1888" href="Relation.Binary.Reasoning.Base.Double.html#3132" class="Function">≡⟨</a> <a id="1891" href="Relation.Binary.PropositionalEquality.Core.html#1693" class="Function">sym</a> <a id="1895" class="Symbol">(</a><a id="1896" href="Data.Nat.LCM.html#1260" class="Function">rearrange</a> <a id="1906" href="Data.Nat.LCM.html#1648" class="Bound">m-1</a> <a id="1910" href="Data.Nat.LCM.html#1653" class="Bound">n</a><a id="1911" class="Symbol">)</a> <a id="1913" href="Relation.Binary.Reasoning.Base.Double.html#3132" class="Function">⟩</a>
  <a id="1917" href="Data.Nat.LCM.html#1641" class="Bound">m</a> <a id="1919" href="Agda.Builtin.Nat.html#522" class="Primitive Operator">*</a> <a id="1921" class="Symbol">(</a><a id="1922" href="Data.Nat.LCM.html#1653" class="Bound">n</a> <a id="1924" href="Data.Nat.DivMod.html#1449" class="Function Operator">/</a> <a id="1926" href="Data.Nat.GCD.html#1573" class="Function">gcd</a> <a id="1930" href="Data.Nat.LCM.html#1641" class="Bound">m</a> <a id="1932" href="Data.Nat.LCM.html#1653" class="Bound">n</a><a id="1933" class="Symbol">)</a> <a id="1935" href="Relation.Binary.Reasoning.Base.Double.html#3656" class="Function Operator">∎</a>
  <a id="1939" class="Keyword">where</a> <a id="1945" class="Keyword">open</a> <a id="1950" href="Data.Nat.Divisibility.html#3482" class="Module">∣-Reasoning</a>

<a id="lcm-least"></a><a id="1963" href="Data.Nat.LCM.html#1963" class="Function">lcm-least</a> <a id="1973" class="Symbol">:</a> <a id="1975" class="Symbol">∀</a> <a id="1977" class="Symbol">{</a><a id="1978" href="Data.Nat.LCM.html#1978" class="Bound">m</a> <a id="1980" href="Data.Nat.LCM.html#1980" class="Bound">n</a> <a id="1982" href="Data.Nat.LCM.html#1982" class="Bound">c</a><a id="1983" class="Symbol">}</a> <a id="1985" class="Symbol">→</a> <a id="1987" href="Data.Nat.LCM.html#1978" class="Bound">m</a> <a id="1989" href="Data.Nat.Divisibility.Core.html#1146" class="Record Operator">∣</a> <a id="1991" href="Data.Nat.LCM.html#1982" class="Bound">c</a> <a id="1993" class="Symbol">→</a> <a id="1995" href="Data.Nat.LCM.html#1980" class="Bound">n</a> <a id="1997" href="Data.Nat.Divisibility.Core.html#1146" class="Record Operator">∣</a> <a id="1999" href="Data.Nat.LCM.html#1982" class="Bound">c</a> <a id="2001" class="Symbol">→</a> <a id="2003" href="Data.Nat.LCM.html#1062" class="Function">lcm</a> <a id="2007" href="Data.Nat.LCM.html#1978" class="Bound">m</a> <a id="2009" href="Data.Nat.LCM.html#1980" class="Bound">n</a> <a id="2011" href="Data.Nat.Divisibility.Core.html#1146" class="Record Operator">∣</a> <a id="2013" href="Data.Nat.LCM.html#1982" class="Bound">c</a>
<a id="2015" href="Data.Nat.LCM.html#1963" class="Function">lcm-least</a> <a id="2025" class="Symbol">{</a><a id="2026" href="Agda.Builtin.Nat.html#204" class="InductiveConstructor">zero</a><a id="2030" class="Symbol">}</a>        <a id="2039" class="Symbol">{</a><a id="2040" href="Data.Nat.LCM.html#2040" class="Bound">n</a><a id="2041" class="Symbol">}</a> <a id="2043" class="Symbol">{</a><a id="2044" href="Data.Nat.LCM.html#2044" class="Bound">c</a><a id="2045" class="Symbol">}</a> <a id="2047" href="Data.Nat.LCM.html#2047" class="Bound">0∣c</a> <a id="2051" class="Symbol">_</a>   <a id="2055" class="Symbol">=</a> <a id="2057" href="Data.Nat.LCM.html#2047" class="Bound">0∣c</a>
<a id="2061" href="Data.Nat.LCM.html#1963" class="Function">lcm-least</a> <a id="2071" class="Symbol">{</a><a id="2072" href="Data.Nat.LCM.html#2072" class="Bound">m</a><a id="2073" class="Symbol">@(</a><a id="2075" href="Agda.Builtin.Nat.html#217" class="InductiveConstructor">suc</a> <a id="2079" href="Data.Nat.LCM.html#2079" class="Bound">m-1</a><a id="2082" class="Symbol">)}</a> <a id="2085" class="Symbol">{</a><a id="2086" href="Data.Nat.LCM.html#2086" class="Bound">n</a><a id="2087" class="Symbol">}</a> <a id="2089" class="Symbol">{</a><a id="2090" href="Data.Nat.LCM.html#2090" class="Bound">c</a><a id="2091" class="Symbol">}</a> <a id="2093" href="Data.Nat.LCM.html#2093" class="Bound">m∣c</a> <a id="2097" href="Data.Nat.LCM.html#2097" class="Bound">n∣c</a> <a id="2101" class="Symbol">=</a> <a id="2103" href="Relation.Binary.PropositionalEquality.Core.html#1789" class="Function">P.subst</a> <a id="2111" class="Symbol">(</a><a id="2112" href="Data.Nat.Divisibility.Core.html#1146" class="Record Operator">_∣</a> <a id="2115" href="Data.Nat.LCM.html#2090" class="Bound">c</a><a id="2116" class="Symbol">)</a> <a id="2118" class="Symbol">(</a><a id="2119" href="Relation.Binary.PropositionalEquality.Core.html#1693" class="Function">sym</a> <a id="2123" class="Symbol">(</a><a id="2124" href="Data.Nat.LCM.html#1260" class="Function">rearrange</a> <a id="2134" href="Data.Nat.LCM.html#2079" class="Bound">m-1</a> <a id="2138" href="Data.Nat.LCM.html#2086" class="Bound">n</a><a id="2139" class="Symbol">))</a>
  <a id="2144" class="Symbol">(</a><a id="2145" href="Data.Nat.Divisibility.html#7981" class="Function">m∣n*o⇒m/n∣o</a> <a id="2157" class="Symbol">{</a><a id="2158" class="Argument">n≢0</a> <a id="2162" class="Symbol">=</a> <a id="2164" href="Data.Nat.LCM.html#862" class="Function">gcd≢0′</a> <a id="2171" href="Data.Nat.LCM.html#2079" class="Bound">m-1</a> <a id="2175" href="Data.Nat.LCM.html#2086" class="Bound">n</a><a id="2176" class="Symbol">}</a> <a id="2178" href="Data.Nat.LCM.html#2230" class="Function">gcd[m,n]∣m*n</a> <a id="2191" href="Data.Nat.LCM.html#2316" class="Function">mn∣c*gcd</a><a id="2199" class="Symbol">)</a>
  <a id="2203" class="Keyword">where</a>
  <a id="2211" class="Keyword">open</a> <a id="2216" href="Data.Nat.Divisibility.html#3482" class="Module">∣-Reasoning</a>
  <a id="2230" href="Data.Nat.LCM.html#2230" class="Function">gcd[m,n]∣m*n</a> <a id="2243" class="Symbol">:</a> <a id="2245" href="Data.Nat.GCD.html#1573" class="Function">gcd</a> <a id="2249" href="Data.Nat.LCM.html#2072" class="Bound">m</a> <a id="2251" href="Data.Nat.LCM.html#2086" class="Bound">n</a> <a id="2253" href="Data.Nat.Divisibility.Core.html#1146" class="Record Operator">∣</a> <a id="2255" href="Data.Nat.LCM.html#2072" class="Bound">m</a> <a id="2257" href="Agda.Builtin.Nat.html#522" class="Primitive Operator">*</a> <a id="2259" href="Data.Nat.LCM.html#2086" class="Bound">n</a>
  <a id="2263" href="Data.Nat.LCM.html#2230" class="Function">gcd[m,n]∣m*n</a> <a id="2276" class="Symbol">=</a> <a id="2278" href="Data.Nat.Divisibility.html#2349" class="Function">∣-trans</a> <a id="2286" class="Symbol">(</a><a id="2287" href="Data.Nat.GCD.html#2469" class="Function">gcd[m,n]∣m</a> <a id="2298" href="Data.Nat.LCM.html#2072" class="Bound">m</a> <a id="2300" href="Data.Nat.LCM.html#2086" class="Bound">n</a><a id="2301" class="Symbol">)</a> <a id="2303" class="Symbol">(</a><a id="2304" href="Data.Nat.Divisibility.html#4872" class="Function">m∣m*n</a> <a id="2310" href="Data.Nat.LCM.html#2086" class="Bound">n</a><a id="2311" class="Symbol">)</a>

  <a id="2316" href="Data.Nat.LCM.html#2316" class="Function">mn∣c*gcd</a> <a id="2325" class="Symbol">:</a> <a id="2327" href="Data.Nat.LCM.html#2072" class="Bound">m</a> <a id="2329" href="Agda.Builtin.Nat.html#522" class="Primitive Operator">*</a> <a id="2331" href="Data.Nat.LCM.html#2086" class="Bound">n</a> <a id="2333" href="Data.Nat.Divisibility.Core.html#1146" class="Record Operator">∣</a> <a id="2335" href="Data.Nat.LCM.html#2090" class="Bound">c</a> <a id="2337" href="Agda.Builtin.Nat.html#522" class="Primitive Operator">*</a> <a id="2339" href="Data.Nat.GCD.html#1573" class="Function">gcd</a> <a id="2343" href="Data.Nat.LCM.html#2072" class="Bound">m</a> <a id="2345" href="Data.Nat.LCM.html#2086" class="Bound">n</a>
  <a id="2349" href="Data.Nat.LCM.html#2316" class="Function">mn∣c*gcd</a> <a id="2358" class="Symbol">=</a> <a id="2360" href="Relation.Binary.Reasoning.Base.Double.html#2222" class="Function Operator">begin</a>
    <a id="2370" href="Data.Nat.LCM.html#2072" class="Bound">m</a> <a id="2372" href="Agda.Builtin.Nat.html#522" class="Primitive Operator">*</a> <a id="2374" href="Data.Nat.LCM.html#2086" class="Bound">n</a>               <a id="2390" href="Data.Nat.Divisibility.html#3635" class="Function">∣⟨</a> <a id="2393" href="Data.Nat.GCD.html#2882" class="Function">gcd-greatest</a> <a id="2406" class="Symbol">(</a><a id="2407" href="Relation.Binary.PropositionalEquality.Core.html#1789" class="Function">P.subst</a> <a id="2415" class="Symbol">(</a><a id="2416" href="Data.Nat.Divisibility.Core.html#1146" class="Record Operator">_∣</a> <a id="2419" href="Data.Nat.LCM.html#2090" class="Bound">c</a> <a id="2421" href="Agda.Builtin.Nat.html#522" class="Primitive Operator">*</a> <a id="2423" href="Data.Nat.LCM.html#2072" class="Bound">m</a><a id="2424" class="Symbol">)</a> <a id="2426" class="Symbol">(</a><a id="2427" href="Data.Nat.Properties.html#20365" class="Function">*-comm</a> <a id="2434" href="Data.Nat.LCM.html#2086" class="Bound">n</a> <a id="2436" href="Data.Nat.LCM.html#2072" class="Bound">m</a><a id="2437" class="Symbol">)</a> <a id="2439" class="Symbol">(</a><a id="2440" href="Data.Nat.Divisibility.html#5423" class="Function">*-monoˡ-∣</a> <a id="2450" href="Data.Nat.LCM.html#2072" class="Bound">m</a> <a id="2452" href="Data.Nat.LCM.html#2097" class="Bound">n∣c</a><a id="2455" class="Symbol">))</a> <a id="2458" class="Symbol">(</a><a id="2459" href="Data.Nat.Divisibility.html#5423" class="Function">*-monoˡ-∣</a> <a id="2469" href="Data.Nat.LCM.html#2086" class="Bound">n</a> <a id="2471" href="Data.Nat.LCM.html#2093" class="Bound">m∣c</a><a id="2474" class="Symbol">)</a> <a id="2476" href="Data.Nat.Divisibility.html#3635" class="Function">⟩</a>
    <a id="2482" href="Data.Nat.GCD.html#1573" class="Function">gcd</a> <a id="2486" class="Symbol">(</a><a id="2487" href="Data.Nat.LCM.html#2090" class="Bound">c</a> <a id="2489" href="Agda.Builtin.Nat.html#522" class="Primitive Operator">*</a> <a id="2491" href="Data.Nat.LCM.html#2072" class="Bound">m</a><a id="2492" class="Symbol">)</a> <a id="2494" class="Symbol">(</a><a id="2495" href="Data.Nat.LCM.html#2090" class="Bound">c</a> <a id="2497" href="Agda.Builtin.Nat.html#522" class="Primitive Operator">*</a> <a id="2499" href="Data.Nat.LCM.html#2086" class="Bound">n</a><a id="2500" class="Symbol">)</a> <a id="2502" href="Relation.Binary.Reasoning.Base.Double.html#3132" class="Function">≡⟨</a> <a id="2505" href="Relation.Binary.PropositionalEquality.Core.html#1693" class="Function">sym</a> <a id="2509" class="Symbol">(</a><a id="2510" href="Data.Nat.GCD.html#5220" class="Function">c*gcd[m,n]≡gcd[cm,cn]</a> <a id="2532" href="Data.Nat.LCM.html#2090" class="Bound">c</a> <a id="2534" href="Data.Nat.LCM.html#2072" class="Bound">m</a> <a id="2536" href="Data.Nat.LCM.html#2086" class="Bound">n</a><a id="2537" class="Symbol">)</a> <a id="2539" href="Relation.Binary.Reasoning.Base.Double.html#3132" class="Function">⟩</a>
    <a id="2545" href="Data.Nat.LCM.html#2090" class="Bound">c</a> <a id="2547" href="Agda.Builtin.Nat.html#522" class="Primitive Operator">*</a> <a id="2549" href="Data.Nat.GCD.html#1573" class="Function">gcd</a> <a id="2553" href="Data.Nat.LCM.html#2072" class="Bound">m</a> <a id="2555" href="Data.Nat.LCM.html#2086" class="Bound">n</a>         <a id="2565" href="Relation.Binary.Reasoning.Base.Double.html#3656" class="Function Operator">∎</a>

<a id="2568" class="Comment">------------------------------------------------------------------------</a>
<a id="2641" class="Comment">-- Other properties</a>

<a id="2662" class="Comment">-- Note that all other properties of `gcd` should be inferable from the</a>
<a id="2734" class="Comment">-- 3 core properties above.</a>

<a id="gcd*lcm"></a><a id="2763" href="Data.Nat.LCM.html#2763" class="Function">gcd*lcm</a> <a id="2771" class="Symbol">:</a> <a id="2773" class="Symbol">∀</a> <a id="2775" href="Data.Nat.LCM.html#2775" class="Bound">m</a> <a id="2777" href="Data.Nat.LCM.html#2777" class="Bound">n</a> <a id="2779" class="Symbol">→</a> <a id="2781" href="Data.Nat.GCD.html#1573" class="Function">gcd</a> <a id="2785" href="Data.Nat.LCM.html#2775" class="Bound">m</a> <a id="2787" href="Data.Nat.LCM.html#2777" class="Bound">n</a> <a id="2789" href="Agda.Builtin.Nat.html#522" class="Primitive Operator">*</a> <a id="2791" href="Data.Nat.LCM.html#1062" class="Function">lcm</a> <a id="2795" href="Data.Nat.LCM.html#2775" class="Bound">m</a> <a id="2797" href="Data.Nat.LCM.html#2777" class="Bound">n</a> <a id="2799" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="2801" href="Data.Nat.LCM.html#2775" class="Bound">m</a> <a id="2803" href="Agda.Builtin.Nat.html#522" class="Primitive Operator">*</a> <a id="2805" href="Data.Nat.LCM.html#2777" class="Bound">n</a>
<a id="2807" href="Data.Nat.LCM.html#2763" class="Function">gcd*lcm</a> <a id="2815" href="Agda.Builtin.Nat.html#204" class="InductiveConstructor">zero</a>        <a id="2827" href="Data.Nat.LCM.html#2827" class="Bound">n</a> <a id="2829" class="Symbol">=</a> <a id="2831" href="Data.Nat.Properties.html#20239" class="Function">*-zeroʳ</a> <a id="2839" class="Symbol">(</a><a id="2840" href="Data.Nat.GCD.html#1573" class="Function">gcd</a> <a id="2844" class="Number">0</a> <a id="2846" href="Data.Nat.LCM.html#2827" class="Bound">n</a><a id="2847" class="Symbol">)</a>
<a id="2849" href="Data.Nat.LCM.html#2763" class="Function">gcd*lcm</a> <a id="2857" href="Data.Nat.LCM.html#2857" class="Bound">m</a><a id="2858" class="Symbol">@(</a><a id="2860" href="Agda.Builtin.Nat.html#217" class="InductiveConstructor">suc</a> <a id="2864" href="Data.Nat.LCM.html#2864" class="Bound">m-1</a><a id="2867" class="Symbol">)</a> <a id="2869" href="Data.Nat.LCM.html#2869" class="Bound">n</a> <a id="2871" class="Symbol">=</a> <a id="2873" href="Relation.Binary.PropositionalEquality.Core.html#1738" class="Function">trans</a> <a id="2879" class="Symbol">(</a><a id="2880" href="Relation.Binary.PropositionalEquality.Core.html#1139" class="Function">cong</a> <a id="2885" class="Symbol">(</a><a id="2886" href="Data.Nat.GCD.html#1573" class="Function">gcd</a> <a id="2890" href="Data.Nat.LCM.html#2857" class="Bound">m</a> <a id="2892" href="Data.Nat.LCM.html#2869" class="Bound">n</a> <a id="2894" href="Agda.Builtin.Nat.html#522" class="Primitive Operator">*_</a><a id="2896" class="Symbol">)</a> <a id="2898" class="Symbol">(</a><a id="2899" href="Data.Nat.LCM.html#1260" class="Function">rearrange</a> <a id="2909" href="Data.Nat.LCM.html#2864" class="Bound">m-1</a> <a id="2913" href="Data.Nat.LCM.html#2869" class="Bound">n</a><a id="2914" class="Symbol">))</a> <a id="2917" class="Symbol">(</a><a id="2918" href="Data.Nat.DivMod.html#7201" class="Function">m*[n/m]≡n</a> <a id="2928" class="Symbol">{</a><a id="2929" href="Data.Nat.GCD.html#1573" class="Function">gcd</a> <a id="2933" href="Data.Nat.LCM.html#2857" class="Bound">m</a> <a id="2935" href="Data.Nat.LCM.html#2869" class="Bound">n</a><a id="2936" class="Symbol">}</a> <a id="2938" class="Symbol">(</a><a id="2939" href="Relation.Binary.Reasoning.Base.Double.html#2222" class="Function Operator">begin</a>
  <a id="2947" href="Data.Nat.GCD.html#1573" class="Function">gcd</a> <a id="2951" href="Data.Nat.LCM.html#2857" class="Bound">m</a> <a id="2953" href="Data.Nat.LCM.html#2869" class="Bound">n</a> <a id="2955" href="Data.Nat.Divisibility.html#3635" class="Function">∣⟨</a> <a id="2958" href="Data.Nat.GCD.html#2469" class="Function">gcd[m,n]∣m</a> <a id="2969" href="Data.Nat.LCM.html#2857" class="Bound">m</a> <a id="2971" href="Data.Nat.LCM.html#2869" class="Bound">n</a> <a id="2973" href="Data.Nat.Divisibility.html#3635" class="Function">⟩</a>
  <a id="2977" href="Data.Nat.LCM.html#2857" class="Bound">m</a>       <a id="2985" href="Data.Nat.Divisibility.html#3635" class="Function">∣⟨</a> <a id="2988" href="Data.Nat.Divisibility.html#4872" class="Function">m∣m*n</a> <a id="2994" href="Data.Nat.LCM.html#2869" class="Bound">n</a> <a id="2996" href="Data.Nat.Divisibility.html#3635" class="Function">⟩</a>
  <a id="3000" href="Data.Nat.LCM.html#2857" class="Bound">m</a> <a id="3002" href="Agda.Builtin.Nat.html#522" class="Primitive Operator">*</a> <a id="3004" href="Data.Nat.LCM.html#2869" class="Bound">n</a>   <a id="3008" href="Relation.Binary.Reasoning.Base.Double.html#3656" class="Function Operator">∎</a><a id="3009" class="Symbol">))</a>
  <a id="3014" class="Keyword">where</a> <a id="3020" class="Keyword">open</a> <a id="3025" href="Data.Nat.Divisibility.html#3482" class="Module">∣-Reasoning</a>

<a id="lcm[0,n]≡0"></a><a id="3038" href="Data.Nat.LCM.html#3038" class="Function">lcm[0,n]≡0</a> <a id="3049" class="Symbol">:</a> <a id="3051" class="Symbol">∀</a> <a id="3053" href="Data.Nat.LCM.html#3053" class="Bound">n</a> <a id="3055" class="Symbol">→</a> <a id="3057" href="Data.Nat.LCM.html#1062" class="Function">lcm</a> <a id="3061" class="Number">0</a> <a id="3063" href="Data.Nat.LCM.html#3053" class="Bound">n</a> <a id="3065" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="3067" class="Number">0</a>
<a id="3069" href="Data.Nat.LCM.html#3038" class="Function">lcm[0,n]≡0</a> <a id="3080" href="Data.Nat.LCM.html#3080" class="Bound">n</a> <a id="3082" class="Symbol">=</a> <a id="3084" href="Data.Nat.Divisibility.html#3919" class="Function">0∣⇒≡0</a> <a id="3090" class="Symbol">(</a><a id="3091" href="Data.Nat.LCM.html#1456" class="Function">m∣lcm[m,n]</a> <a id="3102" class="Number">0</a> <a id="3104" href="Data.Nat.LCM.html#3080" class="Bound">n</a><a id="3105" class="Symbol">)</a>

<a id="lcm[n,0]≡0"></a><a id="3108" href="Data.Nat.LCM.html#3108" class="Function">lcm[n,0]≡0</a> <a id="3119" class="Symbol">:</a> <a id="3121" class="Symbol">∀</a> <a id="3123" href="Data.Nat.LCM.html#3123" class="Bound">n</a> <a id="3125" class="Symbol">→</a> <a id="3127" href="Data.Nat.LCM.html#1062" class="Function">lcm</a> <a id="3131" href="Data.Nat.LCM.html#3123" class="Bound">n</a> <a id="3133" class="Number">0</a> <a id="3135" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="3137" class="Number">0</a>
<a id="3139" href="Data.Nat.LCM.html#3108" class="Function">lcm[n,0]≡0</a> <a id="3150" href="Data.Nat.LCM.html#3150" class="Bound">n</a> <a id="3152" class="Symbol">=</a> <a id="3154" href="Data.Nat.Divisibility.html#3919" class="Function">0∣⇒≡0</a> <a id="3160" class="Symbol">(</a><a id="3161" href="Data.Nat.LCM.html#1565" class="Function">n∣lcm[m,n]</a> <a id="3172" href="Data.Nat.LCM.html#3150" class="Bound">n</a> <a id="3174" class="Number">0</a><a id="3175" class="Symbol">)</a>

<a id="lcm-comm"></a><a id="3178" href="Data.Nat.LCM.html#3178" class="Function">lcm-comm</a> <a id="3187" class="Symbol">:</a> <a id="3189" class="Symbol">∀</a> <a id="3191" href="Data.Nat.LCM.html#3191" class="Bound">m</a> <a id="3193" href="Data.Nat.LCM.html#3193" class="Bound">n</a> <a id="3195" class="Symbol">→</a> <a id="3197" href="Data.Nat.LCM.html#1062" class="Function">lcm</a> <a id="3201" href="Data.Nat.LCM.html#3191" class="Bound">m</a> <a id="3203" href="Data.Nat.LCM.html#3193" class="Bound">n</a> <a id="3205" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="3207" href="Data.Nat.LCM.html#1062" class="Function">lcm</a> <a id="3211" href="Data.Nat.LCM.html#3193" class="Bound">n</a> <a id="3213" href="Data.Nat.LCM.html#3191" class="Bound">m</a>
<a id="3215" href="Data.Nat.LCM.html#3178" class="Function">lcm-comm</a> <a id="3224" href="Data.Nat.LCM.html#3224" class="Bound">m</a> <a id="3226" href="Data.Nat.LCM.html#3226" class="Bound">n</a> <a id="3228" class="Symbol">=</a> <a id="3230" href="Data.Nat.Divisibility.html#2459" class="Function">∣-antisym</a>
  <a id="3242" class="Symbol">(</a><a id="3243" href="Data.Nat.LCM.html#1963" class="Function">lcm-least</a> <a id="3253" class="Symbol">(</a><a id="3254" href="Data.Nat.LCM.html#1565" class="Function">n∣lcm[m,n]</a> <a id="3265" href="Data.Nat.LCM.html#3226" class="Bound">n</a> <a id="3267" href="Data.Nat.LCM.html#3224" class="Bound">m</a><a id="3268" class="Symbol">)</a> <a id="3270" class="Symbol">(</a><a id="3271" href="Data.Nat.LCM.html#1456" class="Function">m∣lcm[m,n]</a> <a id="3282" href="Data.Nat.LCM.html#3226" class="Bound">n</a> <a id="3284" href="Data.Nat.LCM.html#3224" class="Bound">m</a><a id="3285" class="Symbol">))</a>
  <a id="3290" class="Symbol">(</a><a id="3291" href="Data.Nat.LCM.html#1963" class="Function">lcm-least</a> <a id="3301" class="Symbol">(</a><a id="3302" href="Data.Nat.LCM.html#1565" class="Function">n∣lcm[m,n]</a> <a id="3313" href="Data.Nat.LCM.html#3224" class="Bound">m</a> <a id="3315" href="Data.Nat.LCM.html#3226" class="Bound">n</a><a id="3316" class="Symbol">)</a> <a id="3318" class="Symbol">(</a><a id="3319" href="Data.Nat.LCM.html#1456" class="Function">m∣lcm[m,n]</a> <a id="3330" href="Data.Nat.LCM.html#3224" class="Bound">m</a> <a id="3332" href="Data.Nat.LCM.html#3226" class="Bound">n</a><a id="3333" class="Symbol">))</a>

<a id="3337" class="Comment">------------------------------------------------------------------------</a>
<a id="3410" class="Comment">-- Least common multiple (lcm).</a>

<a id="3443" class="Keyword">module</a> <a id="LCM"></a><a id="3450" href="Data.Nat.LCM.html#3450" class="Module">LCM</a> <a id="3454" class="Keyword">where</a>

  <a id="3463" class="Comment">-- Specification of the least common multiple (lcm) of two natural</a>
  <a id="3532" class="Comment">-- numbers.</a>

  <a id="3547" class="Keyword">record</a> <a id="LCM.LCM"></a><a id="3554" href="Data.Nat.LCM.html#3554" class="Record">LCM</a> <a id="3558" class="Symbol">(</a><a id="3559" href="Data.Nat.LCM.html#3559" class="Bound">i</a> <a id="3561" href="Data.Nat.LCM.html#3561" class="Bound">j</a> <a id="3563" href="Data.Nat.LCM.html#3563" class="Bound">lcm</a> <a id="3567" class="Symbol">:</a> <a id="3569" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a><a id="3570" class="Symbol">)</a> <a id="3572" class="Symbol">:</a> <a id="3574" href="Agda.Primitive.html#320" class="Primitive">Set</a> <a id="3578" class="Keyword">where</a>
    <a id="3588" class="Keyword">field</a>
      <a id="3600" class="Comment">-- The lcm is a common multiple.</a>
      <a id="LCM.LCM.commonMultiple"></a><a id="3639" href="Data.Nat.LCM.html#3639" class="Field">commonMultiple</a> <a id="3654" class="Symbol">:</a> <a id="3656" href="Data.Nat.LCM.html#3559" class="Bound">i</a> <a id="3658" href="Data.Nat.Divisibility.Core.html#1146" class="Record Operator">∣</a> <a id="3660" href="Data.Nat.LCM.html#3563" class="Bound">lcm</a> <a id="3664" href="Data.Product.html#1176" class="Function Operator">×</a> <a id="3666" href="Data.Nat.LCM.html#3561" class="Bound">j</a> <a id="3668" href="Data.Nat.Divisibility.Core.html#1146" class="Record Operator">∣</a> <a id="3670" href="Data.Nat.LCM.html#3563" class="Bound">lcm</a>

      <a id="3681" class="Comment">-- The lcm divides all common multiples, i.e. the lcm is the least</a>
      <a id="3754" class="Comment">-- common multiple according to the partial order _∣_.</a>
      <a id="LCM.LCM.least"></a><a id="3815" href="Data.Nat.LCM.html#3815" class="Field">least</a> <a id="3821" class="Symbol">:</a> <a id="3823" class="Symbol">∀</a> <a id="3825" class="Symbol">{</a><a id="3826" href="Data.Nat.LCM.html#3826" class="Bound">m</a><a id="3827" class="Symbol">}</a> <a id="3829" class="Symbol">→</a> <a id="3831" href="Data.Nat.LCM.html#3559" class="Bound">i</a> <a id="3833" href="Data.Nat.Divisibility.Core.html#1146" class="Record Operator">∣</a> <a id="3835" href="Data.Nat.LCM.html#3826" class="Bound">m</a> <a id="3837" href="Data.Product.html#1176" class="Function Operator">×</a> <a id="3839" href="Data.Nat.LCM.html#3561" class="Bound">j</a> <a id="3841" href="Data.Nat.Divisibility.Core.html#1146" class="Record Operator">∣</a> <a id="3843" href="Data.Nat.LCM.html#3826" class="Bound">m</a> <a id="3845" class="Symbol">→</a> <a id="3847" href="Data.Nat.LCM.html#3563" class="Bound">lcm</a> <a id="3851" href="Data.Nat.Divisibility.Core.html#1146" class="Record Operator">∣</a> <a id="3853" href="Data.Nat.LCM.html#3826" class="Bound">m</a>

  <a id="3858" class="Keyword">open</a> <a id="3863" href="Data.Nat.LCM.html#3554" class="Module">LCM</a> <a id="3867" class="Keyword">public</a>

  <a id="3877" class="Comment">-- The lcm is unique.</a>

  <a id="LCM.unique"></a><a id="3902" href="Data.Nat.LCM.html#3902" class="Function">unique</a> <a id="3909" class="Symbol">:</a> <a id="3911" class="Symbol">∀</a> <a id="3913" class="Symbol">{</a><a id="3914" href="Data.Nat.LCM.html#3914" class="Bound">d₁</a> <a id="3917" href="Data.Nat.LCM.html#3917" class="Bound">d₂</a> <a id="3920" href="Data.Nat.LCM.html#3920" class="Bound">m</a> <a id="3922" href="Data.Nat.LCM.html#3922" class="Bound">n</a><a id="3923" class="Symbol">}</a> <a id="3925" class="Symbol">→</a> <a id="3927" href="Data.Nat.LCM.html#3554" class="Record">LCM</a> <a id="3931" href="Data.Nat.LCM.html#3920" class="Bound">m</a> <a id="3933" href="Data.Nat.LCM.html#3922" class="Bound">n</a> <a id="3935" href="Data.Nat.LCM.html#3914" class="Bound">d₁</a> <a id="3938" class="Symbol">→</a> <a id="3940" href="Data.Nat.LCM.html#3554" class="Record">LCM</a> <a id="3944" href="Data.Nat.LCM.html#3920" class="Bound">m</a> <a id="3946" href="Data.Nat.LCM.html#3922" class="Bound">n</a> <a id="3948" href="Data.Nat.LCM.html#3917" class="Bound">d₂</a> <a id="3951" class="Symbol">→</a> <a id="3953" href="Data.Nat.LCM.html#3914" class="Bound">d₁</a> <a id="3956" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="3958" href="Data.Nat.LCM.html#3917" class="Bound">d₂</a>
  <a id="3963" href="Data.Nat.LCM.html#3902" class="Function">unique</a> <a id="3970" href="Data.Nat.LCM.html#3970" class="Bound">d₁</a> <a id="3973" href="Data.Nat.LCM.html#3973" class="Bound">d₂</a> <a id="3976" class="Symbol">=</a> <a id="3978" href="Data.Nat.Divisibility.html#2459" class="Function">∣-antisym</a> <a id="3988" class="Symbol">(</a><a id="3989" href="Data.Nat.LCM.html#3815" class="Field">LCM.least</a> <a id="3999" href="Data.Nat.LCM.html#3970" class="Bound">d₁</a> <a id="4002" class="Symbol">(</a><a id="4003" href="Data.Nat.LCM.html#3639" class="Field">LCM.commonMultiple</a> <a id="4022" href="Data.Nat.LCM.html#3973" class="Bound">d₂</a><a id="4024" class="Symbol">))</a>
                           <a id="4054" class="Symbol">(</a><a id="4055" href="Data.Nat.LCM.html#3815" class="Field">LCM.least</a> <a id="4065" href="Data.Nat.LCM.html#3973" class="Bound">d₂</a> <a id="4068" class="Symbol">(</a><a id="4069" href="Data.Nat.LCM.html#3639" class="Field">LCM.commonMultiple</a> <a id="4088" href="Data.Nat.LCM.html#3970" class="Bound">d₁</a><a id="4090" class="Symbol">))</a>

<a id="4094" class="Keyword">open</a> <a id="4099" href="Data.Nat.LCM.html#3450" class="Module">LCM</a> <a id="4103" class="Keyword">public</a> <a id="4110" class="Keyword">using</a> <a id="4116" class="Symbol">(</a><a id="4117" href="Data.Nat.LCM.html#3554" class="Record">LCM</a><a id="4120" class="Symbol">)</a> <a id="4122" class="Keyword">hiding</a> <a id="4129" class="Symbol">(</a><a id="4130" class="Keyword">module</a> <a id="4137" href="Data.Nat.LCM.html#3554" class="Module">LCM</a><a id="4140" class="Symbol">)</a>

<a id="4143" class="Comment">------------------------------------------------------------------------</a>
<a id="4216" class="Comment">-- Calculating the LCM</a>

<a id="lcm-LCM"></a><a id="4240" href="Data.Nat.LCM.html#4240" class="Function">lcm-LCM</a> <a id="4248" class="Symbol">:</a> <a id="4250" class="Symbol">∀</a> <a id="4252" href="Data.Nat.LCM.html#4252" class="Bound">m</a> <a id="4254" href="Data.Nat.LCM.html#4254" class="Bound">n</a> <a id="4256" class="Symbol">→</a> <a id="4258" href="Data.Nat.LCM.html#3554" class="Record">LCM</a> <a id="4262" href="Data.Nat.LCM.html#4252" class="Bound">m</a> <a id="4264" href="Data.Nat.LCM.html#4254" class="Bound">n</a> <a id="4266" class="Symbol">(</a><a id="4267" href="Data.Nat.LCM.html#1062" class="Function">lcm</a> <a id="4271" href="Data.Nat.LCM.html#4252" class="Bound">m</a> <a id="4273" href="Data.Nat.LCM.html#4254" class="Bound">n</a><a id="4274" class="Symbol">)</a>
<a id="4276" href="Data.Nat.LCM.html#4240" class="Function">lcm-LCM</a> <a id="4284" href="Data.Nat.LCM.html#4284" class="Bound">m</a> <a id="4286" href="Data.Nat.LCM.html#4286" class="Bound">n</a> <a id="4288" class="Symbol">=</a> <a id="4290" class="Keyword">record</a>
  <a id="4299" class="Symbol">{</a> <a id="4301" href="Data.Nat.LCM.html#3639" class="Field">commonMultiple</a> <a id="4316" class="Symbol">=</a> <a id="4318" href="Data.Nat.LCM.html#1456" class="Function">m∣lcm[m,n]</a> <a id="4329" href="Data.Nat.LCM.html#4284" class="Bound">m</a> <a id="4331" href="Data.Nat.LCM.html#4286" class="Bound">n</a> <a id="4333" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="4335" href="Data.Nat.LCM.html#1565" class="Function">n∣lcm[m,n]</a> <a id="4346" href="Data.Nat.LCM.html#4284" class="Bound">m</a> <a id="4348" href="Data.Nat.LCM.html#4286" class="Bound">n</a>
  <a id="4352" class="Symbol">;</a> <a id="4354" href="Data.Nat.LCM.html#3815" class="Field">least</a>          <a id="4369" class="Symbol">=</a> <a id="4371" href="Data.Product.html#4893" class="Function">uncurry′</a> <a id="4380" href="Data.Nat.LCM.html#1963" class="Function">lcm-least</a>
  <a id="4392" class="Symbol">}</a>

<a id="mkLCM"></a><a id="4395" href="Data.Nat.LCM.html#4395" class="Function">mkLCM</a> <a id="4401" class="Symbol">:</a> <a id="4403" class="Symbol">∀</a> <a id="4405" href="Data.Nat.LCM.html#4405" class="Bound">m</a> <a id="4407" href="Data.Nat.LCM.html#4407" class="Bound">n</a> <a id="4409" class="Symbol">→</a> <a id="4411" href="Data.Product.html#1378" class="Function">∃</a> <a id="4413" class="Symbol">λ</a> <a id="4415" href="Data.Nat.LCM.html#4415" class="Bound">d</a> <a id="4417" class="Symbol">→</a> <a id="4419" href="Data.Nat.LCM.html#3554" class="Record">LCM</a> <a id="4423" href="Data.Nat.LCM.html#4405" class="Bound">m</a> <a id="4425" href="Data.Nat.LCM.html#4407" class="Bound">n</a> <a id="4427" href="Data.Nat.LCM.html#4415" class="Bound">d</a>
<a id="4429" href="Data.Nat.LCM.html#4395" class="Function">mkLCM</a> <a id="4435" href="Data.Nat.LCM.html#4435" class="Bound">m</a> <a id="4437" href="Data.Nat.LCM.html#4437" class="Bound">n</a> <a id="4439" class="Symbol">=</a> <a id="4441" href="Data.Nat.LCM.html#1062" class="Function">lcm</a> <a id="4445" href="Data.Nat.LCM.html#4435" class="Bound">m</a> <a id="4447" href="Data.Nat.LCM.html#4437" class="Bound">n</a> <a id="4449" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="4451" href="Data.Nat.LCM.html#4240" class="Function">lcm-LCM</a> <a id="4459" href="Data.Nat.LCM.html#4435" class="Bound">m</a> <a id="4461" href="Data.Nat.LCM.html#4437" class="Bound">n</a>

<a id="GCD*LCM"></a><a id="4464" href="Data.Nat.LCM.html#4464" class="Function">GCD*LCM</a> <a id="4472" class="Symbol">:</a> <a id="4474" class="Symbol">∀</a> <a id="4476" class="Symbol">{</a><a id="4477" href="Data.Nat.LCM.html#4477" class="Bound">m</a> <a id="4479" href="Data.Nat.LCM.html#4479" class="Bound">n</a> <a id="4481" href="Data.Nat.LCM.html#4481" class="Bound">g</a> <a id="4483" href="Data.Nat.LCM.html#4483" class="Bound">l</a><a id="4484" class="Symbol">}</a> <a id="4486" class="Symbol">→</a> <a id="4488" href="Data.Nat.GCD.html#6267" class="Record">GCD</a> <a id="4492" href="Data.Nat.LCM.html#4477" class="Bound">m</a> <a id="4494" href="Data.Nat.LCM.html#4479" class="Bound">n</a> <a id="4496" href="Data.Nat.LCM.html#4481" class="Bound">g</a> <a id="4498" class="Symbol">→</a> <a id="4500" href="Data.Nat.LCM.html#3554" class="Record">LCM</a> <a id="4504" href="Data.Nat.LCM.html#4477" class="Bound">m</a> <a id="4506" href="Data.Nat.LCM.html#4479" class="Bound">n</a> <a id="4508" href="Data.Nat.LCM.html#4483" class="Bound">l</a> <a id="4510" class="Symbol">→</a> <a id="4512" href="Data.Nat.LCM.html#4477" class="Bound">m</a> <a id="4514" href="Agda.Builtin.Nat.html#522" class="Primitive Operator">*</a> <a id="4516" href="Data.Nat.LCM.html#4479" class="Bound">n</a> <a id="4518" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="4520" href="Data.Nat.LCM.html#4481" class="Bound">g</a> <a id="4522" href="Agda.Builtin.Nat.html#522" class="Primitive Operator">*</a> <a id="4524" href="Data.Nat.LCM.html#4483" class="Bound">l</a>
<a id="4526" href="Data.Nat.LCM.html#4464" class="Function">GCD*LCM</a> <a id="4534" class="Symbol">{</a><a id="4535" href="Data.Nat.LCM.html#4535" class="Bound">m</a><a id="4536" class="Symbol">}</a> <a id="4538" class="Symbol">{</a><a id="4539" href="Data.Nat.LCM.html#4539" class="Bound">n</a><a id="4540" class="Symbol">}</a> <a id="4542" class="Symbol">{</a><a id="4543" href="Data.Nat.LCM.html#4543" class="Bound">g</a><a id="4544" class="Symbol">}</a> <a id="4546" class="Symbol">{</a><a id="4547" href="Data.Nat.LCM.html#4547" class="Bound">l</a><a id="4548" class="Symbol">}</a> <a id="4550" href="Data.Nat.LCM.html#4550" class="Bound">gc</a> <a id="4553" href="Data.Nat.LCM.html#4553" class="Bound">lc</a> <a id="4556" class="Symbol">=</a> <a id="4558" href="Relation.Binary.PropositionalEquality.Core.html#1693" class="Function">sym</a> <a id="4562" class="Symbol">(</a><a id="4563" href="Relation.Binary.PropositionalEquality.Core.html#2815" class="Function Operator">begin</a>
  <a id="4571" href="Data.Nat.LCM.html#4543" class="Bound">g</a> <a id="4573" href="Agda.Builtin.Nat.html#522" class="Primitive Operator">*</a> <a id="4575" href="Data.Nat.LCM.html#4547" class="Bound">l</a>             <a id="4589" href="Relation.Binary.PropositionalEquality.Core.html#2932" class="Function">≡⟨</a> <a id="4592" href="Relation.Binary.PropositionalEquality.Core.html#1376" class="Function">cong₂</a> <a id="4598" href="Agda.Builtin.Nat.html#522" class="Primitive Operator">_*_</a> <a id="4602" class="Symbol">(</a><a id="4603" href="Data.Nat.GCD.html#6635" class="Function">GCD.unique</a> <a id="4614" href="Data.Nat.LCM.html#4550" class="Bound">gc</a> <a id="4617" class="Symbol">(</a><a id="4618" href="Data.Nat.GCD.html#7650" class="Function">gcd-GCD</a> <a id="4626" href="Data.Nat.LCM.html#4535" class="Bound">m</a> <a id="4628" href="Data.Nat.LCM.html#4539" class="Bound">n</a><a id="4629" class="Symbol">))</a> <a id="4632" class="Symbol">(</a><a id="4633" href="Data.Nat.LCM.html#3902" class="Function">LCM.unique</a> <a id="4644" href="Data.Nat.LCM.html#4553" class="Bound">lc</a> <a id="4647" class="Symbol">(</a><a id="4648" href="Data.Nat.LCM.html#4240" class="Function">lcm-LCM</a> <a id="4656" href="Data.Nat.LCM.html#4535" class="Bound">m</a> <a id="4658" href="Data.Nat.LCM.html#4539" class="Bound">n</a><a id="4659" class="Symbol">))</a> <a id="4662" href="Relation.Binary.PropositionalEquality.Core.html#2932" class="Function">⟩</a>
  <a id="4666" href="Data.Nat.GCD.html#1573" class="Function">gcd</a> <a id="4670" href="Data.Nat.LCM.html#4535" class="Bound">m</a> <a id="4672" href="Data.Nat.LCM.html#4539" class="Bound">n</a> <a id="4674" href="Agda.Builtin.Nat.html#522" class="Primitive Operator">*</a> <a id="4676" href="Data.Nat.LCM.html#1062" class="Function">lcm</a> <a id="4680" href="Data.Nat.LCM.html#4535" class="Bound">m</a> <a id="4682" href="Data.Nat.LCM.html#4539" class="Bound">n</a> <a id="4684" href="Relation.Binary.PropositionalEquality.Core.html#2932" class="Function">≡⟨</a> <a id="4687" href="Data.Nat.LCM.html#2763" class="Function">gcd*lcm</a> <a id="4695" href="Data.Nat.LCM.html#4535" class="Bound">m</a> <a id="4697" href="Data.Nat.LCM.html#4539" class="Bound">n</a> <a id="4699" href="Relation.Binary.PropositionalEquality.Core.html#2932" class="Function">⟩</a>
  <a id="4703" href="Data.Nat.LCM.html#4535" class="Bound">m</a> <a id="4705" href="Agda.Builtin.Nat.html#522" class="Primitive Operator">*</a> <a id="4707" href="Data.Nat.LCM.html#4539" class="Bound">n</a>             <a id="4721" href="Relation.Binary.PropositionalEquality.Core.html#3114" class="Function Operator">∎</a><a id="4722" class="Symbol">)</a>
  <a id="4726" class="Keyword">where</a> <a id="4732" class="Keyword">open</a> <a id="4737" href="Relation.Binary.PropositionalEquality.Core.html#2717" class="Module">≡-Reasoning</a>
</pre></body></html>