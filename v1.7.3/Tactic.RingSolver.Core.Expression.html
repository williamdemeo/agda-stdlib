<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Tactic.RingSolver.Core.Expression</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- The Agda standard library</a>
<a id="103" class="Comment">--</a>
<a id="106" class="Comment">-- A type for expressions over a raw ring.</a>
<a id="149" class="Comment">------------------------------------------------------------------------</a>

<a id="223" class="Symbol">{-#</a> <a id="227" class="Keyword">OPTIONS</a> <a id="235" class="Pragma">--cubical-compatible</a> <a id="256" class="Pragma">--safe</a> <a id="263" class="Symbol">#-}</a>

<a id="268" class="Keyword">module</a> <a id="275" href="Tactic.RingSolver.Core.Expression.html" class="Module">Tactic.RingSolver.Core.Expression</a> <a id="309" class="Keyword">where</a>

<a id="316" class="Keyword">open</a> <a id="321" class="Keyword">import</a> <a id="328" href="Data.Nat.Base.html" class="Module">Data.Nat.Base</a> <a id="342" class="Keyword">using</a> <a id="348" class="Symbol">(</a><a id="349" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="350" class="Symbol">)</a>
<a id="352" class="Keyword">open</a> <a id="357" class="Keyword">import</a> <a id="364" href="Data.Fin.Base.html" class="Module">Data.Fin.Base</a> <a id="378" class="Keyword">using</a> <a id="384" class="Symbol">(</a><a id="385" href="Data.Fin.Base.html#1135" class="Datatype">Fin</a><a id="388" class="Symbol">)</a>
<a id="390" class="Keyword">open</a> <a id="395" class="Keyword">import</a> <a id="402" href="Data.Vec.Base.html" class="Module">Data.Vec.Base</a> <a id="416" class="Symbol">as</a> <a id="419" class="Module">Vec</a> <a id="423" class="Keyword">using</a> <a id="429" class="Symbol">(</a><a id="430" href="Data.Vec.Base.html#1007" class="Datatype">Vec</a><a id="433" class="Symbol">)</a>

<a id="436" class="Keyword">open</a> <a id="441" class="Keyword">import</a> <a id="448" href="Algebra.html" class="Module">Algebra</a>

<a id="457" class="Keyword">infixl</a> <a id="464" class="Number">6</a> <a id="466" href="Tactic.RingSolver.Core.Expression.html#649" class="InductiveConstructor Operator">_⊕_</a>
<a id="470" class="Keyword">infixl</a> <a id="477" class="Number">7</a> <a id="479" href="Tactic.RingSolver.Core.Expression.html#700" class="InductiveConstructor Operator">_⊗_</a>
<a id="483" class="Keyword">infixr</a> <a id="490" class="Number">8</a> <a id="492" href="Tactic.RingSolver.Core.Expression.html#757" class="InductiveConstructor Operator">_⊛_</a>

<a id="497" class="Keyword">data</a> <a id="Expr"></a><a id="502" href="Tactic.RingSolver.Core.Expression.html#502" class="Datatype">Expr</a> <a id="507" class="Symbol">{</a><a id="508" href="Tactic.RingSolver.Core.Expression.html#508" class="Bound">a</a><a id="509" class="Symbol">}</a> <a id="511" class="Symbol">(</a><a id="512" href="Tactic.RingSolver.Core.Expression.html#512" class="Bound">A</a> <a id="514" class="Symbol">:</a> <a id="516" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="520" href="Tactic.RingSolver.Core.Expression.html#508" class="Bound">a</a><a id="521" class="Symbol">)</a> <a id="523" class="Symbol">(</a><a id="524" href="Tactic.RingSolver.Core.Expression.html#524" class="Bound">n</a> <a id="526" class="Symbol">:</a> <a id="528" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="529" class="Symbol">)</a> <a id="531" class="Symbol">:</a> <a id="533" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="537" href="Tactic.RingSolver.Core.Expression.html#508" class="Bound">a</a> <a id="539" class="Keyword">where</a>
  <a id="Expr.Κ"></a><a id="547" href="Tactic.RingSolver.Core.Expression.html#547" class="InductiveConstructor">Κ</a>   <a id="551" class="Symbol">:</a> <a id="553" href="Tactic.RingSolver.Core.Expression.html#512" class="Bound">A</a> <a id="555" class="Symbol">→</a> <a id="557" href="Tactic.RingSolver.Core.Expression.html#502" class="Datatype">Expr</a> <a id="562" href="Tactic.RingSolver.Core.Expression.html#512" class="Bound">A</a> <a id="564" href="Tactic.RingSolver.Core.Expression.html#524" class="Bound">n</a>                   <a id="584" class="Comment">-- Constant</a>
  <a id="Expr.Ι"></a><a id="598" href="Tactic.RingSolver.Core.Expression.html#598" class="InductiveConstructor">Ι</a>   <a id="602" class="Symbol">:</a> <a id="604" href="Data.Fin.Base.html#1135" class="Datatype">Fin</a> <a id="608" href="Tactic.RingSolver.Core.Expression.html#524" class="Bound">n</a> <a id="610" class="Symbol">→</a> <a id="612" href="Tactic.RingSolver.Core.Expression.html#502" class="Datatype">Expr</a> <a id="617" href="Tactic.RingSolver.Core.Expression.html#512" class="Bound">A</a> <a id="619" href="Tactic.RingSolver.Core.Expression.html#524" class="Bound">n</a>               <a id="635" class="Comment">-- Variable</a>
  <a id="Expr._⊕_"></a><a id="649" href="Tactic.RingSolver.Core.Expression.html#649" class="InductiveConstructor Operator">_⊕_</a> <a id="653" class="Symbol">:</a> <a id="655" href="Tactic.RingSolver.Core.Expression.html#502" class="Datatype">Expr</a> <a id="660" href="Tactic.RingSolver.Core.Expression.html#512" class="Bound">A</a> <a id="662" href="Tactic.RingSolver.Core.Expression.html#524" class="Bound">n</a> <a id="664" class="Symbol">→</a> <a id="666" href="Tactic.RingSolver.Core.Expression.html#502" class="Datatype">Expr</a> <a id="671" href="Tactic.RingSolver.Core.Expression.html#512" class="Bound">A</a> <a id="673" href="Tactic.RingSolver.Core.Expression.html#524" class="Bound">n</a> <a id="675" class="Symbol">→</a> <a id="677" href="Tactic.RingSolver.Core.Expression.html#502" class="Datatype">Expr</a> <a id="682" href="Tactic.RingSolver.Core.Expression.html#512" class="Bound">A</a> <a id="684" href="Tactic.RingSolver.Core.Expression.html#524" class="Bound">n</a> <a id="686" class="Comment">-- Addition</a>
  <a id="Expr._⊗_"></a><a id="700" href="Tactic.RingSolver.Core.Expression.html#700" class="InductiveConstructor Operator">_⊗_</a> <a id="704" class="Symbol">:</a> <a id="706" href="Tactic.RingSolver.Core.Expression.html#502" class="Datatype">Expr</a> <a id="711" href="Tactic.RingSolver.Core.Expression.html#512" class="Bound">A</a> <a id="713" href="Tactic.RingSolver.Core.Expression.html#524" class="Bound">n</a> <a id="715" class="Symbol">→</a> <a id="717" href="Tactic.RingSolver.Core.Expression.html#502" class="Datatype">Expr</a> <a id="722" href="Tactic.RingSolver.Core.Expression.html#512" class="Bound">A</a> <a id="724" href="Tactic.RingSolver.Core.Expression.html#524" class="Bound">n</a> <a id="726" class="Symbol">→</a> <a id="728" href="Tactic.RingSolver.Core.Expression.html#502" class="Datatype">Expr</a> <a id="733" href="Tactic.RingSolver.Core.Expression.html#512" class="Bound">A</a> <a id="735" href="Tactic.RingSolver.Core.Expression.html#524" class="Bound">n</a> <a id="737" class="Comment">-- Multiplication</a>
  <a id="Expr._⊛_"></a><a id="757" href="Tactic.RingSolver.Core.Expression.html#757" class="InductiveConstructor Operator">_⊛_</a> <a id="761" class="Symbol">:</a> <a id="763" href="Tactic.RingSolver.Core.Expression.html#502" class="Datatype">Expr</a> <a id="768" href="Tactic.RingSolver.Core.Expression.html#512" class="Bound">A</a> <a id="770" href="Tactic.RingSolver.Core.Expression.html#524" class="Bound">n</a> <a id="772" class="Symbol">→</a> <a id="774" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="776" class="Symbol">→</a> <a id="778" href="Tactic.RingSolver.Core.Expression.html#502" class="Datatype">Expr</a> <a id="783" href="Tactic.RingSolver.Core.Expression.html#512" class="Bound">A</a> <a id="785" href="Tactic.RingSolver.Core.Expression.html#524" class="Bound">n</a>        <a id="794" class="Comment">-- Exponentiation</a>
  <a id="Expr.⊝_"></a><a id="814" href="Tactic.RingSolver.Core.Expression.html#814" class="InductiveConstructor Operator">⊝_</a>  <a id="818" class="Symbol">:</a> <a id="820" href="Tactic.RingSolver.Core.Expression.html#502" class="Datatype">Expr</a> <a id="825" href="Tactic.RingSolver.Core.Expression.html#512" class="Bound">A</a> <a id="827" href="Tactic.RingSolver.Core.Expression.html#524" class="Bound">n</a> <a id="829" class="Symbol">→</a> <a id="831" href="Tactic.RingSolver.Core.Expression.html#502" class="Datatype">Expr</a> <a id="836" href="Tactic.RingSolver.Core.Expression.html#512" class="Bound">A</a> <a id="838" href="Tactic.RingSolver.Core.Expression.html#524" class="Bound">n</a>            <a id="851" class="Comment">-- Negation</a>


<a id="865" class="Keyword">module</a> <a id="872" href="Tactic.RingSolver.Core.Expression.html#872" class="Module">Eval</a>
  <a id="879" class="Symbol">{</a><a id="880" href="Tactic.RingSolver.Core.Expression.html#880" class="Bound">ℓ₁</a> <a id="883" href="Tactic.RingSolver.Core.Expression.html#883" class="Bound">ℓ₂</a><a id="885" class="Symbol">}</a> <a id="887" class="Symbol">(</a><a id="888" href="Tactic.RingSolver.Core.Expression.html#888" class="Bound">rawRing</a> <a id="896" class="Symbol">:</a> <a id="898" href="Algebra.Bundles.html#20205" class="Record">RawRing</a> <a id="906" href="Tactic.RingSolver.Core.Expression.html#880" class="Bound">ℓ₁</a> <a id="909" href="Tactic.RingSolver.Core.Expression.html#883" class="Bound">ℓ₂</a><a id="911" class="Symbol">)</a>
  <a id="915" class="Symbol">(</a><a id="916" class="Keyword">open</a> <a id="921" href="Algebra.Bundles.html#20205" class="Module">RawRing</a> <a id="929" href="Tactic.RingSolver.Core.Expression.html#888" class="Bound">rawRing</a><a id="936" class="Symbol">)</a>
  <a id="940" class="Symbol">{</a><a id="941" href="Tactic.RingSolver.Core.Expression.html#941" class="Bound">a</a><a id="942" class="Symbol">}</a> <a id="944" class="Symbol">{</a><a id="945" href="Tactic.RingSolver.Core.Expression.html#945" class="Bound">A</a> <a id="947" class="Symbol">:</a> <a id="949" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="953" href="Tactic.RingSolver.Core.Expression.html#941" class="Bound">a</a><a id="954" class="Symbol">}</a> <a id="956" class="Symbol">(</a><a id="957" href="Tactic.RingSolver.Core.Expression.html#957" class="Bound Operator">⟦_⟧ᵣ</a> <a id="962" class="Symbol">:</a> <a id="964" href="Tactic.RingSolver.Core.Expression.html#945" class="Bound">A</a> <a id="966" class="Symbol">→</a> <a id="968" href="Algebra.Bundles.html#20314" class="Field">Carrier</a><a id="975" class="Symbol">)</a> <a id="977" class="Keyword">where</a>

  <a id="986" class="Keyword">open</a> <a id="991" class="Keyword">import</a> <a id="998" href="Algebra.Definitions.RawSemiring.html" class="Module">Algebra.Definitions.RawSemiring</a> <a id="1030" href="Algebra.Bundles.html#20483" class="Function">rawSemiring</a>
    <a id="1046" class="Keyword">using</a> <a id="1052" class="Symbol">(</a><a id="1053" href="Algebra.Definitions.RawSemiring.html#1337" class="Function Operator">_^′_</a><a id="1057" class="Symbol">)</a>

  <a id="1062" href="Tactic.RingSolver.Core.Expression.html#1062" class="Function Operator">⟦_⟧</a> <a id="1066" class="Symbol">:</a> <a id="1068" class="Symbol">∀</a> <a id="1070" class="Symbol">{</a><a id="1071" href="Tactic.RingSolver.Core.Expression.html#1071" class="Bound">n</a><a id="1072" class="Symbol">}</a> <a id="1074" class="Symbol">→</a> <a id="1076" href="Tactic.RingSolver.Core.Expression.html#502" class="Datatype">Expr</a> <a id="1081" href="Tactic.RingSolver.Core.Expression.html#945" class="Bound">A</a> <a id="1083" href="Tactic.RingSolver.Core.Expression.html#1071" class="Bound">n</a> <a id="1085" class="Symbol">→</a> <a id="1087" href="Data.Vec.Base.html#1007" class="Datatype">Vec</a> <a id="1091" href="Algebra.Bundles.html#20314" class="Field">Carrier</a> <a id="1099" href="Tactic.RingSolver.Core.Expression.html#1071" class="Bound">n</a> <a id="1101" class="Symbol">→</a> <a id="1103" href="Algebra.Bundles.html#20314" class="Field">Carrier</a>
  <a id="1113" href="Tactic.RingSolver.Core.Expression.html#1062" class="Function Operator">⟦</a> <a id="1115" href="Tactic.RingSolver.Core.Expression.html#547" class="InductiveConstructor">Κ</a> <a id="1117" href="Tactic.RingSolver.Core.Expression.html#1117" class="Bound">x</a>   <a id="1121" href="Tactic.RingSolver.Core.Expression.html#1062" class="Function Operator">⟧</a> <a id="1123" href="Tactic.RingSolver.Core.Expression.html#1123" class="Bound">ρ</a> <a id="1125" class="Symbol">=</a> <a id="1127" href="Tactic.RingSolver.Core.Expression.html#957" class="Bound Operator">⟦</a> <a id="1129" href="Tactic.RingSolver.Core.Expression.html#1117" class="Bound">x</a> <a id="1131" href="Tactic.RingSolver.Core.Expression.html#957" class="Bound Operator">⟧ᵣ</a>
  <a id="1136" href="Tactic.RingSolver.Core.Expression.html#1062" class="Function Operator">⟦</a> <a id="1138" href="Tactic.RingSolver.Core.Expression.html#598" class="InductiveConstructor">Ι</a> <a id="1140" href="Tactic.RingSolver.Core.Expression.html#1140" class="Bound">x</a>   <a id="1144" href="Tactic.RingSolver.Core.Expression.html#1062" class="Function Operator">⟧</a> <a id="1146" href="Tactic.RingSolver.Core.Expression.html#1146" class="Bound">ρ</a> <a id="1148" class="Symbol">=</a> <a id="1150" href="Data.Vec.Base.html#1614" class="Function">Vec.lookup</a> <a id="1161" href="Tactic.RingSolver.Core.Expression.html#1146" class="Bound">ρ</a> <a id="1163" href="Tactic.RingSolver.Core.Expression.html#1140" class="Bound">x</a>
  <a id="1167" href="Tactic.RingSolver.Core.Expression.html#1062" class="Function Operator">⟦</a> <a id="1169" href="Tactic.RingSolver.Core.Expression.html#1169" class="Bound">x</a> <a id="1171" href="Tactic.RingSolver.Core.Expression.html#649" class="InductiveConstructor Operator">⊕</a> <a id="1173" href="Tactic.RingSolver.Core.Expression.html#1173" class="Bound">y</a> <a id="1175" href="Tactic.RingSolver.Core.Expression.html#1062" class="Function Operator">⟧</a> <a id="1177" href="Tactic.RingSolver.Core.Expression.html#1177" class="Bound">ρ</a> <a id="1179" class="Symbol">=</a> <a id="1181" href="Tactic.RingSolver.Core.Expression.html#1062" class="Function Operator">⟦</a> <a id="1183" href="Tactic.RingSolver.Core.Expression.html#1169" class="Bound">x</a> <a id="1185" href="Tactic.RingSolver.Core.Expression.html#1062" class="Function Operator">⟧</a> <a id="1187" href="Tactic.RingSolver.Core.Expression.html#1177" class="Bound">ρ</a> <a id="1189" href="Algebra.Bundles.html#20362" class="Field Operator">+</a> <a id="1191" href="Tactic.RingSolver.Core.Expression.html#1062" class="Function Operator">⟦</a> <a id="1193" href="Tactic.RingSolver.Core.Expression.html#1173" class="Bound">y</a> <a id="1195" href="Tactic.RingSolver.Core.Expression.html#1062" class="Function Operator">⟧</a> <a id="1197" href="Tactic.RingSolver.Core.Expression.html#1177" class="Bound">ρ</a>
  <a id="1201" href="Tactic.RingSolver.Core.Expression.html#1062" class="Function Operator">⟦</a> <a id="1203" href="Tactic.RingSolver.Core.Expression.html#1203" class="Bound">x</a> <a id="1205" href="Tactic.RingSolver.Core.Expression.html#700" class="InductiveConstructor Operator">⊗</a> <a id="1207" href="Tactic.RingSolver.Core.Expression.html#1207" class="Bound">y</a> <a id="1209" href="Tactic.RingSolver.Core.Expression.html#1062" class="Function Operator">⟧</a> <a id="1211" href="Tactic.RingSolver.Core.Expression.html#1211" class="Bound">ρ</a> <a id="1213" class="Symbol">=</a> <a id="1215" href="Tactic.RingSolver.Core.Expression.html#1062" class="Function Operator">⟦</a> <a id="1217" href="Tactic.RingSolver.Core.Expression.html#1203" class="Bound">x</a> <a id="1219" href="Tactic.RingSolver.Core.Expression.html#1062" class="Function Operator">⟧</a> <a id="1221" href="Tactic.RingSolver.Core.Expression.html#1211" class="Bound">ρ</a> <a id="1223" href="Algebra.Bundles.html#20388" class="Field Operator">*</a> <a id="1225" href="Tactic.RingSolver.Core.Expression.html#1062" class="Function Operator">⟦</a> <a id="1227" href="Tactic.RingSolver.Core.Expression.html#1207" class="Bound">y</a> <a id="1229" href="Tactic.RingSolver.Core.Expression.html#1062" class="Function Operator">⟧</a> <a id="1231" href="Tactic.RingSolver.Core.Expression.html#1211" class="Bound">ρ</a>
  <a id="1235" href="Tactic.RingSolver.Core.Expression.html#1062" class="Function Operator">⟦</a>   <a id="1239" href="Tactic.RingSolver.Core.Expression.html#814" class="InductiveConstructor Operator">⊝</a> <a id="1241" href="Tactic.RingSolver.Core.Expression.html#1241" class="Bound">x</a> <a id="1243" href="Tactic.RingSolver.Core.Expression.html#1062" class="Function Operator">⟧</a> <a id="1245" href="Tactic.RingSolver.Core.Expression.html#1245" class="Bound">ρ</a> <a id="1247" class="Symbol">=</a> <a id="1249" href="Algebra.Bundles.html#20414" class="Field Operator">-</a> <a id="1251" href="Tactic.RingSolver.Core.Expression.html#1062" class="Function Operator">⟦</a> <a id="1253" href="Tactic.RingSolver.Core.Expression.html#1241" class="Bound">x</a> <a id="1255" href="Tactic.RingSolver.Core.Expression.html#1062" class="Function Operator">⟧</a> <a id="1257" href="Tactic.RingSolver.Core.Expression.html#1245" class="Bound">ρ</a>
  <a id="1261" href="Tactic.RingSolver.Core.Expression.html#1062" class="Function Operator">⟦</a> <a id="1263" href="Tactic.RingSolver.Core.Expression.html#1263" class="Bound">x</a> <a id="1265" href="Tactic.RingSolver.Core.Expression.html#757" class="InductiveConstructor Operator">⊛</a> <a id="1267" href="Tactic.RingSolver.Core.Expression.html#1267" class="Bound">i</a> <a id="1269" href="Tactic.RingSolver.Core.Expression.html#1062" class="Function Operator">⟧</a> <a id="1271" href="Tactic.RingSolver.Core.Expression.html#1271" class="Bound">ρ</a> <a id="1273" class="Symbol">=</a> <a id="1275" href="Tactic.RingSolver.Core.Expression.html#1062" class="Function Operator">⟦</a> <a id="1277" href="Tactic.RingSolver.Core.Expression.html#1263" class="Bound">x</a> <a id="1279" href="Tactic.RingSolver.Core.Expression.html#1062" class="Function Operator">⟧</a> <a id="1281" href="Tactic.RingSolver.Core.Expression.html#1271" class="Bound">ρ</a> <a id="1283" href="Algebra.Definitions.RawSemiring.html#1337" class="Function Operator">^′</a> <a id="1286" href="Tactic.RingSolver.Core.Expression.html#1267" class="Bound">i</a>
</pre></body></html>