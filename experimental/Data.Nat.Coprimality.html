<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Data.Nat.Coprimality</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- The Agda standard library</a>
<a id="103" class="Comment">--</a>
<a id="106" class="Comment">-- Coprimality</a>
<a id="121" class="Comment">------------------------------------------------------------------------</a>

<a id="195" class="Symbol">{-#</a> <a id="199" class="Keyword">OPTIONS</a> <a id="207" class="Pragma">--cubical-compatible</a> <a id="228" class="Pragma">--safe</a> <a id="235" class="Symbol">#-}</a>

<a id="240" class="Keyword">module</a> <a id="247" href="Data.Nat.Coprimality.html" class="Module">Data.Nat.Coprimality</a> <a id="268" class="Keyword">where</a>

<a id="275" class="Keyword">open</a> <a id="280" class="Keyword">import</a> <a id="287" href="Data.Empty.html" class="Module">Data.Empty</a>
<a id="298" class="Keyword">open</a> <a id="303" class="Keyword">import</a> <a id="310" href="Data.Fin.Base.html" class="Module">Data.Fin.Base</a> <a id="324" class="Keyword">using</a> <a id="330" class="Symbol">(</a><a id="331" href="Data.Fin.Base.html#1320" class="Function">toℕ</a><a id="334" class="Symbol">;</a> <a id="336" href="Data.Fin.Base.html#2011" class="Function">fromℕ&lt;</a><a id="342" class="Symbol">)</a>
<a id="344" class="Keyword">open</a> <a id="349" class="Keyword">import</a> <a id="356" href="Data.Fin.Properties.html" class="Module">Data.Fin.Properties</a> <a id="376" class="Keyword">using</a> <a id="382" class="Symbol">(</a><a id="383" href="Data.Fin.Properties.html#7294" class="Function">toℕ-fromℕ&lt;</a><a id="393" class="Symbol">)</a>
<a id="395" class="Keyword">open</a> <a id="400" class="Keyword">import</a> <a id="407" href="Data.Nat.Base.html" class="Module">Data.Nat.Base</a>
<a id="421" class="Keyword">open</a> <a id="426" class="Keyword">import</a> <a id="433" href="Data.Nat.Divisibility.html" class="Module">Data.Nat.Divisibility</a>
<a id="455" class="Keyword">open</a> <a id="460" class="Keyword">import</a> <a id="467" href="Data.Nat.GCD.html" class="Module">Data.Nat.GCD</a>
<a id="480" class="Keyword">open</a> <a id="485" class="Keyword">import</a> <a id="492" href="Data.Nat.GCD.Lemmas.html" class="Module">Data.Nat.GCD.Lemmas</a>
<a id="512" class="Keyword">open</a> <a id="517" class="Keyword">import</a> <a id="524" href="Data.Nat.Primality.html" class="Module">Data.Nat.Primality</a>
<a id="543" class="Keyword">open</a> <a id="548" class="Keyword">import</a> <a id="555" href="Data.Nat.Properties.html" class="Module">Data.Nat.Properties</a>
<a id="575" class="Keyword">open</a> <a id="580" class="Keyword">import</a> <a id="587" href="Data.Nat.DivMod.html" class="Module">Data.Nat.DivMod</a>
<a id="603" class="Keyword">open</a> <a id="608" class="Keyword">import</a> <a id="615" href="Data.Product.html" class="Module">Data.Product</a> <a id="628" class="Symbol">as</a> <a id="631" class="Module">Prod</a>
<a id="636" class="Keyword">open</a> <a id="641" class="Keyword">import</a> <a id="648" href="Function.html" class="Module">Function</a>
<a id="657" class="Keyword">open</a> <a id="662" class="Keyword">import</a> <a id="669" href="Level.html" class="Module">Level</a> <a id="675" class="Keyword">using</a> <a id="681" class="Symbol">(</a><a id="682" href="Level.html#521" class="Function">0ℓ</a><a id="684" class="Symbol">)</a>
<a id="686" class="Keyword">open</a> <a id="691" class="Keyword">import</a> <a id="698" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a> <a id="736" class="Symbol">as</a> <a id="739" class="Module">P</a>
  <a id="743" class="Keyword">using</a> <a id="749" class="Symbol">(</a><a id="750" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">_≡_</a><a id="753" class="Symbol">;</a> <a id="755" href="Relation.Binary.PropositionalEquality.Core.html#839" class="Function Operator">_≢_</a><a id="758" class="Symbol">;</a> <a id="760" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a><a id="764" class="Symbol">;</a> <a id="766" href="Relation.Binary.PropositionalEquality.Core.html#1738" class="Function">trans</a><a id="771" class="Symbol">;</a> <a id="773" href="Relation.Binary.PropositionalEquality.Core.html#1139" class="Function">cong</a><a id="777" class="Symbol">;</a> <a id="779" href="Relation.Binary.PropositionalEquality.Core.html#1789" class="Function">subst</a><a id="784" class="Symbol">;</a> <a id="786" class="Keyword">module</a> <a id="793" href="Relation.Binary.PropositionalEquality.Core.html#2717" class="Module">≡-Reasoning</a><a id="804" class="Symbol">)</a>
<a id="806" class="Keyword">open</a> <a id="811" class="Keyword">import</a> <a id="818" href="Relation.Nullary.html" class="Module">Relation.Nullary</a> <a id="835" class="Symbol">as</a> <a id="838" class="Module">Nullary</a> <a id="846" class="Keyword">hiding</a> <a id="853" class="Symbol">(</a><a id="854" href="Relation.Nullary.html#1847" class="Function">recompute</a><a id="863" class="Symbol">)</a>
<a id="865" class="Keyword">open</a> <a id="870" class="Keyword">import</a> <a id="877" href="Relation.Nullary.Negation.html" class="Module">Relation.Nullary.Negation</a> <a id="903" class="Keyword">using</a> <a id="909" class="Symbol">(</a><a id="910" href="Relation.Nullary.Negation.Core.html#787" class="Function">contradiction</a><a id="923" class="Symbol">)</a>
<a id="925" class="Keyword">open</a> <a id="930" class="Keyword">import</a> <a id="937" href="Relation.Binary.html" class="Module">Relation.Binary</a>

<a id="954" class="Keyword">open</a> <a id="959" href="Data.Nat.Properties.html#13839" class="Module">≤-Reasoning</a>

<a id="972" class="Comment">------------------------------------------------------------------------</a>
<a id="1045" class="Comment">-- Definition</a>
<a id="1059" class="Comment">--</a>
<a id="1062" class="Comment">-- Coprime m n is inhabited iff m and n are coprime (relatively</a>
<a id="1126" class="Comment">-- prime), i.e. if their only common divisor is 1.</a>

<a id="Coprime"></a><a id="1178" href="Data.Nat.Coprimality.html#1178" class="Function">Coprime</a> <a id="1186" class="Symbol">:</a> <a id="1188" href="Relation.Binary.Core.html#891" class="Function">Rel</a> <a id="1192" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a> <a id="1194" href="Level.html#521" class="Function">0ℓ</a>
<a id="1197" href="Data.Nat.Coprimality.html#1178" class="Function">Coprime</a> <a id="1205" href="Data.Nat.Coprimality.html#1205" class="Bound">m</a> <a id="1207" href="Data.Nat.Coprimality.html#1207" class="Bound">n</a> <a id="1209" class="Symbol">=</a> <a id="1211" class="Symbol">∀</a> <a id="1213" class="Symbol">{</a><a id="1214" href="Data.Nat.Coprimality.html#1214" class="Bound">i</a><a id="1215" class="Symbol">}</a> <a id="1217" class="Symbol">→</a> <a id="1219" href="Data.Nat.Coprimality.html#1214" class="Bound">i</a> <a id="1221" href="Data.Nat.Divisibility.Core.html#1146" class="Record Operator">∣</a> <a id="1223" href="Data.Nat.Coprimality.html#1205" class="Bound">m</a> <a id="1225" href="Data.Product.html#1176" class="Function Operator">×</a> <a id="1227" href="Data.Nat.Coprimality.html#1214" class="Bound">i</a> <a id="1229" href="Data.Nat.Divisibility.Core.html#1146" class="Record Operator">∣</a> <a id="1231" href="Data.Nat.Coprimality.html#1207" class="Bound">n</a> <a id="1233" class="Symbol">→</a> <a id="1235" href="Data.Nat.Coprimality.html#1214" class="Bound">i</a> <a id="1237" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="1239" class="Number">1</a>

<a id="1242" class="Comment">------------------------------------------------------------------------</a>
<a id="1315" class="Comment">-- Relationship between GCD and coprimality</a>

<a id="coprime⇒GCD≡1"></a><a id="1360" href="Data.Nat.Coprimality.html#1360" class="Function">coprime⇒GCD≡1</a> <a id="1374" class="Symbol">:</a> <a id="1376" class="Symbol">∀</a> <a id="1378" class="Symbol">{</a><a id="1379" href="Data.Nat.Coprimality.html#1379" class="Bound">m</a> <a id="1381" href="Data.Nat.Coprimality.html#1381" class="Bound">n</a><a id="1382" class="Symbol">}</a> <a id="1384" class="Symbol">→</a> <a id="1386" href="Data.Nat.Coprimality.html#1178" class="Function">Coprime</a> <a id="1394" href="Data.Nat.Coprimality.html#1379" class="Bound">m</a> <a id="1396" href="Data.Nat.Coprimality.html#1381" class="Bound">n</a> <a id="1398" class="Symbol">→</a> <a id="1400" href="Data.Nat.GCD.html#6265" class="Record">GCD</a> <a id="1404" href="Data.Nat.Coprimality.html#1379" class="Bound">m</a> <a id="1406" href="Data.Nat.Coprimality.html#1381" class="Bound">n</a> <a id="1408" class="Number">1</a>
<a id="1410" href="Data.Nat.Coprimality.html#1360" class="Function">coprime⇒GCD≡1</a> <a id="1424" class="Symbol">{</a><a id="1425" href="Data.Nat.Coprimality.html#1425" class="Bound">m</a><a id="1426" class="Symbol">}</a> <a id="1428" class="Symbol">{</a><a id="1429" href="Data.Nat.Coprimality.html#1429" class="Bound">n</a><a id="1430" class="Symbol">}</a> <a id="1432" href="Data.Nat.Coprimality.html#1432" class="Bound">c</a> <a id="1434" class="Symbol">=</a> <a id="1436" href="Data.Nat.GCD.html#6311" class="InductiveConstructor">GCD.is</a> <a id="1443" class="Symbol">(</a><a id="1444" href="Data.Nat.Divisibility.html#3831" class="Function Operator">1∣</a> <a id="1447" href="Data.Nat.Coprimality.html#1425" class="Bound">m</a> <a id="1449" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="1451" href="Data.Nat.Divisibility.html#3831" class="Function Operator">1∣</a> <a id="1454" href="Data.Nat.Coprimality.html#1429" class="Bound">n</a><a id="1455" class="Symbol">)</a> <a id="1457" class="Symbol">(</a><a id="1458" href="Data.Nat.Divisibility.html#2224" class="Function">∣-reflexive</a> <a id="1470" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="1472" href="Data.Nat.Coprimality.html#1432" class="Bound">c</a><a id="1473" class="Symbol">)</a>

<a id="GCD≡1⇒coprime"></a><a id="1476" href="Data.Nat.Coprimality.html#1476" class="Function">GCD≡1⇒coprime</a> <a id="1490" class="Symbol">:</a> <a id="1492" class="Symbol">∀</a> <a id="1494" class="Symbol">{</a><a id="1495" href="Data.Nat.Coprimality.html#1495" class="Bound">m</a> <a id="1497" href="Data.Nat.Coprimality.html#1497" class="Bound">n</a><a id="1498" class="Symbol">}</a> <a id="1500" class="Symbol">→</a> <a id="1502" href="Data.Nat.GCD.html#6265" class="Record">GCD</a> <a id="1506" href="Data.Nat.Coprimality.html#1495" class="Bound">m</a> <a id="1508" href="Data.Nat.Coprimality.html#1497" class="Bound">n</a> <a id="1510" class="Number">1</a> <a id="1512" class="Symbol">→</a> <a id="1514" href="Data.Nat.Coprimality.html#1178" class="Function">Coprime</a> <a id="1522" href="Data.Nat.Coprimality.html#1495" class="Bound">m</a> <a id="1524" href="Data.Nat.Coprimality.html#1497" class="Bound">n</a>
<a id="1526" href="Data.Nat.Coprimality.html#1476" class="Function">GCD≡1⇒coprime</a> <a id="1540" href="Data.Nat.Coprimality.html#1540" class="Bound">g</a> <a id="1542" href="Data.Nat.Coprimality.html#1542" class="Bound">cd</a> <a id="1545" class="Keyword">with</a> <a id="1550" href="Data.Nat.GCD.html#6543" class="Field">GCD.greatest</a> <a id="1563" href="Data.Nat.Coprimality.html#1540" class="Bound">g</a> <a id="1565" href="Data.Nat.Coprimality.html#1542" class="Bound">cd</a>
<a id="1568" class="Symbol">...</a> <a id="1572" class="Symbol">|</a> <a id="1574" href="Data.Nat.Divisibility.Core.html#1186" class="InductiveConstructor">divides</a> <a id="1582" href="Data.Nat.Coprimality.html#1582" class="Bound">q</a> <a id="1584" href="Data.Nat.Coprimality.html#1584" class="Bound">eq</a> <a id="1587" class="Symbol">=</a> <a id="1589" href="Data.Nat.Properties.html#25797" class="Function">m*n≡1⇒n≡1</a> <a id="1599" href="Data.Nat.Coprimality.html#1582" class="Bound">q</a> <a id="1601" class="Symbol">_</a> <a id="1603" class="Symbol">(</a><a id="1604" href="Relation.Binary.PropositionalEquality.Core.html#1693" class="Function">P.sym</a> <a id="1610" href="Data.Nat.Coprimality.html#1584" class="Bound">eq</a><a id="1612" class="Symbol">)</a>

<a id="coprime⇒gcd≡1"></a><a id="1615" href="Data.Nat.Coprimality.html#1615" class="Function">coprime⇒gcd≡1</a> <a id="1629" class="Symbol">:</a> <a id="1631" class="Symbol">∀</a> <a id="1633" class="Symbol">{</a><a id="1634" href="Data.Nat.Coprimality.html#1634" class="Bound">m</a> <a id="1636" href="Data.Nat.Coprimality.html#1636" class="Bound">n</a><a id="1637" class="Symbol">}</a> <a id="1639" class="Symbol">→</a> <a id="1641" href="Data.Nat.Coprimality.html#1178" class="Function">Coprime</a> <a id="1649" href="Data.Nat.Coprimality.html#1634" class="Bound">m</a> <a id="1651" href="Data.Nat.Coprimality.html#1636" class="Bound">n</a> <a id="1653" class="Symbol">→</a> <a id="1655" href="Data.Nat.GCD.html#1567" class="Function">gcd</a> <a id="1659" href="Data.Nat.Coprimality.html#1634" class="Bound">m</a> <a id="1661" href="Data.Nat.Coprimality.html#1636" class="Bound">n</a> <a id="1663" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="1665" class="Number">1</a>
<a id="1667" href="Data.Nat.Coprimality.html#1615" class="Function">coprime⇒gcd≡1</a> <a id="1681" href="Data.Nat.Coprimality.html#1681" class="Bound">coprime</a> <a id="1689" class="Symbol">=</a> <a id="1691" href="Data.Nat.GCD.html#6740" class="Function">GCD.unique</a> <a id="1702" class="Symbol">(</a><a id="1703" href="Data.Nat.GCD.html#7755" class="Function">gcd-GCD</a> <a id="1711" class="Symbol">_</a> <a id="1713" class="Symbol">_)</a> <a id="1716" class="Symbol">(</a><a id="1717" href="Data.Nat.Coprimality.html#1360" class="Function">coprime⇒GCD≡1</a> <a id="1731" href="Data.Nat.Coprimality.html#1681" class="Bound">coprime</a><a id="1738" class="Symbol">)</a>

<a id="gcd≡1⇒coprime"></a><a id="1741" href="Data.Nat.Coprimality.html#1741" class="Function">gcd≡1⇒coprime</a> <a id="1755" class="Symbol">:</a> <a id="1757" class="Symbol">∀</a> <a id="1759" class="Symbol">{</a><a id="1760" href="Data.Nat.Coprimality.html#1760" class="Bound">m</a> <a id="1762" href="Data.Nat.Coprimality.html#1762" class="Bound">n</a><a id="1763" class="Symbol">}</a> <a id="1765" class="Symbol">→</a> <a id="1767" href="Data.Nat.GCD.html#1567" class="Function">gcd</a> <a id="1771" href="Data.Nat.Coprimality.html#1760" class="Bound">m</a> <a id="1773" href="Data.Nat.Coprimality.html#1762" class="Bound">n</a> <a id="1775" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="1777" class="Number">1</a> <a id="1779" class="Symbol">→</a> <a id="1781" href="Data.Nat.Coprimality.html#1178" class="Function">Coprime</a> <a id="1789" href="Data.Nat.Coprimality.html#1760" class="Bound">m</a> <a id="1791" href="Data.Nat.Coprimality.html#1762" class="Bound">n</a>
<a id="1793" href="Data.Nat.Coprimality.html#1741" class="Function">gcd≡1⇒coprime</a> <a id="1807" href="Data.Nat.Coprimality.html#1807" class="Bound">gcd≡1</a> <a id="1813" class="Symbol">=</a> <a id="1815" href="Data.Nat.Coprimality.html#1476" class="Function">GCD≡1⇒coprime</a> <a id="1829" class="Symbol">(</a><a id="1830" href="Relation.Binary.PropositionalEquality.Core.html#1789" class="Function">subst</a> <a id="1836" class="Symbol">(</a><a id="1837" href="Data.Nat.GCD.html#6265" class="Record">GCD</a> <a id="1841" class="Symbol">_</a> <a id="1843" class="Symbol">_)</a> <a id="1846" href="Data.Nat.Coprimality.html#1807" class="Bound">gcd≡1</a> <a id="1852" class="Symbol">(</a><a id="1853" href="Data.Nat.GCD.html#7755" class="Function">gcd-GCD</a> <a id="1861" class="Symbol">_</a> <a id="1863" class="Symbol">_))</a>

<a id="coprime-/gcd"></a><a id="1868" href="Data.Nat.Coprimality.html#1868" class="Function">coprime-/gcd</a> <a id="1881" class="Symbol">:</a> <a id="1883" class="Symbol">∀</a> <a id="1885" href="Data.Nat.Coprimality.html#1885" class="Bound">m</a> <a id="1887" href="Data.Nat.Coprimality.html#1887" class="Bound">n</a> <a id="1889" class="Symbol">.{{</a><a id="1892" href="Data.Nat.Coprimality.html#1892" class="Bound">_</a> <a id="1894" class="Symbol">:</a> <a id="1896" href="Data.Nat.Base.html#2499" class="Record">NonZero</a> <a id="1904" class="Symbol">(</a><a id="1905" href="Data.Nat.GCD.html#1567" class="Function">gcd</a> <a id="1909" href="Data.Nat.Coprimality.html#1885" class="Bound">m</a> <a id="1911" href="Data.Nat.Coprimality.html#1887" class="Bound">n</a><a id="1912" class="Symbol">)}}</a> <a id="1916" class="Symbol">→</a>
               <a id="1933" href="Data.Nat.Coprimality.html#1178" class="Function">Coprime</a> <a id="1941" class="Symbol">(</a><a id="1942" href="Data.Nat.Coprimality.html#1885" class="Bound">m</a> <a id="1944" href="Data.Nat.Base.html#4061" class="Function Operator">/</a> <a id="1946" href="Data.Nat.GCD.html#1567" class="Function">gcd</a> <a id="1950" href="Data.Nat.Coprimality.html#1885" class="Bound">m</a> <a id="1952" href="Data.Nat.Coprimality.html#1887" class="Bound">n</a><a id="1953" class="Symbol">)</a> <a id="1955" class="Symbol">(</a><a id="1956" href="Data.Nat.Coprimality.html#1887" class="Bound">n</a> <a id="1958" href="Data.Nat.Base.html#4061" class="Function Operator">/</a> <a id="1960" href="Data.Nat.GCD.html#1567" class="Function">gcd</a> <a id="1964" href="Data.Nat.Coprimality.html#1885" class="Bound">m</a> <a id="1966" href="Data.Nat.Coprimality.html#1887" class="Bound">n</a><a id="1967" class="Symbol">)</a>
<a id="1969" href="Data.Nat.Coprimality.html#1868" class="Function">coprime-/gcd</a> <a id="1982" href="Data.Nat.Coprimality.html#1982" class="Bound">m</a> <a id="1984" href="Data.Nat.Coprimality.html#1984" class="Bound">n</a> <a id="1986" class="Symbol">=</a> <a id="1988" href="Data.Nat.Coprimality.html#1476" class="Function">GCD≡1⇒coprime</a> <a id="2002" class="Symbol">(</a><a id="2003" href="Data.Nat.GCD.html#8751" class="Function">GCD-/gcd</a> <a id="2012" href="Data.Nat.Coprimality.html#1982" class="Bound">m</a> <a id="2014" href="Data.Nat.Coprimality.html#1984" class="Bound">n</a><a id="2015" class="Symbol">)</a>

<a id="2018" class="Comment">------------------------------------------------------------------------</a>
<a id="2091" class="Comment">-- Relational properties of Coprime</a>

<a id="sym"></a><a id="2128" href="Data.Nat.Coprimality.html#2128" class="Function">sym</a> <a id="2132" class="Symbol">:</a> <a id="2134" href="Relation.Binary.Definitions.html#1507" class="Function">Symmetric</a> <a id="2144" href="Data.Nat.Coprimality.html#1178" class="Function">Coprime</a>
<a id="2152" href="Data.Nat.Coprimality.html#2128" class="Function">sym</a> <a id="2156" href="Data.Nat.Coprimality.html#2156" class="Bound">c</a> <a id="2158" class="Symbol">=</a> <a id="2160" href="Data.Nat.Coprimality.html#2156" class="Bound">c</a> <a id="2162" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="2164" href="Data.Product.html#5376" class="Function">swap</a>

<a id="2170" class="Keyword">private</a>
  <a id="0≢1"></a><a id="2180" href="Data.Nat.Coprimality.html#2180" class="Function">0≢1</a> <a id="2184" class="Symbol">:</a> <a id="2186" class="Number">0</a> <a id="2188" href="Relation.Binary.PropositionalEquality.Core.html#839" class="Function Operator">≢</a> <a id="2190" class="Number">1</a>
  <a id="2194" href="Data.Nat.Coprimality.html#2180" class="Function">0≢1</a> <a id="2198" class="Symbol">()</a>

  <a id="2+≢1"></a><a id="2204" href="Data.Nat.Coprimality.html#2204" class="Function">2+≢1</a> <a id="2209" class="Symbol">:</a> <a id="2211" class="Symbol">∀</a> <a id="2213" class="Symbol">{</a><a id="2214" href="Data.Nat.Coprimality.html#2214" class="Bound">n</a><a id="2215" class="Symbol">}</a> <a id="2217" class="Symbol">→</a> <a id="2219" href="Agda.Builtin.Nat.html#217" class="InductiveConstructor">suc</a> <a id="2223" class="Symbol">(</a><a id="2224" href="Agda.Builtin.Nat.html#217" class="InductiveConstructor">suc</a> <a id="2228" href="Data.Nat.Coprimality.html#2214" class="Bound">n</a><a id="2229" class="Symbol">)</a> <a id="2231" href="Relation.Binary.PropositionalEquality.Core.html#839" class="Function Operator">≢</a> <a id="2233" class="Number">1</a>
  <a id="2237" href="Data.Nat.Coprimality.html#2204" class="Function">2+≢1</a> <a id="2242" class="Symbol">()</a>

<a id="coprime?"></a><a id="2246" href="Data.Nat.Coprimality.html#2246" class="Function">coprime?</a> <a id="2255" class="Symbol">:</a> <a id="2257" href="Relation.Binary.Definitions.html#5844" class="Function">Decidable</a> <a id="2267" href="Data.Nat.Coprimality.html#1178" class="Function">Coprime</a>
<a id="2275" href="Data.Nat.Coprimality.html#2246" class="Function">coprime?</a> <a id="2284" href="Data.Nat.Coprimality.html#2284" class="Bound">i</a> <a id="2286" href="Data.Nat.Coprimality.html#2286" class="Bound">j</a> <a id="2288" class="Keyword">with</a> <a id="2293" href="Data.Nat.GCD.html#7952" class="Function">mkGCD</a> <a id="2299" href="Data.Nat.Coprimality.html#2284" class="Bound">i</a> <a id="2301" href="Data.Nat.Coprimality.html#2286" class="Bound">j</a>
<a id="2303" class="Symbol">...</a> <a id="2307" class="Symbol">|</a> <a id="2309" class="Symbol">(</a><a id="2310" class="Number">0</a>           <a id="2322" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="2324" href="Data.Nat.Coprimality.html#2324" class="Bound">g</a><a id="2325" class="Symbol">)</a> <a id="2327" class="Symbol">=</a> <a id="2329" href="Relation.Nullary.html#1694" class="InductiveConstructor">no</a>  <a id="2333" class="Symbol">(</a><a id="2334" href="Data.Nat.Coprimality.html#2180" class="Function">0≢1</a>  <a id="2339" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="2341" href="Data.Nat.GCD.html#6740" class="Function">GCD.unique</a> <a id="2352" href="Data.Nat.Coprimality.html#2324" class="Bound">g</a> <a id="2354" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="2356" href="Data.Nat.Coprimality.html#1360" class="Function">coprime⇒GCD≡1</a><a id="2369" class="Symbol">)</a>
<a id="2371" class="Symbol">...</a> <a id="2375" class="Symbol">|</a> <a id="2377" class="Symbol">(</a><a id="2378" class="Number">1</a>           <a id="2390" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="2392" href="Data.Nat.Coprimality.html#2392" class="Bound">g</a><a id="2393" class="Symbol">)</a> <a id="2395" class="Symbol">=</a> <a id="2397" href="Relation.Nullary.html#1657" class="InductiveConstructor">yes</a> <a id="2401" class="Symbol">(</a><a id="2402" href="Data.Nat.Coprimality.html#1476" class="Function">GCD≡1⇒coprime</a> <a id="2416" href="Data.Nat.Coprimality.html#2392" class="Bound">g</a><a id="2417" class="Symbol">)</a>
<a id="2419" class="Symbol">...</a> <a id="2423" class="Symbol">|</a> <a id="2425" class="Symbol">(</a><a id="2426" href="Agda.Builtin.Nat.html#217" class="InductiveConstructor">suc</a> <a id="2430" class="Symbol">(</a><a id="2431" href="Agda.Builtin.Nat.html#217" class="InductiveConstructor">suc</a> <a id="2435" href="Data.Nat.Coprimality.html#2435" class="Bound">d</a><a id="2436" class="Symbol">)</a> <a id="2438" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="2440" href="Data.Nat.Coprimality.html#2440" class="Bound">g</a><a id="2441" class="Symbol">)</a> <a id="2443" class="Symbol">=</a> <a id="2445" href="Relation.Nullary.html#1694" class="InductiveConstructor">no</a>  <a id="2449" class="Symbol">(</a><a id="2450" href="Data.Nat.Coprimality.html#2204" class="Function">2+≢1</a> <a id="2455" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="2457" href="Data.Nat.GCD.html#6740" class="Function">GCD.unique</a> <a id="2468" href="Data.Nat.Coprimality.html#2440" class="Bound">g</a> <a id="2470" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="2472" href="Data.Nat.Coprimality.html#1360" class="Function">coprime⇒GCD≡1</a><a id="2485" class="Symbol">)</a>

<a id="2488" class="Comment">------------------------------------------------------------------------</a>
<a id="2561" class="Comment">-- Other basic properties</a>

<a id="2588" class="Comment">-- Everything is coprime to 1.</a>

<a id="1-coprimeTo"></a><a id="2620" href="Data.Nat.Coprimality.html#2620" class="Function">1-coprimeTo</a> <a id="2632" class="Symbol">:</a> <a id="2634" class="Symbol">∀</a> <a id="2636" href="Data.Nat.Coprimality.html#2636" class="Bound">m</a> <a id="2638" class="Symbol">→</a> <a id="2640" href="Data.Nat.Coprimality.html#1178" class="Function">Coprime</a> <a id="2648" class="Number">1</a> <a id="2650" href="Data.Nat.Coprimality.html#2636" class="Bound">m</a>
<a id="2652" href="Data.Nat.Coprimality.html#2620" class="Function">1-coprimeTo</a> <a id="2664" href="Data.Nat.Coprimality.html#2664" class="Bound">m</a> <a id="2666" class="Symbol">=</a> <a id="2668" href="Data.Nat.Divisibility.html#3998" class="Function">∣1⇒≡1</a> <a id="2674" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="2676" href="Agda.Builtin.Sigma.html#234" class="Field">proj₁</a>

<a id="2683" class="Comment">-- Nothing except for 1 is coprime to 0.</a>

<a id="0-coprimeTo-m⇒m≡1"></a><a id="2725" href="Data.Nat.Coprimality.html#2725" class="Function">0-coprimeTo-m⇒m≡1</a> <a id="2743" class="Symbol">:</a> <a id="2745" class="Symbol">∀</a> <a id="2747" class="Symbol">{</a><a id="2748" href="Data.Nat.Coprimality.html#2748" class="Bound">m</a><a id="2749" class="Symbol">}</a> <a id="2751" class="Symbol">→</a> <a id="2753" href="Data.Nat.Coprimality.html#1178" class="Function">Coprime</a> <a id="2761" class="Number">0</a> <a id="2763" href="Data.Nat.Coprimality.html#2748" class="Bound">m</a> <a id="2765" class="Symbol">→</a> <a id="2767" href="Data.Nat.Coprimality.html#2748" class="Bound">m</a> <a id="2769" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="2771" class="Number">1</a>
<a id="2773" href="Data.Nat.Coprimality.html#2725" class="Function">0-coprimeTo-m⇒m≡1</a> <a id="2791" class="Symbol">{</a><a id="2792" href="Data.Nat.Coprimality.html#2792" class="Bound">m</a><a id="2793" class="Symbol">}</a> <a id="2795" href="Data.Nat.Coprimality.html#2795" class="Bound">c</a> <a id="2797" class="Symbol">=</a> <a id="2799" href="Data.Nat.Coprimality.html#2795" class="Bound">c</a> <a id="2801" class="Symbol">(</a><a id="2802" href="Data.Nat.Coprimality.html#2792" class="Bound">m</a> <a id="2804" href="Data.Nat.Divisibility.html#3889" class="Function Operator">∣0</a> <a id="2807" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="2809" href="Data.Nat.Divisibility.html#2304" class="Function">∣-refl</a><a id="2815" class="Symbol">)</a>

<a id="¬0-coprimeTo-2+"></a><a id="2818" href="Data.Nat.Coprimality.html#2818" class="Function">¬0-coprimeTo-2+</a> <a id="2834" class="Symbol">:</a> <a id="2836" class="Symbol">∀</a> <a id="2838" class="Symbol">{</a><a id="2839" href="Data.Nat.Coprimality.html#2839" class="Bound">n</a><a id="2840" class="Symbol">}</a> <a id="2842" class="Symbol">→</a> <a id="2844" href="Relation.Nullary.html#665" class="Function Operator">¬</a> <a id="2846" href="Data.Nat.Coprimality.html#1178" class="Function">Coprime</a> <a id="2854" class="Number">0</a> <a id="2856" class="Symbol">(</a><a id="2857" class="Number">2</a> <a id="2859" href="Agda.Builtin.Nat.html#319" class="Primitive Operator">+</a> <a id="2861" href="Data.Nat.Coprimality.html#2839" class="Bound">n</a><a id="2862" class="Symbol">)</a>
<a id="2864" href="Data.Nat.Coprimality.html#2818" class="Function">¬0-coprimeTo-2+</a> <a id="2880" href="Data.Nat.Coprimality.html#2880" class="Bound">coprime</a> <a id="2888" class="Symbol">=</a> <a id="2890" href="Relation.Nullary.Negation.Core.html#787" class="Function">contradiction</a> <a id="2904" class="Symbol">(</a><a id="2905" href="Data.Nat.Coprimality.html#2725" class="Function">0-coprimeTo-m⇒m≡1</a> <a id="2923" href="Data.Nat.Coprimality.html#2880" class="Bound">coprime</a><a id="2930" class="Symbol">)</a> <a id="2932" class="Symbol">λ()</a>

<a id="2937" class="Comment">-- If m and n are coprime, then n + m and n are also coprime.</a>

<a id="coprime-+"></a><a id="3000" href="Data.Nat.Coprimality.html#3000" class="Function">coprime-+</a> <a id="3010" class="Symbol">:</a> <a id="3012" class="Symbol">∀</a> <a id="3014" class="Symbol">{</a><a id="3015" href="Data.Nat.Coprimality.html#3015" class="Bound">m</a> <a id="3017" href="Data.Nat.Coprimality.html#3017" class="Bound">n</a><a id="3018" class="Symbol">}</a> <a id="3020" class="Symbol">→</a> <a id="3022" href="Data.Nat.Coprimality.html#1178" class="Function">Coprime</a> <a id="3030" href="Data.Nat.Coprimality.html#3015" class="Bound">m</a> <a id="3032" href="Data.Nat.Coprimality.html#3017" class="Bound">n</a> <a id="3034" class="Symbol">→</a> <a id="3036" href="Data.Nat.Coprimality.html#1178" class="Function">Coprime</a> <a id="3044" class="Symbol">(</a><a id="3045" href="Data.Nat.Coprimality.html#3017" class="Bound">n</a> <a id="3047" href="Agda.Builtin.Nat.html#319" class="Primitive Operator">+</a> <a id="3049" href="Data.Nat.Coprimality.html#3015" class="Bound">m</a><a id="3050" class="Symbol">)</a> <a id="3052" href="Data.Nat.Coprimality.html#3017" class="Bound">n</a>
<a id="3054" href="Data.Nat.Coprimality.html#3000" class="Function">coprime-+</a> <a id="3064" href="Data.Nat.Coprimality.html#3064" class="Bound">c</a> <a id="3066" class="Symbol">(</a><a id="3067" href="Data.Nat.Coprimality.html#3067" class="Bound">d₁</a> <a id="3070" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="3072" href="Data.Nat.Coprimality.html#3072" class="Bound">d₂</a><a id="3074" class="Symbol">)</a> <a id="3076" class="Symbol">=</a> <a id="3078" href="Data.Nat.Coprimality.html#3064" class="Bound">c</a> <a id="3080" class="Symbol">(</a><a id="3081" href="Data.Nat.Divisibility.html#4349" class="Function">∣m+n∣m⇒∣n</a> <a id="3091" href="Data.Nat.Coprimality.html#3067" class="Bound">d₁</a> <a id="3094" href="Data.Nat.Coprimality.html#3072" class="Bound">d₂</a> <a id="3097" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="3099" href="Data.Nat.Coprimality.html#3072" class="Bound">d₂</a><a id="3101" class="Symbol">)</a>

<a id="3104" class="Comment">-- Recomputable</a>

<a id="recompute"></a><a id="3121" href="Data.Nat.Coprimality.html#3121" class="Function">recompute</a> <a id="3131" class="Symbol">:</a> <a id="3133" class="Symbol">∀</a> <a id="3135" class="Symbol">{</a><a id="3136" href="Data.Nat.Coprimality.html#3136" class="Bound">n</a> <a id="3138" href="Data.Nat.Coprimality.html#3138" class="Bound">d</a><a id="3139" class="Symbol">}</a> <a id="3141" class="Symbol">→</a> <a id="3143" class="Symbol">.(</a><a id="3145" href="Data.Nat.Coprimality.html#1178" class="Function">Coprime</a> <a id="3153" href="Data.Nat.Coprimality.html#3136" class="Bound">n</a> <a id="3155" href="Data.Nat.Coprimality.html#3138" class="Bound">d</a><a id="3156" class="Symbol">)</a> <a id="3158" class="Symbol">→</a> <a id="3160" href="Data.Nat.Coprimality.html#1178" class="Function">Coprime</a> <a id="3168" href="Data.Nat.Coprimality.html#3136" class="Bound">n</a> <a id="3170" href="Data.Nat.Coprimality.html#3138" class="Bound">d</a>
<a id="3172" href="Data.Nat.Coprimality.html#3121" class="Function">recompute</a> <a id="3182" class="Symbol">{</a><a id="3183" href="Data.Nat.Coprimality.html#3183" class="Bound">n</a><a id="3184" class="Symbol">}</a> <a id="3186" class="Symbol">{</a><a id="3187" href="Data.Nat.Coprimality.html#3187" class="Bound">d</a><a id="3188" class="Symbol">}</a> <a id="3190" href="Data.Nat.Coprimality.html#3190" class="Bound">c</a> <a id="3192" class="Symbol">=</a> <a id="3194" href="Relation.Nullary.html#1847" class="Function">Nullary.recompute</a> <a id="3212" class="Symbol">(</a><a id="3213" href="Data.Nat.Coprimality.html#2246" class="Function">coprime?</a> <a id="3222" href="Data.Nat.Coprimality.html#3183" class="Bound">n</a> <a id="3224" href="Data.Nat.Coprimality.html#3187" class="Bound">d</a><a id="3225" class="Symbol">)</a> <a id="3227" href="Data.Nat.Coprimality.html#3190" class="Bound">c</a>

<a id="3230" class="Comment">------------------------------------------------------------------------</a>
<a id="3303" class="Comment">-- Relationship with Bezout&#39;s lemma</a>

<a id="3340" class="Comment">-- If the &quot;gcd&quot; in Bézout&#39;s identity is non-zero, then the &quot;other&quot;</a>
<a id="3407" class="Comment">-- divisors are coprime.</a>

<a id="Bézout-coprime"></a><a id="3433" href="Data.Nat.Coprimality.html#3433" class="Function">Bézout-coprime</a> <a id="3448" class="Symbol">:</a> <a id="3450" class="Symbol">∀</a> <a id="3452" class="Symbol">{</a><a id="3453" href="Data.Nat.Coprimality.html#3453" class="Bound">i</a> <a id="3455" href="Data.Nat.Coprimality.html#3455" class="Bound">j</a> <a id="3457" href="Data.Nat.Coprimality.html#3457" class="Bound">d</a><a id="3458" class="Symbol">}</a> <a id="3460" class="Symbol">.{{</a><a id="3463" href="Data.Nat.Coprimality.html#3463" class="Bound">_</a> <a id="3465" class="Symbol">:</a> <a id="3467" href="Data.Nat.Base.html#2499" class="Record">NonZero</a> <a id="3475" href="Data.Nat.Coprimality.html#3457" class="Bound">d</a><a id="3476" class="Symbol">}}</a> <a id="3479" class="Symbol">→</a>
                 <a id="3498" href="Data.Nat.GCD.html#9480" class="Datatype">Bézout.Identity</a> <a id="3514" href="Data.Nat.Coprimality.html#3457" class="Bound">d</a> <a id="3516" class="Symbol">(</a><a id="3517" href="Data.Nat.Coprimality.html#3453" class="Bound">i</a> <a id="3519" href="Agda.Builtin.Nat.html#522" class="Primitive Operator">*</a> <a id="3521" href="Data.Nat.Coprimality.html#3457" class="Bound">d</a><a id="3522" class="Symbol">)</a> <a id="3524" class="Symbol">(</a><a id="3525" href="Data.Nat.Coprimality.html#3455" class="Bound">j</a> <a id="3527" href="Agda.Builtin.Nat.html#522" class="Primitive Operator">*</a> <a id="3529" href="Data.Nat.Coprimality.html#3457" class="Bound">d</a><a id="3530" class="Symbol">)</a> <a id="3532" class="Symbol">→</a> <a id="3534" href="Data.Nat.Coprimality.html#1178" class="Function">Coprime</a> <a id="3542" href="Data.Nat.Coprimality.html#3453" class="Bound">i</a> <a id="3544" href="Data.Nat.Coprimality.html#3455" class="Bound">j</a>
<a id="3546" href="Data.Nat.Coprimality.html#3433" class="Function">Bézout-coprime</a> <a id="3561" class="Symbol">{</a><a id="3562" class="Argument">d</a> <a id="3564" class="Symbol">=</a> <a id="3566" href="Agda.Builtin.Nat.html#217" class="InductiveConstructor">suc</a> <a id="3570" class="Symbol">_}</a> <a id="3573" class="Symbol">(</a><a id="3574" href="Data.Nat.GCD.html#9519" class="InductiveConstructor">Bézout.+-</a> <a id="3584" href="Data.Nat.Coprimality.html#3584" class="Bound">x</a> <a id="3586" href="Data.Nat.Coprimality.html#3586" class="Bound">y</a> <a id="3588" href="Data.Nat.Coprimality.html#3588" class="Bound">eq</a><a id="3590" class="Symbol">)</a> <a id="3592" class="Symbol">(</a><a id="3593" href="Data.Nat.Divisibility.Core.html#1186" class="InductiveConstructor">divides</a> <a id="3601" href="Data.Nat.Coprimality.html#3601" class="Bound">q₁</a> <a id="3604" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a> <a id="3609" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="3611" href="Data.Nat.Divisibility.Core.html#1186" class="InductiveConstructor">divides</a> <a id="3619" href="Data.Nat.Coprimality.html#3619" class="Bound">q₂</a> <a id="3622" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a><a id="3626" class="Symbol">)</a> <a id="3628" class="Symbol">=</a>
  <a id="3632" href="Data.Nat.GCD.Lemmas.html#5618" class="Function">lem₁₀</a> <a id="3638" href="Data.Nat.Coprimality.html#3586" class="Bound">y</a> <a id="3640" href="Data.Nat.Coprimality.html#3619" class="Bound">q₂</a> <a id="3643" href="Data.Nat.Coprimality.html#3584" class="Bound">x</a> <a id="3645" href="Data.Nat.Coprimality.html#3601" class="Bound">q₁</a> <a id="3648" href="Data.Nat.Coprimality.html#3588" class="Bound">eq</a>
<a id="3651" href="Data.Nat.Coprimality.html#3433" class="Function">Bézout-coprime</a> <a id="3666" class="Symbol">{</a><a id="3667" class="Argument">d</a> <a id="3669" class="Symbol">=</a> <a id="3671" href="Agda.Builtin.Nat.html#217" class="InductiveConstructor">suc</a> <a id="3675" class="Symbol">_}</a> <a id="3678" class="Symbol">(</a><a id="3679" href="Data.Nat.GCD.html#9582" class="InductiveConstructor">Bézout.-+</a> <a id="3689" href="Data.Nat.Coprimality.html#3689" class="Bound">x</a> <a id="3691" href="Data.Nat.Coprimality.html#3691" class="Bound">y</a> <a id="3693" href="Data.Nat.Coprimality.html#3693" class="Bound">eq</a><a id="3695" class="Symbol">)</a> <a id="3697" class="Symbol">(</a><a id="3698" href="Data.Nat.Divisibility.Core.html#1186" class="InductiveConstructor">divides</a> <a id="3706" href="Data.Nat.Coprimality.html#3706" class="Bound">q₁</a> <a id="3709" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a> <a id="3714" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="3716" href="Data.Nat.Divisibility.Core.html#1186" class="InductiveConstructor">divides</a> <a id="3724" href="Data.Nat.Coprimality.html#3724" class="Bound">q₂</a> <a id="3727" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a><a id="3731" class="Symbol">)</a> <a id="3733" class="Symbol">=</a>
  <a id="3737" href="Data.Nat.GCD.Lemmas.html#5618" class="Function">lem₁₀</a> <a id="3743" href="Data.Nat.Coprimality.html#3689" class="Bound">x</a> <a id="3745" href="Data.Nat.Coprimality.html#3706" class="Bound">q₁</a> <a id="3748" href="Data.Nat.Coprimality.html#3691" class="Bound">y</a> <a id="3750" href="Data.Nat.Coprimality.html#3724" class="Bound">q₂</a> <a id="3753" href="Data.Nat.Coprimality.html#3693" class="Bound">eq</a>

<a id="3757" class="Comment">-- Coprime numbers satisfy Bézout&#39;s identity.</a>

<a id="coprime-Bézout"></a><a id="3804" href="Data.Nat.Coprimality.html#3804" class="Function">coprime-Bézout</a> <a id="3819" class="Symbol">:</a> <a id="3821" class="Symbol">∀</a> <a id="3823" class="Symbol">{</a><a id="3824" href="Data.Nat.Coprimality.html#3824" class="Bound">i</a> <a id="3826" href="Data.Nat.Coprimality.html#3826" class="Bound">j</a><a id="3827" class="Symbol">}</a> <a id="3829" class="Symbol">→</a> <a id="3831" href="Data.Nat.Coprimality.html#1178" class="Function">Coprime</a> <a id="3839" href="Data.Nat.Coprimality.html#3824" class="Bound">i</a> <a id="3841" href="Data.Nat.Coprimality.html#3826" class="Bound">j</a> <a id="3843" class="Symbol">→</a> <a id="3845" href="Data.Nat.GCD.html#9480" class="Datatype">Bézout.Identity</a> <a id="3861" class="Number">1</a> <a id="3863" href="Data.Nat.Coprimality.html#3824" class="Bound">i</a> <a id="3865" href="Data.Nat.Coprimality.html#3826" class="Bound">j</a>
<a id="3867" href="Data.Nat.Coprimality.html#3804" class="Function">coprime-Bézout</a> <a id="3882" class="Symbol">=</a> <a id="3884" href="Data.Nat.GCD.html#12261" class="Function">Bézout.identity</a> <a id="3900" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="3902" href="Data.Nat.Coprimality.html#1360" class="Function">coprime⇒GCD≡1</a>

<a id="3917" class="Comment">-- If i divides jk and is coprime to j, then it divides k.</a>

<a id="coprime-divisor"></a><a id="3977" href="Data.Nat.Coprimality.html#3977" class="Function">coprime-divisor</a> <a id="3993" class="Symbol">:</a> <a id="3995" class="Symbol">∀</a> <a id="3997" class="Symbol">{</a><a id="3998" href="Data.Nat.Coprimality.html#3998" class="Bound">k</a> <a id="4000" href="Data.Nat.Coprimality.html#4000" class="Bound">i</a> <a id="4002" href="Data.Nat.Coprimality.html#4002" class="Bound">j</a><a id="4003" class="Symbol">}</a> <a id="4005" class="Symbol">→</a> <a id="4007" href="Data.Nat.Coprimality.html#1178" class="Function">Coprime</a> <a id="4015" href="Data.Nat.Coprimality.html#4000" class="Bound">i</a> <a id="4017" href="Data.Nat.Coprimality.html#4002" class="Bound">j</a> <a id="4019" class="Symbol">→</a> <a id="4021" href="Data.Nat.Coprimality.html#4000" class="Bound">i</a> <a id="4023" href="Data.Nat.Divisibility.Core.html#1146" class="Record Operator">∣</a> <a id="4025" href="Data.Nat.Coprimality.html#4002" class="Bound">j</a> <a id="4027" href="Agda.Builtin.Nat.html#522" class="Primitive Operator">*</a> <a id="4029" href="Data.Nat.Coprimality.html#3998" class="Bound">k</a> <a id="4031" class="Symbol">→</a> <a id="4033" href="Data.Nat.Coprimality.html#4000" class="Bound">i</a> <a id="4035" href="Data.Nat.Divisibility.Core.html#1146" class="Record Operator">∣</a> <a id="4037" href="Data.Nat.Coprimality.html#3998" class="Bound">k</a>
<a id="4039" href="Data.Nat.Coprimality.html#3977" class="Function">coprime-divisor</a> <a id="4055" class="Symbol">{</a><a id="4056" href="Data.Nat.Coprimality.html#4056" class="Bound">k</a><a id="4057" class="Symbol">}</a> <a id="4059" href="Data.Nat.Coprimality.html#4059" class="Bound">c</a> <a id="4061" class="Symbol">(</a><a id="4062" href="Data.Nat.Divisibility.Core.html#1186" class="InductiveConstructor">divides</a> <a id="4070" href="Data.Nat.Coprimality.html#4070" class="Bound">q</a> <a id="4072" href="Data.Nat.Coprimality.html#4072" class="Bound">eq′</a><a id="4075" class="Symbol">)</a> <a id="4077" class="Keyword">with</a> <a id="4082" href="Data.Nat.Coprimality.html#3804" class="Function">coprime-Bézout</a> <a id="4097" href="Data.Nat.Coprimality.html#4059" class="Bound">c</a>
<a id="4099" class="Symbol">...</a> <a id="4103" class="Symbol">|</a> <a id="4105" href="Data.Nat.GCD.html#9519" class="InductiveConstructor">Bézout.+-</a> <a id="4115" href="Data.Nat.Coprimality.html#4115" class="Bound">x</a> <a id="4117" href="Data.Nat.Coprimality.html#4117" class="Bound">y</a> <a id="4119" href="Data.Nat.Coprimality.html#4119" class="Bound">eq</a> <a id="4122" class="Symbol">=</a> <a id="4124" href="Data.Nat.Divisibility.Core.html#1186" class="InductiveConstructor">divides</a> <a id="4132" class="Symbol">(</a><a id="4133" href="Data.Nat.Coprimality.html#4115" class="Bound">x</a> <a id="4135" href="Agda.Builtin.Nat.html#522" class="Primitive Operator">*</a> <a id="4137" class="Bound">k</a> <a id="4139" href="Data.Nat.Base.html#3140" class="Primitive Operator">∸</a> <a id="4141" href="Data.Nat.Coprimality.html#4117" class="Bound">y</a> <a id="4143" href="Agda.Builtin.Nat.html#522" class="Primitive Operator">*</a> <a id="4145" class="Bound">q</a><a id="4146" class="Symbol">)</a> <a id="4148" class="Symbol">(</a><a id="4149" href="Data.Nat.GCD.Lemmas.html#4149" class="Function">lem₈</a> <a id="4154" href="Data.Nat.Coprimality.html#4115" class="Bound">x</a> <a id="4156" href="Data.Nat.Coprimality.html#4117" class="Bound">y</a> <a id="4158" href="Data.Nat.Coprimality.html#4119" class="Bound">eq</a> <a id="4161" class="Bound">eq′</a><a id="4164" class="Symbol">)</a>
<a id="4166" class="Symbol">...</a> <a id="4170" class="Symbol">|</a> <a id="4172" href="Data.Nat.GCD.html#9582" class="InductiveConstructor">Bézout.-+</a> <a id="4182" href="Data.Nat.Coprimality.html#4182" class="Bound">x</a> <a id="4184" href="Data.Nat.Coprimality.html#4184" class="Bound">y</a> <a id="4186" href="Data.Nat.Coprimality.html#4186" class="Bound">eq</a> <a id="4189" class="Symbol">=</a> <a id="4191" href="Data.Nat.Divisibility.Core.html#1186" class="InductiveConstructor">divides</a> <a id="4199" class="Symbol">(</a><a id="4200" href="Data.Nat.Coprimality.html#4184" class="Bound">y</a> <a id="4202" href="Agda.Builtin.Nat.html#522" class="Primitive Operator">*</a> <a id="4204" class="Bound">q</a> <a id="4206" href="Data.Nat.Base.html#3140" class="Primitive Operator">∸</a> <a id="4208" href="Data.Nat.Coprimality.html#4182" class="Bound">x</a> <a id="4210" href="Agda.Builtin.Nat.html#522" class="Primitive Operator">*</a> <a id="4212" class="Bound">k</a><a id="4213" class="Symbol">)</a> <a id="4215" class="Symbol">(</a><a id="4216" href="Data.Nat.GCD.Lemmas.html#4975" class="Function">lem₉</a> <a id="4221" href="Data.Nat.Coprimality.html#4182" class="Bound">x</a> <a id="4223" href="Data.Nat.Coprimality.html#4184" class="Bound">y</a> <a id="4225" href="Data.Nat.Coprimality.html#4186" class="Bound">eq</a> <a id="4228" class="Bound">eq′</a><a id="4231" class="Symbol">)</a>

<a id="4234" class="Comment">-- If d is a common divisor of mk and nk, and m and n are coprime,</a>
<a id="4301" class="Comment">-- then d divides k.</a>

<a id="coprime-factors"></a><a id="4323" href="Data.Nat.Coprimality.html#4323" class="Function">coprime-factors</a> <a id="4339" class="Symbol">:</a> <a id="4341" class="Symbol">∀</a> <a id="4343" class="Symbol">{</a><a id="4344" href="Data.Nat.Coprimality.html#4344" class="Bound">d</a> <a id="4346" href="Data.Nat.Coprimality.html#4346" class="Bound">m</a> <a id="4348" href="Data.Nat.Coprimality.html#4348" class="Bound">n</a> <a id="4350" href="Data.Nat.Coprimality.html#4350" class="Bound">k</a><a id="4351" class="Symbol">}</a> <a id="4353" class="Symbol">→</a>
                  <a id="4373" href="Data.Nat.Coprimality.html#1178" class="Function">Coprime</a> <a id="4381" href="Data.Nat.Coprimality.html#4346" class="Bound">m</a> <a id="4383" href="Data.Nat.Coprimality.html#4348" class="Bound">n</a> <a id="4385" class="Symbol">→</a> <a id="4387" href="Data.Nat.Coprimality.html#4344" class="Bound">d</a> <a id="4389" href="Data.Nat.Divisibility.Core.html#1146" class="Record Operator">∣</a> <a id="4391" href="Data.Nat.Coprimality.html#4346" class="Bound">m</a> <a id="4393" href="Agda.Builtin.Nat.html#522" class="Primitive Operator">*</a> <a id="4395" href="Data.Nat.Coprimality.html#4350" class="Bound">k</a> <a id="4397" href="Data.Product.html#1176" class="Function Operator">×</a> <a id="4399" href="Data.Nat.Coprimality.html#4344" class="Bound">d</a> <a id="4401" href="Data.Nat.Divisibility.Core.html#1146" class="Record Operator">∣</a> <a id="4403" href="Data.Nat.Coprimality.html#4348" class="Bound">n</a> <a id="4405" href="Agda.Builtin.Nat.html#522" class="Primitive Operator">*</a> <a id="4407" href="Data.Nat.Coprimality.html#4350" class="Bound">k</a> <a id="4409" class="Symbol">→</a> <a id="4411" href="Data.Nat.Coprimality.html#4344" class="Bound">d</a> <a id="4413" href="Data.Nat.Divisibility.Core.html#1146" class="Record Operator">∣</a> <a id="4415" href="Data.Nat.Coprimality.html#4350" class="Bound">k</a>
<a id="4417" href="Data.Nat.Coprimality.html#4323" class="Function">coprime-factors</a> <a id="4433" href="Data.Nat.Coprimality.html#4433" class="Bound">c</a> <a id="4435" class="Symbol">(</a><a id="4436" href="Data.Nat.Divisibility.Core.html#1186" class="InductiveConstructor">divides</a> <a id="4444" href="Data.Nat.Coprimality.html#4444" class="Bound">q₁</a> <a id="4447" href="Data.Nat.Coprimality.html#4447" class="Bound">eq₁</a> <a id="4451" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="4453" href="Data.Nat.Divisibility.Core.html#1186" class="InductiveConstructor">divides</a> <a id="4461" href="Data.Nat.Coprimality.html#4461" class="Bound">q₂</a> <a id="4464" href="Data.Nat.Coprimality.html#4464" class="Bound">eq₂</a><a id="4467" class="Symbol">)</a> <a id="4469" class="Keyword">with</a> <a id="4474" href="Data.Nat.Coprimality.html#3804" class="Function">coprime-Bézout</a> <a id="4489" href="Data.Nat.Coprimality.html#4433" class="Bound">c</a>
<a id="4491" class="Symbol">...</a> <a id="4495" class="Symbol">|</a> <a id="4497" href="Data.Nat.GCD.html#9519" class="InductiveConstructor">Bézout.+-</a> <a id="4507" href="Data.Nat.Coprimality.html#4507" class="Bound">x</a> <a id="4509" href="Data.Nat.Coprimality.html#4509" class="Bound">y</a> <a id="4511" href="Data.Nat.Coprimality.html#4511" class="Bound">eq</a> <a id="4514" class="Symbol">=</a> <a id="4516" href="Data.Nat.Divisibility.Core.html#1186" class="InductiveConstructor">divides</a> <a id="4524" class="Symbol">(</a><a id="4525" href="Data.Nat.Coprimality.html#4507" class="Bound">x</a> <a id="4527" href="Agda.Builtin.Nat.html#522" class="Primitive Operator">*</a> <a id="4529" class="Bound">q₁</a> <a id="4532" href="Data.Nat.Base.html#3140" class="Primitive Operator">∸</a> <a id="4534" href="Data.Nat.Coprimality.html#4509" class="Bound">y</a> <a id="4536" href="Agda.Builtin.Nat.html#522" class="Primitive Operator">*</a> <a id="4538" class="Bound">q₂</a><a id="4540" class="Symbol">)</a> <a id="4542" class="Symbol">(</a><a id="4543" href="Data.Nat.GCD.Lemmas.html#6395" class="Function">lem₁₁</a> <a id="4549" href="Data.Nat.Coprimality.html#4507" class="Bound">x</a> <a id="4551" href="Data.Nat.Coprimality.html#4509" class="Bound">y</a> <a id="4553" href="Data.Nat.Coprimality.html#4511" class="Bound">eq</a> <a id="4556" class="Bound">eq₁</a> <a id="4560" class="Bound">eq₂</a><a id="4563" class="Symbol">)</a>
<a id="4565" class="Symbol">...</a> <a id="4569" class="Symbol">|</a> <a id="4571" href="Data.Nat.GCD.html#9582" class="InductiveConstructor">Bézout.-+</a> <a id="4581" href="Data.Nat.Coprimality.html#4581" class="Bound">x</a> <a id="4583" href="Data.Nat.Coprimality.html#4583" class="Bound">y</a> <a id="4585" href="Data.Nat.Coprimality.html#4585" class="Bound">eq</a> <a id="4588" class="Symbol">=</a> <a id="4590" href="Data.Nat.Divisibility.Core.html#1186" class="InductiveConstructor">divides</a> <a id="4598" class="Symbol">(</a><a id="4599" href="Data.Nat.Coprimality.html#4583" class="Bound">y</a> <a id="4601" href="Agda.Builtin.Nat.html#522" class="Primitive Operator">*</a> <a id="4603" class="Bound">q₂</a> <a id="4606" href="Data.Nat.Base.html#3140" class="Primitive Operator">∸</a> <a id="4608" href="Data.Nat.Coprimality.html#4581" class="Bound">x</a> <a id="4610" href="Agda.Builtin.Nat.html#522" class="Primitive Operator">*</a> <a id="4612" class="Bound">q₁</a><a id="4614" class="Symbol">)</a> <a id="4616" class="Symbol">(</a><a id="4617" href="Data.Nat.GCD.Lemmas.html#6395" class="Function">lem₁₁</a> <a id="4623" href="Data.Nat.Coprimality.html#4583" class="Bound">y</a> <a id="4625" href="Data.Nat.Coprimality.html#4581" class="Bound">x</a> <a id="4627" href="Data.Nat.Coprimality.html#4585" class="Bound">eq</a> <a id="4630" class="Bound">eq₂</a> <a id="4634" class="Bound">eq₁</a><a id="4637" class="Symbol">)</a>

<a id="4640" class="Comment">------------------------------------------------------------------------</a>
<a id="4713" class="Comment">-- Primality implies coprimality.</a>

<a id="prime⇒coprime"></a><a id="4748" href="Data.Nat.Coprimality.html#4748" class="Function">prime⇒coprime</a> <a id="4762" class="Symbol">:</a> <a id="4764" class="Symbol">∀</a> <a id="4766" href="Data.Nat.Coprimality.html#4766" class="Bound">m</a> <a id="4768" class="Symbol">→</a> <a id="4770" href="Data.Nat.Primality.html#1288" class="Function">Prime</a> <a id="4776" href="Data.Nat.Coprimality.html#4766" class="Bound">m</a> <a id="4778" class="Symbol">→</a>
                <a id="4796" class="Symbol">∀</a> <a id="4798" href="Data.Nat.Coprimality.html#4798" class="Bound">n</a> <a id="4800" class="Symbol">→</a> <a id="4802" class="Number">0</a> <a id="4804" href="Data.Nat.Base.html#1583" class="Function Operator">&lt;</a> <a id="4806" href="Data.Nat.Coprimality.html#4798" class="Bound">n</a> <a id="4808" class="Symbol">→</a> <a id="4810" href="Data.Nat.Coprimality.html#4798" class="Bound">n</a> <a id="4812" href="Data.Nat.Base.html#1583" class="Function Operator">&lt;</a> <a id="4814" href="Data.Nat.Coprimality.html#4766" class="Bound">m</a> <a id="4816" class="Symbol">→</a> <a id="4818" href="Data.Nat.Coprimality.html#1178" class="Function">Coprime</a> <a id="4826" href="Data.Nat.Coprimality.html#4766" class="Bound">m</a> <a id="4828" href="Data.Nat.Coprimality.html#4798" class="Bound">n</a>
<a id="4830" href="Data.Nat.Coprimality.html#4748" class="Function">prime⇒coprime</a> <a id="4844" class="Symbol">(</a><a id="4845" href="Agda.Builtin.Nat.html#217" class="InductiveConstructor">suc</a> <a id="4849" class="Symbol">(</a><a id="4850" href="Agda.Builtin.Nat.html#217" class="InductiveConstructor">suc</a> <a id="4854" class="Symbol">_))</a> <a id="4858" href="Data.Nat.Coprimality.html#4858" class="Bound">p</a> <a id="4860" class="Symbol">_</a> <a id="4862" class="Symbol">_</a> <a id="4864" class="Symbol">_</a> <a id="4866" class="Symbol">{</a><a id="4867" class="Number">0</a><a id="4868" class="Symbol">}</a> <a id="4870" class="Symbol">(</a><a id="4871" href="Data.Nat.Coprimality.html#4871" class="Bound">0∣m</a> <a id="4875" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="4877" class="Symbol">_)</a> <a id="4880" class="Symbol">=</a>
  <a id="4884" href="Relation.Nullary.Negation.Core.html#787" class="Function">contradiction</a> <a id="4898" class="Symbol">(</a><a id="4899" href="Data.Nat.Divisibility.html#3930" class="Function">0∣⇒≡0</a> <a id="4905" href="Data.Nat.Coprimality.html#4871" class="Bound">0∣m</a><a id="4908" class="Symbol">)</a> <a id="4910" class="Symbol">λ()</a>
<a id="4914" href="Data.Nat.Coprimality.html#4748" class="Function">prime⇒coprime</a> <a id="4928" class="Symbol">(</a><a id="4929" href="Agda.Builtin.Nat.html#217" class="InductiveConstructor">suc</a> <a id="4933" class="Symbol">(</a><a id="4934" href="Agda.Builtin.Nat.html#217" class="InductiveConstructor">suc</a> <a id="4938" class="Symbol">_))</a> <a id="4942" class="Symbol">_</a> <a id="4944" class="Symbol">_</a> <a id="4946" class="Symbol">_</a> <a id="4948" class="Symbol">_</a> <a id="4950" class="Symbol">{</a><a id="4951" class="Number">1</a><a id="4952" class="Symbol">}</a> <a id="4954" class="Symbol">_</a>         <a id="4964" class="Symbol">=</a> <a id="4966" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a>
<a id="4971" href="Data.Nat.Coprimality.html#4748" class="Function">prime⇒coprime</a> <a id="4985" class="Symbol">(</a><a id="4986" href="Agda.Builtin.Nat.html#217" class="InductiveConstructor">suc</a> <a id="4990" class="Symbol">(</a><a id="4991" href="Agda.Builtin.Nat.html#217" class="InductiveConstructor">suc</a> <a id="4995" class="Symbol">_))</a> <a id="4999" href="Data.Nat.Coprimality.html#4999" class="Bound">p</a> <a id="5001" class="Symbol">(</a><a id="5002" href="Agda.Builtin.Nat.html#217" class="InductiveConstructor">suc</a> <a id="5006" class="Symbol">_)</a> <a id="5009" class="Symbol">_</a> <a id="5011" href="Data.Nat.Coprimality.html#5011" class="Bound">n&lt;m</a> <a id="5015" class="Symbol">{(</a><a id="5017" href="Agda.Builtin.Nat.html#217" class="InductiveConstructor">suc</a> <a id="5021" class="Symbol">(</a><a id="5022" href="Agda.Builtin.Nat.html#217" class="InductiveConstructor">suc</a> <a id="5026" class="Symbol">_))}</a> <a id="5031" class="Symbol">(</a><a id="5032" href="Data.Nat.Coprimality.html#5032" class="Bound">d∣m</a> <a id="5036" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="5038" href="Data.Nat.Coprimality.html#5038" class="Bound">d∣n</a><a id="5041" class="Symbol">)</a> <a id="5043" class="Symbol">=</a>
  <a id="5047" href="Relation.Nullary.Negation.Core.html#787" class="Function">contradiction</a> <a id="5061" href="Data.Nat.Coprimality.html#5032" class="Bound">d∣m</a> <a id="5065" class="Symbol">(</a><a id="5066" href="Data.Nat.Coprimality.html#4999" class="Bound">p</a> <a id="5068" href="Data.Nat.Coprimality.html#5085" class="Function">2≤d</a> <a id="5072" href="Data.Nat.Coprimality.html#5106" class="Function">d&lt;m</a><a id="5075" class="Symbol">)</a>
  <a id="5079" class="Keyword">where</a> <a id="5085" href="Data.Nat.Coprimality.html#5085" class="Function">2≤d</a> <a id="5089" class="Symbol">=</a> <a id="5091" href="Data.Nat.Base.html#1538" class="InductiveConstructor">s≤s</a> <a id="5095" class="Symbol">(</a><a id="5096" href="Data.Nat.Base.html#1538" class="InductiveConstructor">s≤s</a> <a id="5100" href="Data.Nat.Base.html#1496" class="InductiveConstructor">z≤n</a><a id="5103" class="Symbol">);</a> <a id="5106" href="Data.Nat.Coprimality.html#5106" class="Function">d&lt;m</a> <a id="5110" class="Symbol">=</a> <a id="5112" href="Data.Nat.Properties.html#9944" class="Function">&lt;-transˡ</a> <a id="5121" class="Symbol">(</a><a id="5122" href="Data.Nat.Base.html#1538" class="InductiveConstructor">s≤s</a> <a id="5126" class="Symbol">(</a><a id="5127" href="Data.Nat.Divisibility.html#1822" class="Function">∣⇒≤</a> <a id="5131" href="Data.Nat.Coprimality.html#5038" class="Bound">d∣n</a><a id="5134" class="Symbol">))</a> <a id="5137" href="Data.Nat.Coprimality.html#5011" class="Bound">n&lt;m</a>
</pre></body></html>