<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Data.Nat.DivMod.WithK</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- The Agda standard library</a>
<a id="103" class="Comment">--</a>
<a id="106" class="Comment">-- More efficient mod and divMod operations (require the K axiom)</a>
<a id="172" class="Comment">------------------------------------------------------------------------</a>

<a id="246" class="Symbol">{-#</a> <a id="250" class="Keyword">OPTIONS</a> <a id="258" class="Pragma">--with-K</a> <a id="267" class="Pragma">--safe</a> <a id="274" class="Symbol">#-}</a>

<a id="279" class="Keyword">module</a> <a id="286" href="Data.Nat.DivMod.WithK.html" class="Module">Data.Nat.DivMod.WithK</a> <a id="308" class="Keyword">where</a>

<a id="315" class="Keyword">open</a> <a id="320" class="Keyword">import</a> <a id="327" href="Data.Nat.html" class="Module">Data.Nat</a> <a id="336" class="Keyword">using</a> <a id="342" class="Symbol">(</a><a id="343" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a><a id="344" class="Symbol">;</a> <a id="346" href="Data.Nat.Base.html#2499" class="Record">NonZero</a><a id="353" class="Symbol">;</a> <a id="355" href="Agda.Builtin.Nat.html#319" class="Primitive Operator">_+_</a><a id="358" class="Symbol">;</a> <a id="360" href="Agda.Builtin.Nat.html#522" class="Primitive Operator">_*_</a><a id="363" class="Symbol">;</a> <a id="365" href="Data.Nat.Properties.html#2945" class="Function Operator">_≟_</a><a id="368" class="Symbol">;</a> <a id="370" href="Agda.Builtin.Nat.html#204" class="InductiveConstructor">zero</a><a id="374" class="Symbol">;</a> <a id="376" href="Agda.Builtin.Nat.html#217" class="InductiveConstructor">suc</a><a id="379" class="Symbol">)</a>
<a id="381" class="Keyword">open</a> <a id="386" class="Keyword">import</a> <a id="393" href="Data.Nat.DivMod.html" class="Module">Data.Nat.DivMod</a> <a id="409" class="Keyword">hiding</a> <a id="416" class="Symbol">(</a><a id="417" href="Data.Nat.DivMod.html#19109" class="Function Operator">_mod_</a><a id="422" class="Symbol">;</a> <a id="424" href="Data.Nat.DivMod.html#19221" class="Function Operator">_divMod_</a><a id="432" class="Symbol">)</a>
<a id="434" class="Keyword">open</a> <a id="439" class="Keyword">import</a> <a id="446" href="Data.Nat.Properties.html" class="Module">Data.Nat.Properties</a> <a id="466" class="Keyword">using</a> <a id="472" class="Symbol">(</a><a id="473" href="Data.Nat.Properties.html#62857" class="Function">≤⇒≤″</a><a id="477" class="Symbol">)</a>
<a id="479" class="Keyword">open</a> <a id="484" class="Keyword">import</a> <a id="491" href="Data.Nat.WithK.html" class="Module">Data.Nat.WithK</a>
<a id="506" class="Keyword">open</a> <a id="511" class="Keyword">import</a> <a id="518" href="Data.Fin.Base.html" class="Module">Data.Fin.Base</a> <a id="532" class="Keyword">using</a> <a id="538" class="Symbol">(</a><a id="539" href="Data.Fin.Base.html#1212" class="Datatype">Fin</a><a id="542" class="Symbol">;</a> <a id="544" href="Data.Fin.Base.html#1320" class="Function">toℕ</a><a id="547" class="Symbol">;</a> <a id="549" href="Data.Fin.Base.html#2146" class="Function">fromℕ&lt;″</a><a id="556" class="Symbol">)</a>
<a id="558" class="Keyword">open</a> <a id="563" class="Keyword">import</a> <a id="570" href="Data.Fin.Properties.html" class="Module">Data.Fin.Properties</a> <a id="590" class="Keyword">using</a> <a id="596" class="Symbol">(</a><a id="597" href="Data.Fin.Properties.html#8627" class="Function">toℕ-fromℕ&lt;″</a><a id="608" class="Symbol">)</a>
<a id="610" class="Keyword">open</a> <a id="615" class="Keyword">import</a> <a id="622" href="Function.Base.html" class="Module">Function.Base</a> <a id="636" class="Keyword">using</a> <a id="642" class="Symbol">(</a><a id="643" href="Function.Base.html#2003" class="Function Operator">_$_</a><a id="646" class="Symbol">)</a>
<a id="648" class="Keyword">open</a> <a id="653" class="Keyword">import</a> <a id="660" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a>
  <a id="700" class="Keyword">using</a> <a id="706" class="Symbol">(</a><a id="707" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a><a id="711" class="Symbol">;</a> <a id="713" href="Relation.Binary.PropositionalEquality.Core.html#1693" class="Function">sym</a><a id="716" class="Symbol">;</a> <a id="718" href="Relation.Binary.PropositionalEquality.Core.html#1139" class="Function">cong</a><a id="722" class="Symbol">;</a> <a id="724" class="Keyword">module</a> <a id="731" href="Relation.Binary.PropositionalEquality.Core.html#2717" class="Module">≡-Reasoning</a><a id="742" class="Symbol">)</a>
<a id="744" class="Keyword">open</a> <a id="749" class="Keyword">import</a> <a id="756" href="Relation.Binary.PropositionalEquality.WithK.html" class="Module">Relation.Binary.PropositionalEquality.WithK</a>

<a id="801" class="Keyword">open</a> <a id="806" href="Relation.Binary.PropositionalEquality.Core.html#2717" class="Module">≡-Reasoning</a>

<a id="819" class="Keyword">infixl</a> <a id="826" class="Number">7</a> <a id="828" href="Data.Nat.DivMod.WithK.html#939" class="Function Operator">_mod_</a> <a id="834" href="Data.Nat.DivMod.WithK.html#1206" class="Function Operator">_divMod_</a>

<a id="844" class="Comment">------------------------------------------------------------------------</a>
<a id="917" class="Comment">-- Certified modulus</a>

<a id="_mod_"></a><a id="939" href="Data.Nat.DivMod.WithK.html#939" class="Function Operator">_mod_</a> <a id="945" class="Symbol">:</a> <a id="947" class="Symbol">(</a><a id="948" href="Data.Nat.DivMod.WithK.html#948" class="Bound">dividend</a> <a id="957" href="Data.Nat.DivMod.WithK.html#957" class="Bound">divisor</a> <a id="965" class="Symbol">:</a> <a id="967" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a><a id="968" class="Symbol">)</a> <a id="970" class="Symbol">→</a> <a id="972" class="Symbol">.{{</a> <a id="976" href="Data.Nat.DivMod.WithK.html#976" class="Bound">_</a> <a id="978" class="Symbol">:</a> <a id="980" href="Data.Nat.Base.html#2499" class="Record">NonZero</a> <a id="988" href="Data.Nat.DivMod.WithK.html#957" class="Bound">divisor</a> <a id="996" class="Symbol">}}</a> <a id="999" class="Symbol">→</a> <a id="1001" href="Data.Fin.Base.html#1212" class="Datatype">Fin</a> <a id="1005" href="Data.Nat.DivMod.WithK.html#957" class="Bound">divisor</a>
<a id="1013" href="Data.Nat.DivMod.WithK.html#1013" class="Bound">a</a> <a id="1015" href="Data.Nat.DivMod.WithK.html#939" class="Function Operator">mod</a> <a id="1019" href="Data.Nat.DivMod.WithK.html#1019" class="Bound">n</a> <a id="1021" class="Symbol">=</a> <a id="1023" href="Data.Fin.Base.html#2146" class="Function">fromℕ&lt;″</a> <a id="1031" class="Symbol">(</a><a id="1032" href="Data.Nat.DivMod.WithK.html#1013" class="Bound">a</a> <a id="1034" href="Data.Nat.Base.html#4244" class="Function Operator">%</a> <a id="1036" href="Data.Nat.DivMod.WithK.html#1019" class="Bound">n</a><a id="1037" class="Symbol">)</a> <a id="1039" class="Symbol">(</a><a id="1040" href="Data.Nat.WithK.html#387" class="Function">≤″-erase</a> <a id="1049" class="Symbol">(</a><a id="1050" href="Data.Nat.Properties.html#62857" class="Function">≤⇒≤″</a> <a id="1055" class="Symbol">(</a><a id="1056" href="Data.Nat.DivMod.html#3979" class="Function">m%n&lt;n</a> <a id="1062" href="Data.Nat.DivMod.WithK.html#1013" class="Bound">a</a> <a id="1064" href="Data.Nat.DivMod.WithK.html#1019" class="Bound">n</a><a id="1065" class="Symbol">)))</a>

<a id="1070" class="Comment">------------------------------------------------------------------------</a>
<a id="1143" class="Comment">-- Returns modulus and division result with correctness proof</a>

<a id="_divMod_"></a><a id="1206" href="Data.Nat.DivMod.WithK.html#1206" class="Function Operator">_divMod_</a> <a id="1215" class="Symbol">:</a> <a id="1217" class="Symbol">(</a><a id="1218" href="Data.Nat.DivMod.WithK.html#1218" class="Bound">dividend</a> <a id="1227" href="Data.Nat.DivMod.WithK.html#1227" class="Bound">divisor</a> <a id="1235" class="Symbol">:</a> <a id="1237" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a><a id="1238" class="Symbol">)</a> <a id="1240" class="Symbol">→</a> <a id="1242" class="Symbol">.{{</a> <a id="1246" href="Data.Nat.Base.html#2499" class="Record">NonZero</a> <a id="1254" href="Data.Nat.DivMod.WithK.html#1227" class="Bound">divisor</a> <a id="1262" class="Symbol">}}</a> <a id="1265" class="Symbol">→</a>
           <a id="1278" href="Data.Nat.DivMod.html#18825" class="Record">DivMod</a> <a id="1285" href="Data.Nat.DivMod.WithK.html#1218" class="Bound">dividend</a> <a id="1294" href="Data.Nat.DivMod.WithK.html#1227" class="Bound">divisor</a>
<a id="1302" href="Data.Nat.DivMod.WithK.html#1302" class="Bound">a</a> <a id="1304" href="Data.Nat.DivMod.WithK.html#1206" class="Function Operator">divMod</a> <a id="1311" href="Data.Nat.DivMod.WithK.html#1311" class="Bound">n</a> <a id="1313" class="Symbol">=</a> <a id="1315" href="Data.Nat.DivMod.html#18881" class="InductiveConstructor">result</a> <a id="1322" class="Symbol">(</a><a id="1323" href="Data.Nat.DivMod.WithK.html#1302" class="Bound">a</a> <a id="1325" href="Data.Nat.Base.html#4061" class="Function Operator">/</a> <a id="1327" href="Data.Nat.DivMod.WithK.html#1311" class="Bound">n</a><a id="1328" class="Symbol">)</a> <a id="1330" class="Symbol">(</a><a id="1331" href="Data.Nat.DivMod.WithK.html#1302" class="Bound">a</a> <a id="1333" href="Data.Nat.DivMod.WithK.html#939" class="Function Operator">mod</a> <a id="1337" href="Data.Nat.DivMod.WithK.html#1311" class="Bound">n</a><a id="1338" class="Symbol">)</a> <a id="1340" href="Function.Base.html#2003" class="Function Operator">$</a> <a id="1342" href="Relation.Binary.PropositionalEquality.WithK.html#865" class="Primitive">≡-erase</a> <a id="1350" href="Function.Base.html#2003" class="Function Operator">$</a> <a id="1352" href="Relation.Binary.PropositionalEquality.Core.html#2815" class="Function Operator">begin</a>
  <a id="1360" href="Data.Nat.DivMod.WithK.html#1302" class="Bound">a</a>                                 <a id="1394" href="Relation.Binary.PropositionalEquality.Core.html#2932" class="Function">≡⟨</a> <a id="1397" href="Data.Nat.DivMod.html#1162" class="Function">m≡m%n+[m/n]*n</a> <a id="1411" href="Data.Nat.DivMod.WithK.html#1302" class="Bound">a</a> <a id="1413" href="Data.Nat.DivMod.WithK.html#1311" class="Bound">n</a> <a id="1415" href="Relation.Binary.PropositionalEquality.Core.html#2932" class="Function">⟩</a>
  <a id="1419" href="Data.Nat.DivMod.WithK.html#1302" class="Bound">a</a> <a id="1421" href="Data.Nat.Base.html#4244" class="Function Operator">%</a> <a id="1423" href="Data.Nat.DivMod.WithK.html#1311" class="Bound">n</a>              <a id="1438" href="Agda.Builtin.Nat.html#319" class="Primitive Operator">+</a> <a id="1440" href="Data.Nat.DivMod.WithK.html#1590" class="Function">[a/n]*n</a>      <a id="1453" href="Relation.Binary.PropositionalEquality.Core.html#2932" class="Function">≡⟨</a> <a id="1456" href="Relation.Binary.PropositionalEquality.Core.html#1139" class="Function">cong</a> <a id="1461" class="Symbol">(</a><a id="1462" href="Agda.Builtin.Nat.html#319" class="Primitive Operator">_+</a> <a id="1465" href="Data.Nat.DivMod.WithK.html#1590" class="Function">[a/n]*n</a><a id="1472" class="Symbol">)</a> <a id="1474" class="Symbol">(</a><a id="1475" href="Relation.Binary.PropositionalEquality.Core.html#1693" class="Function">sym</a> <a id="1479" class="Symbol">(</a><a id="1480" href="Data.Fin.Properties.html#8627" class="Function">toℕ-fromℕ&lt;″</a> <a id="1492" href="Data.Nat.DivMod.WithK.html#1551" class="Function">lemma′</a><a id="1498" class="Symbol">))</a> <a id="1501" href="Relation.Binary.PropositionalEquality.Core.html#2932" class="Function">⟩</a>
  <a id="1505" href="Data.Fin.Base.html#1320" class="Function">toℕ</a> <a id="1509" class="Symbol">(</a><a id="1510" href="Data.Fin.Base.html#2146" class="Function">fromℕ&lt;″</a> <a id="1518" class="Symbol">_</a> <a id="1520" href="Data.Nat.DivMod.WithK.html#1551" class="Function">lemma′</a><a id="1526" class="Symbol">)</a> <a id="1528" href="Agda.Builtin.Nat.html#319" class="Primitive Operator">+</a> <a id="1530" href="Data.Nat.DivMod.WithK.html#1590" class="Function">[a/n]*n</a>  <a id="1539" href="Relation.Binary.PropositionalEquality.Core.html#3114" class="Function Operator">∎</a>
  <a id="1543" class="Keyword">where</a>
  <a id="1551" href="Data.Nat.DivMod.WithK.html#1551" class="Function">lemma′</a> <a id="1558" class="Symbol">=</a> <a id="1560" href="Data.Nat.WithK.html#387" class="Function">≤″-erase</a> <a id="1569" class="Symbol">(</a><a id="1570" href="Data.Nat.Properties.html#62857" class="Function">≤⇒≤″</a> <a id="1575" class="Symbol">(</a><a id="1576" href="Data.Nat.DivMod.html#3979" class="Function">m%n&lt;n</a> <a id="1582" href="Data.Nat.DivMod.WithK.html#1302" class="Bound">a</a> <a id="1584" href="Data.Nat.DivMod.WithK.html#1311" class="Bound">n</a><a id="1585" class="Symbol">))</a>
  <a id="1590" href="Data.Nat.DivMod.WithK.html#1590" class="Function">[a/n]*n</a> <a id="1598" class="Symbol">=</a> <a id="1600" href="Data.Nat.DivMod.WithK.html#1302" class="Bound">a</a> <a id="1602" href="Data.Nat.Base.html#4061" class="Function Operator">/</a> <a id="1604" href="Data.Nat.DivMod.WithK.html#1311" class="Bound">n</a> <a id="1606" href="Agda.Builtin.Nat.html#522" class="Primitive Operator">*</a> <a id="1608" href="Data.Nat.DivMod.WithK.html#1311" class="Bound">n</a>
</pre></body></html>