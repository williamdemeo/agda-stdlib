<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Data.String</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- The Agda standard library</a>
<a id="103" class="Comment">--</a>
<a id="106" class="Comment">-- Strings</a>
<a id="117" class="Comment">------------------------------------------------------------------------</a>

<a id="191" class="Symbol">{-#</a> <a id="195" class="Keyword">OPTIONS</a> <a id="203" class="Pragma">--cubical-compatible</a> <a id="224" class="Pragma">--safe</a> <a id="231" class="Symbol">#-}</a>

<a id="236" class="Keyword">module</a> <a id="243" href="Data.String.html" class="Module">Data.String</a> <a id="255" class="Keyword">where</a>

<a id="262" class="Keyword">open</a> <a id="267" class="Keyword">import</a> <a id="274" href="Data.Bool.html" class="Module">Data.Bool</a> <a id="284" class="Keyword">using</a> <a id="290" class="Symbol">(</a><a id="291" href="Agda.Builtin.Bool.html#181" class="InductiveConstructor">true</a><a id="295" class="Symbol">;</a> <a id="297" href="Agda.Builtin.Bool.html#175" class="InductiveConstructor">false</a><a id="302" class="Symbol">;</a> <a id="304" href="Data.Bool.Properties.html#15982" class="Function">T?</a><a id="306" class="Symbol">)</a>
<a id="308" class="Keyword">open</a> <a id="313" class="Keyword">import</a> <a id="320" href="Data.Char.html" class="Module">Data.Char</a> <a id="330" class="Symbol">as</a> <a id="333" class="Module">Char</a> <a id="338" class="Keyword">using</a> <a id="344" class="Symbol">(</a><a id="345" href="Agda.Builtin.Char.html#221" class="Postulate">Char</a><a id="349" class="Symbol">)</a>
<a id="351" class="Keyword">open</a> <a id="356" class="Keyword">import</a> <a id="363" href="Function.Base.html" class="Module">Function.Base</a>
<a id="377" class="Keyword">open</a> <a id="382" class="Keyword">import</a> <a id="389" href="Data.Nat.Base.html" class="Module">Data.Nat.Base</a> <a id="403" class="Symbol">as</a> <a id="406" class="Module">ℕ</a> <a id="408" class="Keyword">using</a> <a id="414" class="Symbol">(</a><a id="415" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a><a id="416" class="Symbol">;</a> <a id="418" href="Data.Nat.Base.html#3140" class="Primitive Operator">_∸_</a><a id="421" class="Symbol">;</a> <a id="423" href="Data.Nat.Base.html#3631" class="Function Operator">⌊_/2⌋</a><a id="428" class="Symbol">;</a> <a id="430" href="Data.Nat.Base.html#3758" class="Function Operator">⌈_/2⌉</a><a id="435" class="Symbol">)</a>
<a id="437" class="Keyword">import</a> <a id="444" href="Data.Nat.Properties.html" class="Module">Data.Nat.Properties</a> <a id="464" class="Symbol">as</a> <a id="467" class="Module">ℕₚ</a>
<a id="470" class="Keyword">open</a> <a id="475" class="Keyword">import</a> <a id="482" href="Data.List.Base.html" class="Module">Data.List.Base</a> <a id="497" class="Symbol">as</a> <a id="500" class="Module">List</a> <a id="505" class="Keyword">using</a> <a id="511" class="Symbol">(</a><a id="512" href="Agda.Builtin.List.html#130" class="Datatype">List</a><a id="516" class="Symbol">;</a> <a id="518" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">_∷_</a><a id="521" class="Symbol">;</a> <a id="523" href="Data.List.Base.html#7191" class="InductiveConstructor">[]</a><a id="525" class="Symbol">;</a> <a id="527" href="Data.List.Base.html#5049" class="Function Operator">[_]</a><a id="530" class="Symbol">)</a>
<a id="532" class="Keyword">open</a> <a id="537" class="Keyword">import</a> <a id="544" href="Data.List.NonEmpty.html" class="Module">Data.List.NonEmpty</a> <a id="563" class="Symbol">as</a> <a id="566" class="Module">NE</a> <a id="569" class="Keyword">using</a> <a id="575" class="Symbol">(</a><a id="576" href="Data.List.NonEmpty.Base.html#1266" class="Record">List⁺</a><a id="581" class="Symbol">)</a>
<a id="583" class="Keyword">open</a> <a id="588" class="Keyword">import</a> <a id="595" href="Data.List.Extrema.html" class="Module">Data.List.Extrema</a> <a id="613" href="Data.Nat.Properties.html#7148" class="Function">ℕₚ.≤-totalOrder</a>
<a id="629" class="Keyword">open</a> <a id="634" class="Keyword">import</a> <a id="641" href="Data.List.Relation.Binary.Pointwise.html" class="Module">Data.List.Relation.Binary.Pointwise</a> <a id="677" class="Keyword">using</a> <a id="683" class="Symbol">(</a><a id="684" href="Data.List.Relation.Binary.Pointwise.Base.html#784" class="Datatype">Pointwise</a><a id="693" class="Symbol">)</a>
<a id="695" class="Keyword">open</a> <a id="700" class="Keyword">import</a> <a id="707" href="Data.List.Relation.Binary.Lex.Strict.html" class="Module">Data.List.Relation.Binary.Lex.Strict</a> <a id="744" class="Keyword">using</a> <a id="750" class="Symbol">(</a><a id="751" href="Data.List.Relation.Binary.Lex.Core.html#1508" class="Function">Lex-&lt;</a><a id="756" class="Symbol">;</a> <a id="758" href="Data.List.Relation.Binary.Lex.Core.html#1614" class="Function">Lex-≤</a><a id="763" class="Symbol">)</a>
<a id="765" class="Keyword">open</a> <a id="770" class="Keyword">import</a> <a id="777" href="Data.Vec.Base.html" class="Module">Data.Vec.Base</a> <a id="791" class="Symbol">as</a> <a id="794" class="Module">Vec</a> <a id="798" class="Keyword">using</a> <a id="804" class="Symbol">(</a><a id="805" href="Data.Vec.Base.html#1066" class="Datatype">Vec</a><a id="808" class="Symbol">)</a>
<a id="810" class="Keyword">open</a> <a id="815" class="Keyword">import</a> <a id="822" href="Data.Char.Base.html" class="Module">Data.Char.Base</a> <a id="837" class="Symbol">as</a> <a id="840" class="Module">Char</a> <a id="845" class="Keyword">using</a> <a id="851" class="Symbol">(</a><a id="852" href="Agda.Builtin.Char.html#221" class="Postulate">Char</a><a id="856" class="Symbol">)</a>
<a id="858" class="Keyword">import</a> <a id="865" href="Data.Char.Properties.html" class="Module">Data.Char.Properties</a> <a id="886" class="Symbol">as</a> <a id="889" class="Module">Char</a> <a id="894" class="Keyword">using</a> <a id="900" class="Symbol">(</a><a id="901" href="Data.Char.Properties.html#1499" class="Function Operator">_≟_</a><a id="904" class="Symbol">)</a>
<a id="906" class="Keyword">open</a> <a id="911" class="Keyword">import</a> <a id="918" href="Function.html" class="Module">Function</a>
<a id="927" class="Keyword">open</a> <a id="932" class="Keyword">import</a> <a id="939" href="Relation.Binary.html" class="Module">Relation.Binary</a> <a id="955" class="Keyword">using</a> <a id="961" class="Symbol">(</a><a id="962" href="Relation.Binary.Core.html#891" class="Function">Rel</a><a id="965" class="Symbol">)</a>
<a id="967" class="Keyword">open</a> <a id="972" class="Keyword">import</a> <a id="979" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a> <a id="1017" class="Keyword">using</a> <a id="1023" class="Symbol">(</a><a id="1024" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">_≡_</a><a id="1027" class="Symbol">;</a> <a id="1029" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a><a id="1033" class="Symbol">)</a>
<a id="1035" class="Keyword">open</a> <a id="1040" class="Keyword">import</a> <a id="1047" href="Relation.Nullary.html" class="Module">Relation.Nullary</a> <a id="1064" class="Keyword">using</a> <a id="1070" class="Symbol">(</a><a id="1071" href="Relation.Nullary.html#1590" class="Field">does</a><a id="1075" class="Symbol">)</a>
<a id="1077" class="Keyword">open</a> <a id="1082" class="Keyword">import</a> <a id="1089" href="Relation.Unary.html" class="Module">Relation.Unary</a> <a id="1104" class="Keyword">using</a> <a id="1110" class="Symbol">(</a><a id="1111" href="Relation.Unary.html#1110" class="Function">Pred</a><a id="1115" class="Symbol">;</a> <a id="1117" href="Relation.Unary.html#3684" class="Function">Decidable</a><a id="1126" class="Symbol">)</a>

<a id="1129" class="Keyword">open</a> <a id="1134" class="Keyword">import</a> <a id="1141" href="Data.List.Membership.DecPropositional.html" class="Module">Data.List.Membership.DecPropositional</a> <a id="1179" href="Data.Char.Properties.html#1499" class="Function Operator">Char._≟_</a>



<a id="1191" class="Comment">------------------------------------------------------------------------</a>
<a id="1264" class="Comment">-- Re-export contents of base, and decidability of equality</a>

<a id="1325" class="Keyword">open</a> <a id="1330" class="Keyword">import</a> <a id="1337" href="Data.String.Base.html" class="Module">Data.String.Base</a> <a id="1354" class="Keyword">public</a>
<a id="1361" class="Keyword">open</a> <a id="1366" class="Keyword">import</a> <a id="1373" href="Data.String.Properties.html" class="Module">Data.String.Properties</a> <a id="1396" class="Keyword">using</a> <a id="1402" class="Symbol">(</a><a id="1403" href="Data.String.Properties.html#1604" class="Function Operator">_≈?_</a><a id="1407" class="Symbol">;</a> <a id="1409" href="Data.String.Properties.html#2284" class="Function Operator">_≟_</a><a id="1412" class="Symbol">;</a> <a id="1414" href="Data.String.Properties.html#2570" class="Function Operator">_&lt;?_</a><a id="1418" class="Symbol">;</a> <a id="1420" href="Data.String.Properties.html#4349" class="Function Operator">_==_</a><a id="1424" class="Symbol">)</a> <a id="1426" class="Keyword">public</a>

<a id="1434" class="Comment">------------------------------------------------------------------------</a>
<a id="1507" class="Comment">-- Conversion functions</a>

<a id="toVec"></a><a id="1532" href="Data.String.html#1532" class="Function">toVec</a> <a id="1538" class="Symbol">:</a> <a id="1540" class="Symbol">(</a><a id="1541" href="Data.String.html#1541" class="Bound">s</a> <a id="1543" class="Symbol">:</a> <a id="1545" href="Agda.Builtin.String.html#318" class="Postulate">String</a><a id="1551" class="Symbol">)</a> <a id="1553" class="Symbol">→</a> <a id="1555" href="Data.Vec.Base.html#1066" class="Datatype">Vec</a> <a id="1559" href="Agda.Builtin.Char.html#221" class="Postulate">Char</a> <a id="1564" class="Symbol">(</a><a id="1565" href="Data.String.Base.html#2477" class="Function">length</a> <a id="1572" href="Data.String.html#1541" class="Bound">s</a><a id="1573" class="Symbol">)</a>
<a id="1575" href="Data.String.html#1532" class="Function">toVec</a> <a id="1581" href="Data.String.html#1581" class="Bound">s</a> <a id="1583" class="Symbol">=</a> <a id="1585" href="Data.Vec.Base.html#8509" class="Function">Vec.fromList</a> <a id="1598" class="Symbol">(</a><a id="1599" href="Data.String.Base.html#1540" class="Primitive">toList</a> <a id="1606" href="Data.String.html#1581" class="Bound">s</a><a id="1607" class="Symbol">)</a>

<a id="fromVec"></a><a id="1610" href="Data.String.html#1610" class="Function">fromVec</a> <a id="1618" class="Symbol">:</a> <a id="1620" class="Symbol">∀</a> <a id="1622" class="Symbol">{</a><a id="1623" href="Data.String.html#1623" class="Bound">n</a><a id="1624" class="Symbol">}</a> <a id="1626" class="Symbol">→</a> <a id="1628" href="Data.Vec.Base.html#1066" class="Datatype">Vec</a> <a id="1632" href="Agda.Builtin.Char.html#221" class="Postulate">Char</a> <a id="1637" href="Data.String.html#1623" class="Bound">n</a> <a id="1639" class="Symbol">→</a> <a id="1641" href="Agda.Builtin.String.html#318" class="Postulate">String</a>
<a id="1648" href="Data.String.html#1610" class="Function">fromVec</a> <a id="1656" class="Symbol">=</a> <a id="1658" href="Data.String.Base.html#1573" class="Primitive">fromList</a> <a id="1667" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="1669" href="Data.Vec.Base.html#8415" class="Function">Vec.toList</a>


<a id="1682" class="Comment">-- enclose string with parens if it contains a space character</a>
<a id="parensIfSpace"></a><a id="1745" href="Data.String.html#1745" class="Function">parensIfSpace</a> <a id="1759" class="Symbol">:</a> <a id="1761" href="Agda.Builtin.String.html#318" class="Postulate">String</a> <a id="1768" class="Symbol">→</a> <a id="1770" href="Agda.Builtin.String.html#318" class="Postulate">String</a>
<a id="1777" href="Data.String.html#1745" class="Function">parensIfSpace</a> <a id="1791" href="Data.String.html#1791" class="Bound">s</a> <a id="1793" class="Keyword">with</a> <a id="1798" href="Relation.Nullary.html#1590" class="Field">does</a> <a id="1803" class="Symbol">(</a><a id="1804" class="String">&#39; &#39;</a> <a id="1808" href="Data.List.Membership.DecSetoid.html#826" class="Function Operator">∈?</a> <a id="1811" href="Data.String.Base.html#1540" class="Primitive">toList</a> <a id="1818" href="Data.String.html#1791" class="Bound">s</a><a id="1819" class="Symbol">)</a>
<a id="1821" class="Symbol">...</a> <a id="1825" class="Symbol">|</a> <a id="1827" href="Agda.Builtin.Bool.html#181" class="InductiveConstructor">true</a>  <a id="1833" class="Symbol">=</a> <a id="1835" href="Data.String.Base.html#2873" class="Function">parens</a> <a id="1842" class="Bound">s</a>
<a id="1844" class="Symbol">...</a> <a id="1848" class="Symbol">|</a> <a id="1850" href="Agda.Builtin.Bool.html#175" class="InductiveConstructor">false</a> <a id="1856" class="Symbol">=</a> <a id="1858" class="Bound">s</a>


<a id="1862" class="Comment">------------------------------------------------------------------------</a>
<a id="1935" class="Comment">-- Rectangle</a>

<a id="1949" class="Comment">-- Build a rectangular column by:</a>
<a id="1983" class="Comment">-- Given a vector of cells and a padding function for each one</a>
<a id="2046" class="Comment">-- Compute the max of the widths, and pad the strings accordingly.</a>

<a id="rectangle"></a><a id="2114" href="Data.String.html#2114" class="Function">rectangle</a> <a id="2124" class="Symbol">:</a> <a id="2126" class="Symbol">∀</a> <a id="2128" class="Symbol">{</a><a id="2129" href="Data.String.html#2129" class="Bound">n</a><a id="2130" class="Symbol">}</a> <a id="2132" class="Symbol">→</a> <a id="2134" href="Data.Vec.Base.html#1066" class="Datatype">Vec</a> <a id="2138" class="Symbol">(</a><a id="2139" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a> <a id="2141" class="Symbol">→</a> <a id="2143" href="Agda.Builtin.String.html#318" class="Postulate">String</a> <a id="2150" class="Symbol">→</a> <a id="2152" href="Agda.Builtin.String.html#318" class="Postulate">String</a><a id="2158" class="Symbol">)</a> <a id="2160" href="Data.String.html#2129" class="Bound">n</a> <a id="2162" class="Symbol">→</a>
            <a id="2176" href="Data.Vec.Base.html#1066" class="Datatype">Vec</a> <a id="2180" href="Agda.Builtin.String.html#318" class="Postulate">String</a> <a id="2187" href="Data.String.html#2129" class="Bound">n</a> <a id="2189" class="Symbol">→</a> <a id="2191" href="Data.Vec.Base.html#1066" class="Datatype">Vec</a> <a id="2195" href="Agda.Builtin.String.html#318" class="Postulate">String</a> <a id="2202" href="Data.String.html#2129" class="Bound">n</a>
<a id="2204" href="Data.String.html#2114" class="Function">rectangle</a> <a id="2214" href="Data.String.html#2214" class="Bound">pads</a> <a id="2219" href="Data.String.html#2219" class="Bound">cells</a> <a id="2225" class="Symbol">=</a> <a id="2227" href="Data.Vec.Base.html#3582" class="Function">Vec.zipWith</a> <a id="2239" class="Symbol">(λ</a> <a id="2242" href="Data.String.html#2242" class="Bound">p</a> <a id="2244" href="Data.String.html#2244" class="Bound">c</a> <a id="2246" class="Symbol">→</a> <a id="2248" href="Data.String.html#2242" class="Bound">p</a> <a id="2250" href="Data.String.html#2324" class="Function">width</a> <a id="2256" href="Data.String.html#2244" class="Bound">c</a><a id="2257" class="Symbol">)</a> <a id="2259" href="Data.String.html#2214" class="Bound">pads</a> <a id="2264" href="Data.String.html#2219" class="Bound">cells</a> <a id="2270" class="Keyword">where</a>

  <a id="2279" href="Data.String.html#2279" class="Function">sizes</a> <a id="2285" class="Symbol">=</a> <a id="2287" href="Data.List.Base.html#1572" class="Function">List.map</a> <a id="2296" href="Data.String.Base.html#2477" class="Function">length</a> <a id="2303" class="Symbol">(</a><a id="2304" href="Data.Vec.Base.html#8415" class="Function">Vec.toList</a> <a id="2315" href="Data.String.html#2219" class="Bound">cells</a><a id="2320" class="Symbol">)</a>
  <a id="2324" href="Data.String.html#2324" class="Function">width</a> <a id="2330" class="Symbol">=</a> <a id="2332" href="Data.List.Extrema.html#1945" class="Function">max</a> <a id="2336" class="Number">0</a> <a id="2338" href="Data.String.html#2279" class="Function">sizes</a>

<a id="2345" class="Comment">-- Special cases for left, center, and right alignment</a>

<a id="rectangleˡ"></a><a id="2401" href="Data.String.html#2401" class="Function">rectangleˡ</a> <a id="2412" class="Symbol">:</a> <a id="2414" class="Symbol">∀</a> <a id="2416" class="Symbol">{</a><a id="2417" href="Data.String.html#2417" class="Bound">n</a><a id="2418" class="Symbol">}</a> <a id="2420" class="Symbol">→</a> <a id="2422" href="Agda.Builtin.Char.html#221" class="Postulate">Char</a> <a id="2427" class="Symbol">→</a> <a id="2429" href="Data.Vec.Base.html#1066" class="Datatype">Vec</a> <a id="2433" href="Agda.Builtin.String.html#318" class="Postulate">String</a> <a id="2440" href="Data.String.html#2417" class="Bound">n</a> <a id="2442" class="Symbol">→</a> <a id="2444" href="Data.Vec.Base.html#1066" class="Datatype">Vec</a> <a id="2448" href="Agda.Builtin.String.html#318" class="Postulate">String</a> <a id="2455" href="Data.String.html#2417" class="Bound">n</a>
<a id="2457" href="Data.String.html#2401" class="Function">rectangleˡ</a> <a id="2468" href="Data.String.html#2468" class="Bound">c</a> <a id="2470" class="Symbol">=</a> <a id="2472" href="Data.String.html#2114" class="Function">rectangle</a> <a id="2482" class="Symbol">(</a><a id="2483" href="Data.Vec.Base.html#6331" class="Function">Vec.replicate</a> <a id="2497" href="Function.Base.html#2003" class="Function Operator">$</a> <a id="2499" href="Data.String.Base.html#3605" class="Function">padLeft</a> <a id="2507" href="Data.String.html#2468" class="Bound">c</a><a id="2508" class="Symbol">)</a>

<a id="rectangleʳ"></a><a id="2511" href="Data.String.html#2511" class="Function">rectangleʳ</a> <a id="2522" class="Symbol">:</a> <a id="2524" class="Symbol">∀</a> <a id="2526" class="Symbol">{</a><a id="2527" href="Data.String.html#2527" class="Bound">n</a><a id="2528" class="Symbol">}</a> <a id="2530" class="Symbol">→</a> <a id="2532" href="Agda.Builtin.Char.html#221" class="Postulate">Char</a> <a id="2537" class="Symbol">→</a> <a id="2539" href="Data.Vec.Base.html#1066" class="Datatype">Vec</a> <a id="2543" href="Agda.Builtin.String.html#318" class="Postulate">String</a> <a id="2550" href="Data.String.html#2527" class="Bound">n</a> <a id="2552" class="Symbol">→</a> <a id="2554" href="Data.Vec.Base.html#1066" class="Datatype">Vec</a> <a id="2558" href="Agda.Builtin.String.html#318" class="Postulate">String</a> <a id="2565" href="Data.String.html#2527" class="Bound">n</a>
<a id="2567" href="Data.String.html#2511" class="Function">rectangleʳ</a> <a id="2578" href="Data.String.html#2578" class="Bound">c</a> <a id="2580" class="Symbol">=</a> <a id="2582" href="Data.String.html#2114" class="Function">rectangle</a> <a id="2592" class="Symbol">(</a><a id="2593" href="Data.Vec.Base.html#6331" class="Function">Vec.replicate</a> <a id="2607" href="Function.Base.html#2003" class="Function Operator">$</a> <a id="2609" href="Data.String.Base.html#3724" class="Function">padRight</a> <a id="2618" href="Data.String.html#2578" class="Bound">c</a><a id="2619" class="Symbol">)</a>

<a id="rectangleᶜ"></a><a id="2622" href="Data.String.html#2622" class="Function">rectangleᶜ</a> <a id="2633" class="Symbol">:</a> <a id="2635" class="Symbol">∀</a> <a id="2637" class="Symbol">{</a><a id="2638" href="Data.String.html#2638" class="Bound">n</a><a id="2639" class="Symbol">}</a> <a id="2641" class="Symbol">→</a> <a id="2643" href="Agda.Builtin.Char.html#221" class="Postulate">Char</a> <a id="2648" class="Symbol">→</a> <a id="2650" href="Agda.Builtin.Char.html#221" class="Postulate">Char</a> <a id="2655" class="Symbol">→</a> <a id="2657" href="Data.Vec.Base.html#1066" class="Datatype">Vec</a> <a id="2661" href="Agda.Builtin.String.html#318" class="Postulate">String</a> <a id="2668" href="Data.String.html#2638" class="Bound">n</a> <a id="2670" class="Symbol">→</a> <a id="2672" href="Data.Vec.Base.html#1066" class="Datatype">Vec</a> <a id="2676" href="Agda.Builtin.String.html#318" class="Postulate">String</a> <a id="2683" href="Data.String.html#2638" class="Bound">n</a>
<a id="2685" href="Data.String.html#2622" class="Function">rectangleᶜ</a> <a id="2696" href="Data.String.html#2696" class="Bound">cₗ</a> <a id="2699" href="Data.String.html#2699" class="Bound">cᵣ</a> <a id="2702" class="Symbol">=</a> <a id="2704" href="Data.String.html#2114" class="Function">rectangle</a> <a id="2714" class="Symbol">(</a><a id="2715" href="Data.Vec.Base.html#6331" class="Function">Vec.replicate</a> <a id="2729" href="Function.Base.html#2003" class="Function Operator">$</a> <a id="2731" href="Data.String.Base.html#3845" class="Function">padBoth</a> <a id="2739" href="Data.String.html#2696" class="Bound">cₗ</a> <a id="2742" href="Data.String.html#2699" class="Bound">cᵣ</a><a id="2744" class="Symbol">)</a>
</pre></body></html>