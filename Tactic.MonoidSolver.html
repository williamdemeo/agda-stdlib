<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Tactic.MonoidSolver</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- The Agda standard library</a>
<a id="103" class="Comment">--</a>
<a id="106" class="Comment">-- Reflection-based solver for monoid equalities</a>
<a id="155" class="Comment">------------------------------------------------------------------------</a>
<a id="228" class="Comment">--</a>
<a id="231" class="Comment">-- This solver automates the construction of proofs of equivalences</a>
<a id="299" class="Comment">-- between monoid expressions.</a>
<a id="330" class="Comment">-- When called like so:</a>
<a id="354" class="Comment">--</a>
<a id="357" class="Comment">--   proof : ∀ x y z → (x ∙ y) ∙ z ≈ x ∙ (y ∙ z) ∙ ε</a>
<a id="410" class="Comment">--   proof x y z = solve mon</a>
<a id="439" class="Comment">--</a>
<a id="442" class="Comment">-- The following diagram describes what happens under the hood:</a>
<a id="506" class="Comment">--</a>
<a id="509" class="Comment">--            ┌▸x ∙ (y ∙ (z ∙ ε)) ════ x ∙ (y ∙ (z ∙ ε))◂┐</a>
<a id="568" class="Comment">--            │         ║                      ║         │</a>
<a id="627" class="Comment">--            │         ║                      ║         │</a>
<a id="686" class="Comment">--          [_⇓]        ║                      ║        [_⇓]</a>
<a id="747" class="Comment">--          ╱           ║                      ║          ╲</a>
<a id="807" class="Comment">--         ╱            ║                      ║           ╲</a>
<a id="868" class="Comment">-- (x ∙′ y) ∙′ z      homo                   homo    x ∙′ (y ∙′ z) ∙′ ε′</a>
<a id="941" class="Comment">--   ▴     ╲            ║                      ║           ╱       ▴</a>
<a id="1010" class="Comment">--   │      ╲           ║                      ║          ╱        │</a>
<a id="1079" class="Comment">--   │       [_↓]       ║                      ║        [_↓]       │</a>
<a id="1148" class="Comment">--   │        │         ║                      ║         │         │</a>
<a id="1217" class="Comment">--   │        │         ║                      ║         │         │</a>
<a id="1286" class="Comment">--   │        └───▸(x ∙ y) ∙ z          x ∙ (y ∙ z) ∙ ε◂─┘         │</a>
<a id="1355" class="Comment">--   │                  │                      │                   │</a>
<a id="1424" class="Comment">--   │                  │                      │                   │</a>
<a id="1493" class="Comment">--   └────reflection────┘                      └───reflection──────┘</a>
<a id="1562" class="Comment">--</a>
<a id="1565" class="Comment">-- The actual output—the proof constructed by the solver—is represented</a>
<a id="1637" class="Comment">-- by the double-lined path (══).</a>
<a id="1671" class="Comment">--</a>
<a id="1674" class="Comment">-- We start at the bottom, with our two expressions.</a>
<a id="1727" class="Comment">-- Through reflection, we convert these two expressions to their AST</a>
<a id="1796" class="Comment">-- representations, in the Expr type.</a>
<a id="1834" class="Comment">-- We then can evaluate the AST in two ways: one simply gives us back</a>
<a id="1904" class="Comment">-- the two expressions we put in ([_↓]), and the other normalises</a>
<a id="1970" class="Comment">-- ([_⇓]).</a>
<a id="1981" class="Comment">-- We use the homo function to prove equivalence between these two</a>
<a id="2048" class="Comment">-- forms: joining up these two proofs gives us the desired overall</a>
<a id="2115" class="Comment">-- proof.</a>

<a id="2126" class="Comment">-- Note: What&#39;s going on with the Monoid parameter?</a>
<a id="2178" class="Comment">--</a>
<a id="2181" class="Comment">-- This module is not parameterised over a monoid, which is contrary</a>
<a id="2250" class="Comment">-- to what you might expect. Instead, we take the monoid record as an</a>
<a id="2320" class="Comment">-- argument to the solve macro, and then pass it around as an</a>
<a id="2382" class="Comment">-- argument wherever we need it.</a>
<a id="2415" class="Comment">--</a>
<a id="2418" class="Comment">-- We need to get the monoid record at the call site, not the import</a>
<a id="2487" class="Comment">-- site, to ensure that it&#39;s consistent with the rest of the context.</a>
<a id="2557" class="Comment">-- For instance, if we wanted to produce `x ∙ y` using the monoid record</a>
<a id="2630" class="Comment">-- as imported, we would run into problems:</a>
<a id="2674" class="Comment">-- * If we tried to just reflect on the expression itself</a>
<a id="2732" class="Comment">--   (quoteTerm (x ∙ y)) we would likely get some de Bruijn indices</a>
<a id="2800" class="Comment">--   wrong (in x and y), and ∙ might not even be in scope where the</a>
<a id="2868" class="Comment">--   user wants us to solve! If they&#39;re solving an expression like</a>
<a id="2935" class="Comment">--   x + (y + z), they can pass in the +-0-monoid, but don&#39;t have to</a>
<a id="3004" class="Comment">--   open it themselves.</a>
<a id="3029" class="Comment">-- * If instead we tried to construct a term which accesses the _∙_</a>
<a id="3097" class="Comment">--   field on the reflection of the record, we&#39;d run into similar</a>
<a id="3163" class="Comment">--   problems again. While the record is a parameter for us, it might</a>
<a id="3233" class="Comment">--   not be for the user.</a>
<a id="3259" class="Comment">-- Basically, we need the Monoid we&#39;re looking at to be exactly the</a>
<a id="3327" class="Comment">-- same as the one the user is looking at, and in order to do that we</a>
<a id="3397" class="Comment">-- quote it at the call site.</a>

<a id="3428" class="Symbol">{-#</a> <a id="3432" class="Keyword">OPTIONS</a> <a id="3440" class="Pragma">--without-K</a> <a id="3452" class="Pragma">--safe</a> <a id="3459" class="Symbol">#-}</a>

<a id="3464" class="Keyword">module</a> <a id="3471" href="Tactic.MonoidSolver.html" class="Module">Tactic.MonoidSolver</a> <a id="3491" class="Keyword">where</a>

<a id="3498" class="Keyword">open</a> <a id="3503" class="Keyword">import</a> <a id="3510" href="Algebra.html" class="Module">Algebra</a>
<a id="3518" class="Keyword">open</a> <a id="3523" class="Keyword">import</a> <a id="3530" href="Function.html" class="Module">Function</a>

<a id="3540" class="Keyword">open</a> <a id="3545" class="Keyword">import</a> <a id="3552" href="Data.Bool.html" class="Module">Data.Bool</a>    <a id="3565" class="Symbol">as</a> <a id="3568" class="Module">Bool</a>    <a id="3576" class="Keyword">using</a> <a id="3582" class="Symbol">(</a><a id="3583" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a><a id="3587" class="Symbol">;</a> <a id="3589" href="Data.Bool.Base.html#1044" class="Function Operator">_∨_</a><a id="3592" class="Symbol">;</a> <a id="3594" href="Data.Bool.Base.html#1283" class="Function Operator">if_then_else_</a><a id="3607" class="Symbol">)</a>
<a id="3609" class="Keyword">open</a> <a id="3614" class="Keyword">import</a> <a id="3621" href="Data.Maybe.html" class="Module">Data.Maybe</a>   <a id="3634" class="Symbol">as</a> <a id="3637" class="Module">Maybe</a>   <a id="3645" class="Keyword">using</a> <a id="3651" class="Symbol">(</a><a id="3652" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a><a id="3657" class="Symbol">;</a> <a id="3659" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a><a id="3663" class="Symbol">;</a> <a id="3665" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a><a id="3672" class="Symbol">;</a> <a id="3674" href="Data.Maybe.Base.html#1377" class="Function">maybe</a><a id="3679" class="Symbol">)</a>
<a id="3681" class="Keyword">open</a> <a id="3686" class="Keyword">import</a> <a id="3693" href="Data.List.html" class="Module">Data.List</a>    <a id="3706" class="Symbol">as</a> <a id="3709" class="Module">List</a>    <a id="3717" class="Keyword">using</a> <a id="3723" class="Symbol">(</a><a id="3724" href="Agda.Builtin.List.html#148" class="Datatype">List</a><a id="3728" class="Symbol">;</a> <a id="3730" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">_∷_</a><a id="3733" class="Symbol">;</a> <a id="3735" href="Data.List.Base.html#7361" class="InductiveConstructor">[]</a><a id="3737" class="Symbol">)</a>
<a id="3739" class="Keyword">open</a> <a id="3744" class="Keyword">import</a> <a id="3751" href="Data.Nat.html" class="Module">Data.Nat</a>     <a id="3764" class="Symbol">as</a> <a id="3767" class="Module">ℕ</a>       <a id="3775" class="Keyword">using</a> <a id="3781" class="Symbol">(</a><a id="3782" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="3783" class="Symbol">;</a> <a id="3785" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a><a id="3788" class="Symbol">;</a> <a id="3790" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a><a id="3794" class="Symbol">)</a>
<a id="3796" class="Keyword">open</a> <a id="3801" class="Keyword">import</a> <a id="3808" href="Data.Product.html" class="Module">Data.Product</a> <a id="3821" class="Symbol">as</a> <a id="3824" class="Module">Product</a> <a id="3832" class="Keyword">using</a> <a id="3838" class="Symbol">(</a><a id="3839" href="Data.Product.Base.html#1109" class="Function Operator">_×_</a><a id="3842" class="Symbol">;</a> <a id="3844" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">_,_</a><a id="3847" class="Symbol">)</a>

<a id="3850" class="Keyword">open</a> <a id="3855" class="Keyword">import</a> <a id="3862" href="Reflection.AST.html" class="Module">Reflection.AST</a>
<a id="3877" class="Keyword">open</a> <a id="3882" class="Keyword">import</a> <a id="3889" href="Reflection.AST.Term.html" class="Module">Reflection.AST.Term</a>
<a id="3909" class="Keyword">open</a> <a id="3914" class="Keyword">import</a> <a id="3921" href="Reflection.AST.Argument.html" class="Module">Reflection.AST.Argument</a>
<a id="3945" class="Keyword">import</a> <a id="3952" href="Reflection.AST.Name.html" class="Module">Reflection.AST.Name</a> <a id="3972" class="Symbol">as</a> <a id="3975" class="Module">Name</a>
<a id="3980" class="Keyword">open</a> <a id="3985" class="Keyword">import</a> <a id="3992" href="Reflection.TCM.html" class="Module">Reflection.TCM</a>
<a id="4007" class="Keyword">open</a> <a id="4012" class="Keyword">import</a> <a id="4019" href="Reflection.TCM.Syntax.html" class="Module">Reflection.TCM.Syntax</a>

<a id="4042" class="Keyword">import</a> <a id="4049" href="Relation.Binary.Reasoning.Setoid.html" class="Module">Relation.Binary.Reasoning.Setoid</a> <a id="4082" class="Symbol">as</a> <a id="4085" class="Module">SetoidReasoning</a>

<a id="4102" class="Comment">----------------------------------------------------------------------</a>
<a id="4173" class="Comment">-- The Expr type with homomorphism proofs</a>
<a id="4215" class="Comment">----------------------------------------------------------------------</a>

<a id="4287" class="Keyword">infixl</a> <a id="4294" class="Number">7</a> <a id="4296" href="Tactic.MonoidSolver.html#4343" class="InductiveConstructor Operator">_∙′_</a>
<a id="4301" class="Keyword">data</a> <a id="Expr"></a><a id="4306" href="Tactic.MonoidSolver.html#4306" class="Datatype">Expr</a> <a id="4311" class="Symbol">{</a><a id="4312" href="Tactic.MonoidSolver.html#4312" class="Bound">a</a><a id="4313" class="Symbol">}</a> <a id="4315" class="Symbol">(</a><a id="4316" href="Tactic.MonoidSolver.html#4316" class="Bound">A</a> <a id="4318" class="Symbol">:</a> <a id="4320" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="4324" href="Tactic.MonoidSolver.html#4312" class="Bound">a</a><a id="4325" class="Symbol">)</a> <a id="4327" class="Symbol">:</a> <a id="4329" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="4333" href="Tactic.MonoidSolver.html#4312" class="Bound">a</a> <a id="4335" class="Keyword">where</a>
  <a id="Expr._∙′_"></a><a id="4343" href="Tactic.MonoidSolver.html#4343" class="InductiveConstructor Operator">_∙′_</a>  <a id="4349" class="Symbol">:</a> <a id="4351" href="Tactic.MonoidSolver.html#4306" class="Datatype">Expr</a> <a id="4356" href="Tactic.MonoidSolver.html#4316" class="Bound">A</a> <a id="4358" class="Symbol">→</a> <a id="4360" href="Tactic.MonoidSolver.html#4306" class="Datatype">Expr</a> <a id="4365" href="Tactic.MonoidSolver.html#4316" class="Bound">A</a> <a id="4367" class="Symbol">→</a> <a id="4369" href="Tactic.MonoidSolver.html#4306" class="Datatype">Expr</a> <a id="4374" href="Tactic.MonoidSolver.html#4316" class="Bound">A</a>
  <a id="Expr.ε′"></a><a id="4378" href="Tactic.MonoidSolver.html#4378" class="InductiveConstructor">ε′</a>    <a id="4384" class="Symbol">:</a> <a id="4386" href="Tactic.MonoidSolver.html#4306" class="Datatype">Expr</a> <a id="4391" href="Tactic.MonoidSolver.html#4316" class="Bound">A</a>
  <a id="Expr.[_↑]"></a><a id="4395" href="Tactic.MonoidSolver.html#4395" class="InductiveConstructor Operator">[_↑]</a>  <a id="4401" class="Symbol">:</a> <a id="4403" href="Tactic.MonoidSolver.html#4316" class="Bound">A</a> <a id="4405" class="Symbol">→</a> <a id="4407" href="Tactic.MonoidSolver.html#4306" class="Datatype">Expr</a> <a id="4412" href="Tactic.MonoidSolver.html#4316" class="Bound">A</a>

<a id="4415" class="Keyword">module</a> <a id="4422" href="Tactic.MonoidSolver.html#4422" class="Module">_</a> <a id="4424" class="Symbol">{</a><a id="4425" href="Tactic.MonoidSolver.html#4425" class="Bound">m₁</a> <a id="4428" href="Tactic.MonoidSolver.html#4428" class="Bound">m₂</a><a id="4430" class="Symbol">}</a> <a id="4432" class="Symbol">(</a><a id="4433" href="Tactic.MonoidSolver.html#4433" class="Bound">monoid</a> <a id="4440" class="Symbol">:</a> <a id="4442" href="Algebra.Bundles.html#6007" class="Record">Monoid</a> <a id="4449" href="Tactic.MonoidSolver.html#4425" class="Bound">m₁</a> <a id="4452" href="Tactic.MonoidSolver.html#4428" class="Bound">m₂</a><a id="4454" class="Symbol">)</a> <a id="4456" class="Keyword">where</a>

  <a id="4465" class="Keyword">open</a> <a id="4470" href="Algebra.Bundles.html#6007" class="Module">Monoid</a> <a id="4477" href="Tactic.MonoidSolver.html#4433" class="Bound">monoid</a>
  <a id="4486" class="Keyword">open</a> <a id="4491" href="Relation.Binary.Reasoning.Setoid.html" class="Module">SetoidReasoning</a> <a id="4507" href="Algebra.Structures.html#1282" class="Function">setoid</a>

  <a id="4517" class="Comment">-- Convert the AST to an expression (i.e. evaluate it) without</a>
  <a id="4582" class="Comment">-- normalising.</a>
  <a id="4600" href="Tactic.MonoidSolver.html#4600" class="Function Operator">[_↓]</a> <a id="4605" class="Symbol">:</a> <a id="4607" href="Tactic.MonoidSolver.html#4306" class="Datatype">Expr</a> <a id="4612" href="Algebra.Bundles.html#6086" class="Field">Carrier</a> <a id="4620" class="Symbol">→</a> <a id="4622" href="Algebra.Bundles.html#6086" class="Field">Carrier</a>
  <a id="4632" href="Tactic.MonoidSolver.html#4600" class="Function Operator">[</a> <a id="4634" href="Tactic.MonoidSolver.html#4634" class="Bound">x</a> <a id="4636" href="Tactic.MonoidSolver.html#4343" class="InductiveConstructor Operator">∙′</a> <a id="4639" href="Tactic.MonoidSolver.html#4639" class="Bound">y</a>  <a id="4642" href="Tactic.MonoidSolver.html#4600" class="Function Operator">↓]</a> <a id="4645" class="Symbol">=</a> <a id="4647" href="Tactic.MonoidSolver.html#4600" class="Function Operator">[</a> <a id="4649" href="Tactic.MonoidSolver.html#4634" class="Bound">x</a> <a id="4651" href="Tactic.MonoidSolver.html#4600" class="Function Operator">↓]</a> <a id="4654" href="Algebra.Bundles.html#6136" class="Field Operator">∙</a> <a id="4656" href="Tactic.MonoidSolver.html#4600" class="Function Operator">[</a> <a id="4658" href="Tactic.MonoidSolver.html#4639" class="Bound">y</a> <a id="4660" href="Tactic.MonoidSolver.html#4600" class="Function Operator">↓]</a>
  <a id="4665" href="Tactic.MonoidSolver.html#4600" class="Function Operator">[</a> <a id="4667" href="Tactic.MonoidSolver.html#4378" class="InductiveConstructor">ε′</a>      <a id="4675" href="Tactic.MonoidSolver.html#4600" class="Function Operator">↓]</a> <a id="4678" class="Symbol">=</a> <a id="4680" href="Algebra.Bundles.html#6163" class="Field">ε</a>
  <a id="4684" href="Tactic.MonoidSolver.html#4600" class="Function Operator">[</a> <a id="4686" href="Tactic.MonoidSolver.html#4395" class="InductiveConstructor Operator">[</a> <a id="4688" href="Tactic.MonoidSolver.html#4688" class="Bound">x</a> <a id="4690" href="Tactic.MonoidSolver.html#4395" class="InductiveConstructor Operator">↑]</a>  <a id="4694" href="Tactic.MonoidSolver.html#4600" class="Function Operator">↓]</a> <a id="4697" class="Symbol">=</a> <a id="4699" href="Tactic.MonoidSolver.html#4688" class="Bound">x</a>

  <a id="4704" class="Comment">-- Convert an AST to an expression (i.e. evaluate it) while</a>
  <a id="4766" class="Comment">-- normalising.</a>
  <a id="4784" class="Comment">--</a>
  <a id="4789" class="Comment">-- This first function actually converts an AST to the Cayley</a>
  <a id="4853" class="Comment">-- representation of the underlying monoid.</a>
  <a id="4899" class="Comment">-- This obeys the monoid laws up to beta-eta equality, which is the</a>
  <a id="4969" class="Comment">-- property which gives us the &quot;normalising&quot; behaviour we want.</a>
  <a id="5035" href="Tactic.MonoidSolver.html#5035" class="Function Operator">[_⇓]′</a> <a id="5041" class="Symbol">:</a> <a id="5043" href="Tactic.MonoidSolver.html#4306" class="Datatype">Expr</a> <a id="5048" href="Algebra.Bundles.html#6086" class="Field">Carrier</a> <a id="5056" class="Symbol">→</a> <a id="5058" href="Algebra.Bundles.html#6086" class="Field">Carrier</a> <a id="5066" class="Symbol">→</a> <a id="5068" href="Algebra.Bundles.html#6086" class="Field">Carrier</a>
  <a id="5078" href="Tactic.MonoidSolver.html#5035" class="Function Operator">[</a> <a id="5080" href="Tactic.MonoidSolver.html#5080" class="Bound">x</a> <a id="5082" href="Tactic.MonoidSolver.html#4343" class="InductiveConstructor Operator">∙′</a> <a id="5085" href="Tactic.MonoidSolver.html#5085" class="Bound">y</a>  <a id="5088" href="Tactic.MonoidSolver.html#5035" class="Function Operator">⇓]′</a> <a id="5092" href="Tactic.MonoidSolver.html#5092" class="Bound">z</a> <a id="5094" class="Symbol">=</a> <a id="5096" href="Tactic.MonoidSolver.html#5035" class="Function Operator">[</a> <a id="5098" href="Tactic.MonoidSolver.html#5080" class="Bound">x</a> <a id="5100" href="Tactic.MonoidSolver.html#5035" class="Function Operator">⇓]′</a> <a id="5104" class="Symbol">(</a><a id="5105" href="Tactic.MonoidSolver.html#5035" class="Function Operator">[</a> <a id="5107" href="Tactic.MonoidSolver.html#5085" class="Bound">y</a> <a id="5109" href="Tactic.MonoidSolver.html#5035" class="Function Operator">⇓]′</a> <a id="5113" href="Tactic.MonoidSolver.html#5092" class="Bound">z</a><a id="5114" class="Symbol">)</a>
  <a id="5118" href="Tactic.MonoidSolver.html#5035" class="Function Operator">[</a> <a id="5120" href="Tactic.MonoidSolver.html#4378" class="InductiveConstructor">ε′</a>      <a id="5128" href="Tactic.MonoidSolver.html#5035" class="Function Operator">⇓]′</a> <a id="5132" href="Tactic.MonoidSolver.html#5132" class="Bound">y</a> <a id="5134" class="Symbol">=</a> <a id="5136" href="Tactic.MonoidSolver.html#5132" class="Bound">y</a>
  <a id="5140" href="Tactic.MonoidSolver.html#5035" class="Function Operator">[</a> <a id="5142" href="Tactic.MonoidSolver.html#4395" class="InductiveConstructor Operator">[</a> <a id="5144" href="Tactic.MonoidSolver.html#5144" class="Bound">x</a> <a id="5146" href="Tactic.MonoidSolver.html#4395" class="InductiveConstructor Operator">↑]</a>  <a id="5150" href="Tactic.MonoidSolver.html#5035" class="Function Operator">⇓]′</a> <a id="5154" href="Tactic.MonoidSolver.html#5154" class="Bound">y</a> <a id="5156" class="Symbol">=</a> <a id="5158" href="Tactic.MonoidSolver.html#5144" class="Bound">x</a> <a id="5160" href="Algebra.Bundles.html#6136" class="Field Operator">∙</a> <a id="5162" href="Tactic.MonoidSolver.html#5154" class="Bound">y</a>

  <a id="5167" href="Tactic.MonoidSolver.html#5167" class="Function Operator">[_⇓]</a> <a id="5172" class="Symbol">:</a> <a id="5174" href="Tactic.MonoidSolver.html#4306" class="Datatype">Expr</a> <a id="5179" href="Algebra.Bundles.html#6086" class="Field">Carrier</a> <a id="5187" class="Symbol">→</a> <a id="5189" href="Algebra.Bundles.html#6086" class="Field">Carrier</a>
  <a id="5199" href="Tactic.MonoidSolver.html#5167" class="Function Operator">[</a> <a id="5201" href="Tactic.MonoidSolver.html#5201" class="Bound">x</a> <a id="5203" href="Tactic.MonoidSolver.html#5167" class="Function Operator">⇓]</a> <a id="5206" class="Symbol">=</a> <a id="5208" href="Tactic.MonoidSolver.html#5035" class="Function Operator">[</a> <a id="5210" href="Tactic.MonoidSolver.html#5201" class="Bound">x</a> <a id="5212" href="Tactic.MonoidSolver.html#5035" class="Function Operator">⇓]′</a> <a id="5216" href="Algebra.Bundles.html#6163" class="Field">ε</a>

  <a id="5221" href="Tactic.MonoidSolver.html#5221" class="Function">homo′</a> <a id="5227" class="Symbol">:</a> <a id="5229" class="Symbol">∀</a> <a id="5231" href="Tactic.MonoidSolver.html#5231" class="Bound">x</a> <a id="5233" href="Tactic.MonoidSolver.html#5233" class="Bound">y</a> <a id="5235" class="Symbol">→</a> <a id="5237" href="Tactic.MonoidSolver.html#5167" class="Function Operator">[</a> <a id="5239" href="Tactic.MonoidSolver.html#5231" class="Bound">x</a> <a id="5241" href="Tactic.MonoidSolver.html#5167" class="Function Operator">⇓]</a> <a id="5244" href="Algebra.Bundles.html#6136" class="Field Operator">∙</a> <a id="5246" href="Tactic.MonoidSolver.html#5233" class="Bound">y</a> <a id="5248" href="Algebra.Bundles.html#6107" class="Field Operator">≈</a> <a id="5250" href="Tactic.MonoidSolver.html#5035" class="Function Operator">[</a> <a id="5252" href="Tactic.MonoidSolver.html#5231" class="Bound">x</a> <a id="5254" href="Tactic.MonoidSolver.html#5035" class="Function Operator">⇓]′</a> <a id="5258" href="Tactic.MonoidSolver.html#5233" class="Bound">y</a>
  <a id="5262" href="Tactic.MonoidSolver.html#5221" class="Function">homo′</a> <a id="5268" href="Tactic.MonoidSolver.html#4378" class="InductiveConstructor">ε′</a> <a id="5271" href="Tactic.MonoidSolver.html#5271" class="Bound">y</a>       <a id="5279" class="Symbol">=</a> <a id="5281" href="Algebra.Structures.html#4028" class="Function">identityˡ</a> <a id="5291" href="Tactic.MonoidSolver.html#5271" class="Bound">y</a>
  <a id="5295" href="Tactic.MonoidSolver.html#5221" class="Function">homo′</a> <a id="5301" href="Tactic.MonoidSolver.html#4395" class="InductiveConstructor Operator">[</a> <a id="5303" href="Tactic.MonoidSolver.html#5303" class="Bound">x</a> <a id="5305" href="Tactic.MonoidSolver.html#4395" class="InductiveConstructor Operator">↑]</a> <a id="5308" href="Tactic.MonoidSolver.html#5308" class="Bound">y</a>   <a id="5312" class="Symbol">=</a> <a id="5314" href="Algebra.Structures.html#1418" class="Function">∙-congʳ</a> <a id="5322" class="Symbol">(</a><a id="5323" href="Algebra.Structures.html#4089" class="Function">identityʳ</a> <a id="5333" href="Tactic.MonoidSolver.html#5303" class="Bound">x</a><a id="5334" class="Symbol">)</a>
  <a id="5338" href="Tactic.MonoidSolver.html#5221" class="Function">homo′</a> <a id="5344" class="Symbol">(</a><a id="5345" href="Tactic.MonoidSolver.html#5345" class="Bound">x</a> <a id="5347" href="Tactic.MonoidSolver.html#4343" class="InductiveConstructor Operator">∙′</a> <a id="5350" href="Tactic.MonoidSolver.html#5350" class="Bound">y</a><a id="5351" class="Symbol">)</a> <a id="5353" href="Tactic.MonoidSolver.html#5353" class="Bound">z</a> <a id="5355" class="Symbol">=</a> <a id="5357" href="Relation.Binary.Reasoning.Base.Single.html#1916" class="Function Operator">begin</a>
    <a id="5367" href="Tactic.MonoidSolver.html#5167" class="Function Operator">[</a> <a id="5369" href="Tactic.MonoidSolver.html#5345" class="Bound">x</a> <a id="5371" href="Tactic.MonoidSolver.html#4343" class="InductiveConstructor Operator">∙′</a> <a id="5374" href="Tactic.MonoidSolver.html#5350" class="Bound">y</a> <a id="5376" href="Tactic.MonoidSolver.html#5167" class="Function Operator">⇓]</a> <a id="5379" href="Algebra.Bundles.html#6136" class="Field Operator">∙</a> <a id="5381" href="Tactic.MonoidSolver.html#5353" class="Bound">z</a>       <a id="5389" href="Relation.Binary.Reasoning.Base.Single.html#2470" class="Function Operator">≡⟨⟩</a>
    <a id="5397" href="Tactic.MonoidSolver.html#5035" class="Function Operator">[</a> <a id="5399" href="Tactic.MonoidSolver.html#5345" class="Bound">x</a> <a id="5401" href="Tactic.MonoidSolver.html#5035" class="Function Operator">⇓]′</a> <a id="5405" href="Tactic.MonoidSolver.html#5167" class="Function Operator">[</a> <a id="5407" href="Tactic.MonoidSolver.html#5350" class="Bound">y</a> <a id="5409" href="Tactic.MonoidSolver.html#5167" class="Function Operator">⇓]</a> <a id="5412" href="Algebra.Bundles.html#6136" class="Field Operator">∙</a> <a id="5414" href="Tactic.MonoidSolver.html#5353" class="Bound">z</a>    <a id="5419" href="Relation.Binary.Reasoning.Setoid.html#1153" class="Function">≈˘⟨</a> <a id="5423" href="Algebra.Structures.html#1418" class="Function">∙-congʳ</a> <a id="5431" class="Symbol">(</a><a id="5432" href="Tactic.MonoidSolver.html#5221" class="Function">homo′</a> <a id="5438" href="Tactic.MonoidSolver.html#5345" class="Bound">x</a> <a id="5440" href="Tactic.MonoidSolver.html#5167" class="Function Operator">[</a> <a id="5442" href="Tactic.MonoidSolver.html#5350" class="Bound">y</a> <a id="5444" href="Tactic.MonoidSolver.html#5167" class="Function Operator">⇓]</a><a id="5446" class="Symbol">)</a> <a id="5448" href="Relation.Binary.Reasoning.Setoid.html#1153" class="Function">⟩</a>
    <a id="5454" class="Symbol">(</a><a id="5455" href="Tactic.MonoidSolver.html#5167" class="Function Operator">[</a> <a id="5457" href="Tactic.MonoidSolver.html#5345" class="Bound">x</a> <a id="5459" href="Tactic.MonoidSolver.html#5167" class="Function Operator">⇓]</a> <a id="5462" href="Algebra.Bundles.html#6136" class="Field Operator">∙</a> <a id="5464" href="Tactic.MonoidSolver.html#5167" class="Function Operator">[</a> <a id="5466" href="Tactic.MonoidSolver.html#5350" class="Bound">y</a> <a id="5468" href="Tactic.MonoidSolver.html#5167" class="Function Operator">⇓]</a><a id="5470" class="Symbol">)</a> <a id="5472" href="Algebra.Bundles.html#6136" class="Field Operator">∙</a> <a id="5474" href="Tactic.MonoidSolver.html#5353" class="Bound">z</a> <a id="5476" href="Relation.Binary.Reasoning.Setoid.html#1052" class="Function">≈⟨</a> <a id="5479" href="Algebra.Structures.html#2869" class="Function">assoc</a> <a id="5485" href="Tactic.MonoidSolver.html#5167" class="Function Operator">[</a> <a id="5487" href="Tactic.MonoidSolver.html#5345" class="Bound">x</a> <a id="5489" href="Tactic.MonoidSolver.html#5167" class="Function Operator">⇓]</a> <a id="5492" href="Tactic.MonoidSolver.html#5167" class="Function Operator">[</a> <a id="5494" href="Tactic.MonoidSolver.html#5350" class="Bound">y</a> <a id="5496" href="Tactic.MonoidSolver.html#5167" class="Function Operator">⇓]</a> <a id="5499" href="Tactic.MonoidSolver.html#5353" class="Bound">z</a> <a id="5501" href="Relation.Binary.Reasoning.Setoid.html#1052" class="Function">⟩</a>
    <a id="5507" href="Tactic.MonoidSolver.html#5167" class="Function Operator">[</a> <a id="5509" href="Tactic.MonoidSolver.html#5345" class="Bound">x</a> <a id="5511" href="Tactic.MonoidSolver.html#5167" class="Function Operator">⇓]</a> <a id="5514" href="Algebra.Bundles.html#6136" class="Field Operator">∙</a> <a id="5516" class="Symbol">(</a><a id="5517" href="Tactic.MonoidSolver.html#5167" class="Function Operator">[</a> <a id="5519" href="Tactic.MonoidSolver.html#5350" class="Bound">y</a> <a id="5521" href="Tactic.MonoidSolver.html#5167" class="Function Operator">⇓]</a> <a id="5524" href="Algebra.Bundles.html#6136" class="Field Operator">∙</a> <a id="5526" href="Tactic.MonoidSolver.html#5353" class="Bound">z</a><a id="5527" class="Symbol">)</a> <a id="5529" href="Relation.Binary.Reasoning.Setoid.html#1052" class="Function">≈⟨</a> <a id="5532" href="Algebra.Structures.html#1357" class="Function">∙-congˡ</a> <a id="5540" class="Symbol">(</a><a id="5541" href="Tactic.MonoidSolver.html#5221" class="Function">homo′</a> <a id="5547" href="Tactic.MonoidSolver.html#5350" class="Bound">y</a> <a id="5549" href="Tactic.MonoidSolver.html#5353" class="Bound">z</a><a id="5550" class="Symbol">)</a> <a id="5552" href="Relation.Binary.Reasoning.Setoid.html#1052" class="Function">⟩</a>
    <a id="5558" href="Tactic.MonoidSolver.html#5167" class="Function Operator">[</a> <a id="5560" href="Tactic.MonoidSolver.html#5345" class="Bound">x</a> <a id="5562" href="Tactic.MonoidSolver.html#5167" class="Function Operator">⇓]</a> <a id="5565" href="Algebra.Bundles.html#6136" class="Field Operator">∙</a> <a id="5567" class="Symbol">(</a><a id="5568" href="Tactic.MonoidSolver.html#5035" class="Function Operator">[</a> <a id="5570" href="Tactic.MonoidSolver.html#5350" class="Bound">y</a> <a id="5572" href="Tactic.MonoidSolver.html#5035" class="Function Operator">⇓]′</a> <a id="5576" href="Tactic.MonoidSolver.html#5353" class="Bound">z</a><a id="5577" class="Symbol">)</a>  <a id="5580" href="Relation.Binary.Reasoning.Setoid.html#1052" class="Function">≈⟨</a> <a id="5583" href="Tactic.MonoidSolver.html#5221" class="Function">homo′</a> <a id="5589" href="Tactic.MonoidSolver.html#5345" class="Bound">x</a> <a id="5591" class="Symbol">(</a><a id="5592" href="Tactic.MonoidSolver.html#5035" class="Function Operator">[</a> <a id="5594" href="Tactic.MonoidSolver.html#5350" class="Bound">y</a> <a id="5596" href="Tactic.MonoidSolver.html#5035" class="Function Operator">⇓]′</a> <a id="5600" href="Tactic.MonoidSolver.html#5353" class="Bound">z</a><a id="5601" class="Symbol">)</a> <a id="5603" href="Relation.Binary.Reasoning.Setoid.html#1052" class="Function">⟩</a>
    <a id="5609" href="Tactic.MonoidSolver.html#5035" class="Function Operator">[</a> <a id="5611" href="Tactic.MonoidSolver.html#5345" class="Bound">x</a> <a id="5613" href="Tactic.MonoidSolver.html#5035" class="Function Operator">⇓]′</a> <a id="5617" class="Symbol">(</a><a id="5618" href="Tactic.MonoidSolver.html#5035" class="Function Operator">[</a> <a id="5620" href="Tactic.MonoidSolver.html#5350" class="Bound">y</a> <a id="5622" href="Tactic.MonoidSolver.html#5035" class="Function Operator">⇓]′</a> <a id="5626" href="Tactic.MonoidSolver.html#5353" class="Bound">z</a><a id="5627" class="Symbol">)</a>   <a id="5631" href="Relation.Binary.Reasoning.Base.Single.html#2555" class="Function Operator">∎</a>

  <a id="5636" href="Tactic.MonoidSolver.html#5636" class="Function">homo</a> <a id="5641" class="Symbol">:</a> <a id="5643" class="Symbol">∀</a> <a id="5645" href="Tactic.MonoidSolver.html#5645" class="Bound">x</a> <a id="5647" class="Symbol">→</a> <a id="5649" href="Tactic.MonoidSolver.html#5167" class="Function Operator">[</a> <a id="5651" href="Tactic.MonoidSolver.html#5645" class="Bound">x</a> <a id="5653" href="Tactic.MonoidSolver.html#5167" class="Function Operator">⇓]</a> <a id="5656" href="Algebra.Bundles.html#6107" class="Field Operator">≈</a> <a id="5658" href="Tactic.MonoidSolver.html#4600" class="Function Operator">[</a> <a id="5660" href="Tactic.MonoidSolver.html#5645" class="Bound">x</a> <a id="5662" href="Tactic.MonoidSolver.html#4600" class="Function Operator">↓]</a>
  <a id="5667" href="Tactic.MonoidSolver.html#5636" class="Function">homo</a> <a id="5672" href="Tactic.MonoidSolver.html#4378" class="InductiveConstructor">ε′</a>       <a id="5681" class="Symbol">=</a> <a id="5683" href="Relation.Binary.Structures.html#1582" class="Function">refl</a>
  <a id="5690" href="Tactic.MonoidSolver.html#5636" class="Function">homo</a> <a id="5695" href="Tactic.MonoidSolver.html#4395" class="InductiveConstructor Operator">[</a> <a id="5697" href="Tactic.MonoidSolver.html#5697" class="Bound">x</a> <a id="5699" href="Tactic.MonoidSolver.html#4395" class="InductiveConstructor Operator">↑]</a>   <a id="5704" class="Symbol">=</a> <a id="5706" href="Algebra.Structures.html#4089" class="Function">identityʳ</a> <a id="5716" href="Tactic.MonoidSolver.html#5697" class="Bound">x</a>
  <a id="5720" href="Tactic.MonoidSolver.html#5636" class="Function">homo</a> <a id="5725" class="Symbol">(</a><a id="5726" href="Tactic.MonoidSolver.html#5726" class="Bound">x</a> <a id="5728" href="Tactic.MonoidSolver.html#4343" class="InductiveConstructor Operator">∙′</a> <a id="5731" href="Tactic.MonoidSolver.html#5731" class="Bound">y</a><a id="5732" class="Symbol">)</a> <a id="5734" class="Symbol">=</a> <a id="5736" href="Relation.Binary.Reasoning.Base.Single.html#1916" class="Function Operator">begin</a>
    <a id="5746" href="Tactic.MonoidSolver.html#5167" class="Function Operator">[</a> <a id="5748" href="Tactic.MonoidSolver.html#5726" class="Bound">x</a> <a id="5750" href="Tactic.MonoidSolver.html#4343" class="InductiveConstructor Operator">∙′</a> <a id="5753" href="Tactic.MonoidSolver.html#5731" class="Bound">y</a> <a id="5755" href="Tactic.MonoidSolver.html#5167" class="Function Operator">⇓]</a>     <a id="5762" href="Relation.Binary.Reasoning.Base.Single.html#2470" class="Function Operator">≡⟨⟩</a>
    <a id="5770" href="Tactic.MonoidSolver.html#5035" class="Function Operator">[</a> <a id="5772" href="Tactic.MonoidSolver.html#5726" class="Bound">x</a> <a id="5774" href="Tactic.MonoidSolver.html#5035" class="Function Operator">⇓]′</a> <a id="5778" href="Tactic.MonoidSolver.html#5167" class="Function Operator">[</a> <a id="5780" href="Tactic.MonoidSolver.html#5731" class="Bound">y</a> <a id="5782" href="Tactic.MonoidSolver.html#5167" class="Function Operator">⇓]</a>  <a id="5786" href="Relation.Binary.Reasoning.Setoid.html#1153" class="Function">≈˘⟨</a> <a id="5790" href="Tactic.MonoidSolver.html#5221" class="Function">homo′</a> <a id="5796" href="Tactic.MonoidSolver.html#5726" class="Bound">x</a> <a id="5798" href="Tactic.MonoidSolver.html#5167" class="Function Operator">[</a> <a id="5800" href="Tactic.MonoidSolver.html#5731" class="Bound">y</a> <a id="5802" href="Tactic.MonoidSolver.html#5167" class="Function Operator">⇓]</a> <a id="5805" href="Relation.Binary.Reasoning.Setoid.html#1153" class="Function">⟩</a>
    <a id="5811" href="Tactic.MonoidSolver.html#5167" class="Function Operator">[</a> <a id="5813" href="Tactic.MonoidSolver.html#5726" class="Bound">x</a> <a id="5815" href="Tactic.MonoidSolver.html#5167" class="Function Operator">⇓]</a> <a id="5818" href="Algebra.Bundles.html#6136" class="Field Operator">∙</a> <a id="5820" href="Tactic.MonoidSolver.html#5167" class="Function Operator">[</a> <a id="5822" href="Tactic.MonoidSolver.html#5731" class="Bound">y</a> <a id="5824" href="Tactic.MonoidSolver.html#5167" class="Function Operator">⇓]</a> <a id="5827" href="Relation.Binary.Reasoning.Setoid.html#1052" class="Function">≈⟨</a> <a id="5830" href="Algebra.Structures.html#1207" class="Function">∙-cong</a> <a id="5837" class="Symbol">(</a><a id="5838" href="Tactic.MonoidSolver.html#5636" class="Function">homo</a> <a id="5843" href="Tactic.MonoidSolver.html#5726" class="Bound">x</a><a id="5844" class="Symbol">)</a> <a id="5846" class="Symbol">(</a><a id="5847" href="Tactic.MonoidSolver.html#5636" class="Function">homo</a> <a id="5852" href="Tactic.MonoidSolver.html#5731" class="Bound">y</a><a id="5853" class="Symbol">)</a> <a id="5855" href="Relation.Binary.Reasoning.Setoid.html#1052" class="Function">⟩</a>
    <a id="5861" href="Tactic.MonoidSolver.html#4600" class="Function Operator">[</a> <a id="5863" href="Tactic.MonoidSolver.html#5726" class="Bound">x</a> <a id="5865" href="Tactic.MonoidSolver.html#4600" class="Function Operator">↓]</a> <a id="5868" href="Algebra.Bundles.html#6136" class="Field Operator">∙</a> <a id="5870" href="Tactic.MonoidSolver.html#4600" class="Function Operator">[</a> <a id="5872" href="Tactic.MonoidSolver.html#5731" class="Bound">y</a> <a id="5874" href="Tactic.MonoidSolver.html#4600" class="Function Operator">↓]</a> <a id="5877" href="Relation.Binary.Reasoning.Base.Single.html#2555" class="Function Operator">∎</a>

<a id="5880" class="Comment">----------------------------------------------------------------------</a>
<a id="5951" class="Comment">-- Helpers for reflection</a>
<a id="5977" class="Comment">----------------------------------------------------------------------</a>

<a id="getArgs"></a><a id="6049" href="Tactic.MonoidSolver.html#6049" class="Function">getArgs</a> <a id="6057" class="Symbol">:</a> <a id="6059" href="Agda.Builtin.Reflection.html#4688" class="Datatype">Term</a> <a id="6064" class="Symbol">→</a> <a id="6066" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="6072" class="Symbol">(</a><a id="6073" href="Agda.Builtin.Reflection.html#4688" class="Datatype">Term</a> <a id="6078" href="Data.Product.Base.html#1109" class="Function Operator">×</a> <a id="6080" href="Agda.Builtin.Reflection.html#4688" class="Datatype">Term</a><a id="6084" class="Symbol">)</a>
<a id="6086" href="Tactic.MonoidSolver.html#6049" class="Function">getArgs</a> <a id="6094" class="Symbol">(</a><a id="6095" href="Agda.Builtin.Reflection.html#4903" class="InductiveConstructor">def</a> <a id="6099" class="Symbol">_</a> <a id="6101" href="Tactic.MonoidSolver.html#6101" class="Bound">xs</a><a id="6103" class="Symbol">)</a> <a id="6105" class="Symbol">=</a> <a id="6107" href="Tactic.MonoidSolver.html#6123" class="Function">go</a> <a id="6110" href="Tactic.MonoidSolver.html#6101" class="Bound">xs</a>
  <a id="6115" class="Keyword">where</a>
  <a id="6123" href="Tactic.MonoidSolver.html#6123" class="Function">go</a> <a id="6126" class="Symbol">:</a> <a id="6128" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="6133" class="Symbol">(</a><a id="6134" href="Agda.Builtin.Reflection.html#3697" class="Datatype">Arg</a> <a id="6138" href="Agda.Builtin.Reflection.html#4688" class="Datatype">Term</a><a id="6142" class="Symbol">)</a> <a id="6144" class="Symbol">→</a> <a id="6146" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="6152" class="Symbol">(</a><a id="6153" href="Agda.Builtin.Reflection.html#4688" class="Datatype">Term</a> <a id="6158" href="Data.Product.Base.html#1109" class="Function Operator">×</a> <a id="6160" href="Agda.Builtin.Reflection.html#4688" class="Datatype">Term</a><a id="6164" class="Symbol">)</a>
  <a id="6168" href="Tactic.MonoidSolver.html#6123" class="Function">go</a> <a id="6171" class="Symbol">(</a><a id="6172" href="Reflection.AST.Argument.html#1295" class="InductiveConstructor">vArg</a> <a id="6177" href="Tactic.MonoidSolver.html#6177" class="Bound">x</a> <a id="6179" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="6181" href="Reflection.AST.Argument.html#1295" class="InductiveConstructor">vArg</a> <a id="6186" href="Tactic.MonoidSolver.html#6186" class="Bound">y</a> <a id="6188" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="6190" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="6192" class="Symbol">)</a> <a id="6194" class="Symbol">=</a> <a id="6196" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="6201" class="Symbol">(</a><a id="6202" href="Tactic.MonoidSolver.html#6177" class="Bound">x</a> <a id="6204" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="6206" href="Tactic.MonoidSolver.html#6186" class="Bound">y</a><a id="6207" class="Symbol">)</a>
  <a id="6211" href="Tactic.MonoidSolver.html#6123" class="CatchallClause Function">go</a><a id="6213" class="CatchallClause"> </a><a id="6214" class="CatchallClause Symbol">(</a><a id="6215" href="Tactic.MonoidSolver.html#6215" class="CatchallClause Bound">x</a><a id="6216" class="CatchallClause"> </a><a id="6217" href="Agda.Builtin.List.html#200" class="CatchallClause InductiveConstructor Operator">∷</a><a id="6218" class="CatchallClause"> </a><a id="6219" href="Tactic.MonoidSolver.html#6219" class="CatchallClause Bound">xs</a><a id="6221" class="CatchallClause Symbol">)</a>               <a id="6237" class="Symbol">=</a> <a id="6239" href="Tactic.MonoidSolver.html#6123" class="Function">go</a> <a id="6242" href="Tactic.MonoidSolver.html#6219" class="Bound">xs</a>
  <a id="6247" href="Tactic.MonoidSolver.html#6123" class="CatchallClause Function">go</a><a id="6249" class="CatchallClause"> </a><a id="6250" class="CatchallClause Symbol">_</a>                      <a id="6273" class="Symbol">=</a> <a id="6275" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a>
<a id="6283" href="Tactic.MonoidSolver.html#6049" class="CatchallClause Function">getArgs</a><a id="6290" class="CatchallClause"> </a><a id="6291" class="CatchallClause Symbol">_</a> <a id="6293" class="Symbol">=</a> <a id="6295" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a>

<a id="6304" class="Comment">----------------------------------------------------------------------</a>
<a id="6375" class="Comment">-- Getting monoid names</a>
<a id="6399" class="Comment">----------------------------------------------------------------------</a>

<a id="6471" class="Comment">-- We try to be flexible here, by matching two kinds of names.</a>
<a id="6534" class="Comment">-- The first is the field accessor for the monoid record itself.</a>
<a id="6599" class="Comment">-- However, users will likely want to use the solver with</a>
<a id="6657" class="Comment">-- expressions like:</a>
<a id="6678" class="Comment">--</a>
<a id="6681" class="Comment">--   xs ++ (ys ++ zs) ≡ (xs ++ ys) ++ zs</a>
<a id="6722" class="Comment">--</a>
<a id="6725" class="Comment">-- So we also evaluate the field accessor to find functions like ++.</a>

<a id="6795" class="Keyword">record</a> <a id="MonoidNames"></a><a id="6802" href="Tactic.MonoidSolver.html#6802" class="Record">MonoidNames</a> <a id="6814" class="Symbol">:</a> <a id="6816" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="6820" class="Keyword">where</a>
  <a id="6828" class="Keyword">field</a>
    <a id="MonoidNames.is-∙"></a><a id="6838" href="Tactic.MonoidSolver.html#6838" class="Field">is-∙</a> <a id="6843" class="Symbol">:</a> <a id="6845" href="Agda.Builtin.Reflection.html#489" class="Postulate">Name</a> <a id="6850" class="Symbol">→</a> <a id="6852" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a>
    <a id="MonoidNames.is-ε"></a><a id="6861" href="Tactic.MonoidSolver.html#6861" class="Field">is-ε</a> <a id="6866" class="Symbol">:</a> <a id="6868" href="Agda.Builtin.Reflection.html#489" class="Postulate">Name</a> <a id="6873" class="Symbol">→</a> <a id="6875" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a>

<a id="buildMatcher"></a><a id="6881" href="Tactic.MonoidSolver.html#6881" class="Function">buildMatcher</a> <a id="6894" class="Symbol">:</a> <a id="6896" href="Agda.Builtin.Reflection.html#489" class="Postulate">Name</a> <a id="6901" class="Symbol">→</a> <a id="6903" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="6909" href="Agda.Builtin.Reflection.html#489" class="Postulate">Name</a> <a id="6914" class="Symbol">→</a> <a id="6916" href="Agda.Builtin.Reflection.html#489" class="Postulate">Name</a> <a id="6921" class="Symbol">→</a> <a id="6923" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a>
<a id="6928" href="Tactic.MonoidSolver.html#6881" class="Function">buildMatcher</a> <a id="6941" href="Tactic.MonoidSolver.html#6941" class="Bound">n</a> <a id="6943" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a>  <a id="6952" href="Tactic.MonoidSolver.html#6952" class="Bound">x</a> <a id="6954" class="Symbol">=</a> <a id="6956" href="Tactic.MonoidSolver.html#6941" class="Bound">n</a> <a id="6958" href="Agda.Builtin.Reflection.html#540" class="Primitive Operator">Name.≡ᵇ</a> <a id="6966" href="Tactic.MonoidSolver.html#6952" class="Bound">x</a>
<a id="6968" href="Tactic.MonoidSolver.html#6881" class="Function">buildMatcher</a> <a id="6981" href="Tactic.MonoidSolver.html#6981" class="Bound">n</a> <a id="6983" class="Symbol">(</a><a id="6984" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="6989" href="Tactic.MonoidSolver.html#6989" class="Bound">m</a><a id="6990" class="Symbol">)</a> <a id="6992" href="Tactic.MonoidSolver.html#6992" class="Bound">x</a> <a id="6994" class="Symbol">=</a> <a id="6996" href="Tactic.MonoidSolver.html#6981" class="Bound">n</a> <a id="6998" href="Agda.Builtin.Reflection.html#540" class="Primitive Operator">Name.≡ᵇ</a> <a id="7006" href="Tactic.MonoidSolver.html#6992" class="Bound">x</a> <a id="7008" href="Data.Bool.Base.html#1044" class="Function Operator">∨</a> <a id="7010" href="Tactic.MonoidSolver.html#6989" class="Bound">m</a> <a id="7012" href="Agda.Builtin.Reflection.html#540" class="Primitive Operator">Name.≡ᵇ</a> <a id="7020" href="Tactic.MonoidSolver.html#6992" class="Bound">x</a>

<a id="findMonoidNames"></a><a id="7023" href="Tactic.MonoidSolver.html#7023" class="Function">findMonoidNames</a> <a id="7039" class="Symbol">:</a> <a id="7041" href="Agda.Builtin.Reflection.html#4688" class="Datatype">Term</a> <a id="7046" class="Symbol">→</a> <a id="7048" href="Agda.Builtin.Reflection.html#8218" class="Postulate">TC</a> <a id="7051" href="Tactic.MonoidSolver.html#6802" class="Record">MonoidNames</a>
<a id="7063" href="Tactic.MonoidSolver.html#7023" class="Function">findMonoidNames</a> <a id="7079" href="Tactic.MonoidSolver.html#7079" class="Bound">mon</a> <a id="7083" class="Symbol">=</a> <a id="7085" class="Keyword">do</a>
  <a id="7090" href="Tactic.MonoidSolver.html#7090" class="Bound">∙-altName</a> <a id="7100" href="Reflection.TCM.Syntax.html#614" class="Function Operator">←</a> <a id="7102" href="Agda.Builtin.Reflection.html#8573" class="Postulate">normalise</a> <a id="7112" class="Symbol">(</a><a id="7113" href="Agda.Builtin.Reflection.html#4903" class="InductiveConstructor">def</a> <a id="7117" class="Symbol">(</a><a id="7118" class="Keyword">quote</a> <a id="7124" href="Algebra.Bundles.html#6136" class="Field Operator">Monoid._∙_</a><a id="7134" class="Symbol">)</a> <a id="7136" class="Symbol">(</a><a id="7137" class="Number">2</a> <a id="7139" href="Reflection.AST.Term.html#2938" class="Function Operator">⋯⟅∷⟆</a> <a id="7144" href="Tactic.MonoidSolver.html#7079" class="Bound">mon</a> <a id="7148" href="Reflection.AST.Argument.html#1687" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="7152" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="7154" class="Symbol">))</a>
  <a id="7159" href="Tactic.MonoidSolver.html#7159" class="Bound">ε-altName</a> <a id="7169" href="Reflection.TCM.Syntax.html#614" class="Function Operator">←</a> <a id="7171" href="Agda.Builtin.Reflection.html#8573" class="Postulate">normalise</a> <a id="7181" class="Symbol">(</a><a id="7182" href="Agda.Builtin.Reflection.html#4903" class="InductiveConstructor">def</a> <a id="7186" class="Symbol">(</a><a id="7187" class="Keyword">quote</a> <a id="7193" href="Algebra.Bundles.html#6163" class="Field">Monoid.ε</a><a id="7201" class="Symbol">)</a>   <a id="7205" class="Symbol">(</a><a id="7206" class="Number">2</a> <a id="7208" href="Reflection.AST.Term.html#2938" class="Function Operator">⋯⟅∷⟆</a> <a id="7213" href="Tactic.MonoidSolver.html#7079" class="Bound">mon</a> <a id="7217" href="Reflection.AST.Argument.html#1687" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="7221" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="7223" class="Symbol">))</a>
  <a id="7228" href="Reflection.TCM.html#1016" class="Postulate">pure</a> <a id="7233" class="Keyword">record</a>
    <a id="7244" class="Symbol">{</a> <a id="7246" href="Tactic.MonoidSolver.html#6838" class="Field">is-∙</a> <a id="7251" class="Symbol">=</a> <a id="7253" href="Tactic.MonoidSolver.html#6881" class="Function">buildMatcher</a> <a id="7266" class="Symbol">(</a><a id="7267" class="Keyword">quote</a> <a id="7273" href="Algebra.Bundles.html#6136" class="Field Operator">Monoid._∙_</a><a id="7283" class="Symbol">)</a> <a id="7285" class="Symbol">(</a><a id="7286" href="Reflection.AST.Term.html#2306" class="Function">getName</a> <a id="7294" href="Tactic.MonoidSolver.html#7090" class="Bound">∙-altName</a><a id="7303" class="Symbol">)</a>
    <a id="7309" class="Symbol">;</a> <a id="7311" href="Tactic.MonoidSolver.html#6861" class="Field">is-ε</a> <a id="7316" class="Symbol">=</a> <a id="7318" href="Tactic.MonoidSolver.html#6881" class="Function">buildMatcher</a> <a id="7331" class="Symbol">(</a><a id="7332" class="Keyword">quote</a> <a id="7338" href="Algebra.Bundles.html#6163" class="Field">Monoid.ε</a><a id="7346" class="Symbol">)</a>   <a id="7350" class="Symbol">(</a><a id="7351" href="Reflection.AST.Term.html#2306" class="Function">getName</a> <a id="7359" href="Tactic.MonoidSolver.html#7159" class="Bound">ε-altName</a><a id="7368" class="Symbol">)</a>
    <a id="7374" class="Symbol">}</a>

<a id="7377" class="Comment">----------------------------------------------------------------------</a>
<a id="7448" class="Comment">-- Building Expr</a>
<a id="7465" class="Comment">----------------------------------------------------------------------</a>

<a id="7537" class="Comment">-- We now define a function that takes an AST representing the LHS</a>
<a id="7604" class="Comment">-- or RHS of the equation to solve and converts it into an AST</a>
<a id="7667" class="Comment">-- respresenting the corresponding Expr.</a>

<a id="″ε″"></a><a id="7709" href="Tactic.MonoidSolver.html#7709" class="Function">″ε″</a> <a id="7713" class="Symbol">:</a> <a id="7715" href="Agda.Builtin.Reflection.html#4688" class="Datatype">Term</a>
<a id="7720" href="Tactic.MonoidSolver.html#7709" class="Function">″ε″</a> <a id="7724" class="Symbol">=</a> <a id="7726" class="Keyword">quote</a> <a id="7732" href="Tactic.MonoidSolver.html#4378" class="InductiveConstructor">ε′</a> <a id="7735" href="Function.Base.html#4330" class="Function Operator">⟨</a> <a id="7737" href="Agda.Builtin.Reflection.html#4846" class="InductiveConstructor">con</a> <a id="7741" href="Function.Base.html#4330" class="Function Operator">⟩</a> <a id="7743" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>

<a id="[_↑]′"></a><a id="7747" href="Tactic.MonoidSolver.html#7747" class="Function Operator">[_↑]′</a> <a id="7753" class="Symbol">:</a> <a id="7755" href="Agda.Builtin.Reflection.html#4688" class="Datatype">Term</a> <a id="7760" class="Symbol">→</a> <a id="7762" href="Agda.Builtin.Reflection.html#4688" class="Datatype">Term</a>
<a id="7767" href="Tactic.MonoidSolver.html#7747" class="Function Operator">[</a> <a id="7769" href="Tactic.MonoidSolver.html#7769" class="Bound">t</a> <a id="7771" href="Tactic.MonoidSolver.html#7747" class="Function Operator">↑]′</a> <a id="7775" class="Symbol">=</a> <a id="7777" class="Keyword">quote</a> <a id="7783" href="Tactic.MonoidSolver.html#4395" class="InductiveConstructor Operator">[_↑]</a> <a id="7788" href="Function.Base.html#4330" class="Function Operator">⟨</a> <a id="7790" href="Agda.Builtin.Reflection.html#4846" class="InductiveConstructor">con</a> <a id="7794" href="Function.Base.html#4330" class="Function Operator">⟩</a> <a id="7796" class="Symbol">(</a><a id="7797" href="Tactic.MonoidSolver.html#7769" class="Bound">t</a> <a id="7799" href="Reflection.AST.Argument.html#1687" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="7803" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="7805" class="Symbol">)</a>

<a id="7808" class="Keyword">module</a> <a id="7815" href="Tactic.MonoidSolver.html#7815" class="Module">_</a> <a id="7817" class="Symbol">(</a><a id="7818" href="Tactic.MonoidSolver.html#7818" class="Bound">names</a> <a id="7824" class="Symbol">:</a> <a id="7826" href="Tactic.MonoidSolver.html#6802" class="Record">MonoidNames</a><a id="7837" class="Symbol">)</a> <a id="7839" class="Keyword">where</a>

 <a id="7847" class="Keyword">open</a> <a id="7852" href="Tactic.MonoidSolver.html#6802" class="Module">MonoidNames</a> <a id="7864" href="Tactic.MonoidSolver.html#7818" class="Bound">names</a>

 <a id="7872" class="Keyword">mutual</a>
  <a id="7881" href="Tactic.MonoidSolver.html#7881" class="Function">″∙″</a> <a id="7885" class="Symbol">:</a> <a id="7887" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="7892" class="Symbol">(</a><a id="7893" href="Agda.Builtin.Reflection.html#3697" class="Datatype">Arg</a> <a id="7897" href="Agda.Builtin.Reflection.html#4688" class="Datatype">Term</a><a id="7901" class="Symbol">)</a> <a id="7903" class="Symbol">→</a> <a id="7905" href="Agda.Builtin.Reflection.html#4688" class="Datatype">Term</a>
  <a id="7912" href="Tactic.MonoidSolver.html#7881" class="Function">″∙″</a> <a id="7916" class="Symbol">(</a><a id="7917" href="Tactic.MonoidSolver.html#7917" class="Bound">x</a> <a id="7919" href="Reflection.AST.Argument.html#1687" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="7923" href="Tactic.MonoidSolver.html#7923" class="Bound">y</a> <a id="7925" href="Reflection.AST.Argument.html#1687" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="7929" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="7931" class="Symbol">)</a> <a id="7933" class="Symbol">=</a> <a id="7935" class="Keyword">quote</a> <a id="7941" href="Tactic.MonoidSolver.html#4343" class="InductiveConstructor Operator">_∙′_</a> <a id="7946" href="Function.Base.html#4330" class="Function Operator">⟨</a> <a id="7948" href="Agda.Builtin.Reflection.html#4846" class="InductiveConstructor">con</a> <a id="7952" href="Function.Base.html#4330" class="Function Operator">⟩</a> <a id="7954" href="Tactic.MonoidSolver.html#8057" class="Function">buildExpr</a> <a id="7964" href="Tactic.MonoidSolver.html#7917" class="Bound">x</a> <a id="7966" href="Reflection.AST.Argument.html#1687" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="7970" href="Tactic.MonoidSolver.html#8057" class="Function">buildExpr</a> <a id="7980" href="Tactic.MonoidSolver.html#7923" class="Bound">y</a> <a id="7982" href="Reflection.AST.Argument.html#1687" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="7986" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>
  <a id="7991" href="Tactic.MonoidSolver.html#7881" class="CatchallClause Function">″∙″</a><a id="7994" class="CatchallClause"> </a><a id="7995" class="CatchallClause Symbol">(</a><a id="7996" href="Tactic.MonoidSolver.html#7996" class="CatchallClause Bound">x</a><a id="7997" class="CatchallClause"> </a><a id="7998" href="Agda.Builtin.List.html#200" class="CatchallClause InductiveConstructor Operator">∷</a><a id="7999" class="CatchallClause"> </a><a id="8000" href="Tactic.MonoidSolver.html#8000" class="CatchallClause Bound">xs</a><a id="8002" class="CatchallClause Symbol">)</a>         <a id="8012" class="Symbol">=</a> <a id="8014" href="Tactic.MonoidSolver.html#7881" class="Function">″∙″</a> <a id="8018" href="Tactic.MonoidSolver.html#8000" class="Bound">xs</a>
  <a id="8023" href="Tactic.MonoidSolver.html#7881" class="CatchallClause Function">″∙″</a><a id="8026" class="CatchallClause"> </a><a id="8027" class="CatchallClause Symbol">_</a>                <a id="8044" class="Symbol">=</a> <a id="8046" href="Agda.Builtin.Reflection.html#5246" class="InductiveConstructor">unknown</a>

  <a id="8057" href="Tactic.MonoidSolver.html#8057" class="Function">buildExpr</a> <a id="8067" class="Symbol">:</a> <a id="8069" href="Agda.Builtin.Reflection.html#4688" class="Datatype">Term</a> <a id="8074" class="Symbol">→</a> <a id="8076" href="Agda.Builtin.Reflection.html#4688" class="Datatype">Term</a>
  <a id="8083" href="Tactic.MonoidSolver.html#8057" class="Function">buildExpr</a> <a id="8093" href="Tactic.MonoidSolver.html#8093" class="Bound">t</a><a id="8094" class="Symbol">@(</a><a id="8096" href="Agda.Builtin.Reflection.html#4903" class="InductiveConstructor">def</a> <a id="8100" href="Tactic.MonoidSolver.html#8100" class="Bound">n</a> <a id="8102" href="Tactic.MonoidSolver.html#8102" class="Bound">xs</a><a id="8104" class="Symbol">)</a> <a id="8106" class="Symbol">=</a>
    <a id="8112" href="Data.Bool.Base.html#1283" class="Function Operator">if</a> <a id="8115" href="Tactic.MonoidSolver.html#6838" class="Field">is-∙</a> <a id="8120" href="Tactic.MonoidSolver.html#8100" class="Bound">n</a>
      <a id="8128" href="Data.Bool.Base.html#1283" class="Function Operator">then</a> <a id="8133" href="Tactic.MonoidSolver.html#7881" class="Function">″∙″</a> <a id="8137" href="Tactic.MonoidSolver.html#8102" class="Bound">xs</a>
    <a id="8144" href="Data.Bool.Base.html#1283" class="Function Operator">else</a> <a id="8149" href="Data.Bool.Base.html#1283" class="Function Operator">if</a> <a id="8152" href="Tactic.MonoidSolver.html#6861" class="Field">is-ε</a> <a id="8157" href="Tactic.MonoidSolver.html#8100" class="Bound">n</a>
      <a id="8165" href="Data.Bool.Base.html#1283" class="Function Operator">then</a> <a id="8170" href="Tactic.MonoidSolver.html#7709" class="Function">″ε″</a>
    <a id="8178" href="Data.Bool.Base.html#1283" class="Function Operator">else</a>
      <a id="8189" href="Tactic.MonoidSolver.html#7747" class="Function Operator">[</a> <a id="8191" href="Tactic.MonoidSolver.html#8093" class="Bound">t</a> <a id="8193" href="Tactic.MonoidSolver.html#7747" class="Function Operator">↑]′</a>
  <a id="8199" href="Tactic.MonoidSolver.html#8057" class="Function">buildExpr</a> <a id="8209" href="Tactic.MonoidSolver.html#8209" class="Bound">t</a><a id="8210" class="Symbol">@(</a><a id="8212" href="Agda.Builtin.Reflection.html#4846" class="InductiveConstructor">con</a> <a id="8216" href="Tactic.MonoidSolver.html#8216" class="Bound">n</a> <a id="8218" href="Tactic.MonoidSolver.html#8218" class="Bound">xs</a><a id="8220" class="Symbol">)</a> <a id="8222" class="Symbol">=</a>
    <a id="8228" href="Data.Bool.Base.html#1283" class="Function Operator">if</a> <a id="8231" href="Tactic.MonoidSolver.html#6838" class="Field">is-∙</a> <a id="8236" href="Tactic.MonoidSolver.html#8216" class="Bound">n</a>
      <a id="8244" href="Data.Bool.Base.html#1283" class="Function Operator">then</a> <a id="8249" href="Tactic.MonoidSolver.html#7881" class="Function">″∙″</a> <a id="8253" href="Tactic.MonoidSolver.html#8218" class="Bound">xs</a>
    <a id="8260" href="Data.Bool.Base.html#1283" class="Function Operator">else</a> <a id="8265" href="Data.Bool.Base.html#1283" class="Function Operator">if</a> <a id="8268" href="Tactic.MonoidSolver.html#6861" class="Field">is-ε</a> <a id="8273" href="Tactic.MonoidSolver.html#8216" class="Bound">n</a>
      <a id="8281" href="Data.Bool.Base.html#1283" class="Function Operator">then</a> <a id="8286" href="Tactic.MonoidSolver.html#7709" class="Function">″ε″</a>
    <a id="8294" href="Data.Bool.Base.html#1283" class="Function Operator">else</a> <a id="8299" href="Tactic.MonoidSolver.html#7747" class="Function Operator">[</a> <a id="8301" href="Tactic.MonoidSolver.html#8209" class="Bound">t</a> <a id="8303" href="Tactic.MonoidSolver.html#7747" class="Function Operator">↑]′</a>
  <a id="8309" href="Tactic.MonoidSolver.html#8057" class="CatchallClause Function">buildExpr</a><a id="8318" class="CatchallClause"> </a><a id="8319" href="Tactic.MonoidSolver.html#8319" class="CatchallClause Bound">t</a> <a id="8321" class="Symbol">=</a> <a id="8323" class="Keyword">quote</a> <a id="8329" href="Tactic.MonoidSolver.html#4395" class="InductiveConstructor Operator">[_↑]</a> <a id="8334" href="Function.Base.html#4330" class="Function Operator">⟨</a> <a id="8336" href="Agda.Builtin.Reflection.html#4846" class="InductiveConstructor">con</a> <a id="8340" href="Function.Base.html#4330" class="Function Operator">⟩</a> <a id="8342" class="Symbol">(</a><a id="8343" href="Tactic.MonoidSolver.html#8319" class="Bound">t</a> <a id="8345" href="Reflection.AST.Argument.html#1687" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="8349" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="8351" class="Symbol">)</a>

<a id="8354" class="Comment">----------------------------------------------------------------------</a>
<a id="8425" class="Comment">-- Constructing the solution</a>
<a id="8454" class="Comment">----------------------------------------------------------------------</a>

<a id="8526" class="Comment">-- This function joins up the two homomorphism proofs. It constructs</a>
<a id="8595" class="Comment">-- a proof of the following form:</a>
<a id="8629" class="Comment">--</a>
<a id="8632" class="Comment">--   trans (sym (homo x)) (homo y)</a>
<a id="8667" class="Comment">--</a>
<a id="8670" class="Comment">-- where x and y are the Expr representations of each side of the</a>
<a id="8736" class="Comment">-- goal equation.</a>

<a id="constructSoln"></a><a id="8755" href="Tactic.MonoidSolver.html#8755" class="Function">constructSoln</a> <a id="8769" class="Symbol">:</a> <a id="8771" href="Agda.Builtin.Reflection.html#4688" class="Datatype">Term</a> <a id="8776" class="Symbol">→</a> <a id="8778" href="Tactic.MonoidSolver.html#6802" class="Record">MonoidNames</a> <a id="8790" class="Symbol">→</a> <a id="8792" href="Agda.Builtin.Reflection.html#4688" class="Datatype">Term</a> <a id="8797" class="Symbol">→</a> <a id="8799" href="Agda.Builtin.Reflection.html#4688" class="Datatype">Term</a> <a id="8804" class="Symbol">→</a> <a id="8806" href="Agda.Builtin.Reflection.html#4688" class="Datatype">Term</a>
<a id="8811" href="Tactic.MonoidSolver.html#8755" class="Function">constructSoln</a> <a id="8825" href="Tactic.MonoidSolver.html#8825" class="Bound">mon</a> <a id="8829" href="Tactic.MonoidSolver.html#8829" class="Bound">names</a> <a id="8835" href="Tactic.MonoidSolver.html#8835" class="Bound">lhs</a> <a id="8839" href="Tactic.MonoidSolver.html#8839" class="Bound">rhs</a> <a id="8843" class="Symbol">=</a>
  <a id="8847" class="Keyword">quote</a> <a id="8853" href="Relation.Binary.Structures.html#1634" class="Function">Monoid.trans</a> <a id="8866" href="Function.Base.html#4330" class="Function Operator">⟨</a> <a id="8868" href="Agda.Builtin.Reflection.html#4903" class="InductiveConstructor">def</a> <a id="8872" href="Function.Base.html#4330" class="Function Operator">⟩</a> <a id="8874" class="Number">2</a> <a id="8876" href="Reflection.AST.Term.html#2938" class="Function Operator">⋯⟅∷⟆</a> <a id="8881" href="Tactic.MonoidSolver.html#8825" class="Bound">mon</a> <a id="8885" href="Reflection.AST.Argument.html#1687" class="InductiveConstructor Operator">⟨∷⟩</a>
    <a id="8893" class="Symbol">(</a><a id="8894" class="Keyword">quote</a> <a id="8900" href="Relation.Binary.Structures.html#1608" class="Function">Monoid.sym</a> <a id="8911" href="Function.Base.html#4330" class="Function Operator">⟨</a> <a id="8913" href="Agda.Builtin.Reflection.html#4903" class="InductiveConstructor">def</a> <a id="8917" href="Function.Base.html#4330" class="Function Operator">⟩</a> <a id="8919" class="Number">2</a> <a id="8921" href="Reflection.AST.Term.html#2938" class="Function Operator">⋯⟅∷⟆</a> <a id="8926" href="Tactic.MonoidSolver.html#8825" class="Bound">mon</a> <a id="8930" href="Reflection.AST.Argument.html#1687" class="InductiveConstructor Operator">⟨∷⟩</a>
       <a id="8941" class="Symbol">(</a><a id="8942" class="Keyword">quote</a> <a id="8948" href="Tactic.MonoidSolver.html#5636" class="Function">homo</a> <a id="8953" href="Function.Base.html#4330" class="Function Operator">⟨</a> <a id="8955" href="Agda.Builtin.Reflection.html#4903" class="InductiveConstructor">def</a> <a id="8959" href="Function.Base.html#4330" class="Function Operator">⟩</a> <a id="8961" class="Number">2</a> <a id="8963" href="Reflection.AST.Term.html#2938" class="Function Operator">⋯⟅∷⟆</a> <a id="8968" href="Tactic.MonoidSolver.html#8825" class="Bound">mon</a> <a id="8972" href="Reflection.AST.Argument.html#1687" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="8976" href="Tactic.MonoidSolver.html#8057" class="Function">buildExpr</a> <a id="8986" href="Tactic.MonoidSolver.html#8829" class="Bound">names</a> <a id="8992" href="Tactic.MonoidSolver.html#8835" class="Bound">lhs</a> <a id="8996" href="Reflection.AST.Argument.html#1687" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="9000" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="9002" class="Symbol">)</a> <a id="9004" href="Reflection.AST.Argument.html#1687" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="9008" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="9010" class="Symbol">)</a>
    <a id="9016" href="Reflection.AST.Argument.html#1687" class="InductiveConstructor Operator">⟨∷⟩</a>
    <a id="9024" class="Symbol">(</a><a id="9025" class="Keyword">quote</a> <a id="9031" href="Tactic.MonoidSolver.html#5636" class="Function">homo</a> <a id="9036" href="Function.Base.html#4330" class="Function Operator">⟨</a> <a id="9038" href="Agda.Builtin.Reflection.html#4903" class="InductiveConstructor">def</a> <a id="9042" href="Function.Base.html#4330" class="Function Operator">⟩</a> <a id="9044" class="Number">2</a> <a id="9046" href="Reflection.AST.Term.html#2938" class="Function Operator">⋯⟅∷⟆</a> <a id="9051" href="Tactic.MonoidSolver.html#8825" class="Bound">mon</a> <a id="9055" href="Reflection.AST.Argument.html#1687" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="9059" href="Tactic.MonoidSolver.html#8057" class="Function">buildExpr</a> <a id="9069" href="Tactic.MonoidSolver.html#8829" class="Bound">names</a> <a id="9075" href="Tactic.MonoidSolver.html#8839" class="Bound">rhs</a> <a id="9079" href="Reflection.AST.Argument.html#1687" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="9083" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="9085" class="Symbol">)</a> <a id="9087" href="Reflection.AST.Argument.html#1687" class="InductiveConstructor Operator">⟨∷⟩</a>
    <a id="9095" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>

<a id="9099" class="Comment">----------------------------------------------------------------------</a>
<a id="9170" class="Comment">-- Macro</a>
<a id="9179" class="Comment">----------------------------------------------------------------------</a>

<a id="solve-macro"></a><a id="9251" href="Tactic.MonoidSolver.html#9251" class="Function">solve-macro</a> <a id="9263" class="Symbol">:</a> <a id="9265" href="Agda.Builtin.Reflection.html#4688" class="Datatype">Term</a> <a id="9270" class="Symbol">→</a> <a id="9272" href="Agda.Builtin.Reflection.html#4688" class="Datatype">Term</a> <a id="9277" class="Symbol">→</a> <a id="9279" href="Agda.Builtin.Reflection.html#8218" class="Postulate">TC</a> <a id="9282" class="Symbol">_</a>
<a id="9284" href="Tactic.MonoidSolver.html#9251" class="Function">solve-macro</a> <a id="9296" href="Tactic.MonoidSolver.html#9296" class="Bound">mon</a> <a id="9300" href="Tactic.MonoidSolver.html#9300" class="Bound">hole</a> <a id="9305" class="Symbol">=</a> <a id="9307" class="Keyword">do</a>
  <a id="9312" href="Tactic.MonoidSolver.html#9312" class="Bound">hole′</a> <a id="9318" href="Reflection.TCM.Syntax.html#614" class="Function Operator">←</a> <a id="9320" href="Agda.Builtin.Reflection.html#8494" class="Postulate">inferType</a> <a id="9330" href="Tactic.MonoidSolver.html#9300" class="Bound">hole</a> <a id="9335" href="Reflection.TCM.Syntax.html#614" class="Function Operator">&gt;&gt;=</a> <a id="9339" href="Agda.Builtin.Reflection.html#8573" class="Postulate">normalise</a>
  <a id="9351" href="Tactic.MonoidSolver.html#9351" class="Bound">names</a> <a id="9357" href="Reflection.TCM.Syntax.html#614" class="Function Operator">←</a> <a id="9359" href="Tactic.MonoidSolver.html#7023" class="Function">findMonoidNames</a> <a id="9375" href="Tactic.MonoidSolver.html#9296" class="Bound">mon</a>
  <a id="9381" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="9386" class="Symbol">(</a><a id="9387" href="Tactic.MonoidSolver.html#9387" class="Bound">lhs</a> <a id="9391" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="9393" href="Tactic.MonoidSolver.html#9393" class="Bound">rhs</a><a id="9396" class="Symbol">)</a> <a id="9398" href="Reflection.TCM.Syntax.html#614" class="Function Operator">←</a> <a id="9400" href="Reflection.TCM.html#1016" class="Postulate">pure</a> <a id="9405" class="Symbol">(</a><a id="9406" href="Tactic.MonoidSolver.html#6049" class="Function">getArgs</a> <a id="9414" href="Tactic.MonoidSolver.html#9312" class="Bound">hole′</a><a id="9419" class="Symbol">)</a>
    <a id="9425" class="Keyword">where</a> <a id="9431" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a> <a id="9439" class="Symbol">→</a> <a id="9441" href="Agda.Builtin.Reflection.html#8431" class="Postulate">typeError</a> <a id="9451" class="Symbol">(</a><a id="9452" href="Agda.Builtin.Reflection.html#7948" class="InductiveConstructor">termErr</a> <a id="9460" href="Tactic.MonoidSolver.html#9312" class="Bound">hole′</a> <a id="9466" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="9468" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="9470" class="Symbol">)</a>
  <a id="9474" class="Keyword">let</a> <a id="9478" href="Tactic.MonoidSolver.html#9478" class="Bound">soln</a> <a id="9483" class="Symbol">=</a> <a id="9485" href="Tactic.MonoidSolver.html#8755" class="Function">constructSoln</a> <a id="9499" href="Tactic.MonoidSolver.html#9296" class="Bound">mon</a> <a id="9503" href="Tactic.MonoidSolver.html#9351" class="Bound">names</a> <a id="9509" href="Tactic.MonoidSolver.html#9387" class="Bound">lhs</a> <a id="9513" href="Tactic.MonoidSolver.html#9393" class="Bound">rhs</a>
  <a id="9519" href="Agda.Builtin.Reflection.html#8391" class="Postulate">unify</a> <a id="9525" href="Tactic.MonoidSolver.html#9300" class="Bound">hole</a> <a id="9530" href="Tactic.MonoidSolver.html#9478" class="Bound">soln</a>

<a id="9536" class="Keyword">macro</a>
  <a id="solve"></a><a id="9544" href="Tactic.MonoidSolver.html#9544" class="Function">solve</a> <a id="9550" class="Symbol">:</a> <a id="9552" href="Agda.Builtin.Reflection.html#4688" class="Datatype">Term</a> <a id="9557" class="Symbol">→</a> <a id="9559" href="Agda.Builtin.Reflection.html#4688" class="Datatype">Term</a> <a id="9564" class="Symbol">→</a> <a id="9566" href="Agda.Builtin.Reflection.html#8218" class="Postulate">TC</a> <a id="9569" class="Symbol">_</a>
  <a id="9573" href="Tactic.MonoidSolver.html#9544" class="Function">solve</a> <a id="9579" class="Symbol">=</a> <a id="9581" href="Tactic.MonoidSolver.html#9251" class="Function">solve-macro</a>
</pre></body></html>