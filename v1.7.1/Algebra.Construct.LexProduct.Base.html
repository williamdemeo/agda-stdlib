<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Algebra.Construct.LexProduct.Base</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- The Agda standard library</a>
<a id="103" class="Comment">--</a>
<a id="106" class="Comment">-- Definitions of the lexicographic product of two operators.</a>
<a id="168" class="Comment">------------------------------------------------------------------------</a>

<a id="242" class="Symbol">{-#</a> <a id="246" class="Keyword">OPTIONS</a> <a id="254" class="Pragma">--without-K</a> <a id="266" class="Pragma">--safe</a> <a id="273" class="Symbol">#-}</a>

<a id="278" class="Keyword">open</a> <a id="283" class="Keyword">import</a> <a id="290" href="Algebra.Core.html" class="Module">Algebra.Core</a> <a id="303" class="Keyword">using</a> <a id="309" class="Symbol">(</a><a id="310" href="Algebra.Core.html#518" class="Function">Op₂</a><a id="313" class="Symbol">)</a>
<a id="315" class="Keyword">open</a> <a id="320" class="Keyword">import</a> <a id="327" href="Data.Bool.Base.html" class="Module">Data.Bool.Base</a> <a id="342" class="Keyword">using</a> <a id="348" class="Symbol">(</a><a id="349" href="Agda.Builtin.Bool.html#188" class="InductiveConstructor">true</a><a id="353" class="Symbol">;</a> <a id="355" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">false</a><a id="360" class="Symbol">)</a>
<a id="362" class="Keyword">open</a> <a id="367" class="Keyword">import</a> <a id="374" href="Data.Product.html" class="Module">Data.Product</a> <a id="387" class="Keyword">using</a> <a id="393" class="Symbol">(</a><a id="394" href="Data.Product.html#1167" class="Function Operator">_×_</a><a id="397" class="Symbol">;</a> <a id="399" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">_,_</a><a id="402" class="Symbol">)</a>
<a id="404" class="Keyword">open</a> <a id="409" class="Keyword">import</a> <a id="416" href="Relation.Binary.Core.html" class="Module">Relation.Binary.Core</a> <a id="437" class="Keyword">using</a> <a id="443" class="Symbol">(</a><a id="444" href="Relation.Binary.Core.html#882" class="Function">Rel</a><a id="447" class="Symbol">)</a>
<a id="449" class="Keyword">open</a> <a id="454" class="Keyword">import</a> <a id="461" href="Relation.Binary.Definitions.html" class="Module">Relation.Binary.Definitions</a> <a id="489" class="Keyword">using</a> <a id="495" class="Symbol">(</a><a id="496" href="Relation.Binary.Definitions.html#4575" class="Function">Decidable</a><a id="505" class="Symbol">)</a>
<a id="507" class="Keyword">open</a> <a id="512" class="Keyword">import</a> <a id="519" href="Relation.Nullary.html" class="Module">Relation.Nullary</a> <a id="536" class="Keyword">using</a> <a id="542" class="Symbol">(</a><a id="543" href="Relation.Nullary.html#1581" class="Field">does</a><a id="547" class="Symbol">;</a> <a id="549" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a><a id="552" class="Symbol">;</a> <a id="554" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a><a id="556" class="Symbol">)</a>

<a id="559" class="Keyword">module</a> <a id="566" href="Algebra.Construct.LexProduct.Base.html" class="Module">Algebra.Construct.LexProduct.Base</a>
  <a id="602" class="Symbol">{</a><a id="603" href="Algebra.Construct.LexProduct.Base.html#603" class="Bound">a</a> <a id="605" href="Algebra.Construct.LexProduct.Base.html#605" class="Bound">b</a> <a id="607" href="Algebra.Construct.LexProduct.Base.html#607" class="Bound">ℓ</a><a id="608" class="Symbol">}</a> <a id="610" class="Symbol">{</a><a id="611" href="Algebra.Construct.LexProduct.Base.html#611" class="Bound">A</a> <a id="613" class="Symbol">:</a> <a id="615" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="619" href="Algebra.Construct.LexProduct.Base.html#603" class="Bound">a</a><a id="620" class="Symbol">}</a> <a id="622" class="Symbol">{</a><a id="623" href="Algebra.Construct.LexProduct.Base.html#623" class="Bound">B</a> <a id="625" class="Symbol">:</a> <a id="627" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="631" href="Algebra.Construct.LexProduct.Base.html#605" class="Bound">b</a><a id="632" class="Symbol">}</a>
  <a id="636" class="Symbol">(</a><a id="637" href="Algebra.Construct.LexProduct.Base.html#637" class="Bound Operator">_∙_</a> <a id="641" class="Symbol">:</a> <a id="643" href="Algebra.Core.html#518" class="Function">Op₂</a> <a id="647" href="Algebra.Construct.LexProduct.Base.html#611" class="Bound">A</a><a id="648" class="Symbol">)</a> <a id="650" class="Symbol">(</a><a id="651" href="Algebra.Construct.LexProduct.Base.html#651" class="Bound Operator">_◦_</a> <a id="655" class="Symbol">:</a> <a id="657" href="Algebra.Core.html#518" class="Function">Op₂</a> <a id="661" href="Algebra.Construct.LexProduct.Base.html#623" class="Bound">B</a><a id="662" class="Symbol">)</a>
  <a id="666" class="Symbol">{</a><a id="667" href="Algebra.Construct.LexProduct.Base.html#667" class="Bound Operator">_≈₁_</a> <a id="672" class="Symbol">:</a> <a id="674" href="Relation.Binary.Core.html#882" class="Function">Rel</a> <a id="678" href="Algebra.Construct.LexProduct.Base.html#611" class="Bound">A</a> <a id="680" href="Algebra.Construct.LexProduct.Base.html#607" class="Bound">ℓ</a><a id="681" class="Symbol">}</a> <a id="683" class="Symbol">(</a><a id="684" href="Algebra.Construct.LexProduct.Base.html#684" class="Bound Operator">_≟₁_</a> <a id="689" class="Symbol">:</a> <a id="691" href="Relation.Binary.Definitions.html#4575" class="Function">Decidable</a> <a id="701" href="Algebra.Construct.LexProduct.Base.html#667" class="Bound Operator">_≈₁_</a><a id="705" class="Symbol">)</a>
  <a id="709" class="Keyword">where</a>

<a id="716" class="Comment">------------------------------------------------------------------------</a>
<a id="789" class="Comment">-- Definition</a>

<a id="804" class="Comment">-- In order to get the first component to be definitionally equal to</a>
<a id="873" class="Comment">-- `a ∙ b` and to simplify some of the proofs we first define an inner</a>
<a id="944" class="Comment">-- operator that only calculates the second component of product.</a>

<a id="innerLex"></a><a id="1011" href="Algebra.Construct.LexProduct.Base.html#1011" class="Function">innerLex</a> <a id="1020" class="Symbol">:</a> <a id="1022" href="Algebra.Construct.LexProduct.Base.html#611" class="Bound">A</a> <a id="1024" class="Symbol">→</a> <a id="1026" href="Algebra.Construct.LexProduct.Base.html#611" class="Bound">A</a> <a id="1028" class="Symbol">→</a> <a id="1030" href="Algebra.Construct.LexProduct.Base.html#623" class="Bound">B</a> <a id="1032" class="Symbol">→</a> <a id="1034" href="Algebra.Construct.LexProduct.Base.html#623" class="Bound">B</a> <a id="1036" class="Symbol">→</a> <a id="1038" href="Algebra.Construct.LexProduct.Base.html#623" class="Bound">B</a>
<a id="1040" href="Algebra.Construct.LexProduct.Base.html#1011" class="Function">innerLex</a> <a id="1049" href="Algebra.Construct.LexProduct.Base.html#1049" class="Bound">a</a> <a id="1051" href="Algebra.Construct.LexProduct.Base.html#1051" class="Bound">b</a> <a id="1053" href="Algebra.Construct.LexProduct.Base.html#1053" class="Bound">x</a> <a id="1055" href="Algebra.Construct.LexProduct.Base.html#1055" class="Bound">y</a> <a id="1057" class="Keyword">with</a> <a id="1062" href="Relation.Nullary.html#1581" class="Field">does</a> <a id="1067" class="Symbol">((</a><a id="1069" href="Algebra.Construct.LexProduct.Base.html#1049" class="Bound">a</a> <a id="1071" href="Algebra.Construct.LexProduct.Base.html#637" class="Bound Operator">∙</a> <a id="1073" href="Algebra.Construct.LexProduct.Base.html#1051" class="Bound">b</a><a id="1074" class="Symbol">)</a> <a id="1076" href="Algebra.Construct.LexProduct.Base.html#684" class="Bound Operator">≟₁</a> <a id="1079" href="Algebra.Construct.LexProduct.Base.html#1049" class="Bound">a</a><a id="1080" class="Symbol">)</a> <a id="1082" class="Symbol">|</a> <a id="1084" href="Relation.Nullary.html#1581" class="Field">does</a> <a id="1089" class="Symbol">((</a><a id="1091" href="Algebra.Construct.LexProduct.Base.html#1049" class="Bound">a</a> <a id="1093" href="Algebra.Construct.LexProduct.Base.html#637" class="Bound Operator">∙</a> <a id="1095" href="Algebra.Construct.LexProduct.Base.html#1051" class="Bound">b</a><a id="1096" class="Symbol">)</a> <a id="1098" href="Algebra.Construct.LexProduct.Base.html#684" class="Bound Operator">≟₁</a> <a id="1101" href="Algebra.Construct.LexProduct.Base.html#1051" class="Bound">b</a><a id="1102" class="Symbol">)</a>
<a id="1104" class="Symbol">...</a> <a id="1108" class="Symbol">|</a> <a id="1110" href="Agda.Builtin.Bool.html#188" class="InductiveConstructor">true</a>  <a id="1116" class="Symbol">|</a> <a id="1118" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">false</a> <a id="1124" class="Symbol">=</a> <a id="1126" class="Bound">x</a>
<a id="1128" class="Symbol">...</a> <a id="1132" class="Symbol">|</a> <a id="1134" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">false</a> <a id="1140" class="Symbol">|</a> <a id="1142" href="Agda.Builtin.Bool.html#188" class="InductiveConstructor">true</a>  <a id="1148" class="Symbol">=</a> <a id="1150" class="Bound">y</a>
<a id="1152" class="CatchallClause Symbol">...</a><a id="1155" class="CatchallClause"> </a><a id="1156" class="CatchallClause Symbol">|</a><a id="1157" class="CatchallClause">     </a><a id="1162" class="CatchallClause Symbol">_</a><a id="1163" class="CatchallClause"> </a><a id="1164" class="CatchallClause Symbol">|</a><a id="1165" class="CatchallClause">     </a><a id="1170" class="CatchallClause Symbol">_</a> <a id="1172" class="Symbol">=</a> <a id="1174" class="Bound">x</a> <a id="1176" href="Algebra.Construct.LexProduct.Base.html#651" class="Bound Operator">◦</a> <a id="1178" class="Bound">y</a>

<a id="1181" class="Comment">-- The full lexicographic choice operator can then be simply defined</a>
<a id="1250" class="Comment">-- in terms of the inner one.</a>

<a id="lex"></a><a id="1281" href="Algebra.Construct.LexProduct.Base.html#1281" class="Function">lex</a> <a id="1285" class="Symbol">:</a> <a id="1287" href="Algebra.Core.html#518" class="Function">Op₂</a> <a id="1291" class="Symbol">(</a><a id="1292" href="Algebra.Construct.LexProduct.Base.html#611" class="Bound">A</a> <a id="1294" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="1296" href="Algebra.Construct.LexProduct.Base.html#623" class="Bound">B</a><a id="1297" class="Symbol">)</a>
<a id="1299" href="Algebra.Construct.LexProduct.Base.html#1281" class="Function">lex</a> <a id="1303" class="Symbol">(</a><a id="1304" href="Algebra.Construct.LexProduct.Base.html#1304" class="Bound">a</a> <a id="1306" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1308" href="Algebra.Construct.LexProduct.Base.html#1308" class="Bound">x</a><a id="1309" class="Symbol">)</a> <a id="1311" class="Symbol">(</a><a id="1312" href="Algebra.Construct.LexProduct.Base.html#1312" class="Bound">b</a> <a id="1314" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1316" href="Algebra.Construct.LexProduct.Base.html#1316" class="Bound">y</a><a id="1317" class="Symbol">)</a> <a id="1319" class="Symbol">=</a> <a id="1321" class="Symbol">(</a><a id="1322" href="Algebra.Construct.LexProduct.Base.html#1304" class="Bound">a</a> <a id="1324" href="Algebra.Construct.LexProduct.Base.html#637" class="Bound Operator">∙</a> <a id="1326" href="Algebra.Construct.LexProduct.Base.html#1312" class="Bound">b</a> <a id="1328" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1330" href="Algebra.Construct.LexProduct.Base.html#1011" class="Function">innerLex</a> <a id="1339" href="Algebra.Construct.LexProduct.Base.html#1304" class="Bound">a</a> <a id="1341" href="Algebra.Construct.LexProduct.Base.html#1312" class="Bound">b</a> <a id="1343" href="Algebra.Construct.LexProduct.Base.html#1308" class="Bound">x</a> <a id="1345" href="Algebra.Construct.LexProduct.Base.html#1316" class="Bound">y</a><a id="1346" class="Symbol">)</a>
</pre></body></html>