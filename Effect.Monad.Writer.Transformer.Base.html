<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Effect.Monad.Writer.Transformer.Base</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- The Agda standard library</a>
<a id="103" class="Comment">--</a>
<a id="106" class="Comment">-- Basic type and definition of the writer monad transformer</a>
<a id="167" class="Comment">------------------------------------------------------------------------</a>

<a id="241" class="Symbol">{-#</a> <a id="245" class="Keyword">OPTIONS</a> <a id="253" class="Pragma">--without-K</a> <a id="265" class="Pragma">--safe</a> <a id="272" class="Symbol">#-}</a>

<a id="277" class="Keyword">module</a> <a id="284" href="Effect.Monad.Writer.Transformer.Base.html" class="Module">Effect.Monad.Writer.Transformer.Base</a> <a id="321" class="Keyword">where</a>

<a id="328" class="Keyword">open</a> <a id="333" class="Keyword">import</a> <a id="340" href="Algebra.html" class="Module">Algebra</a> <a id="348" class="Keyword">using</a> <a id="354" class="Symbol">(</a><a id="355" href="Algebra.Bundles.Raw.html#1096" class="Record">RawMonoid</a><a id="364" class="Symbol">)</a>
<a id="366" class="Keyword">open</a> <a id="371" class="Keyword">import</a> <a id="378" href="Data.Product.html" class="Module">Data.Product</a> <a id="391" class="Keyword">using</a> <a id="397" class="Symbol">(</a><a id="398" href="Data.Product.Base.html#1109" class="Function Operator">_×_</a><a id="401" class="Symbol">;</a> <a id="403" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">_,_</a><a id="406" class="Symbol">;</a> <a id="408" href="Data.Product.Base.html#608" class="Field">proj₁</a><a id="413" class="Symbol">;</a> <a id="415" href="Data.Product.Base.html#622" class="Field">proj₂</a><a id="420" class="Symbol">)</a>
<a id="422" class="Keyword">open</a> <a id="427" class="Keyword">import</a> <a id="434" href="Data.Unit.Polymorphic.html" class="Module">Data.Unit.Polymorphic</a> <a id="456" class="Keyword">using</a> <a id="462" class="Symbol">(</a><a id="463" href="Data.Unit.Polymorphic.Base.html#480" class="Function">⊤</a><a id="464" class="Symbol">;</a> <a id="466" href="Data.Unit.Polymorphic.Base.html#524" class="Function">tt</a><a id="468" class="Symbol">)</a>
<a id="470" class="Keyword">open</a> <a id="475" class="Keyword">import</a> <a id="482" href="Function.Base.html" class="Module">Function.Base</a> <a id="496" class="Keyword">using</a> <a id="502" class="Symbol">(</a><a id="503" href="Function.Base.html#695" class="Function">id</a><a id="505" class="Symbol">;</a> <a id="507" href="Function.Base.html#3637" class="Function Operator">_∘′_</a><a id="511" class="Symbol">)</a>
<a id="513" class="Keyword">open</a> <a id="518" class="Keyword">import</a> <a id="525" href="Level.html" class="Module">Level</a> <a id="531" class="Keyword">using</a> <a id="537" class="Symbol">(</a><a id="538" href="Agda.Primitive.html#597" class="Postulate">Level</a><a id="543" class="Symbol">;</a> <a id="545" href="Agda.Primitive.html#780" class="Primitive">suc</a><a id="548" class="Symbol">;</a> <a id="550" href="Agda.Primitive.html#810" class="Primitive Operator">_⊔_</a><a id="553" class="Symbol">)</a>

<a id="556" class="Keyword">open</a> <a id="561" class="Keyword">import</a> <a id="568" href="Effect.Functor.html" class="Module">Effect.Functor</a> <a id="583" class="Keyword">using</a> <a id="589" class="Symbol">(</a><a id="590" href="Effect.Functor.html#570" class="Record">RawFunctor</a><a id="600" class="Symbol">)</a>

<a id="603" class="Keyword">private</a>
  <a id="613" class="Keyword">variable</a>
    <a id="626" href="Effect.Monad.Writer.Transformer.Base.html#626" class="Generalizable">w</a> <a id="628" href="Effect.Monad.Writer.Transformer.Base.html#628" class="Generalizable">f</a> <a id="630" href="Effect.Monad.Writer.Transformer.Base.html#630" class="Generalizable">g</a> <a id="632" class="Symbol">:</a> <a id="634" href="Agda.Primitive.html#597" class="Postulate">Level</a>
    <a id="644" href="Effect.Monad.Writer.Transformer.Base.html#644" class="Generalizable">A</a> <a id="646" class="Symbol">:</a> <a id="648" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="652" href="Effect.Monad.Writer.Transformer.Base.html#630" class="Generalizable">g</a>
    <a id="658" href="Effect.Monad.Writer.Transformer.Base.html#658" class="Generalizable">M</a> <a id="660" class="Symbol">:</a> <a id="662" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="666" href="Effect.Monad.Writer.Transformer.Base.html#626" class="Generalizable">w</a> <a id="668" class="Symbol">→</a> <a id="670" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="674" href="Effect.Monad.Writer.Transformer.Base.html#630" class="Generalizable">g</a>
    <a id="680" href="Effect.Monad.Writer.Transformer.Base.html#680" class="Generalizable">𝕎</a> <a id="682" class="Symbol">:</a> <a id="684" href="Algebra.Bundles.Raw.html#1096" class="Record">RawMonoid</a> <a id="694" href="Effect.Monad.Writer.Transformer.Base.html#626" class="Generalizable">w</a> <a id="696" href="Effect.Monad.Writer.Transformer.Base.html#630" class="Generalizable">g</a>

<a id="699" class="Comment">------------------------------------------------------------------------</a>
<a id="772" class="Comment">-- Writer monad operations</a>

<a id="800" class="Keyword">record</a> <a id="RawMonadWriter"></a><a id="807" href="Effect.Monad.Writer.Transformer.Base.html#807" class="Record">RawMonadWriter</a>
       <a id="829" class="Symbol">(</a><a id="830" href="Effect.Monad.Writer.Transformer.Base.html#830" class="Bound">𝕎</a> <a id="832" class="Symbol">:</a> <a id="834" href="Algebra.Bundles.Raw.html#1096" class="Record">RawMonoid</a> <a id="844" href="Effect.Monad.Writer.Transformer.Base.html#626" class="Generalizable">w</a> <a id="846" href="Effect.Monad.Writer.Transformer.Base.html#628" class="Generalizable">f</a><a id="847" class="Symbol">)</a>
       <a id="856" class="Symbol">(</a><a id="857" href="Effect.Monad.Writer.Transformer.Base.html#857" class="Bound">M</a> <a id="859" class="Symbol">:</a> <a id="861" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="865" href="Effect.Monad.Writer.Transformer.Base.html#626" class="Generalizable">w</a> <a id="867" class="Symbol">→</a> <a id="869" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="873" href="Effect.Monad.Writer.Transformer.Base.html#630" class="Generalizable">g</a><a id="874" class="Symbol">)</a>
       <a id="883" class="Symbol">:</a> <a id="885" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="889" class="Symbol">(</a><a id="890" href="Agda.Primitive.html#780" class="Primitive">suc</a> <a id="894" href="Effect.Monad.Writer.Transformer.Base.html#844" class="Bound">w</a> <a id="896" href="Agda.Primitive.html#810" class="Primitive Operator">⊔</a> <a id="898" href="Effect.Monad.Writer.Transformer.Base.html#873" class="Bound">g</a><a id="899" class="Symbol">)</a> <a id="901" class="Keyword">where</a>
  <a id="909" class="Keyword">open</a> <a id="914" href="Algebra.Bundles.Raw.html#1096" class="Module">RawMonoid</a> <a id="924" href="Effect.Monad.Writer.Transformer.Base.html#830" class="Bound">𝕎</a> <a id="926" class="Keyword">renaming</a> <a id="935" class="Symbol">(</a><a id="936" href="Algebra.Bundles.Raw.html#1178" class="Field">Carrier</a> <a id="944" class="Symbol">to</a> <a id="947" class="Field">W</a><a id="948" class="Symbol">)</a>
  <a id="952" class="Keyword">field</a>
    <a id="RawMonadWriter.writer"></a><a id="962" href="Effect.Monad.Writer.Transformer.Base.html#962" class="Field">writer</a> <a id="969" class="Symbol">:</a> <a id="971" href="Effect.Monad.Writer.Transformer.Base.html#947" class="Function">W</a> <a id="973" href="Data.Product.Base.html#1109" class="Function Operator">×</a> <a id="975" href="Effect.Monad.Writer.Transformer.Base.html#644" class="Generalizable">A</a> <a id="977" class="Symbol">→</a> <a id="979" href="Effect.Monad.Writer.Transformer.Base.html#857" class="Bound">M</a> <a id="981" href="Effect.Monad.Writer.Transformer.Base.html#644" class="Generalizable">A</a>
    <a id="RawMonadWriter.listen"></a><a id="987" href="Effect.Monad.Writer.Transformer.Base.html#987" class="Field">listen</a> <a id="994" class="Symbol">:</a> <a id="996" href="Effect.Monad.Writer.Transformer.Base.html#857" class="Bound">M</a> <a id="998" href="Effect.Monad.Writer.Transformer.Base.html#644" class="Generalizable">A</a> <a id="1000" class="Symbol">→</a> <a id="1002" href="Effect.Monad.Writer.Transformer.Base.html#857" class="Bound">M</a> <a id="1004" class="Symbol">(</a><a id="1005" href="Effect.Monad.Writer.Transformer.Base.html#947" class="Function">W</a> <a id="1007" href="Data.Product.Base.html#1109" class="Function Operator">×</a> <a id="1009" href="Effect.Monad.Writer.Transformer.Base.html#644" class="Generalizable">A</a><a id="1010" class="Symbol">)</a>
    <a id="RawMonadWriter.pass"></a><a id="1016" href="Effect.Monad.Writer.Transformer.Base.html#1016" class="Field">pass</a>   <a id="1023" class="Symbol">:</a> <a id="1025" href="Effect.Monad.Writer.Transformer.Base.html#857" class="Bound">M</a> <a id="1027" class="Symbol">((</a><a id="1029" href="Effect.Monad.Writer.Transformer.Base.html#947" class="Function">W</a> <a id="1031" class="Symbol">→</a> <a id="1033" href="Effect.Monad.Writer.Transformer.Base.html#947" class="Function">W</a><a id="1034" class="Symbol">)</a> <a id="1036" href="Data.Product.Base.html#1109" class="Function Operator">×</a> <a id="1038" href="Effect.Monad.Writer.Transformer.Base.html#644" class="Generalizable">A</a><a id="1039" class="Symbol">)</a> <a id="1041" class="Symbol">→</a> <a id="1043" href="Effect.Monad.Writer.Transformer.Base.html#857" class="Bound">M</a> <a id="1045" href="Effect.Monad.Writer.Transformer.Base.html#644" class="Generalizable">A</a>

  <a id="RawMonadWriter.tell"></a><a id="1050" href="Effect.Monad.Writer.Transformer.Base.html#1050" class="Function">tell</a> <a id="1055" class="Symbol">:</a> <a id="1057" href="Effect.Monad.Writer.Transformer.Base.html#947" class="Function">W</a> <a id="1059" class="Symbol">→</a> <a id="1061" href="Effect.Monad.Writer.Transformer.Base.html#857" class="Bound">M</a> <a id="1063" href="Data.Unit.Polymorphic.Base.html#480" class="Function">⊤</a>
  <a id="1067" href="Effect.Monad.Writer.Transformer.Base.html#1050" class="Function">tell</a> <a id="1072" href="Effect.Monad.Writer.Transformer.Base.html#1072" class="Bound">w</a> <a id="1074" class="Symbol">=</a> <a id="1076" href="Effect.Monad.Writer.Transformer.Base.html#962" class="Field">writer</a> <a id="1083" class="Symbol">(</a><a id="1084" href="Effect.Monad.Writer.Transformer.Base.html#1072" class="Bound">w</a> <a id="1086" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1088" href="Data.Unit.Polymorphic.Base.html#524" class="Function">tt</a><a id="1090" class="Symbol">)</a>

<a id="1093" class="Comment">------------------------------------------------------------------------</a>
<a id="1166" class="Comment">-- Writer monad transformer (CPS-encoded)</a>

<a id="1209" class="Keyword">record</a> <a id="WriterT"></a><a id="1216" href="Effect.Monad.Writer.Transformer.Base.html#1216" class="Record">WriterT</a>
       <a id="1231" class="Symbol">(</a><a id="1232" href="Effect.Monad.Writer.Transformer.Base.html#1232" class="Bound">𝕎</a> <a id="1234" class="Symbol">:</a> <a id="1236" href="Algebra.Bundles.Raw.html#1096" class="Record">RawMonoid</a> <a id="1246" href="Effect.Monad.Writer.Transformer.Base.html#626" class="Generalizable">w</a> <a id="1248" href="Effect.Monad.Writer.Transformer.Base.html#628" class="Generalizable">f</a><a id="1249" class="Symbol">)</a>
       <a id="1258" class="Symbol">(</a><a id="1259" href="Effect.Monad.Writer.Transformer.Base.html#1259" class="Bound">M</a> <a id="1261" class="Symbol">:</a> <a id="1263" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="1267" href="Effect.Monad.Writer.Transformer.Base.html#626" class="Generalizable">w</a> <a id="1269" class="Symbol">→</a> <a id="1271" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="1275" href="Effect.Monad.Writer.Transformer.Base.html#630" class="Generalizable">g</a><a id="1276" class="Symbol">)</a>
       <a id="1285" class="Symbol">(</a><a id="1286" href="Effect.Monad.Writer.Transformer.Base.html#1286" class="Bound">A</a> <a id="1288" class="Symbol">:</a> <a id="1290" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="1294" href="Effect.Monad.Writer.Transformer.Base.html#626" class="Generalizable">w</a><a id="1295" class="Symbol">)</a>
       <a id="1304" class="Symbol">:</a> <a id="1306" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="1310" class="Symbol">(</a><a id="1311" href="Effect.Monad.Writer.Transformer.Base.html#1246" class="Bound">w</a> <a id="1313" href="Agda.Primitive.html#810" class="Primitive Operator">⊔</a> <a id="1315" href="Effect.Monad.Writer.Transformer.Base.html#1275" class="Bound">g</a><a id="1316" class="Symbol">)</a> <a id="1318" class="Keyword">where</a>
  <a id="1326" class="Keyword">constructor</a> <a id="mkWriterT"></a><a id="1338" href="Effect.Monad.Writer.Transformer.Base.html#1338" class="InductiveConstructor">mkWriterT</a>
  <a id="1350" class="Keyword">open</a> <a id="1355" href="Algebra.Bundles.Raw.html#1096" class="Module">RawMonoid</a> <a id="1365" href="Effect.Monad.Writer.Transformer.Base.html#1232" class="Bound">𝕎</a> <a id="1367" class="Keyword">renaming</a> <a id="1376" class="Symbol">(</a><a id="1377" href="Algebra.Bundles.Raw.html#1178" class="Field">Carrier</a> <a id="1385" class="Symbol">to</a> <a id="1388" class="Field">W</a><a id="1389" class="Symbol">)</a>
  <a id="1393" class="Keyword">field</a> <a id="WriterT.runWriterT"></a><a id="1399" href="Effect.Monad.Writer.Transformer.Base.html#1399" class="Field">runWriterT</a> <a id="1410" class="Symbol">:</a> <a id="1412" href="Effect.Monad.Writer.Transformer.Base.html#1388" class="Function">W</a> <a id="1414" class="Symbol">→</a> <a id="1416" href="Effect.Monad.Writer.Transformer.Base.html#1259" class="Bound">M</a> <a id="1418" class="Symbol">(</a><a id="1419" href="Effect.Monad.Writer.Transformer.Base.html#1388" class="Function">W</a> <a id="1421" href="Data.Product.Base.html#1109" class="Function Operator">×</a> <a id="1423" href="Effect.Monad.Writer.Transformer.Base.html#1286" class="Bound">A</a><a id="1424" class="Symbol">)</a>
<a id="1426" class="Keyword">open</a> <a id="1431" href="Effect.Monad.Writer.Transformer.Base.html#1216" class="Module">WriterT</a> <a id="1439" class="Keyword">public</a>

<a id="1447" class="Keyword">module</a> <a id="1454" href="Effect.Monad.Writer.Transformer.Base.html#1454" class="Module">_</a> <a id="1456" class="Symbol">{</a><a id="1457" href="Effect.Monad.Writer.Transformer.Base.html#1457" class="Bound">𝕎</a> <a id="1459" class="Symbol">:</a> <a id="1461" href="Algebra.Bundles.Raw.html#1096" class="Record">RawMonoid</a> <a id="1471" href="Effect.Monad.Writer.Transformer.Base.html#626" class="Generalizable">w</a> <a id="1473" href="Effect.Monad.Writer.Transformer.Base.html#628" class="Generalizable">f</a><a id="1474" class="Symbol">}</a> <a id="1476" class="Keyword">where</a>

  <a id="1485" class="Keyword">open</a> <a id="1490" href="Algebra.Bundles.Raw.html#1096" class="Module">RawMonoid</a> <a id="1500" href="Effect.Monad.Writer.Transformer.Base.html#1457" class="Bound">𝕎</a> <a id="1502" class="Keyword">renaming</a> <a id="1511" class="Symbol">(</a><a id="1512" href="Algebra.Bundles.Raw.html#1178" class="Field">Carrier</a> <a id="1520" class="Symbol">to</a> <a id="1523" class="Field">W</a><a id="1524" class="Symbol">)</a>

  <a id="1529" href="Effect.Monad.Writer.Transformer.Base.html#1529" class="Function">evalWriterT</a> <a id="1541" class="Symbol">:</a> <a id="1543" href="Effect.Functor.html#570" class="Record">RawFunctor</a> <a id="1554" href="Effect.Monad.Writer.Transformer.Base.html#658" class="Generalizable">M</a> <a id="1556" class="Symbol">→</a> <a id="1558" href="Effect.Monad.Writer.Transformer.Base.html#1216" class="Record">WriterT</a> <a id="1566" href="Effect.Monad.Writer.Transformer.Base.html#1457" class="Bound">𝕎</a> <a id="1568" href="Effect.Monad.Writer.Transformer.Base.html#658" class="Generalizable">M</a> <a id="1570" href="Effect.Monad.Writer.Transformer.Base.html#644" class="Generalizable">A</a> <a id="1572" class="Symbol">→</a> <a id="1574" href="Effect.Monad.Writer.Transformer.Base.html#658" class="Generalizable">M</a> <a id="1576" href="Effect.Monad.Writer.Transformer.Base.html#644" class="Generalizable">A</a>
  <a id="1580" href="Effect.Monad.Writer.Transformer.Base.html#1529" class="Function">evalWriterT</a> <a id="1592" href="Effect.Monad.Writer.Transformer.Base.html#1592" class="Bound">M</a> <a id="1594" href="Effect.Monad.Writer.Transformer.Base.html#1594" class="Bound">ma</a> <a id="1597" class="Symbol">=</a> <a id="1599" href="Data.Product.Base.html#622" class="Field">proj₂</a> <a id="1605" href="Effect.Functor.html#678" class="Function Operator">&lt;$&gt;</a> <a id="1609" href="Effect.Monad.Writer.Transformer.Base.html#1399" class="Field">runWriterT</a> <a id="1620" href="Effect.Monad.Writer.Transformer.Base.html#1594" class="Bound">ma</a> <a id="1623" href="Algebra.Bundles.Raw.html#1252" class="Field">ε</a>
    <a id="1629" class="Keyword">where</a> <a id="1635" class="Keyword">open</a> <a id="1640" href="Effect.Functor.html#570" class="Module">RawFunctor</a> <a id="1651" href="Effect.Monad.Writer.Transformer.Base.html#1592" class="Bound">M</a>

  <a id="1656" href="Effect.Monad.Writer.Transformer.Base.html#1656" class="Function">execWriterT</a> <a id="1668" class="Symbol">:</a> <a id="1670" href="Effect.Functor.html#570" class="Record">RawFunctor</a> <a id="1681" href="Effect.Monad.Writer.Transformer.Base.html#658" class="Generalizable">M</a> <a id="1683" class="Symbol">→</a> <a id="1685" href="Effect.Monad.Writer.Transformer.Base.html#1216" class="Record">WriterT</a> <a id="1693" href="Effect.Monad.Writer.Transformer.Base.html#1457" class="Bound">𝕎</a> <a id="1695" href="Effect.Monad.Writer.Transformer.Base.html#658" class="Generalizable">M</a> <a id="1697" href="Effect.Monad.Writer.Transformer.Base.html#644" class="Generalizable">A</a> <a id="1699" class="Symbol">→</a> <a id="1701" href="Effect.Monad.Writer.Transformer.Base.html#658" class="Generalizable">M</a> <a id="1703" href="Effect.Monad.Writer.Transformer.Base.html#1523" class="Field">W</a>
  <a id="1707" href="Effect.Monad.Writer.Transformer.Base.html#1656" class="Function">execWriterT</a> <a id="1719" href="Effect.Monad.Writer.Transformer.Base.html#1719" class="Bound">M</a> <a id="1721" href="Effect.Monad.Writer.Transformer.Base.html#1721" class="Bound">ma</a> <a id="1724" class="Symbol">=</a> <a id="1726" href="Data.Product.Base.html#608" class="Field">proj₁</a> <a id="1732" href="Effect.Functor.html#678" class="Function Operator">&lt;$&gt;</a> <a id="1736" href="Effect.Monad.Writer.Transformer.Base.html#1399" class="Field">runWriterT</a> <a id="1747" href="Effect.Monad.Writer.Transformer.Base.html#1721" class="Bound">ma</a> <a id="1750" href="Algebra.Bundles.Raw.html#1252" class="Field">ε</a>
    <a id="1756" class="Keyword">where</a> <a id="1762" class="Keyword">open</a> <a id="1767" href="Effect.Functor.html#570" class="Module">RawFunctor</a> <a id="1778" href="Effect.Monad.Writer.Transformer.Base.html#1719" class="Bound">M</a>
</pre></body></html>