<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Algebra.Solver.Monoid</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- The Agda standard library</a>
<a id="103" class="Comment">--</a>
<a id="106" class="Comment">-- A solver for equations over monoids</a>
<a id="145" class="Comment">------------------------------------------------------------------------</a>

<a id="219" class="Symbol">{-#</a> <a id="223" class="Keyword">OPTIONS</a> <a id="231" class="Pragma">--cubical-compatible</a> <a id="252" class="Pragma">--safe</a> <a id="259" class="Symbol">#-}</a>

<a id="264" class="Keyword">open</a> <a id="269" class="Keyword">import</a> <a id="276" href="Algebra.html" class="Module">Algebra</a>

<a id="285" class="Keyword">module</a> <a id="292" href="Algebra.Solver.Monoid.html" class="Module">Algebra.Solver.Monoid</a> <a id="314" class="Symbol">{</a><a id="315" href="Algebra.Solver.Monoid.html#315" class="Bound">m₁</a> <a id="318" href="Algebra.Solver.Monoid.html#318" class="Bound">m₂</a><a id="320" class="Symbol">}</a> <a id="322" class="Symbol">(</a><a id="323" href="Algebra.Solver.Monoid.html#323" class="Bound">M</a> <a id="325" class="Symbol">:</a> <a id="327" href="Algebra.Bundles.html#7315" class="Record">Monoid</a> <a id="334" href="Algebra.Solver.Monoid.html#315" class="Bound">m₁</a> <a id="337" href="Algebra.Solver.Monoid.html#318" class="Bound">m₂</a><a id="339" class="Symbol">)</a> <a id="341" class="Keyword">where</a>

<a id="348" class="Keyword">open</a> <a id="353" class="Keyword">import</a> <a id="360" href="Data.Fin.Base.html" class="Module">Data.Fin.Base</a> <a id="374" class="Symbol">as</a> <a id="377" class="Module">Fin</a>
<a id="381" class="Keyword">import</a> <a id="388" href="Data.Fin.Properties.html" class="Module">Data.Fin.Properties</a> <a id="408" class="Symbol">as</a> <a id="411" class="Module">Fin</a>
<a id="415" class="Keyword">open</a> <a id="420" class="Keyword">import</a> <a id="427" href="Data.List.Base.html" class="Module">Data.List.Base</a> <a id="442" class="Keyword">hiding</a> <a id="449" class="Symbol">(</a><a id="450" href="Data.List.Base.html#6561" class="Function">lookup</a><a id="456" class="Symbol">)</a>
<a id="458" class="Keyword">import</a> <a id="465" href="Data.List.Relation.Binary.Equality.DecPropositional.html" class="Module">Data.List.Relation.Binary.Equality.DecPropositional</a> <a id="517" class="Symbol">as</a> <a id="520" class="Module">ListEq</a>
<a id="527" class="Keyword">open</a> <a id="532" class="Keyword">import</a> <a id="539" href="Data.Maybe.Base.html" class="Module">Data.Maybe.Base</a> <a id="555" class="Symbol">as</a> <a id="558" class="Module">Maybe</a>
  <a id="566" class="Keyword">using</a> <a id="572" class="Symbol">(</a><a id="573" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a><a id="578" class="Symbol">;</a> <a id="580" href="Data.Maybe.Base.html#1732" class="Function">From-just</a><a id="589" class="Symbol">;</a> <a id="591" href="Data.Maybe.Base.html#1820" class="Function">from-just</a><a id="600" class="Symbol">)</a>
<a id="602" class="Keyword">open</a> <a id="607" class="Keyword">import</a> <a id="614" href="Data.Nat.Base.html" class="Module">Data.Nat.Base</a> <a id="628" class="Keyword">using</a> <a id="634" class="Symbol">(</a><a id="635" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="636" class="Symbol">)</a>
<a id="638" class="Keyword">open</a> <a id="643" class="Keyword">import</a> <a id="650" href="Data.Product.Base.html" class="Module">Data.Product.Base</a> <a id="668" class="Keyword">using</a> <a id="674" class="Symbol">(</a><a id="675" href="Data.Product.Base.html#1618" class="Function Operator">_×_</a><a id="678" class="Symbol">;</a> <a id="680" href="Data.Product.Base.html#3109" class="Function">uncurry</a><a id="687" class="Symbol">)</a>
<a id="689" class="Keyword">open</a> <a id="694" class="Keyword">import</a> <a id="701" href="Data.Vec.Base.html" class="Module">Data.Vec.Base</a> <a id="715" class="Keyword">using</a> <a id="721" class="Symbol">(</a><a id="722" href="Data.Vec.Base.html#1119" class="Datatype">Vec</a><a id="725" class="Symbol">;</a> <a id="727" href="Data.Vec.Base.html#1676" class="Function">lookup</a><a id="733" class="Symbol">)</a>
<a id="735" class="Keyword">open</a> <a id="740" class="Keyword">import</a> <a id="747" href="Function.Base.html" class="Module">Function.Base</a> <a id="761" class="Keyword">using</a> <a id="767" class="Symbol">(</a><a id="768" href="Function.Base.html#1115" class="Function Operator">_∘_</a><a id="771" class="Symbol">;</a> <a id="773" href="Function.Base.html#1974" class="Function Operator">_$_</a><a id="776" class="Symbol">)</a>
<a id="778" class="Keyword">open</a> <a id="783" class="Keyword">import</a> <a id="790" href="Relation.Binary.Consequences.html" class="Module">Relation.Binary.Consequences</a> <a id="819" class="Keyword">using</a> <a id="825" class="Symbol">(</a><a id="826" href="Relation.Binary.Consequences.html#6909" class="Function">dec⇒weaklyDec</a><a id="839" class="Symbol">)</a>
<a id="841" class="Keyword">open</a> <a id="846" class="Keyword">import</a> <a id="853" href="Relation.Binary.Definitions.html" class="Module">Relation.Binary.Definitions</a> <a id="881" class="Keyword">using</a> <a id="887" class="Symbol">(</a><a id="888" href="Relation.Binary.Definitions.html#6834" class="Function">DecidableEquality</a><a id="905" class="Symbol">)</a>

<a id="908" class="Keyword">open</a> <a id="913" class="Keyword">import</a> <a id="920" href="Relation.Binary.PropositionalEquality.Core.html" class="Module">Relation.Binary.PropositionalEquality.Core</a> <a id="963" class="Keyword">using</a> <a id="969" class="Symbol">(</a><a id="970" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">_≡_</a><a id="973" class="Symbol">;</a> <a id="975" href="Relation.Binary.PropositionalEquality.Core.html#1339" class="Function">cong</a><a id="979" class="Symbol">)</a>
<a id="981" class="Keyword">import</a> <a id="988" href="Relation.Binary.Reflection.html" class="Module">Relation.Binary.Reflection</a>
<a id="1015" class="Keyword">import</a> <a id="1022" href="Relation.Nullary.Decidable.Core.html" class="Module">Relation.Nullary.Decidable.Core</a> <a id="1054" class="Symbol">as</a> <a id="1057" class="Module">Dec</a>

<a id="1062" class="Keyword">open</a> <a id="1067" href="Algebra.Bundles.html#7315" class="Module">Monoid</a> <a id="1074" href="Algebra.Solver.Monoid.html#323" class="Bound">M</a>
<a id="1076" class="Keyword">open</a> <a id="1081" class="Keyword">import</a> <a id="1088" href="Relation.Binary.Reasoning.Setoid.html" class="Module">Relation.Binary.Reasoning.Setoid</a> <a id="1121" href="Algebra.Structures.html#1873" class="Function">setoid</a>

<a id="1129" class="Comment">------------------------------------------------------------------------</a>
<a id="1202" class="Comment">-- Monoid expressions</a>

<a id="1225" class="Comment">-- There is one constructor for every operation, plus one for</a>
<a id="1287" class="Comment">-- variables; there may be at most n variables.</a>

<a id="1336" class="Keyword">infixr</a> <a id="1343" class="Number">5</a> <a id="1345" href="Algebra.Solver.Monoid.html#1420" class="InductiveConstructor Operator">_⊕_</a>

<a id="1350" class="Keyword">data</a> <a id="Expr"></a><a id="1355" href="Algebra.Solver.Monoid.html#1355" class="Datatype">Expr</a> <a id="1360" class="Symbol">(</a><a id="1361" href="Algebra.Solver.Monoid.html#1361" class="Bound">n</a> <a id="1363" class="Symbol">:</a> <a id="1365" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="1366" class="Symbol">)</a> <a id="1368" class="Symbol">:</a> <a id="1370" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="1374" class="Keyword">where</a>
  <a id="Expr.var"></a><a id="1382" href="Algebra.Solver.Monoid.html#1382" class="InductiveConstructor">var</a> <a id="1386" class="Symbol">:</a> <a id="1388" href="Data.Fin.Base.html#1159" class="Datatype">Fin</a> <a id="1392" href="Algebra.Solver.Monoid.html#1361" class="Bound">n</a> <a id="1394" class="Symbol">→</a> <a id="1396" href="Algebra.Solver.Monoid.html#1355" class="Datatype">Expr</a> <a id="1401" href="Algebra.Solver.Monoid.html#1361" class="Bound">n</a>
  <a id="Expr.id"></a><a id="1405" href="Algebra.Solver.Monoid.html#1405" class="InductiveConstructor">id</a>  <a id="1409" class="Symbol">:</a> <a id="1411" href="Algebra.Solver.Monoid.html#1355" class="Datatype">Expr</a> <a id="1416" href="Algebra.Solver.Monoid.html#1361" class="Bound">n</a>
  <a id="Expr._⊕_"></a><a id="1420" href="Algebra.Solver.Monoid.html#1420" class="InductiveConstructor Operator">_⊕_</a> <a id="1424" class="Symbol">:</a> <a id="1426" href="Algebra.Solver.Monoid.html#1355" class="Datatype">Expr</a> <a id="1431" href="Algebra.Solver.Monoid.html#1361" class="Bound">n</a> <a id="1433" class="Symbol">→</a> <a id="1435" href="Algebra.Solver.Monoid.html#1355" class="Datatype">Expr</a> <a id="1440" href="Algebra.Solver.Monoid.html#1361" class="Bound">n</a> <a id="1442" class="Symbol">→</a> <a id="1444" href="Algebra.Solver.Monoid.html#1355" class="Datatype">Expr</a> <a id="1449" href="Algebra.Solver.Monoid.html#1361" class="Bound">n</a>

<a id="1452" class="Comment">-- An environment contains one value for every variable.</a>

<a id="Env"></a><a id="1510" href="Algebra.Solver.Monoid.html#1510" class="Function">Env</a> <a id="1514" class="Symbol">:</a> <a id="1516" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="1518" class="Symbol">→</a> <a id="1520" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="1524" class="Symbol">_</a>
<a id="1526" href="Algebra.Solver.Monoid.html#1510" class="Function">Env</a> <a id="1530" href="Algebra.Solver.Monoid.html#1530" class="Bound">n</a> <a id="1532" class="Symbol">=</a> <a id="1534" href="Data.Vec.Base.html#1119" class="Datatype">Vec</a> <a id="1538" href="Algebra.Bundles.html#7394" class="Field">Carrier</a> <a id="1546" href="Algebra.Solver.Monoid.html#1530" class="Bound">n</a>

<a id="1549" class="Comment">-- The semantics of an expression is a function from an environment to</a>
<a id="1620" class="Comment">-- a value.</a>

<a id="⟦_⟧"></a><a id="1633" href="Algebra.Solver.Monoid.html#1633" class="Function Operator">⟦_⟧</a> <a id="1637" class="Symbol">:</a> <a id="1639" class="Symbol">∀</a> <a id="1641" class="Symbol">{</a><a id="1642" href="Algebra.Solver.Monoid.html#1642" class="Bound">n</a><a id="1643" class="Symbol">}</a> <a id="1645" class="Symbol">→</a> <a id="1647" href="Algebra.Solver.Monoid.html#1355" class="Datatype">Expr</a> <a id="1652" href="Algebra.Solver.Monoid.html#1642" class="Bound">n</a> <a id="1654" class="Symbol">→</a> <a id="1656" href="Algebra.Solver.Monoid.html#1510" class="Function">Env</a> <a id="1660" href="Algebra.Solver.Monoid.html#1642" class="Bound">n</a> <a id="1662" class="Symbol">→</a> <a id="1664" href="Algebra.Bundles.html#7394" class="Field">Carrier</a>
<a id="1672" href="Algebra.Solver.Monoid.html#1633" class="Function Operator">⟦</a> <a id="1674" href="Algebra.Solver.Monoid.html#1382" class="InductiveConstructor">var</a> <a id="1678" href="Algebra.Solver.Monoid.html#1678" class="Bound">x</a>   <a id="1682" href="Algebra.Solver.Monoid.html#1633" class="Function Operator">⟧</a> <a id="1684" href="Algebra.Solver.Monoid.html#1684" class="Bound">ρ</a> <a id="1686" class="Symbol">=</a> <a id="1688" href="Data.Vec.Base.html#1676" class="Function">lookup</a> <a id="1695" href="Algebra.Solver.Monoid.html#1684" class="Bound">ρ</a> <a id="1697" href="Algebra.Solver.Monoid.html#1678" class="Bound">x</a>
<a id="1699" href="Algebra.Solver.Monoid.html#1633" class="Function Operator">⟦</a> <a id="1701" href="Algebra.Solver.Monoid.html#1405" class="InductiveConstructor">id</a>      <a id="1709" href="Algebra.Solver.Monoid.html#1633" class="Function Operator">⟧</a> <a id="1711" href="Algebra.Solver.Monoid.html#1711" class="Bound">ρ</a> <a id="1713" class="Symbol">=</a> <a id="1715" href="Algebra.Bundles.html#7471" class="Field">ε</a>
<a id="1717" href="Algebra.Solver.Monoid.html#1633" class="Function Operator">⟦</a> <a id="1719" href="Algebra.Solver.Monoid.html#1719" class="Bound">e₁</a> <a id="1722" href="Algebra.Solver.Monoid.html#1420" class="InductiveConstructor Operator">⊕</a> <a id="1724" href="Algebra.Solver.Monoid.html#1724" class="Bound">e₂</a> <a id="1727" href="Algebra.Solver.Monoid.html#1633" class="Function Operator">⟧</a> <a id="1729" href="Algebra.Solver.Monoid.html#1729" class="Bound">ρ</a> <a id="1731" class="Symbol">=</a> <a id="1733" href="Algebra.Solver.Monoid.html#1633" class="Function Operator">⟦</a> <a id="1735" href="Algebra.Solver.Monoid.html#1719" class="Bound">e₁</a> <a id="1738" href="Algebra.Solver.Monoid.html#1633" class="Function Operator">⟧</a> <a id="1740" href="Algebra.Solver.Monoid.html#1729" class="Bound">ρ</a> <a id="1742" href="Algebra.Bundles.html#7444" class="Field Operator">∙</a> <a id="1744" href="Algebra.Solver.Monoid.html#1633" class="Function Operator">⟦</a> <a id="1746" href="Algebra.Solver.Monoid.html#1724" class="Bound">e₂</a> <a id="1749" href="Algebra.Solver.Monoid.html#1633" class="Function Operator">⟧</a> <a id="1751" href="Algebra.Solver.Monoid.html#1729" class="Bound">ρ</a>

<a id="1754" class="Comment">------------------------------------------------------------------------</a>
<a id="1827" class="Comment">-- Normal forms</a>

<a id="1844" class="Comment">-- A normal form is a list of variables.</a>

<a id="Normal"></a><a id="1886" href="Algebra.Solver.Monoid.html#1886" class="Function">Normal</a> <a id="1893" class="Symbol">:</a> <a id="1895" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="1897" class="Symbol">→</a> <a id="1899" href="Agda.Primitive.html#388" class="Primitive">Set</a>
<a id="1903" href="Algebra.Solver.Monoid.html#1886" class="Function">Normal</a> <a id="1910" href="Algebra.Solver.Monoid.html#1910" class="Bound">n</a> <a id="1912" class="Symbol">=</a> <a id="1914" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="1919" class="Symbol">(</a><a id="1920" href="Data.Fin.Base.html#1159" class="Datatype">Fin</a> <a id="1924" href="Algebra.Solver.Monoid.html#1910" class="Bound">n</a><a id="1925" class="Symbol">)</a>

<a id="1928" class="Comment">-- The semantics of a normal form.</a>

<a id="⟦_⟧⇓"></a><a id="1964" href="Algebra.Solver.Monoid.html#1964" class="Function Operator">⟦_⟧⇓</a> <a id="1969" class="Symbol">:</a> <a id="1971" class="Symbol">∀</a> <a id="1973" class="Symbol">{</a><a id="1974" href="Algebra.Solver.Monoid.html#1974" class="Bound">n</a><a id="1975" class="Symbol">}</a> <a id="1977" class="Symbol">→</a> <a id="1979" href="Algebra.Solver.Monoid.html#1886" class="Function">Normal</a> <a id="1986" href="Algebra.Solver.Monoid.html#1974" class="Bound">n</a> <a id="1988" class="Symbol">→</a> <a id="1990" href="Algebra.Solver.Monoid.html#1510" class="Function">Env</a> <a id="1994" href="Algebra.Solver.Monoid.html#1974" class="Bound">n</a> <a id="1996" class="Symbol">→</a> <a id="1998" href="Algebra.Bundles.html#7394" class="Field">Carrier</a>
<a id="2006" href="Algebra.Solver.Monoid.html#1964" class="Function Operator">⟦</a> <a id="2008" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>     <a id="2015" href="Algebra.Solver.Monoid.html#1964" class="Function Operator">⟧⇓</a> <a id="2018" href="Algebra.Solver.Monoid.html#2018" class="Bound">ρ</a> <a id="2020" class="Symbol">=</a> <a id="2022" href="Algebra.Bundles.html#7471" class="Field">ε</a>
<a id="2024" href="Algebra.Solver.Monoid.html#1964" class="Function Operator">⟦</a> <a id="2026" href="Algebra.Solver.Monoid.html#2026" class="Bound">x</a> <a id="2028" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="2030" href="Algebra.Solver.Monoid.html#2030" class="Bound">nf</a> <a id="2033" href="Algebra.Solver.Monoid.html#1964" class="Function Operator">⟧⇓</a> <a id="2036" href="Algebra.Solver.Monoid.html#2036" class="Bound">ρ</a> <a id="2038" class="Symbol">=</a> <a id="2040" href="Data.Vec.Base.html#1676" class="Function">lookup</a> <a id="2047" href="Algebra.Solver.Monoid.html#2036" class="Bound">ρ</a> <a id="2049" href="Algebra.Solver.Monoid.html#2026" class="Bound">x</a> <a id="2051" href="Algebra.Bundles.html#7444" class="Field Operator">∙</a> <a id="2053" href="Algebra.Solver.Monoid.html#1964" class="Function Operator">⟦</a> <a id="2055" href="Algebra.Solver.Monoid.html#2030" class="Bound">nf</a> <a id="2058" href="Algebra.Solver.Monoid.html#1964" class="Function Operator">⟧⇓</a> <a id="2061" href="Algebra.Solver.Monoid.html#2036" class="Bound">ρ</a>

<a id="2064" class="Comment">-- A normaliser.</a>

<a id="normalise"></a><a id="2082" href="Algebra.Solver.Monoid.html#2082" class="Function">normalise</a> <a id="2092" class="Symbol">:</a> <a id="2094" class="Symbol">∀</a> <a id="2096" class="Symbol">{</a><a id="2097" href="Algebra.Solver.Monoid.html#2097" class="Bound">n</a><a id="2098" class="Symbol">}</a> <a id="2100" class="Symbol">→</a> <a id="2102" href="Algebra.Solver.Monoid.html#1355" class="Datatype">Expr</a> <a id="2107" href="Algebra.Solver.Monoid.html#2097" class="Bound">n</a> <a id="2109" class="Symbol">→</a> <a id="2111" href="Algebra.Solver.Monoid.html#1886" class="Function">Normal</a> <a id="2118" href="Algebra.Solver.Monoid.html#2097" class="Bound">n</a>
<a id="2120" href="Algebra.Solver.Monoid.html#2082" class="Function">normalise</a> <a id="2130" class="Symbol">(</a><a id="2131" href="Algebra.Solver.Monoid.html#1382" class="InductiveConstructor">var</a> <a id="2135" href="Algebra.Solver.Monoid.html#2135" class="Bound">x</a><a id="2136" class="Symbol">)</a>   <a id="2140" class="Symbol">=</a> <a id="2142" href="Algebra.Solver.Monoid.html#2135" class="Bound">x</a> <a id="2144" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="2146" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>
<a id="2149" href="Algebra.Solver.Monoid.html#2082" class="Function">normalise</a> <a id="2159" href="Algebra.Solver.Monoid.html#1405" class="InductiveConstructor">id</a>        <a id="2169" class="Symbol">=</a> <a id="2171" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>
<a id="2174" href="Algebra.Solver.Monoid.html#2082" class="Function">normalise</a> <a id="2184" class="Symbol">(</a><a id="2185" href="Algebra.Solver.Monoid.html#2185" class="Bound">e₁</a> <a id="2188" href="Algebra.Solver.Monoid.html#1420" class="InductiveConstructor Operator">⊕</a> <a id="2190" href="Algebra.Solver.Monoid.html#2190" class="Bound">e₂</a><a id="2192" class="Symbol">)</a> <a id="2194" class="Symbol">=</a> <a id="2196" href="Algebra.Solver.Monoid.html#2082" class="Function">normalise</a> <a id="2206" href="Algebra.Solver.Monoid.html#2185" class="Bound">e₁</a> <a id="2209" href="Data.List.Base.html#1734" class="Function Operator">++</a> <a id="2212" href="Algebra.Solver.Monoid.html#2082" class="Function">normalise</a> <a id="2222" href="Algebra.Solver.Monoid.html#2190" class="Bound">e₂</a>

<a id="2226" class="Comment">-- The normaliser is homomorphic with respect to _++_/_∙_.</a>

<a id="homomorphic"></a><a id="2286" href="Algebra.Solver.Monoid.html#2286" class="Function">homomorphic</a> <a id="2298" class="Symbol">:</a> <a id="2300" class="Symbol">∀</a> <a id="2302" class="Symbol">{</a><a id="2303" href="Algebra.Solver.Monoid.html#2303" class="Bound">n</a><a id="2304" class="Symbol">}</a> <a id="2306" class="Symbol">(</a><a id="2307" href="Algebra.Solver.Monoid.html#2307" class="Bound">nf₁</a> <a id="2311" href="Algebra.Solver.Monoid.html#2311" class="Bound">nf₂</a> <a id="2315" class="Symbol">:</a> <a id="2317" href="Algebra.Solver.Monoid.html#1886" class="Function">Normal</a> <a id="2324" href="Algebra.Solver.Monoid.html#2303" class="Bound">n</a><a id="2325" class="Symbol">)</a> <a id="2327" class="Symbol">(</a><a id="2328" href="Algebra.Solver.Monoid.html#2328" class="Bound">ρ</a> <a id="2330" class="Symbol">:</a> <a id="2332" href="Algebra.Solver.Monoid.html#1510" class="Function">Env</a> <a id="2336" href="Algebra.Solver.Monoid.html#2303" class="Bound">n</a><a id="2337" class="Symbol">)</a> <a id="2339" class="Symbol">→</a>
              <a id="2355" href="Algebra.Solver.Monoid.html#1964" class="Function Operator">⟦</a> <a id="2357" href="Algebra.Solver.Monoid.html#2307" class="Bound">nf₁</a> <a id="2361" href="Data.List.Base.html#1734" class="Function Operator">++</a> <a id="2364" href="Algebra.Solver.Monoid.html#2311" class="Bound">nf₂</a> <a id="2368" href="Algebra.Solver.Monoid.html#1964" class="Function Operator">⟧⇓</a> <a id="2371" href="Algebra.Solver.Monoid.html#2328" class="Bound">ρ</a> <a id="2373" href="Algebra.Bundles.html#7415" class="Field Operator">≈</a> <a id="2375" class="Symbol">(</a><a id="2376" href="Algebra.Solver.Monoid.html#1964" class="Function Operator">⟦</a> <a id="2378" href="Algebra.Solver.Monoid.html#2307" class="Bound">nf₁</a> <a id="2382" href="Algebra.Solver.Monoid.html#1964" class="Function Operator">⟧⇓</a> <a id="2385" href="Algebra.Solver.Monoid.html#2328" class="Bound">ρ</a> <a id="2387" href="Algebra.Bundles.html#7444" class="Field Operator">∙</a> <a id="2389" href="Algebra.Solver.Monoid.html#1964" class="Function Operator">⟦</a> <a id="2391" href="Algebra.Solver.Monoid.html#2311" class="Bound">nf₂</a> <a id="2395" href="Algebra.Solver.Monoid.html#1964" class="Function Operator">⟧⇓</a> <a id="2398" href="Algebra.Solver.Monoid.html#2328" class="Bound">ρ</a><a id="2399" class="Symbol">)</a>
<a id="2401" href="Algebra.Solver.Monoid.html#2286" class="Function">homomorphic</a> <a id="2413" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="2416" href="Algebra.Solver.Monoid.html#2416" class="Bound">nf₂</a> <a id="2420" href="Algebra.Solver.Monoid.html#2420" class="Bound">ρ</a> <a id="2422" class="Symbol">=</a> <a id="2424" href="Relation.Binary.Reasoning.Syntax.html#1572" class="Function Operator">begin</a>
  <a id="2432" href="Algebra.Solver.Monoid.html#1964" class="Function Operator">⟦</a> <a id="2434" href="Algebra.Solver.Monoid.html#2416" class="Bound">nf₂</a> <a id="2438" href="Algebra.Solver.Monoid.html#1964" class="Function Operator">⟧⇓</a> <a id="2441" href="Algebra.Solver.Monoid.html#2420" class="Bound">ρ</a>      <a id="2448" href="Relation.Binary.Reasoning.Syntax.html#7111" class="Function">≈⟨</a> <a id="2451" href="Relation.Binary.Structures.html#1622" class="Function">sym</a> <a id="2455" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="2457" href="Algebra.Structures.html#4987" class="Function">identityˡ</a> <a id="2467" class="Symbol">_</a> <a id="2469" href="Relation.Binary.Reasoning.Syntax.html#7111" class="Function">⟩</a>
  <a id="2473" href="Algebra.Bundles.html#7471" class="Field">ε</a> <a id="2475" href="Algebra.Bundles.html#7444" class="Field Operator">∙</a> <a id="2477" href="Algebra.Solver.Monoid.html#1964" class="Function Operator">⟦</a> <a id="2479" href="Algebra.Solver.Monoid.html#2416" class="Bound">nf₂</a> <a id="2483" href="Algebra.Solver.Monoid.html#1964" class="Function Operator">⟧⇓</a> <a id="2486" href="Algebra.Solver.Monoid.html#2420" class="Bound">ρ</a>  <a id="2489" href="Relation.Binary.Reasoning.Syntax.html#12345" class="Function Operator">∎</a>
<a id="2491" href="Algebra.Solver.Monoid.html#2286" class="Function">homomorphic</a> <a id="2503" class="Symbol">(</a><a id="2504" href="Algebra.Solver.Monoid.html#2504" class="Bound">x</a> <a id="2506" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="2508" href="Algebra.Solver.Monoid.html#2508" class="Bound">nf₁</a><a id="2511" class="Symbol">)</a> <a id="2513" href="Algebra.Solver.Monoid.html#2513" class="Bound">nf₂</a> <a id="2517" href="Algebra.Solver.Monoid.html#2517" class="Bound">ρ</a> <a id="2519" class="Symbol">=</a> <a id="2521" href="Relation.Binary.Reasoning.Syntax.html#1572" class="Function Operator">begin</a>
  <a id="2529" href="Data.Vec.Base.html#1676" class="Function">lookup</a> <a id="2536" href="Algebra.Solver.Monoid.html#2517" class="Bound">ρ</a> <a id="2538" href="Algebra.Solver.Monoid.html#2504" class="Bound">x</a> <a id="2540" href="Algebra.Bundles.html#7444" class="Field Operator">∙</a> <a id="2542" href="Algebra.Solver.Monoid.html#1964" class="Function Operator">⟦</a> <a id="2544" href="Algebra.Solver.Monoid.html#2508" class="Bound">nf₁</a> <a id="2548" href="Data.List.Base.html#1734" class="Function Operator">++</a> <a id="2551" href="Algebra.Solver.Monoid.html#2513" class="Bound">nf₂</a> <a id="2555" href="Algebra.Solver.Monoid.html#1964" class="Function Operator">⟧⇓</a> <a id="2558" href="Algebra.Solver.Monoid.html#2517" class="Bound">ρ</a>          <a id="2569" href="Relation.Binary.Reasoning.Syntax.html#7111" class="Function">≈⟨</a> <a id="2572" href="Algebra.Structures.html#1948" class="Function">∙-congˡ</a> <a id="2580" class="Symbol">(</a><a id="2581" href="Algebra.Solver.Monoid.html#2286" class="Function">homomorphic</a> <a id="2593" href="Algebra.Solver.Monoid.html#2508" class="Bound">nf₁</a> <a id="2597" href="Algebra.Solver.Monoid.html#2513" class="Bound">nf₂</a> <a id="2601" href="Algebra.Solver.Monoid.html#2517" class="Bound">ρ</a><a id="2602" class="Symbol">)</a> <a id="2604" href="Relation.Binary.Reasoning.Syntax.html#7111" class="Function">⟩</a>
  <a id="2608" href="Data.Vec.Base.html#1676" class="Function">lookup</a> <a id="2615" href="Algebra.Solver.Monoid.html#2517" class="Bound">ρ</a> <a id="2617" href="Algebra.Solver.Monoid.html#2504" class="Bound">x</a> <a id="2619" href="Algebra.Bundles.html#7444" class="Field Operator">∙</a> <a id="2621" class="Symbol">(</a><a id="2622" href="Algebra.Solver.Monoid.html#1964" class="Function Operator">⟦</a> <a id="2624" href="Algebra.Solver.Monoid.html#2508" class="Bound">nf₁</a> <a id="2628" href="Algebra.Solver.Monoid.html#1964" class="Function Operator">⟧⇓</a> <a id="2631" href="Algebra.Solver.Monoid.html#2517" class="Bound">ρ</a> <a id="2633" href="Algebra.Bundles.html#7444" class="Field Operator">∙</a> <a id="2635" href="Algebra.Solver.Monoid.html#1964" class="Function Operator">⟦</a> <a id="2637" href="Algebra.Solver.Monoid.html#2513" class="Bound">nf₂</a> <a id="2641" href="Algebra.Solver.Monoid.html#1964" class="Function Operator">⟧⇓</a> <a id="2644" href="Algebra.Solver.Monoid.html#2517" class="Bound">ρ</a><a id="2645" class="Symbol">)</a>  <a id="2648" href="Relation.Binary.Reasoning.Syntax.html#7111" class="Function">≈⟨</a> <a id="2651" href="Relation.Binary.Structures.html#1622" class="Function">sym</a> <a id="2655" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="2657" href="Algebra.Structures.html#3460" class="Function">assoc</a> <a id="2663" class="Symbol">_</a> <a id="2665" class="Symbol">_</a> <a id="2667" class="Symbol">_</a> <a id="2669" href="Relation.Binary.Reasoning.Syntax.html#7111" class="Function">⟩</a>
  <a id="2673" href="Data.Vec.Base.html#1676" class="Function">lookup</a> <a id="2680" href="Algebra.Solver.Monoid.html#2517" class="Bound">ρ</a> <a id="2682" href="Algebra.Solver.Monoid.html#2504" class="Bound">x</a> <a id="2684" href="Algebra.Bundles.html#7444" class="Field Operator">∙</a> <a id="2686" href="Algebra.Solver.Monoid.html#1964" class="Function Operator">⟦</a> <a id="2688" href="Algebra.Solver.Monoid.html#2508" class="Bound">nf₁</a> <a id="2692" href="Algebra.Solver.Monoid.html#1964" class="Function Operator">⟧⇓</a> <a id="2695" href="Algebra.Solver.Monoid.html#2517" class="Bound">ρ</a> <a id="2697" href="Algebra.Bundles.html#7444" class="Field Operator">∙</a> <a id="2699" href="Algebra.Solver.Monoid.html#1964" class="Function Operator">⟦</a> <a id="2701" href="Algebra.Solver.Monoid.html#2513" class="Bound">nf₂</a> <a id="2705" href="Algebra.Solver.Monoid.html#1964" class="Function Operator">⟧⇓</a> <a id="2708" href="Algebra.Solver.Monoid.html#2517" class="Bound">ρ</a>    <a id="2713" href="Relation.Binary.Reasoning.Syntax.html#12345" class="Function Operator">∎</a>

<a id="2716" class="Comment">-- The normaliser preserves the semantics of the expression.</a>

<a id="normalise-correct"></a><a id="2778" href="Algebra.Solver.Monoid.html#2778" class="Function">normalise-correct</a> <a id="2796" class="Symbol">:</a>
  <a id="2800" class="Symbol">∀</a> <a id="2802" class="Symbol">{</a><a id="2803" href="Algebra.Solver.Monoid.html#2803" class="Bound">n</a><a id="2804" class="Symbol">}</a> <a id="2806" class="Symbol">(</a><a id="2807" href="Algebra.Solver.Monoid.html#2807" class="Bound">e</a> <a id="2809" class="Symbol">:</a> <a id="2811" href="Algebra.Solver.Monoid.html#1355" class="Datatype">Expr</a> <a id="2816" href="Algebra.Solver.Monoid.html#2803" class="Bound">n</a><a id="2817" class="Symbol">)</a> <a id="2819" class="Symbol">(</a><a id="2820" href="Algebra.Solver.Monoid.html#2820" class="Bound">ρ</a> <a id="2822" class="Symbol">:</a> <a id="2824" href="Algebra.Solver.Monoid.html#1510" class="Function">Env</a> <a id="2828" href="Algebra.Solver.Monoid.html#2803" class="Bound">n</a><a id="2829" class="Symbol">)</a> <a id="2831" class="Symbol">→</a> <a id="2833" href="Algebra.Solver.Monoid.html#1964" class="Function Operator">⟦</a> <a id="2835" href="Algebra.Solver.Monoid.html#2082" class="Function">normalise</a> <a id="2845" href="Algebra.Solver.Monoid.html#2807" class="Bound">e</a> <a id="2847" href="Algebra.Solver.Monoid.html#1964" class="Function Operator">⟧⇓</a> <a id="2850" href="Algebra.Solver.Monoid.html#2820" class="Bound">ρ</a> <a id="2852" href="Algebra.Bundles.html#7415" class="Field Operator">≈</a> <a id="2854" href="Algebra.Solver.Monoid.html#1633" class="Function Operator">⟦</a> <a id="2856" href="Algebra.Solver.Monoid.html#2807" class="Bound">e</a> <a id="2858" href="Algebra.Solver.Monoid.html#1633" class="Function Operator">⟧</a> <a id="2860" href="Algebra.Solver.Monoid.html#2820" class="Bound">ρ</a>
<a id="2862" href="Algebra.Solver.Monoid.html#2778" class="Function">normalise-correct</a> <a id="2880" class="Symbol">(</a><a id="2881" href="Algebra.Solver.Monoid.html#1382" class="InductiveConstructor">var</a> <a id="2885" href="Algebra.Solver.Monoid.html#2885" class="Bound">x</a><a id="2886" class="Symbol">)</a> <a id="2888" href="Algebra.Solver.Monoid.html#2888" class="Bound">ρ</a> <a id="2890" class="Symbol">=</a> <a id="2892" href="Relation.Binary.Reasoning.Syntax.html#1572" class="Function Operator">begin</a>
  <a id="2900" href="Data.Vec.Base.html#1676" class="Function">lookup</a> <a id="2907" href="Algebra.Solver.Monoid.html#2888" class="Bound">ρ</a> <a id="2909" href="Algebra.Solver.Monoid.html#2885" class="Bound">x</a> <a id="2911" href="Algebra.Bundles.html#7444" class="Field Operator">∙</a> <a id="2913" href="Algebra.Bundles.html#7471" class="Field">ε</a>  <a id="2916" href="Relation.Binary.Reasoning.Syntax.html#7111" class="Function">≈⟨</a> <a id="2919" href="Algebra.Structures.html#5048" class="Function">identityʳ</a> <a id="2929" class="Symbol">_</a> <a id="2931" href="Relation.Binary.Reasoning.Syntax.html#7111" class="Function">⟩</a>
  <a id="2935" href="Data.Vec.Base.html#1676" class="Function">lookup</a> <a id="2942" href="Algebra.Solver.Monoid.html#2888" class="Bound">ρ</a> <a id="2944" href="Algebra.Solver.Monoid.html#2885" class="Bound">x</a>      <a id="2951" href="Relation.Binary.Reasoning.Syntax.html#12345" class="Function Operator">∎</a>
<a id="2953" href="Algebra.Solver.Monoid.html#2778" class="Function">normalise-correct</a> <a id="2971" href="Algebra.Solver.Monoid.html#1405" class="InductiveConstructor">id</a> <a id="2974" href="Algebra.Solver.Monoid.html#2974" class="Bound">ρ</a> <a id="2976" class="Symbol">=</a> <a id="2978" href="Relation.Binary.Reasoning.Syntax.html#1572" class="Function Operator">begin</a>
  <a id="2986" href="Algebra.Bundles.html#7471" class="Field">ε</a>  <a id="2989" href="Relation.Binary.Reasoning.Syntax.html#12345" class="Function Operator">∎</a>
<a id="2991" href="Algebra.Solver.Monoid.html#2778" class="Function">normalise-correct</a> <a id="3009" class="Symbol">(</a><a id="3010" href="Algebra.Solver.Monoid.html#3010" class="Bound">e₁</a> <a id="3013" href="Algebra.Solver.Monoid.html#1420" class="InductiveConstructor Operator">⊕</a> <a id="3015" href="Algebra.Solver.Monoid.html#3015" class="Bound">e₂</a><a id="3017" class="Symbol">)</a> <a id="3019" href="Algebra.Solver.Monoid.html#3019" class="Bound">ρ</a> <a id="3021" class="Symbol">=</a> <a id="3023" href="Relation.Binary.Reasoning.Syntax.html#1572" class="Function Operator">begin</a>
  <a id="3031" href="Algebra.Solver.Monoid.html#1964" class="Function Operator">⟦</a> <a id="3033" href="Algebra.Solver.Monoid.html#2082" class="Function">normalise</a> <a id="3043" href="Algebra.Solver.Monoid.html#3010" class="Bound">e₁</a> <a id="3046" href="Data.List.Base.html#1734" class="Function Operator">++</a> <a id="3049" href="Algebra.Solver.Monoid.html#2082" class="Function">normalise</a> <a id="3059" href="Algebra.Solver.Monoid.html#3015" class="Bound">e₂</a> <a id="3062" href="Algebra.Solver.Monoid.html#1964" class="Function Operator">⟧⇓</a> <a id="3065" href="Algebra.Solver.Monoid.html#3019" class="Bound">ρ</a>        <a id="3074" href="Relation.Binary.Reasoning.Syntax.html#7111" class="Function">≈⟨</a> <a id="3077" href="Algebra.Solver.Monoid.html#2286" class="Function">homomorphic</a> <a id="3089" class="Symbol">(</a><a id="3090" href="Algebra.Solver.Monoid.html#2082" class="Function">normalise</a> <a id="3100" href="Algebra.Solver.Monoid.html#3010" class="Bound">e₁</a><a id="3102" class="Symbol">)</a> <a id="3104" class="Symbol">(</a><a id="3105" href="Algebra.Solver.Monoid.html#2082" class="Function">normalise</a> <a id="3115" href="Algebra.Solver.Monoid.html#3015" class="Bound">e₂</a><a id="3117" class="Symbol">)</a> <a id="3119" href="Algebra.Solver.Monoid.html#3019" class="Bound">ρ</a> <a id="3121" href="Relation.Binary.Reasoning.Syntax.html#7111" class="Function">⟩</a>
  <a id="3125" href="Algebra.Solver.Monoid.html#1964" class="Function Operator">⟦</a> <a id="3127" href="Algebra.Solver.Monoid.html#2082" class="Function">normalise</a> <a id="3137" href="Algebra.Solver.Monoid.html#3010" class="Bound">e₁</a> <a id="3140" href="Algebra.Solver.Monoid.html#1964" class="Function Operator">⟧⇓</a> <a id="3143" href="Algebra.Solver.Monoid.html#3019" class="Bound">ρ</a> <a id="3145" href="Algebra.Bundles.html#7444" class="Field Operator">∙</a> <a id="3147" href="Algebra.Solver.Monoid.html#1964" class="Function Operator">⟦</a> <a id="3149" href="Algebra.Solver.Monoid.html#2082" class="Function">normalise</a> <a id="3159" href="Algebra.Solver.Monoid.html#3015" class="Bound">e₂</a> <a id="3162" href="Algebra.Solver.Monoid.html#1964" class="Function Operator">⟧⇓</a> <a id="3165" href="Algebra.Solver.Monoid.html#3019" class="Bound">ρ</a>  <a id="3168" href="Relation.Binary.Reasoning.Syntax.html#7111" class="Function">≈⟨</a> <a id="3171" href="Algebra.Structures.html#1798" class="Function">∙-cong</a> <a id="3178" class="Symbol">(</a><a id="3179" href="Algebra.Solver.Monoid.html#2778" class="Function">normalise-correct</a> <a id="3197" href="Algebra.Solver.Monoid.html#3010" class="Bound">e₁</a> <a id="3200" href="Algebra.Solver.Monoid.html#3019" class="Bound">ρ</a><a id="3201" class="Symbol">)</a> <a id="3203" class="Symbol">(</a><a id="3204" href="Algebra.Solver.Monoid.html#2778" class="Function">normalise-correct</a> <a id="3222" href="Algebra.Solver.Monoid.html#3015" class="Bound">e₂</a> <a id="3225" href="Algebra.Solver.Monoid.html#3019" class="Bound">ρ</a><a id="3226" class="Symbol">)</a> <a id="3228" href="Relation.Binary.Reasoning.Syntax.html#7111" class="Function">⟩</a>
  <a id="3232" href="Algebra.Solver.Monoid.html#1633" class="Function Operator">⟦</a> <a id="3234" href="Algebra.Solver.Monoid.html#3010" class="Bound">e₁</a> <a id="3237" href="Algebra.Solver.Monoid.html#1633" class="Function Operator">⟧</a> <a id="3239" href="Algebra.Solver.Monoid.html#3019" class="Bound">ρ</a> <a id="3241" href="Algebra.Bundles.html#7444" class="Field Operator">∙</a> <a id="3243" href="Algebra.Solver.Monoid.html#1633" class="Function Operator">⟦</a> <a id="3245" href="Algebra.Solver.Monoid.html#3015" class="Bound">e₂</a> <a id="3248" href="Algebra.Solver.Monoid.html#1633" class="Function Operator">⟧</a> <a id="3250" href="Algebra.Solver.Monoid.html#3019" class="Bound">ρ</a>                        <a id="3275" href="Relation.Binary.Reasoning.Syntax.html#12345" class="Function Operator">∎</a>

<a id="3278" class="Comment">------------------------------------------------------------------------</a>
<a id="3351" class="Comment">-- &quot;Tactic.</a>

<a id="3364" class="Keyword">open</a> <a id="3369" class="Keyword">module</a> <a id="R"></a><a id="3376" href="Algebra.Solver.Monoid.html#3376" class="Module">R</a> <a id="3378" class="Symbol">=</a> <a id="3380" href="Relation.Binary.Reflection.html" class="Module">Relation.Binary.Reflection</a>
                  <a id="3425" href="Algebra.Structures.html#1873" class="Function">setoid</a> <a id="3432" href="Algebra.Solver.Monoid.html#1382" class="InductiveConstructor">var</a> <a id="3436" href="Algebra.Solver.Monoid.html#1633" class="Function Operator">⟦_⟧</a> <a id="3440" class="Symbol">(</a><a id="3441" href="Algebra.Solver.Monoid.html#1964" class="Function Operator">⟦_⟧⇓</a> <a id="3446" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="3448" href="Algebra.Solver.Monoid.html#2082" class="Function">normalise</a><a id="3457" class="Symbol">)</a> <a id="3459" href="Algebra.Solver.Monoid.html#2778" class="Function">normalise-correct</a>
  <a id="3479" class="Keyword">public</a> <a id="3486" class="Keyword">using</a> <a id="3492" class="Symbol">(</a><a id="3493" href="Relation.Binary.Reflection.html#2560" class="Function">solve</a><a id="3498" class="Symbol">;</a> <a id="3500" href="Relation.Binary.Reflection.html#3665" class="Function Operator">_⊜_</a><a id="3503" class="Symbol">)</a>

<a id="3506" class="Comment">-- We can decide if two normal forms are /syntactically/ equal.</a>

<a id="3571" class="Keyword">infix</a> <a id="3577" class="Number">5</a> <a id="3579" href="Algebra.Solver.Monoid.html#3584" class="Function Operator">_≟_</a>

<a id="_≟_"></a><a id="3584" href="Algebra.Solver.Monoid.html#3584" class="Function Operator">_≟_</a> <a id="3588" class="Symbol">:</a> <a id="3590" class="Symbol">∀</a> <a id="3592" class="Symbol">{</a><a id="3593" href="Algebra.Solver.Monoid.html#3593" class="Bound">n</a><a id="3594" class="Symbol">}</a> <a id="3596" class="Symbol">→</a> <a id="3598" href="Relation.Binary.Definitions.html#6834" class="Function">DecidableEquality</a> <a id="3616" class="Symbol">(</a><a id="3617" href="Algebra.Solver.Monoid.html#1886" class="Function">Normal</a> <a id="3624" href="Algebra.Solver.Monoid.html#3593" class="Bound">n</a><a id="3625" class="Symbol">)</a>
<a id="3627" href="Algebra.Solver.Monoid.html#3627" class="Bound">nf₁</a> <a id="3631" href="Algebra.Solver.Monoid.html#3584" class="Function Operator">≟</a> <a id="3633" href="Algebra.Solver.Monoid.html#3633" class="Bound">nf₂</a> <a id="3637" class="Symbol">=</a> <a id="3639" href="Relation.Nullary.Decidable.Core.html#5914" class="Function">Dec.map′</a> <a id="3648" href="Data.List.Relation.Binary.Equality.Propositional.html#1047" class="Function">≋⇒≡</a> <a id="3652" href="Data.List.Relation.Binary.Equality.Propositional.html#1135" class="Function">≡⇒≋</a> <a id="3656" class="Symbol">(</a><a id="3657" href="Algebra.Solver.Monoid.html#3627" class="Bound">nf₁</a> <a id="3661" href="Data.List.Relation.Binary.Equality.DecSetoid.html#1047" class="Function Operator">≋?</a> <a id="3664" href="Algebra.Solver.Monoid.html#3633" class="Bound">nf₂</a><a id="3667" class="Symbol">)</a>
  <a id="3671" class="Keyword">where</a> <a id="3677" class="Keyword">open</a> <a id="3682" href="Data.List.Relation.Binary.Equality.DecPropositional.html" class="Module">ListEq</a> <a id="3689" href="Data.Fin.Properties.html#3736" class="Function Operator">Fin._≟_</a>

<a id="3698" class="Comment">-- We can also give a sound, but not necessarily complete, procedure</a>
<a id="3767" class="Comment">-- for determining if two expressions have the same semantics.</a>

<a id="prove′"></a><a id="3831" href="Algebra.Solver.Monoid.html#3831" class="Function">prove′</a> <a id="3838" class="Symbol">:</a> <a id="3840" class="Symbol">∀</a> <a id="3842" class="Symbol">{</a><a id="3843" href="Algebra.Solver.Monoid.html#3843" class="Bound">n</a><a id="3844" class="Symbol">}</a> <a id="3846" class="Symbol">(</a><a id="3847" href="Algebra.Solver.Monoid.html#3847" class="Bound">e₁</a> <a id="3850" href="Algebra.Solver.Monoid.html#3850" class="Bound">e₂</a> <a id="3853" class="Symbol">:</a> <a id="3855" href="Algebra.Solver.Monoid.html#1355" class="Datatype">Expr</a> <a id="3860" href="Algebra.Solver.Monoid.html#3843" class="Bound">n</a><a id="3861" class="Symbol">)</a> <a id="3863" class="Symbol">→</a> <a id="3865" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="3871" class="Symbol">(∀</a> <a id="3874" href="Algebra.Solver.Monoid.html#3874" class="Bound">ρ</a> <a id="3876" class="Symbol">→</a> <a id="3878" href="Algebra.Solver.Monoid.html#1633" class="Function Operator">⟦</a> <a id="3880" href="Algebra.Solver.Monoid.html#3847" class="Bound">e₁</a> <a id="3883" href="Algebra.Solver.Monoid.html#1633" class="Function Operator">⟧</a> <a id="3885" href="Algebra.Solver.Monoid.html#3874" class="Bound">ρ</a> <a id="3887" href="Algebra.Bundles.html#7415" class="Field Operator">≈</a> <a id="3889" href="Algebra.Solver.Monoid.html#1633" class="Function Operator">⟦</a> <a id="3891" href="Algebra.Solver.Monoid.html#3850" class="Bound">e₂</a> <a id="3894" href="Algebra.Solver.Monoid.html#1633" class="Function Operator">⟧</a> <a id="3896" href="Algebra.Solver.Monoid.html#3874" class="Bound">ρ</a><a id="3897" class="Symbol">)</a>
<a id="3899" href="Algebra.Solver.Monoid.html#3831" class="Function">prove′</a> <a id="3906" href="Algebra.Solver.Monoid.html#3906" class="Bound">e₁</a> <a id="3909" href="Algebra.Solver.Monoid.html#3909" class="Bound">e₂</a> <a id="3912" class="Symbol">=</a>
  <a id="3916" href="Data.Maybe.Base.html#1934" class="Function">Maybe.map</a> <a id="3926" href="Algebra.Solver.Monoid.html#3992" class="Function">lemma</a> <a id="3932" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="3934" href="Relation.Binary.Consequences.html#6909" class="Function">dec⇒weaklyDec</a> <a id="3948" href="Algebra.Solver.Monoid.html#3584" class="Function Operator">_≟_</a> <a id="3952" class="Symbol">(</a><a id="3953" href="Algebra.Solver.Monoid.html#2082" class="Function">normalise</a> <a id="3963" href="Algebra.Solver.Monoid.html#3906" class="Bound">e₁</a><a id="3965" class="Symbol">)</a> <a id="3967" class="Symbol">(</a><a id="3968" href="Algebra.Solver.Monoid.html#2082" class="Function">normalise</a> <a id="3978" href="Algebra.Solver.Monoid.html#3909" class="Bound">e₂</a><a id="3980" class="Symbol">)</a>
  <a id="3984" class="Keyword">where</a>
  <a id="3992" href="Algebra.Solver.Monoid.html#3992" class="Function">lemma</a> <a id="3998" class="Symbol">:</a> <a id="4000" href="Algebra.Solver.Monoid.html#2082" class="Function">normalise</a> <a id="4010" href="Algebra.Solver.Monoid.html#3906" class="Bound">e₁</a> <a id="4013" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="4015" href="Algebra.Solver.Monoid.html#2082" class="Function">normalise</a> <a id="4025" href="Algebra.Solver.Monoid.html#3909" class="Bound">e₂</a> <a id="4028" class="Symbol">→</a> <a id="4030" class="Symbol">∀</a> <a id="4032" href="Algebra.Solver.Monoid.html#4032" class="Bound">ρ</a> <a id="4034" class="Symbol">→</a> <a id="4036" href="Algebra.Solver.Monoid.html#1633" class="Function Operator">⟦</a> <a id="4038" href="Algebra.Solver.Monoid.html#3906" class="Bound">e₁</a> <a id="4041" href="Algebra.Solver.Monoid.html#1633" class="Function Operator">⟧</a> <a id="4043" href="Algebra.Solver.Monoid.html#4032" class="Bound">ρ</a> <a id="4045" href="Algebra.Bundles.html#7415" class="Field Operator">≈</a> <a id="4047" href="Algebra.Solver.Monoid.html#1633" class="Function Operator">⟦</a> <a id="4049" href="Algebra.Solver.Monoid.html#3909" class="Bound">e₂</a> <a id="4052" href="Algebra.Solver.Monoid.html#1633" class="Function Operator">⟧</a> <a id="4054" href="Algebra.Solver.Monoid.html#4032" class="Bound">ρ</a>
  <a id="4058" href="Algebra.Solver.Monoid.html#3992" class="Function">lemma</a> <a id="4064" href="Algebra.Solver.Monoid.html#4064" class="Bound">eq</a> <a id="4067" href="Algebra.Solver.Monoid.html#4067" class="Bound">ρ</a> <a id="4069" class="Symbol">=</a>
    <a id="4075" href="Relation.Binary.Reflection.html#1874" class="Function">R.prove</a> <a id="4083" href="Algebra.Solver.Monoid.html#4067" class="Bound">ρ</a> <a id="4085" href="Algebra.Solver.Monoid.html#3906" class="Bound">e₁</a> <a id="4088" href="Algebra.Solver.Monoid.html#3909" class="Bound">e₂</a> <a id="4091" class="Symbol">(</a><a id="4092" href="Relation.Binary.Reasoning.Syntax.html#1572" class="Function Operator">begin</a>
      <a id="4104" href="Algebra.Solver.Monoid.html#1964" class="Function Operator">⟦</a> <a id="4106" href="Algebra.Solver.Monoid.html#2082" class="Function">normalise</a> <a id="4116" href="Algebra.Solver.Monoid.html#3906" class="Bound">e₁</a> <a id="4119" href="Algebra.Solver.Monoid.html#1964" class="Function Operator">⟧⇓</a> <a id="4122" href="Algebra.Solver.Monoid.html#4067" class="Bound">ρ</a>  <a id="4125" href="Relation.Binary.Reasoning.Syntax.html#11048" class="Function">≡⟨</a> <a id="4128" href="Relation.Binary.PropositionalEquality.Core.html#1339" class="Function">cong</a> <a id="4133" class="Symbol">(λ</a> <a id="4136" href="Algebra.Solver.Monoid.html#4136" class="Bound">e</a> <a id="4138" class="Symbol">→</a> <a id="4140" href="Algebra.Solver.Monoid.html#1964" class="Function Operator">⟦</a> <a id="4142" href="Algebra.Solver.Monoid.html#4136" class="Bound">e</a> <a id="4144" href="Algebra.Solver.Monoid.html#1964" class="Function Operator">⟧⇓</a> <a id="4147" href="Algebra.Solver.Monoid.html#4067" class="Bound">ρ</a><a id="4148" class="Symbol">)</a> <a id="4150" href="Algebra.Solver.Monoid.html#4064" class="Bound">eq</a> <a id="4153" href="Relation.Binary.Reasoning.Syntax.html#11048" class="Function">⟩</a>
      <a id="4161" href="Algebra.Solver.Monoid.html#1964" class="Function Operator">⟦</a> <a id="4163" href="Algebra.Solver.Monoid.html#2082" class="Function">normalise</a> <a id="4173" href="Algebra.Solver.Monoid.html#3909" class="Bound">e₂</a> <a id="4176" href="Algebra.Solver.Monoid.html#1964" class="Function Operator">⟧⇓</a> <a id="4179" href="Algebra.Solver.Monoid.html#4067" class="Bound">ρ</a>  <a id="4182" href="Relation.Binary.Reasoning.Syntax.html#12345" class="Function Operator">∎</a><a id="4183" class="Symbol">)</a>

<a id="4186" class="Comment">-- This procedure can be combined with from-just.</a>

<a id="prove"></a><a id="4237" href="Algebra.Solver.Monoid.html#4237" class="Function">prove</a> <a id="4243" class="Symbol">:</a> <a id="4245" class="Symbol">∀</a> <a id="4247" href="Algebra.Solver.Monoid.html#4247" class="Bound">n</a> <a id="4249" class="Symbol">(</a><a id="4250" href="Algebra.Solver.Monoid.html#4250" class="Bound">es</a> <a id="4253" class="Symbol">:</a> <a id="4255" href="Algebra.Solver.Monoid.html#1355" class="Datatype">Expr</a> <a id="4260" href="Algebra.Solver.Monoid.html#4247" class="Bound">n</a> <a id="4262" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="4264" href="Algebra.Solver.Monoid.html#1355" class="Datatype">Expr</a> <a id="4269" href="Algebra.Solver.Monoid.html#4247" class="Bound">n</a><a id="4270" class="Symbol">)</a> <a id="4272" class="Symbol">→</a>
        <a id="4282" href="Data.Maybe.Base.html#1732" class="Function">From-just</a> <a id="4292" class="Symbol">(</a><a id="4293" href="Data.Product.Base.html#3109" class="Function">uncurry</a> <a id="4301" href="Algebra.Solver.Monoid.html#3831" class="Function">prove′</a> <a id="4308" href="Algebra.Solver.Monoid.html#4250" class="Bound">es</a><a id="4310" class="Symbol">)</a>
<a id="4312" href="Algebra.Solver.Monoid.html#4237" class="Function">prove</a> <a id="4318" class="Symbol">_</a> <a id="4320" class="Symbol">=</a> <a id="4322" href="Data.Maybe.Base.html#1820" class="Function">from-just</a> <a id="4332" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="4334" href="Data.Product.Base.html#3109" class="Function">uncurry</a> <a id="4342" href="Algebra.Solver.Monoid.html#3831" class="Function">prove′</a>
</pre></body></html>