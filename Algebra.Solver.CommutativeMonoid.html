<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Algebra.Solver.CommutativeMonoid</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- The Agda standard library</a>
<a id="103" class="Comment">--</a>
<a id="106" class="Comment">-- Solver for equations in commutative monoids</a>
<a id="153" class="Comment">--</a>
<a id="156" class="Comment">-- Adapted from Algebra.Solver.Monoid</a>
<a id="194" class="Comment">------------------------------------------------------------------------</a>

<a id="268" class="Symbol">{-#</a> <a id="272" class="Keyword">OPTIONS</a> <a id="280" class="Pragma">--without-K</a> <a id="292" class="Pragma">--safe</a> <a id="299" class="Symbol">#-}</a>

<a id="304" class="Keyword">open</a> <a id="309" class="Keyword">import</a> <a id="316" href="Algebra.html" class="Module">Algebra</a>

<a id="325" class="Keyword">module</a> <a id="332" href="Algebra.Solver.CommutativeMonoid.html" class="Module">Algebra.Solver.CommutativeMonoid</a> <a id="365" class="Symbol">{</a><a id="366" href="Algebra.Solver.CommutativeMonoid.html#366" class="Bound">m₁</a> <a id="369" href="Algebra.Solver.CommutativeMonoid.html#369" class="Bound">m₂</a><a id="371" class="Symbol">}</a> <a id="373" class="Symbol">(</a><a id="374" href="Algebra.Solver.CommutativeMonoid.html#374" class="Bound">M</a> <a id="376" class="Symbol">:</a> <a id="378" href="Algebra.Bundles.html#6578" class="Record">CommutativeMonoid</a> <a id="396" href="Algebra.Solver.CommutativeMonoid.html#366" class="Bound">m₁</a> <a id="399" href="Algebra.Solver.CommutativeMonoid.html#369" class="Bound">m₂</a><a id="401" class="Symbol">)</a> <a id="403" class="Keyword">where</a>

<a id="410" class="Keyword">open</a> <a id="415" class="Keyword">import</a> <a id="422" href="Data.Fin.Base.html" class="Module">Data.Fin.Base</a> <a id="436" class="Keyword">using</a> <a id="442" class="Symbol">(</a><a id="443" href="Data.Fin.Base.html#1298" class="Datatype">Fin</a><a id="446" class="Symbol">;</a> <a id="448" href="Data.Fin.Base.html#1320" class="InductiveConstructor">zero</a><a id="452" class="Symbol">;</a> <a id="454" href="Data.Fin.Base.html#1341" class="InductiveConstructor">suc</a><a id="457" class="Symbol">)</a>
<a id="459" class="Keyword">open</a> <a id="464" class="Keyword">import</a> <a id="471" href="Data.Maybe.Base.html" class="Module">Data.Maybe.Base</a> <a id="487" class="Symbol">as</a> <a id="490" class="Module">Maybe</a>
  <a id="498" class="Keyword">using</a> <a id="504" class="Symbol">(</a><a id="505" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a><a id="510" class="Symbol">;</a> <a id="512" href="Data.Maybe.Base.html#1227" class="Function">decToMaybe</a><a id="522" class="Symbol">;</a> <a id="524" href="Data.Maybe.Base.html#1833" class="Function">From-just</a><a id="533" class="Symbol">;</a> <a id="535" href="Data.Maybe.Base.html#1921" class="Function">from-just</a><a id="544" class="Symbol">)</a>
<a id="546" class="Keyword">open</a> <a id="551" class="Keyword">import</a> <a id="558" href="Data.Nat.html" class="Module">Data.Nat</a> <a id="567" class="Symbol">as</a> <a id="570" class="Module">ℕ</a> <a id="572" class="Keyword">using</a> <a id="578" class="Symbol">(</a><a id="579" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="580" class="Symbol">;</a> <a id="582" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a><a id="586" class="Symbol">;</a> <a id="588" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a><a id="591" class="Symbol">;</a> <a id="593" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">_+_</a><a id="596" class="Symbol">)</a>
<a id="598" class="Keyword">open</a> <a id="603" class="Keyword">import</a> <a id="610" href="Data.Nat.GeneralisedArithmetic.html" class="Module">Data.Nat.GeneralisedArithmetic</a> <a id="641" class="Keyword">using</a> <a id="647" class="Symbol">(</a><a id="648" href="Data.Nat.GeneralisedArithmetic.html#564" class="Function">fold</a><a id="652" class="Symbol">)</a>
<a id="654" class="Keyword">open</a> <a id="659" class="Keyword">import</a> <a id="666" href="Data.Product.html" class="Module">Data.Product</a> <a id="679" class="Keyword">using</a> <a id="685" class="Symbol">(</a><a id="686" href="Data.Product.Base.html#1109" class="Function Operator">_×_</a><a id="689" class="Symbol">;</a> <a id="691" href="Data.Product.Base.html#2600" class="Function">uncurry</a><a id="698" class="Symbol">)</a>
<a id="700" class="Keyword">open</a> <a id="705" class="Keyword">import</a> <a id="712" href="Data.Vec.Base.html" class="Module">Data.Vec.Base</a> <a id="726" class="Keyword">using</a> <a id="732" class="Symbol">(</a><a id="733" href="Data.Vec.Base.html#1067" class="Datatype">Vec</a><a id="736" class="Symbol">;</a> <a id="738" href="Data.Vec.Base.html#1103" class="InductiveConstructor">[]</a><a id="740" class="Symbol">;</a> <a id="742" href="Data.Vec.Base.html#1122" class="InductiveConstructor Operator">_∷_</a><a id="745" class="Symbol">;</a> <a id="747" href="Data.Vec.Base.html#1624" class="Function">lookup</a><a id="753" class="Symbol">;</a> <a id="755" href="Data.Vec.Base.html#6385" class="Function">replicate</a><a id="764" class="Symbol">)</a>

<a id="767" class="Keyword">open</a> <a id="772" class="Keyword">import</a> <a id="779" href="Function.Base.html" class="Module">Function.Base</a> <a id="793" class="Keyword">using</a> <a id="799" class="Symbol">(</a><a id="800" href="Function.Base.html#1106" class="Function Operator">_∘_</a><a id="803" class="Symbol">)</a>

<a id="806" class="Keyword">import</a> <a id="813" href="Relation.Binary.Reasoning.Setoid.html" class="Module">Relation.Binary.Reasoning.Setoid</a> <a id="846" class="Symbol">as</a> <a id="849" class="Module">EqReasoning</a>
<a id="861" class="Keyword">import</a> <a id="868" href="Relation.Binary.Reflection.html" class="Module">Relation.Binary.Reflection</a> <a id="895" class="Symbol">as</a> <a id="898" class="Module">Reflection</a>
<a id="909" class="Keyword">import</a> <a id="916" href="Relation.Nullary.Decidable.html" class="Module">Relation.Nullary.Decidable</a> <a id="943" class="Symbol">as</a> <a id="946" class="Module">Dec</a>
<a id="950" class="Keyword">import</a> <a id="957" href="Data.Vec.Relation.Binary.Pointwise.Inductive.html" class="Module">Data.Vec.Relation.Binary.Pointwise.Inductive</a> <a id="1002" class="Symbol">as</a> <a id="1005" class="Module">Pointwise</a>

<a id="1016" class="Keyword">open</a> <a id="1021" class="Keyword">import</a> <a id="1028" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a> <a id="1066" class="Symbol">as</a> <a id="1069" class="Module">P</a> <a id="1071" class="Keyword">using</a> <a id="1077" class="Symbol">(</a><a id="1078" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">_≡_</a><a id="1081" class="Symbol">;</a> <a id="1083" href="Relation.Binary.PropositionalEquality.Properties.html#5521" class="Function">decSetoid</a><a id="1092" class="Symbol">)</a>
<a id="1094" class="Keyword">open</a> <a id="1099" class="Keyword">import</a> <a id="1106" href="Relation.Nullary.Decidable.html" class="Module">Relation.Nullary.Decidable</a> <a id="1133" class="Keyword">using</a> <a id="1139" class="Symbol">(</a><a id="1140" href="Relation.Nullary.Decidable.Core.html#1476" class="Record">Dec</a><a id="1143" class="Symbol">)</a>

<a id="1146" class="Keyword">open</a> <a id="1151" href="Algebra.Bundles.html#6578" class="Module">CommutativeMonoid</a> <a id="1169" href="Algebra.Solver.CommutativeMonoid.html#374" class="Bound">M</a>
<a id="1171" class="Keyword">open</a> <a id="1176" href="Relation.Binary.Reasoning.Setoid.html" class="Module">EqReasoning</a> <a id="1188" href="Algebra.Structures.html#1282" class="Function">setoid</a>

<a id="1196" class="Comment">------------------------------------------------------------------------</a>
<a id="1269" class="Comment">-- Monoid expressions</a>

<a id="1292" class="Comment">-- There is one constructor for every operation, plus one for</a>
<a id="1354" class="Comment">-- variables; there may be at most n variables.</a>

<a id="1403" class="Keyword">infixr</a> <a id="1410" class="Number">5</a> <a id="1412" href="Algebra.Solver.CommutativeMonoid.html#1501" class="InductiveConstructor Operator">_⊕_</a>
<a id="1416" class="Keyword">infixr</a> <a id="1423" class="Number">10</a> <a id="1426" href="Algebra.Solver.CommutativeMonoid.html#2476" class="Function Operator">_•_</a>

<a id="1431" class="Keyword">data</a> <a id="Expr"></a><a id="1436" href="Algebra.Solver.CommutativeMonoid.html#1436" class="Datatype">Expr</a> <a id="1441" class="Symbol">(</a><a id="1442" href="Algebra.Solver.CommutativeMonoid.html#1442" class="Bound">n</a> <a id="1444" class="Symbol">:</a> <a id="1446" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="1447" class="Symbol">)</a> <a id="1449" class="Symbol">:</a> <a id="1451" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="1455" class="Keyword">where</a>
  <a id="Expr.var"></a><a id="1463" href="Algebra.Solver.CommutativeMonoid.html#1463" class="InductiveConstructor">var</a> <a id="1467" class="Symbol">:</a> <a id="1469" href="Data.Fin.Base.html#1298" class="Datatype">Fin</a> <a id="1473" href="Algebra.Solver.CommutativeMonoid.html#1442" class="Bound">n</a> <a id="1475" class="Symbol">→</a> <a id="1477" href="Algebra.Solver.CommutativeMonoid.html#1436" class="Datatype">Expr</a> <a id="1482" href="Algebra.Solver.CommutativeMonoid.html#1442" class="Bound">n</a>
  <a id="Expr.id"></a><a id="1486" href="Algebra.Solver.CommutativeMonoid.html#1486" class="InductiveConstructor">id</a>  <a id="1490" class="Symbol">:</a> <a id="1492" href="Algebra.Solver.CommutativeMonoid.html#1436" class="Datatype">Expr</a> <a id="1497" href="Algebra.Solver.CommutativeMonoid.html#1442" class="Bound">n</a>
  <a id="Expr._⊕_"></a><a id="1501" href="Algebra.Solver.CommutativeMonoid.html#1501" class="InductiveConstructor Operator">_⊕_</a> <a id="1505" class="Symbol">:</a> <a id="1507" href="Algebra.Solver.CommutativeMonoid.html#1436" class="Datatype">Expr</a> <a id="1512" href="Algebra.Solver.CommutativeMonoid.html#1442" class="Bound">n</a> <a id="1514" class="Symbol">→</a> <a id="1516" href="Algebra.Solver.CommutativeMonoid.html#1436" class="Datatype">Expr</a> <a id="1521" href="Algebra.Solver.CommutativeMonoid.html#1442" class="Bound">n</a> <a id="1523" class="Symbol">→</a> <a id="1525" href="Algebra.Solver.CommutativeMonoid.html#1436" class="Datatype">Expr</a> <a id="1530" href="Algebra.Solver.CommutativeMonoid.html#1442" class="Bound">n</a>

<a id="1533" class="Comment">-- An environment contains one value for every variable.</a>

<a id="Env"></a><a id="1591" href="Algebra.Solver.CommutativeMonoid.html#1591" class="Function">Env</a> <a id="1595" class="Symbol">:</a> <a id="1597" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="1599" class="Symbol">→</a> <a id="1601" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="1605" class="Symbol">_</a>
<a id="1607" href="Algebra.Solver.CommutativeMonoid.html#1591" class="Function">Env</a> <a id="1611" href="Algebra.Solver.CommutativeMonoid.html#1611" class="Bound">n</a> <a id="1613" class="Symbol">=</a> <a id="1615" href="Data.Vec.Base.html#1067" class="Datatype">Vec</a> <a id="1619" href="Algebra.Bundles.html#6668" class="Field">Carrier</a> <a id="1627" href="Algebra.Solver.CommutativeMonoid.html#1611" class="Bound">n</a>

<a id="1630" class="Comment">-- The semantics of an expression is a function from an environment to</a>
<a id="1701" class="Comment">-- a value.</a>

<a id="⟦_⟧"></a><a id="1714" href="Algebra.Solver.CommutativeMonoid.html#1714" class="Function Operator">⟦_⟧</a> <a id="1718" class="Symbol">:</a> <a id="1720" class="Symbol">∀</a> <a id="1722" class="Symbol">{</a><a id="1723" href="Algebra.Solver.CommutativeMonoid.html#1723" class="Bound">n</a><a id="1724" class="Symbol">}</a> <a id="1726" class="Symbol">→</a> <a id="1728" href="Algebra.Solver.CommutativeMonoid.html#1436" class="Datatype">Expr</a> <a id="1733" href="Algebra.Solver.CommutativeMonoid.html#1723" class="Bound">n</a> <a id="1735" class="Symbol">→</a> <a id="1737" href="Algebra.Solver.CommutativeMonoid.html#1591" class="Function">Env</a> <a id="1741" href="Algebra.Solver.CommutativeMonoid.html#1723" class="Bound">n</a> <a id="1743" class="Symbol">→</a> <a id="1745" href="Algebra.Bundles.html#6668" class="Field">Carrier</a>
<a id="1753" href="Algebra.Solver.CommutativeMonoid.html#1714" class="Function Operator">⟦</a> <a id="1755" href="Algebra.Solver.CommutativeMonoid.html#1463" class="InductiveConstructor">var</a> <a id="1759" href="Algebra.Solver.CommutativeMonoid.html#1759" class="Bound">x</a>   <a id="1763" href="Algebra.Solver.CommutativeMonoid.html#1714" class="Function Operator">⟧</a> <a id="1765" href="Algebra.Solver.CommutativeMonoid.html#1765" class="Bound">ρ</a> <a id="1767" class="Symbol">=</a> <a id="1769" href="Data.Vec.Base.html#1624" class="Function">lookup</a> <a id="1776" href="Algebra.Solver.CommutativeMonoid.html#1765" class="Bound">ρ</a> <a id="1778" href="Algebra.Solver.CommutativeMonoid.html#1759" class="Bound">x</a>
<a id="1780" href="Algebra.Solver.CommutativeMonoid.html#1714" class="Function Operator">⟦</a> <a id="1782" href="Algebra.Solver.CommutativeMonoid.html#1486" class="InductiveConstructor">id</a>      <a id="1790" href="Algebra.Solver.CommutativeMonoid.html#1714" class="Function Operator">⟧</a> <a id="1792" href="Algebra.Solver.CommutativeMonoid.html#1792" class="Bound">ρ</a> <a id="1794" class="Symbol">=</a> <a id="1796" href="Algebra.Bundles.html#6778" class="Field">ε</a>
<a id="1798" href="Algebra.Solver.CommutativeMonoid.html#1714" class="Function Operator">⟦</a> <a id="1800" href="Algebra.Solver.CommutativeMonoid.html#1800" class="Bound">e₁</a> <a id="1803" href="Algebra.Solver.CommutativeMonoid.html#1501" class="InductiveConstructor Operator">⊕</a> <a id="1805" href="Algebra.Solver.CommutativeMonoid.html#1805" class="Bound">e₂</a> <a id="1808" href="Algebra.Solver.CommutativeMonoid.html#1714" class="Function Operator">⟧</a> <a id="1810" href="Algebra.Solver.CommutativeMonoid.html#1810" class="Bound">ρ</a> <a id="1812" class="Symbol">=</a> <a id="1814" href="Algebra.Solver.CommutativeMonoid.html#1714" class="Function Operator">⟦</a> <a id="1816" href="Algebra.Solver.CommutativeMonoid.html#1800" class="Bound">e₁</a> <a id="1819" href="Algebra.Solver.CommutativeMonoid.html#1714" class="Function Operator">⟧</a> <a id="1821" href="Algebra.Solver.CommutativeMonoid.html#1810" class="Bound">ρ</a> <a id="1823" href="Algebra.Bundles.html#6740" class="Field Operator">∙</a> <a id="1825" href="Algebra.Solver.CommutativeMonoid.html#1714" class="Function Operator">⟦</a> <a id="1827" href="Algebra.Solver.CommutativeMonoid.html#1805" class="Bound">e₂</a> <a id="1830" href="Algebra.Solver.CommutativeMonoid.html#1714" class="Function Operator">⟧</a> <a id="1832" href="Algebra.Solver.CommutativeMonoid.html#1810" class="Bound">ρ</a>

<a id="1835" class="Comment">------------------------------------------------------------------------</a>
<a id="1908" class="Comment">-- Normal forms</a>

<a id="1925" class="Comment">-- A normal form is a vector of multiplicities (a bag).</a>

<a id="Normal"></a><a id="1982" href="Algebra.Solver.CommutativeMonoid.html#1982" class="Function">Normal</a> <a id="1989" class="Symbol">:</a> <a id="1991" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="1993" class="Symbol">→</a> <a id="1995" href="Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="1999" href="Algebra.Solver.CommutativeMonoid.html#1982" class="Function">Normal</a> <a id="2006" href="Algebra.Solver.CommutativeMonoid.html#2006" class="Bound">n</a> <a id="2008" class="Symbol">=</a> <a id="2010" href="Data.Vec.Base.html#1067" class="Datatype">Vec</a> <a id="2014" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="2016" href="Algebra.Solver.CommutativeMonoid.html#2006" class="Bound">n</a>

<a id="2019" class="Comment">-- The semantics of a normal form.</a>

<a id="⟦_⟧⇓"></a><a id="2055" href="Algebra.Solver.CommutativeMonoid.html#2055" class="Function Operator">⟦_⟧⇓</a> <a id="2060" class="Symbol">:</a> <a id="2062" class="Symbol">∀</a> <a id="2064" class="Symbol">{</a><a id="2065" href="Algebra.Solver.CommutativeMonoid.html#2065" class="Bound">n</a><a id="2066" class="Symbol">}</a> <a id="2068" class="Symbol">→</a> <a id="2070" href="Algebra.Solver.CommutativeMonoid.html#1982" class="Function">Normal</a> <a id="2077" href="Algebra.Solver.CommutativeMonoid.html#2065" class="Bound">n</a> <a id="2079" class="Symbol">→</a> <a id="2081" href="Algebra.Solver.CommutativeMonoid.html#1591" class="Function">Env</a> <a id="2085" href="Algebra.Solver.CommutativeMonoid.html#2065" class="Bound">n</a> <a id="2087" class="Symbol">→</a> <a id="2089" href="Algebra.Bundles.html#6668" class="Field">Carrier</a>
<a id="2097" href="Algebra.Solver.CommutativeMonoid.html#2055" class="Function Operator">⟦</a> <a id="2099" href="Data.Vec.Base.html#1103" class="InductiveConstructor">[]</a>    <a id="2105" href="Algebra.Solver.CommutativeMonoid.html#2055" class="Function Operator">⟧⇓</a> <a id="2108" class="Symbol">_</a> <a id="2110" class="Symbol">=</a> <a id="2112" href="Algebra.Bundles.html#6778" class="Field">ε</a>
<a id="2114" href="Algebra.Solver.CommutativeMonoid.html#2055" class="Function Operator">⟦</a> <a id="2116" href="Algebra.Solver.CommutativeMonoid.html#2116" class="Bound">n</a> <a id="2118" href="Data.Vec.Base.html#1122" class="InductiveConstructor Operator">∷</a> <a id="2120" href="Algebra.Solver.CommutativeMonoid.html#2120" class="Bound">v</a> <a id="2122" href="Algebra.Solver.CommutativeMonoid.html#2055" class="Function Operator">⟧⇓</a> <a id="2125" class="Symbol">(</a><a id="2126" href="Algebra.Solver.CommutativeMonoid.html#2126" class="Bound">a</a> <a id="2128" href="Data.Vec.Base.html#1122" class="InductiveConstructor Operator">∷</a> <a id="2130" href="Algebra.Solver.CommutativeMonoid.html#2130" class="Bound">ρ</a><a id="2131" class="Symbol">)</a> <a id="2133" class="Symbol">=</a> <a id="2135" href="Data.Nat.GeneralisedArithmetic.html#564" class="Function">fold</a> <a id="2140" class="Symbol">(</a><a id="2141" href="Algebra.Solver.CommutativeMonoid.html#2055" class="Function Operator">⟦</a> <a id="2143" href="Algebra.Solver.CommutativeMonoid.html#2120" class="Bound">v</a> <a id="2145" href="Algebra.Solver.CommutativeMonoid.html#2055" class="Function Operator">⟧⇓</a> <a id="2148" href="Algebra.Solver.CommutativeMonoid.html#2130" class="Bound">ρ</a><a id="2149" class="Symbol">)</a> <a id="2151" class="Symbol">(λ</a> <a id="2154" href="Algebra.Solver.CommutativeMonoid.html#2154" class="Bound">b</a> <a id="2156" class="Symbol">→</a> <a id="2158" href="Algebra.Solver.CommutativeMonoid.html#2126" class="Bound">a</a> <a id="2160" href="Algebra.Bundles.html#6740" class="Field Operator">∙</a> <a id="2162" href="Algebra.Solver.CommutativeMonoid.html#2154" class="Bound">b</a><a id="2163" class="Symbol">)</a> <a id="2165" href="Algebra.Solver.CommutativeMonoid.html#2116" class="Bound">n</a>

<a id="2168" class="Comment">------------------------------------------------------------------------</a>
<a id="2241" class="Comment">-- Constructions on normal forms</a>

<a id="2275" class="Comment">-- The empty bag.</a>

<a id="empty"></a><a id="2294" href="Algebra.Solver.CommutativeMonoid.html#2294" class="Function">empty</a> <a id="2300" class="Symbol">:</a> <a id="2302" class="Symbol">∀{</a><a id="2304" href="Algebra.Solver.CommutativeMonoid.html#2304" class="Bound">n</a><a id="2305" class="Symbol">}</a> <a id="2307" class="Symbol">→</a> <a id="2309" href="Algebra.Solver.CommutativeMonoid.html#1982" class="Function">Normal</a> <a id="2316" href="Algebra.Solver.CommutativeMonoid.html#2304" class="Bound">n</a>
<a id="2318" href="Algebra.Solver.CommutativeMonoid.html#2294" class="Function">empty</a> <a id="2324" class="Symbol">=</a> <a id="2326" href="Data.Vec.Base.html#6385" class="Function">replicate</a> <a id="2336" class="Number">0</a>

<a id="2339" class="Comment">-- A singleton bag.</a>

<a id="sg"></a><a id="2360" href="Algebra.Solver.CommutativeMonoid.html#2360" class="Function">sg</a> <a id="2363" class="Symbol">:</a> <a id="2365" class="Symbol">∀{</a><a id="2367" href="Algebra.Solver.CommutativeMonoid.html#2367" class="Bound">n</a><a id="2368" class="Symbol">}</a> <a id="2370" class="Symbol">(</a><a id="2371" href="Algebra.Solver.CommutativeMonoid.html#2371" class="Bound">i</a> <a id="2373" class="Symbol">:</a> <a id="2375" href="Data.Fin.Base.html#1298" class="Datatype">Fin</a> <a id="2379" href="Algebra.Solver.CommutativeMonoid.html#2367" class="Bound">n</a><a id="2380" class="Symbol">)</a> <a id="2382" class="Symbol">→</a> <a id="2384" href="Algebra.Solver.CommutativeMonoid.html#1982" class="Function">Normal</a> <a id="2391" href="Algebra.Solver.CommutativeMonoid.html#2367" class="Bound">n</a>
<a id="2393" href="Algebra.Solver.CommutativeMonoid.html#2360" class="Function">sg</a> <a id="2396" href="Data.Fin.Base.html#1320" class="InductiveConstructor">zero</a>    <a id="2404" class="Symbol">=</a> <a id="2406" class="Number">1</a> <a id="2408" href="Data.Vec.Base.html#1122" class="InductiveConstructor Operator">∷</a> <a id="2410" href="Algebra.Solver.CommutativeMonoid.html#2294" class="Function">empty</a>
<a id="2416" href="Algebra.Solver.CommutativeMonoid.html#2360" class="Function">sg</a> <a id="2419" class="Symbol">(</a><a id="2420" href="Data.Fin.Base.html#1341" class="InductiveConstructor">suc</a> <a id="2424" href="Algebra.Solver.CommutativeMonoid.html#2424" class="Bound">i</a><a id="2425" class="Symbol">)</a> <a id="2427" class="Symbol">=</a> <a id="2429" class="Number">0</a> <a id="2431" href="Data.Vec.Base.html#1122" class="InductiveConstructor Operator">∷</a> <a id="2433" href="Algebra.Solver.CommutativeMonoid.html#2360" class="Function">sg</a> <a id="2436" href="Algebra.Solver.CommutativeMonoid.html#2424" class="Bound">i</a>

<a id="2439" class="Comment">-- The composition of normal forms.</a>

<a id="_•_"></a><a id="2476" href="Algebra.Solver.CommutativeMonoid.html#2476" class="Function Operator">_•_</a>  <a id="2481" class="Symbol">:</a> <a id="2483" class="Symbol">∀{</a><a id="2485" href="Algebra.Solver.CommutativeMonoid.html#2485" class="Bound">n</a><a id="2486" class="Symbol">}</a> <a id="2488" class="Symbol">(</a><a id="2489" href="Algebra.Solver.CommutativeMonoid.html#2489" class="Bound">v</a> <a id="2491" href="Algebra.Solver.CommutativeMonoid.html#2491" class="Bound">w</a> <a id="2493" class="Symbol">:</a> <a id="2495" href="Algebra.Solver.CommutativeMonoid.html#1982" class="Function">Normal</a> <a id="2502" href="Algebra.Solver.CommutativeMonoid.html#2485" class="Bound">n</a><a id="2503" class="Symbol">)</a> <a id="2505" class="Symbol">→</a> <a id="2507" href="Algebra.Solver.CommutativeMonoid.html#1982" class="Function">Normal</a> <a id="2514" href="Algebra.Solver.CommutativeMonoid.html#2485" class="Bound">n</a>
<a id="2516" href="Data.Vec.Base.html#1103" class="InductiveConstructor">[]</a>      <a id="2524" href="Algebra.Solver.CommutativeMonoid.html#2476" class="Function Operator">•</a> <a id="2526" href="Data.Vec.Base.html#1103" class="InductiveConstructor">[]</a>      <a id="2534" class="Symbol">=</a> <a id="2536" href="Data.Vec.Base.html#1103" class="InductiveConstructor">[]</a>
<a id="2539" class="Symbol">(</a><a id="2540" href="Algebra.Solver.CommutativeMonoid.html#2540" class="Bound">l</a> <a id="2542" href="Data.Vec.Base.html#1122" class="InductiveConstructor Operator">∷</a> <a id="2544" href="Algebra.Solver.CommutativeMonoid.html#2544" class="Bound">v</a><a id="2545" class="Symbol">)</a> <a id="2547" href="Algebra.Solver.CommutativeMonoid.html#2476" class="Function Operator">•</a> <a id="2549" class="Symbol">(</a><a id="2550" href="Algebra.Solver.CommutativeMonoid.html#2550" class="Bound">m</a> <a id="2552" href="Data.Vec.Base.html#1122" class="InductiveConstructor Operator">∷</a> <a id="2554" href="Algebra.Solver.CommutativeMonoid.html#2554" class="Bound">w</a><a id="2555" class="Symbol">)</a> <a id="2557" class="Symbol">=</a> <a id="2559" href="Algebra.Solver.CommutativeMonoid.html#2540" class="Bound">l</a> <a id="2561" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="2563" href="Algebra.Solver.CommutativeMonoid.html#2550" class="Bound">m</a> <a id="2565" href="Data.Vec.Base.html#1122" class="InductiveConstructor Operator">∷</a> <a id="2567" href="Algebra.Solver.CommutativeMonoid.html#2544" class="Bound">v</a> <a id="2569" href="Algebra.Solver.CommutativeMonoid.html#2476" class="Function Operator">•</a> <a id="2571" href="Algebra.Solver.CommutativeMonoid.html#2554" class="Bound">w</a>

<a id="2574" class="Comment">------------------------------------------------------------------------</a>
<a id="2647" class="Comment">-- Correctness of the constructions on normal forms</a>

<a id="2700" class="Comment">-- The empty bag stands for the unit ε.</a>

<a id="empty-correct"></a><a id="2741" href="Algebra.Solver.CommutativeMonoid.html#2741" class="Function">empty-correct</a> <a id="2755" class="Symbol">:</a> <a id="2757" class="Symbol">∀{</a><a id="2759" href="Algebra.Solver.CommutativeMonoid.html#2759" class="Bound">n</a><a id="2760" class="Symbol">}</a> <a id="2762" class="Symbol">(</a><a id="2763" href="Algebra.Solver.CommutativeMonoid.html#2763" class="Bound">ρ</a> <a id="2765" class="Symbol">:</a> <a id="2767" href="Algebra.Solver.CommutativeMonoid.html#1591" class="Function">Env</a> <a id="2771" href="Algebra.Solver.CommutativeMonoid.html#2759" class="Bound">n</a><a id="2772" class="Symbol">)</a> <a id="2774" class="Symbol">→</a> <a id="2776" href="Algebra.Solver.CommutativeMonoid.html#2055" class="Function Operator">⟦</a> <a id="2778" href="Algebra.Solver.CommutativeMonoid.html#2294" class="Function">empty</a> <a id="2784" href="Algebra.Solver.CommutativeMonoid.html#2055" class="Function Operator">⟧⇓</a> <a id="2787" href="Algebra.Solver.CommutativeMonoid.html#2763" class="Bound">ρ</a> <a id="2789" href="Algebra.Bundles.html#6700" class="Field Operator">≈</a> <a id="2791" href="Algebra.Bundles.html#6778" class="Field">ε</a>
<a id="2793" href="Algebra.Solver.CommutativeMonoid.html#2741" class="Function">empty-correct</a> <a id="2807" href="Data.Vec.Base.html#1103" class="InductiveConstructor">[]</a> <a id="2810" class="Symbol">=</a> <a id="2812" href="Relation.Binary.Structures.html#1582" class="Function">refl</a>
<a id="2817" href="Algebra.Solver.CommutativeMonoid.html#2741" class="Function">empty-correct</a> <a id="2831" class="Symbol">(</a><a id="2832" href="Algebra.Solver.CommutativeMonoid.html#2832" class="Bound">a</a> <a id="2834" href="Data.Vec.Base.html#1122" class="InductiveConstructor Operator">∷</a> <a id="2836" href="Algebra.Solver.CommutativeMonoid.html#2836" class="Bound">ρ</a><a id="2837" class="Symbol">)</a> <a id="2839" class="Symbol">=</a> <a id="2841" href="Algebra.Solver.CommutativeMonoid.html#2741" class="Function">empty-correct</a> <a id="2855" href="Algebra.Solver.CommutativeMonoid.html#2836" class="Bound">ρ</a>

<a id="2858" class="Comment">-- The singleton bag stands for a single variable.</a>

<a id="sg-correct"></a><a id="2910" href="Algebra.Solver.CommutativeMonoid.html#2910" class="Function">sg-correct</a> <a id="2921" class="Symbol">:</a> <a id="2923" class="Symbol">∀{</a><a id="2925" href="Algebra.Solver.CommutativeMonoid.html#2925" class="Bound">n</a><a id="2926" class="Symbol">}</a> <a id="2928" class="Symbol">(</a><a id="2929" href="Algebra.Solver.CommutativeMonoid.html#2929" class="Bound">x</a> <a id="2931" class="Symbol">:</a> <a id="2933" href="Data.Fin.Base.html#1298" class="Datatype">Fin</a> <a id="2937" href="Algebra.Solver.CommutativeMonoid.html#2925" class="Bound">n</a><a id="2938" class="Symbol">)</a> <a id="2940" class="Symbol">(</a><a id="2941" href="Algebra.Solver.CommutativeMonoid.html#2941" class="Bound">ρ</a> <a id="2943" class="Symbol">:</a> <a id="2945" href="Algebra.Solver.CommutativeMonoid.html#1591" class="Function">Env</a> <a id="2949" href="Algebra.Solver.CommutativeMonoid.html#2925" class="Bound">n</a><a id="2950" class="Symbol">)</a> <a id="2952" class="Symbol">→</a>  <a id="2955" href="Algebra.Solver.CommutativeMonoid.html#2055" class="Function Operator">⟦</a> <a id="2957" href="Algebra.Solver.CommutativeMonoid.html#2360" class="Function">sg</a> <a id="2960" href="Algebra.Solver.CommutativeMonoid.html#2929" class="Bound">x</a> <a id="2962" href="Algebra.Solver.CommutativeMonoid.html#2055" class="Function Operator">⟧⇓</a> <a id="2965" href="Algebra.Solver.CommutativeMonoid.html#2941" class="Bound">ρ</a> <a id="2967" href="Algebra.Bundles.html#6700" class="Field Operator">≈</a> <a id="2969" href="Data.Vec.Base.html#1624" class="Function">lookup</a> <a id="2976" href="Algebra.Solver.CommutativeMonoid.html#2941" class="Bound">ρ</a> <a id="2978" href="Algebra.Solver.CommutativeMonoid.html#2929" class="Bound">x</a>
<a id="2980" href="Algebra.Solver.CommutativeMonoid.html#2910" class="Function">sg-correct</a> <a id="2991" href="Data.Fin.Base.html#1320" class="InductiveConstructor">zero</a> <a id="2996" class="Symbol">(</a><a id="2997" href="Algebra.Solver.CommutativeMonoid.html#2997" class="Bound">x</a> <a id="2999" href="Data.Vec.Base.html#1122" class="InductiveConstructor Operator">∷</a> <a id="3001" href="Algebra.Solver.CommutativeMonoid.html#3001" class="Bound">ρ</a><a id="3002" class="Symbol">)</a> <a id="3004" class="Symbol">=</a> <a id="3006" href="Relation.Binary.Reasoning.Base.Single.html#1916" class="Function Operator">begin</a>
    <a id="3016" href="Algebra.Solver.CommutativeMonoid.html#2997" class="Bound">x</a> <a id="3018" href="Algebra.Bundles.html#6740" class="Field Operator">∙</a> <a id="3020" href="Algebra.Solver.CommutativeMonoid.html#2055" class="Function Operator">⟦</a> <a id="3022" href="Algebra.Solver.CommutativeMonoid.html#2294" class="Function">empty</a> <a id="3028" href="Algebra.Solver.CommutativeMonoid.html#2055" class="Function Operator">⟧⇓</a> <a id="3031" href="Algebra.Solver.CommutativeMonoid.html#3001" class="Bound">ρ</a>   <a id="3035" href="Relation.Binary.Reasoning.Setoid.html#1052" class="Function">≈⟨</a> <a id="3038" href="Algebra.Structures.html#1357" class="Function">∙-congˡ</a> <a id="3046" class="Symbol">(</a><a id="3047" href="Algebra.Solver.CommutativeMonoid.html#2741" class="Function">empty-correct</a> <a id="3061" href="Algebra.Solver.CommutativeMonoid.html#3001" class="Bound">ρ</a><a id="3062" class="Symbol">)</a> <a id="3064" href="Relation.Binary.Reasoning.Setoid.html#1052" class="Function">⟩</a>
    <a id="3070" href="Algebra.Solver.CommutativeMonoid.html#2997" class="Bound">x</a> <a id="3072" href="Algebra.Bundles.html#6740" class="Field Operator">∙</a> <a id="3074" href="Algebra.Bundles.html#6778" class="Field">ε</a>              <a id="3089" href="Relation.Binary.Reasoning.Setoid.html#1052" class="Function">≈⟨</a> <a id="3092" href="Algebra.Structures.html#4089" class="Function">identityʳ</a> <a id="3102" class="Symbol">_</a> <a id="3104" href="Relation.Binary.Reasoning.Setoid.html#1052" class="Function">⟩</a>
    <a id="3110" href="Algebra.Solver.CommutativeMonoid.html#2997" class="Bound">x</a>                  <a id="3129" href="Relation.Binary.Reasoning.Base.Single.html#2555" class="Function Operator">∎</a>
<a id="3131" href="Algebra.Solver.CommutativeMonoid.html#2910" class="Function">sg-correct</a> <a id="3142" class="Symbol">(</a><a id="3143" href="Data.Fin.Base.html#1341" class="InductiveConstructor">suc</a> <a id="3147" href="Algebra.Solver.CommutativeMonoid.html#3147" class="Bound">x</a><a id="3148" class="Symbol">)</a> <a id="3150" class="Symbol">(</a><a id="3151" href="Algebra.Solver.CommutativeMonoid.html#3151" class="Bound">m</a> <a id="3153" href="Data.Vec.Base.html#1122" class="InductiveConstructor Operator">∷</a> <a id="3155" href="Algebra.Solver.CommutativeMonoid.html#3155" class="Bound">ρ</a><a id="3156" class="Symbol">)</a> <a id="3158" class="Symbol">=</a> <a id="3160" href="Algebra.Solver.CommutativeMonoid.html#2910" class="Function">sg-correct</a> <a id="3171" href="Algebra.Solver.CommutativeMonoid.html#3147" class="Bound">x</a> <a id="3173" href="Algebra.Solver.CommutativeMonoid.html#3155" class="Bound">ρ</a>

<a id="3176" class="Comment">-- Normal form composition corresponds to the composition of the monoid.</a>

<a id="comp-correct"></a><a id="3250" href="Algebra.Solver.CommutativeMonoid.html#3250" class="Function">comp-correct</a> <a id="3263" class="Symbol">:</a> <a id="3265" class="Symbol">∀</a> <a id="3267" class="Symbol">{</a><a id="3268" href="Algebra.Solver.CommutativeMonoid.html#3268" class="Bound">n</a><a id="3269" class="Symbol">}</a> <a id="3271" class="Symbol">(</a><a id="3272" href="Algebra.Solver.CommutativeMonoid.html#3272" class="Bound">v</a> <a id="3274" href="Algebra.Solver.CommutativeMonoid.html#3274" class="Bound">w</a> <a id="3276" class="Symbol">:</a> <a id="3278" href="Algebra.Solver.CommutativeMonoid.html#1982" class="Function">Normal</a> <a id="3285" href="Algebra.Solver.CommutativeMonoid.html#3268" class="Bound">n</a><a id="3286" class="Symbol">)</a> <a id="3288" class="Symbol">(</a><a id="3289" href="Algebra.Solver.CommutativeMonoid.html#3289" class="Bound">ρ</a> <a id="3291" class="Symbol">:</a> <a id="3293" href="Algebra.Solver.CommutativeMonoid.html#1591" class="Function">Env</a> <a id="3297" href="Algebra.Solver.CommutativeMonoid.html#3268" class="Bound">n</a><a id="3298" class="Symbol">)</a> <a id="3300" class="Symbol">→</a>
              <a id="3316" href="Algebra.Solver.CommutativeMonoid.html#2055" class="Function Operator">⟦</a> <a id="3318" href="Algebra.Solver.CommutativeMonoid.html#3272" class="Bound">v</a> <a id="3320" href="Algebra.Solver.CommutativeMonoid.html#2476" class="Function Operator">•</a> <a id="3322" href="Algebra.Solver.CommutativeMonoid.html#3274" class="Bound">w</a> <a id="3324" href="Algebra.Solver.CommutativeMonoid.html#2055" class="Function Operator">⟧⇓</a> <a id="3327" href="Algebra.Solver.CommutativeMonoid.html#3289" class="Bound">ρ</a> <a id="3329" href="Algebra.Bundles.html#6700" class="Field Operator">≈</a> <a id="3331" class="Symbol">(</a><a id="3332" href="Algebra.Solver.CommutativeMonoid.html#2055" class="Function Operator">⟦</a> <a id="3334" href="Algebra.Solver.CommutativeMonoid.html#3272" class="Bound">v</a> <a id="3336" href="Algebra.Solver.CommutativeMonoid.html#2055" class="Function Operator">⟧⇓</a> <a id="3339" href="Algebra.Solver.CommutativeMonoid.html#3289" class="Bound">ρ</a> <a id="3341" href="Algebra.Bundles.html#6740" class="Field Operator">∙</a> <a id="3343" href="Algebra.Solver.CommutativeMonoid.html#2055" class="Function Operator">⟦</a> <a id="3345" href="Algebra.Solver.CommutativeMonoid.html#3274" class="Bound">w</a> <a id="3347" href="Algebra.Solver.CommutativeMonoid.html#2055" class="Function Operator">⟧⇓</a> <a id="3350" href="Algebra.Solver.CommutativeMonoid.html#3289" class="Bound">ρ</a><a id="3351" class="Symbol">)</a>
<a id="3353" href="Algebra.Solver.CommutativeMonoid.html#3250" class="Function">comp-correct</a> <a id="3366" href="Data.Vec.Base.html#1103" class="InductiveConstructor">[]</a> <a id="3369" href="Data.Vec.Base.html#1103" class="InductiveConstructor">[]</a> <a id="3372" href="Algebra.Solver.CommutativeMonoid.html#3372" class="Bound">ρ</a> <a id="3374" class="Symbol">=</a>  <a id="3377" href="Relation.Binary.Structures.html#1608" class="Function">sym</a> <a id="3381" class="Symbol">(</a><a id="3382" href="Algebra.Structures.html#4028" class="Function">identityˡ</a> <a id="3392" class="Symbol">_)</a>
<a id="3395" href="Algebra.Solver.CommutativeMonoid.html#3250" class="Function">comp-correct</a> <a id="3408" class="Symbol">(</a><a id="3409" href="Algebra.Solver.CommutativeMonoid.html#3409" class="Bound">l</a> <a id="3411" href="Data.Vec.Base.html#1122" class="InductiveConstructor Operator">∷</a> <a id="3413" href="Algebra.Solver.CommutativeMonoid.html#3413" class="Bound">v</a><a id="3414" class="Symbol">)</a> <a id="3416" class="Symbol">(</a><a id="3417" href="Algebra.Solver.CommutativeMonoid.html#3417" class="Bound">m</a> <a id="3419" href="Data.Vec.Base.html#1122" class="InductiveConstructor Operator">∷</a> <a id="3421" href="Algebra.Solver.CommutativeMonoid.html#3421" class="Bound">w</a><a id="3422" class="Symbol">)</a> <a id="3424" class="Symbol">(</a><a id="3425" href="Algebra.Solver.CommutativeMonoid.html#3425" class="Bound">a</a> <a id="3427" href="Data.Vec.Base.html#1122" class="InductiveConstructor Operator">∷</a> <a id="3429" href="Algebra.Solver.CommutativeMonoid.html#3429" class="Bound">ρ</a><a id="3430" class="Symbol">)</a> <a id="3432" class="Symbol">=</a> <a id="3434" href="Algebra.Solver.CommutativeMonoid.html#3701" class="Function">lemma</a> <a id="3440" href="Algebra.Solver.CommutativeMonoid.html#3409" class="Bound">l</a> <a id="3442" href="Algebra.Solver.CommutativeMonoid.html#3417" class="Bound">m</a> <a id="3444" class="Symbol">(</a><a id="3445" href="Algebra.Solver.CommutativeMonoid.html#3250" class="Function">comp-correct</a> <a id="3458" href="Algebra.Solver.CommutativeMonoid.html#3413" class="Bound">v</a> <a id="3460" href="Algebra.Solver.CommutativeMonoid.html#3421" class="Bound">w</a> <a id="3462" href="Algebra.Solver.CommutativeMonoid.html#3429" class="Bound">ρ</a><a id="3463" class="Symbol">)</a>
  <a id="3467" class="Keyword">where</a>
    <a id="3477" href="Algebra.Solver.CommutativeMonoid.html#3477" class="Function">flip12</a> <a id="3484" class="Symbol">:</a> <a id="3486" class="Symbol">∀</a> <a id="3488" href="Algebra.Solver.CommutativeMonoid.html#3488" class="Bound">a</a> <a id="3490" href="Algebra.Solver.CommutativeMonoid.html#3490" class="Bound">b</a> <a id="3492" href="Algebra.Solver.CommutativeMonoid.html#3492" class="Bound">c</a> <a id="3494" class="Symbol">→</a> <a id="3496" href="Algebra.Solver.CommutativeMonoid.html#3488" class="Bound">a</a> <a id="3498" href="Algebra.Bundles.html#6740" class="Field Operator">∙</a> <a id="3500" class="Symbol">(</a><a id="3501" href="Algebra.Solver.CommutativeMonoid.html#3490" class="Bound">b</a> <a id="3503" href="Algebra.Bundles.html#6740" class="Field Operator">∙</a> <a id="3505" href="Algebra.Solver.CommutativeMonoid.html#3492" class="Bound">c</a><a id="3506" class="Symbol">)</a> <a id="3508" href="Algebra.Bundles.html#6700" class="Field Operator">≈</a> <a id="3510" href="Algebra.Solver.CommutativeMonoid.html#3490" class="Bound">b</a> <a id="3512" href="Algebra.Bundles.html#6740" class="Field Operator">∙</a> <a id="3514" class="Symbol">(</a><a id="3515" href="Algebra.Solver.CommutativeMonoid.html#3488" class="Bound">a</a> <a id="3517" href="Algebra.Bundles.html#6740" class="Field Operator">∙</a> <a id="3519" href="Algebra.Solver.CommutativeMonoid.html#3492" class="Bound">c</a><a id="3520" class="Symbol">)</a>
    <a id="3526" href="Algebra.Solver.CommutativeMonoid.html#3477" class="Function">flip12</a> <a id="3533" href="Algebra.Solver.CommutativeMonoid.html#3533" class="Bound">a</a> <a id="3535" href="Algebra.Solver.CommutativeMonoid.html#3535" class="Bound">b</a> <a id="3537" href="Algebra.Solver.CommutativeMonoid.html#3537" class="Bound">c</a> <a id="3539" class="Symbol">=</a> <a id="3541" href="Relation.Binary.Reasoning.Base.Single.html#1916" class="Function Operator">begin</a>
        <a id="3555" href="Algebra.Solver.CommutativeMonoid.html#3533" class="Bound">a</a> <a id="3557" href="Algebra.Bundles.html#6740" class="Field Operator">∙</a> <a id="3559" class="Symbol">(</a><a id="3560" href="Algebra.Solver.CommutativeMonoid.html#3535" class="Bound">b</a> <a id="3562" href="Algebra.Bundles.html#6740" class="Field Operator">∙</a> <a id="3564" href="Algebra.Solver.CommutativeMonoid.html#3537" class="Bound">c</a><a id="3565" class="Symbol">)</a>  <a id="3568" href="Relation.Binary.Reasoning.Setoid.html#1052" class="Function">≈⟨</a> <a id="3571" href="Relation.Binary.Structures.html#1608" class="Function">sym</a> <a id="3575" class="Symbol">(</a><a id="3576" href="Algebra.Structures.html#2869" class="Function">assoc</a> <a id="3582" class="Symbol">_</a> <a id="3584" class="Symbol">_</a> <a id="3586" class="Symbol">_)</a> <a id="3589" href="Relation.Binary.Reasoning.Setoid.html#1052" class="Function">⟩</a>
        <a id="3599" class="Symbol">(</a><a id="3600" href="Algebra.Solver.CommutativeMonoid.html#3533" class="Bound">a</a> <a id="3602" href="Algebra.Bundles.html#6740" class="Field Operator">∙</a> <a id="3604" href="Algebra.Solver.CommutativeMonoid.html#3535" class="Bound">b</a><a id="3605" class="Symbol">)</a> <a id="3607" href="Algebra.Bundles.html#6740" class="Field Operator">∙</a> <a id="3609" href="Algebra.Solver.CommutativeMonoid.html#3537" class="Bound">c</a>  <a id="3612" href="Relation.Binary.Reasoning.Setoid.html#1052" class="Function">≈⟨</a> <a id="3615" href="Algebra.Structures.html#1418" class="Function">∙-congʳ</a> <a id="3623" class="Symbol">(</a><a id="3624" href="Algebra.Structures.html#4376" class="Function">comm</a> <a id="3629" class="Symbol">_</a> <a id="3631" class="Symbol">_)</a> <a id="3634" href="Relation.Binary.Reasoning.Setoid.html#1052" class="Function">⟩</a>
        <a id="3644" class="Symbol">(</a><a id="3645" href="Algebra.Solver.CommutativeMonoid.html#3535" class="Bound">b</a> <a id="3647" href="Algebra.Bundles.html#6740" class="Field Operator">∙</a> <a id="3649" href="Algebra.Solver.CommutativeMonoid.html#3533" class="Bound">a</a><a id="3650" class="Symbol">)</a> <a id="3652" href="Algebra.Bundles.html#6740" class="Field Operator">∙</a> <a id="3654" href="Algebra.Solver.CommutativeMonoid.html#3537" class="Bound">c</a>  <a id="3657" href="Relation.Binary.Reasoning.Setoid.html#1052" class="Function">≈⟨</a> <a id="3660" href="Algebra.Structures.html#2869" class="Function">assoc</a> <a id="3666" class="Symbol">_</a> <a id="3668" class="Symbol">_</a> <a id="3670" class="Symbol">_</a> <a id="3672" href="Relation.Binary.Reasoning.Setoid.html#1052" class="Function">⟩</a>
        <a id="3682" href="Algebra.Solver.CommutativeMonoid.html#3535" class="Bound">b</a> <a id="3684" href="Algebra.Bundles.html#6740" class="Field Operator">∙</a> <a id="3686" class="Symbol">(</a><a id="3687" href="Algebra.Solver.CommutativeMonoid.html#3533" class="Bound">a</a> <a id="3689" href="Algebra.Bundles.html#6740" class="Field Operator">∙</a> <a id="3691" href="Algebra.Solver.CommutativeMonoid.html#3537" class="Bound">c</a><a id="3692" class="Symbol">)</a>  <a id="3695" href="Relation.Binary.Reasoning.Base.Single.html#2555" class="Function Operator">∎</a>
    <a id="3701" href="Algebra.Solver.CommutativeMonoid.html#3701" class="Function">lemma</a> <a id="3707" class="Symbol">:</a> <a id="3709" class="Symbol">∀</a> <a id="3711" href="Algebra.Solver.CommutativeMonoid.html#3711" class="Bound">l</a> <a id="3713" href="Algebra.Solver.CommutativeMonoid.html#3713" class="Bound">m</a> <a id="3715" class="Symbol">{</a><a id="3716" href="Algebra.Solver.CommutativeMonoid.html#3716" class="Bound">d</a> <a id="3718" href="Algebra.Solver.CommutativeMonoid.html#3718" class="Bound">b</a> <a id="3720" href="Algebra.Solver.CommutativeMonoid.html#3720" class="Bound">c</a><a id="3721" class="Symbol">}</a> <a id="3723" class="Symbol">(</a><a id="3724" href="Algebra.Solver.CommutativeMonoid.html#3724" class="Bound">p</a> <a id="3726" class="Symbol">:</a> <a id="3728" href="Algebra.Solver.CommutativeMonoid.html#3716" class="Bound">d</a> <a id="3730" href="Algebra.Bundles.html#6700" class="Field Operator">≈</a> <a id="3732" href="Algebra.Solver.CommutativeMonoid.html#3718" class="Bound">b</a> <a id="3734" href="Algebra.Bundles.html#6740" class="Field Operator">∙</a> <a id="3736" href="Algebra.Solver.CommutativeMonoid.html#3720" class="Bound">c</a><a id="3737" class="Symbol">)</a> <a id="3739" class="Symbol">→</a>
      <a id="3747" href="Data.Nat.GeneralisedArithmetic.html#564" class="Function">fold</a> <a id="3752" href="Algebra.Solver.CommutativeMonoid.html#3716" class="Bound">d</a> <a id="3754" class="Symbol">(</a><a id="3755" href="Algebra.Solver.CommutativeMonoid.html#3425" class="Bound">a</a> <a id="3757" href="Algebra.Bundles.html#6740" class="Field Operator">∙_</a><a id="3759" class="Symbol">)</a> <a id="3761" class="Symbol">(</a><a id="3762" href="Algebra.Solver.CommutativeMonoid.html#3711" class="Bound">l</a> <a id="3764" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="3766" href="Algebra.Solver.CommutativeMonoid.html#3713" class="Bound">m</a><a id="3767" class="Symbol">)</a> <a id="3769" href="Algebra.Bundles.html#6700" class="Field Operator">≈</a> <a id="3771" href="Data.Nat.GeneralisedArithmetic.html#564" class="Function">fold</a> <a id="3776" href="Algebra.Solver.CommutativeMonoid.html#3718" class="Bound">b</a> <a id="3778" class="Symbol">(</a><a id="3779" href="Algebra.Solver.CommutativeMonoid.html#3425" class="Bound">a</a> <a id="3781" href="Algebra.Bundles.html#6740" class="Field Operator">∙_</a><a id="3783" class="Symbol">)</a> <a id="3785" href="Algebra.Solver.CommutativeMonoid.html#3711" class="Bound">l</a> <a id="3787" href="Algebra.Bundles.html#6740" class="Field Operator">∙</a> <a id="3789" href="Data.Nat.GeneralisedArithmetic.html#564" class="Function">fold</a> <a id="3794" href="Algebra.Solver.CommutativeMonoid.html#3720" class="Bound">c</a> <a id="3796" class="Symbol">(</a><a id="3797" href="Algebra.Solver.CommutativeMonoid.html#3425" class="Bound">a</a> <a id="3799" href="Algebra.Bundles.html#6740" class="Field Operator">∙_</a><a id="3801" class="Symbol">)</a> <a id="3803" href="Algebra.Solver.CommutativeMonoid.html#3713" class="Bound">m</a>
    <a id="3809" href="Algebra.Solver.CommutativeMonoid.html#3701" class="Function">lemma</a> <a id="3815" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a> <a id="3820" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a> <a id="3825" href="Algebra.Solver.CommutativeMonoid.html#3825" class="Bound">p</a> <a id="3827" class="Symbol">=</a> <a id="3829" href="Algebra.Solver.CommutativeMonoid.html#3825" class="Bound">p</a>
    <a id="3835" href="Algebra.Solver.CommutativeMonoid.html#3701" class="Function">lemma</a> <a id="3841" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a> <a id="3846" class="Symbol">(</a><a id="3847" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="3851" href="Algebra.Solver.CommutativeMonoid.html#3851" class="Bound">m</a><a id="3852" class="Symbol">)</a> <a id="3854" href="Algebra.Solver.CommutativeMonoid.html#3854" class="Bound">p</a> <a id="3856" class="Symbol">=</a> <a id="3858" href="Relation.Binary.Structures.html#1634" class="Function">trans</a> <a id="3864" class="Symbol">(</a><a id="3865" href="Algebra.Structures.html#1357" class="Function">∙-congˡ</a> <a id="3873" class="Symbol">(</a><a id="3874" href="Algebra.Solver.CommutativeMonoid.html#3701" class="Function">lemma</a> <a id="3880" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a> <a id="3885" href="Algebra.Solver.CommutativeMonoid.html#3851" class="Bound">m</a> <a id="3887" href="Algebra.Solver.CommutativeMonoid.html#3854" class="Bound">p</a><a id="3888" class="Symbol">))</a> <a id="3891" class="Symbol">(</a><a id="3892" href="Algebra.Solver.CommutativeMonoid.html#3477" class="Function">flip12</a> <a id="3899" class="Symbol">_</a> <a id="3901" class="Symbol">_</a> <a id="3903" class="Symbol">_)</a>
    <a id="3910" href="Algebra.Solver.CommutativeMonoid.html#3701" class="Function">lemma</a> <a id="3916" class="Symbol">(</a><a id="3917" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="3921" href="Algebra.Solver.CommutativeMonoid.html#3921" class="Bound">l</a><a id="3922" class="Symbol">)</a> <a id="3924" href="Algebra.Solver.CommutativeMonoid.html#3924" class="Bound">m</a> <a id="3926" href="Algebra.Solver.CommutativeMonoid.html#3926" class="Bound">p</a> <a id="3928" class="Symbol">=</a> <a id="3930" href="Relation.Binary.Structures.html#1634" class="Function">trans</a> <a id="3936" class="Symbol">(</a><a id="3937" href="Algebra.Structures.html#1357" class="Function">∙-congˡ</a> <a id="3945" class="Symbol">(</a><a id="3946" href="Algebra.Solver.CommutativeMonoid.html#3701" class="Function">lemma</a> <a id="3952" href="Algebra.Solver.CommutativeMonoid.html#3921" class="Bound">l</a> <a id="3954" href="Algebra.Solver.CommutativeMonoid.html#3924" class="Bound">m</a> <a id="3956" href="Algebra.Solver.CommutativeMonoid.html#3926" class="Bound">p</a><a id="3957" class="Symbol">))</a> <a id="3960" class="Symbol">(</a><a id="3961" href="Relation.Binary.Structures.html#1608" class="Function">sym</a> <a id="3965" class="Symbol">(</a><a id="3966" href="Algebra.Structures.html#2869" class="Function">assoc</a> <a id="3972" href="Algebra.Solver.CommutativeMonoid.html#3425" class="Bound">a</a> <a id="3974" class="Symbol">_</a> <a id="3976" class="Symbol">_))</a>

<a id="3981" class="Comment">------------------------------------------------------------------------</a>
<a id="4054" class="Comment">-- Normalization</a>

<a id="4072" class="Comment">-- A normaliser.</a>

<a id="normalise"></a><a id="4090" href="Algebra.Solver.CommutativeMonoid.html#4090" class="Function">normalise</a> <a id="4100" class="Symbol">:</a> <a id="4102" class="Symbol">∀</a> <a id="4104" class="Symbol">{</a><a id="4105" href="Algebra.Solver.CommutativeMonoid.html#4105" class="Bound">n</a><a id="4106" class="Symbol">}</a> <a id="4108" class="Symbol">→</a> <a id="4110" href="Algebra.Solver.CommutativeMonoid.html#1436" class="Datatype">Expr</a> <a id="4115" href="Algebra.Solver.CommutativeMonoid.html#4105" class="Bound">n</a> <a id="4117" class="Symbol">→</a> <a id="4119" href="Algebra.Solver.CommutativeMonoid.html#1982" class="Function">Normal</a> <a id="4126" href="Algebra.Solver.CommutativeMonoid.html#4105" class="Bound">n</a>
<a id="4128" href="Algebra.Solver.CommutativeMonoid.html#4090" class="Function">normalise</a> <a id="4138" class="Symbol">(</a><a id="4139" href="Algebra.Solver.CommutativeMonoid.html#1463" class="InductiveConstructor">var</a> <a id="4143" href="Algebra.Solver.CommutativeMonoid.html#4143" class="Bound">x</a><a id="4144" class="Symbol">)</a>   <a id="4148" class="Symbol">=</a> <a id="4150" href="Algebra.Solver.CommutativeMonoid.html#2360" class="Function">sg</a> <a id="4153" href="Algebra.Solver.CommutativeMonoid.html#4143" class="Bound">x</a>
<a id="4155" href="Algebra.Solver.CommutativeMonoid.html#4090" class="Function">normalise</a> <a id="4165" href="Algebra.Solver.CommutativeMonoid.html#1486" class="InductiveConstructor">id</a>        <a id="4175" class="Symbol">=</a> <a id="4177" href="Algebra.Solver.CommutativeMonoid.html#2294" class="Function">empty</a>
<a id="4183" href="Algebra.Solver.CommutativeMonoid.html#4090" class="Function">normalise</a> <a id="4193" class="Symbol">(</a><a id="4194" href="Algebra.Solver.CommutativeMonoid.html#4194" class="Bound">e₁</a> <a id="4197" href="Algebra.Solver.CommutativeMonoid.html#1501" class="InductiveConstructor Operator">⊕</a> <a id="4199" href="Algebra.Solver.CommutativeMonoid.html#4199" class="Bound">e₂</a><a id="4201" class="Symbol">)</a> <a id="4203" class="Symbol">=</a> <a id="4205" href="Algebra.Solver.CommutativeMonoid.html#4090" class="Function">normalise</a> <a id="4215" href="Algebra.Solver.CommutativeMonoid.html#4194" class="Bound">e₁</a> <a id="4218" href="Algebra.Solver.CommutativeMonoid.html#2476" class="Function Operator">•</a> <a id="4220" href="Algebra.Solver.CommutativeMonoid.html#4090" class="Function">normalise</a> <a id="4230" href="Algebra.Solver.CommutativeMonoid.html#4199" class="Bound">e₂</a>

<a id="4234" class="Comment">-- The normaliser preserves the semantics of the expression.</a>

<a id="normalise-correct"></a><a id="4296" href="Algebra.Solver.CommutativeMonoid.html#4296" class="Function">normalise-correct</a> <a id="4314" class="Symbol">:</a> <a id="4316" class="Symbol">∀</a> <a id="4318" class="Symbol">{</a><a id="4319" href="Algebra.Solver.CommutativeMonoid.html#4319" class="Bound">n</a><a id="4320" class="Symbol">}</a> <a id="4322" class="Symbol">(</a><a id="4323" href="Algebra.Solver.CommutativeMonoid.html#4323" class="Bound">e</a> <a id="4325" class="Symbol">:</a> <a id="4327" href="Algebra.Solver.CommutativeMonoid.html#1436" class="Datatype">Expr</a> <a id="4332" href="Algebra.Solver.CommutativeMonoid.html#4319" class="Bound">n</a><a id="4333" class="Symbol">)</a> <a id="4335" class="Symbol">(</a><a id="4336" href="Algebra.Solver.CommutativeMonoid.html#4336" class="Bound">ρ</a> <a id="4338" class="Symbol">:</a> <a id="4340" href="Algebra.Solver.CommutativeMonoid.html#1591" class="Function">Env</a> <a id="4344" href="Algebra.Solver.CommutativeMonoid.html#4319" class="Bound">n</a><a id="4345" class="Symbol">)</a> <a id="4347" class="Symbol">→</a>
    <a id="4353" href="Algebra.Solver.CommutativeMonoid.html#2055" class="Function Operator">⟦</a> <a id="4355" href="Algebra.Solver.CommutativeMonoid.html#4090" class="Function">normalise</a> <a id="4365" href="Algebra.Solver.CommutativeMonoid.html#4323" class="Bound">e</a> <a id="4367" href="Algebra.Solver.CommutativeMonoid.html#2055" class="Function Operator">⟧⇓</a> <a id="4370" href="Algebra.Solver.CommutativeMonoid.html#4336" class="Bound">ρ</a> <a id="4372" href="Algebra.Bundles.html#6700" class="Field Operator">≈</a> <a id="4374" href="Algebra.Solver.CommutativeMonoid.html#1714" class="Function Operator">⟦</a> <a id="4376" href="Algebra.Solver.CommutativeMonoid.html#4323" class="Bound">e</a> <a id="4378" href="Algebra.Solver.CommutativeMonoid.html#1714" class="Function Operator">⟧</a> <a id="4380" href="Algebra.Solver.CommutativeMonoid.html#4336" class="Bound">ρ</a>
<a id="4382" href="Algebra.Solver.CommutativeMonoid.html#4296" class="Function">normalise-correct</a> <a id="4400" class="Symbol">(</a><a id="4401" href="Algebra.Solver.CommutativeMonoid.html#1463" class="InductiveConstructor">var</a> <a id="4405" href="Algebra.Solver.CommutativeMonoid.html#4405" class="Bound">x</a><a id="4406" class="Symbol">)</a>   <a id="4410" href="Algebra.Solver.CommutativeMonoid.html#4410" class="Bound">ρ</a> <a id="4412" class="Symbol">=</a> <a id="4414" href="Algebra.Solver.CommutativeMonoid.html#2910" class="Function">sg-correct</a> <a id="4425" href="Algebra.Solver.CommutativeMonoid.html#4405" class="Bound">x</a> <a id="4427" href="Algebra.Solver.CommutativeMonoid.html#4410" class="Bound">ρ</a>
<a id="4429" href="Algebra.Solver.CommutativeMonoid.html#4296" class="Function">normalise-correct</a> <a id="4447" href="Algebra.Solver.CommutativeMonoid.html#1486" class="InductiveConstructor">id</a>        <a id="4457" href="Algebra.Solver.CommutativeMonoid.html#4457" class="Bound">ρ</a> <a id="4459" class="Symbol">=</a> <a id="4461" href="Algebra.Solver.CommutativeMonoid.html#2741" class="Function">empty-correct</a> <a id="4475" href="Algebra.Solver.CommutativeMonoid.html#4457" class="Bound">ρ</a>
<a id="4477" href="Algebra.Solver.CommutativeMonoid.html#4296" class="Function">normalise-correct</a> <a id="4495" class="Symbol">(</a><a id="4496" href="Algebra.Solver.CommutativeMonoid.html#4496" class="Bound">e₁</a> <a id="4499" href="Algebra.Solver.CommutativeMonoid.html#1501" class="InductiveConstructor Operator">⊕</a> <a id="4501" href="Algebra.Solver.CommutativeMonoid.html#4501" class="Bound">e₂</a><a id="4503" class="Symbol">)</a> <a id="4505" href="Algebra.Solver.CommutativeMonoid.html#4505" class="Bound">ρ</a> <a id="4507" class="Symbol">=</a>  <a id="4510" href="Relation.Binary.Reasoning.Base.Single.html#1916" class="Function Operator">begin</a>

    <a id="4521" href="Algebra.Solver.CommutativeMonoid.html#2055" class="Function Operator">⟦</a> <a id="4523" href="Algebra.Solver.CommutativeMonoid.html#4090" class="Function">normalise</a> <a id="4533" href="Algebra.Solver.CommutativeMonoid.html#4496" class="Bound">e₁</a> <a id="4536" href="Algebra.Solver.CommutativeMonoid.html#2476" class="Function Operator">•</a> <a id="4538" href="Algebra.Solver.CommutativeMonoid.html#4090" class="Function">normalise</a> <a id="4548" href="Algebra.Solver.CommutativeMonoid.html#4501" class="Bound">e₂</a> <a id="4551" href="Algebra.Solver.CommutativeMonoid.html#2055" class="Function Operator">⟧⇓</a> <a id="4554" href="Algebra.Solver.CommutativeMonoid.html#4505" class="Bound">ρ</a>

  <a id="4559" href="Relation.Binary.Reasoning.Setoid.html#1052" class="Function">≈⟨</a> <a id="4562" href="Algebra.Solver.CommutativeMonoid.html#3250" class="Function">comp-correct</a> <a id="4575" class="Symbol">(</a><a id="4576" href="Algebra.Solver.CommutativeMonoid.html#4090" class="Function">normalise</a> <a id="4586" href="Algebra.Solver.CommutativeMonoid.html#4496" class="Bound">e₁</a><a id="4588" class="Symbol">)</a> <a id="4590" class="Symbol">(</a><a id="4591" href="Algebra.Solver.CommutativeMonoid.html#4090" class="Function">normalise</a> <a id="4601" href="Algebra.Solver.CommutativeMonoid.html#4501" class="Bound">e₂</a><a id="4603" class="Symbol">)</a> <a id="4605" href="Algebra.Solver.CommutativeMonoid.html#4505" class="Bound">ρ</a> <a id="4607" href="Relation.Binary.Reasoning.Setoid.html#1052" class="Function">⟩</a>

    <a id="4614" href="Algebra.Solver.CommutativeMonoid.html#2055" class="Function Operator">⟦</a> <a id="4616" href="Algebra.Solver.CommutativeMonoid.html#4090" class="Function">normalise</a> <a id="4626" href="Algebra.Solver.CommutativeMonoid.html#4496" class="Bound">e₁</a> <a id="4629" href="Algebra.Solver.CommutativeMonoid.html#2055" class="Function Operator">⟧⇓</a> <a id="4632" href="Algebra.Solver.CommutativeMonoid.html#4505" class="Bound">ρ</a> <a id="4634" href="Algebra.Bundles.html#6740" class="Field Operator">∙</a> <a id="4636" href="Algebra.Solver.CommutativeMonoid.html#2055" class="Function Operator">⟦</a> <a id="4638" href="Algebra.Solver.CommutativeMonoid.html#4090" class="Function">normalise</a> <a id="4648" href="Algebra.Solver.CommutativeMonoid.html#4501" class="Bound">e₂</a> <a id="4651" href="Algebra.Solver.CommutativeMonoid.html#2055" class="Function Operator">⟧⇓</a> <a id="4654" href="Algebra.Solver.CommutativeMonoid.html#4505" class="Bound">ρ</a>

  <a id="4659" href="Relation.Binary.Reasoning.Setoid.html#1052" class="Function">≈⟨</a> <a id="4662" href="Algebra.Structures.html#1207" class="Function">∙-cong</a> <a id="4669" class="Symbol">(</a><a id="4670" href="Algebra.Solver.CommutativeMonoid.html#4296" class="Function">normalise-correct</a> <a id="4688" href="Algebra.Solver.CommutativeMonoid.html#4496" class="Bound">e₁</a> <a id="4691" href="Algebra.Solver.CommutativeMonoid.html#4505" class="Bound">ρ</a><a id="4692" class="Symbol">)</a> <a id="4694" class="Symbol">(</a><a id="4695" href="Algebra.Solver.CommutativeMonoid.html#4296" class="Function">normalise-correct</a> <a id="4713" href="Algebra.Solver.CommutativeMonoid.html#4501" class="Bound">e₂</a> <a id="4716" href="Algebra.Solver.CommutativeMonoid.html#4505" class="Bound">ρ</a><a id="4717" class="Symbol">)</a> <a id="4719" href="Relation.Binary.Reasoning.Setoid.html#1052" class="Function">⟩</a>

    <a id="4726" href="Algebra.Solver.CommutativeMonoid.html#1714" class="Function Operator">⟦</a> <a id="4728" href="Algebra.Solver.CommutativeMonoid.html#4496" class="Bound">e₁</a> <a id="4731" href="Algebra.Solver.CommutativeMonoid.html#1714" class="Function Operator">⟧</a> <a id="4733" href="Algebra.Solver.CommutativeMonoid.html#4505" class="Bound">ρ</a> <a id="4735" href="Algebra.Bundles.html#6740" class="Field Operator">∙</a> <a id="4737" href="Algebra.Solver.CommutativeMonoid.html#1714" class="Function Operator">⟦</a> <a id="4739" href="Algebra.Solver.CommutativeMonoid.html#4501" class="Bound">e₂</a> <a id="4742" href="Algebra.Solver.CommutativeMonoid.html#1714" class="Function Operator">⟧</a> <a id="4744" href="Algebra.Solver.CommutativeMonoid.html#4505" class="Bound">ρ</a>
  <a id="4748" href="Relation.Binary.Reasoning.Base.Single.html#2555" class="Function Operator">∎</a>

<a id="4751" class="Comment">------------------------------------------------------------------------</a>
<a id="4824" class="Comment">-- &quot;Tactic.</a>

<a id="4837" class="Keyword">open</a> <a id="4842" class="Keyword">module</a> <a id="R"></a><a id="4849" href="Algebra.Solver.CommutativeMonoid.html#4849" class="Module">R</a> <a id="4851" class="Symbol">=</a> <a id="4853" href="Relation.Binary.Reflection.html" class="Module">Reflection</a>
                  <a id="4882" href="Algebra.Structures.html#1282" class="Function">setoid</a> <a id="4889" href="Algebra.Solver.CommutativeMonoid.html#1463" class="InductiveConstructor">var</a> <a id="4893" href="Algebra.Solver.CommutativeMonoid.html#1714" class="Function Operator">⟦_⟧</a> <a id="4897" class="Symbol">(</a><a id="4898" href="Algebra.Solver.CommutativeMonoid.html#2055" class="Function Operator">⟦_⟧⇓</a> <a id="4903" href="Function.Base.html#1106" class="Function Operator">∘</a> <a id="4905" href="Algebra.Solver.CommutativeMonoid.html#4090" class="Function">normalise</a><a id="4914" class="Symbol">)</a> <a id="4916" href="Algebra.Solver.CommutativeMonoid.html#4296" class="Function">normalise-correct</a>
  <a id="4936" class="Keyword">public</a> <a id="4943" class="Keyword">using</a> <a id="4949" class="Symbol">(</a><a id="4950" href="Relation.Binary.Reflection.html#2395" class="Function">solve</a><a id="4955" class="Symbol">;</a> <a id="4957" href="Relation.Binary.Reflection.html#3500" class="Function Operator">_⊜_</a><a id="4960" class="Symbol">)</a>

<a id="4963" class="Comment">-- We can decide if two normal forms are /syntactically/ equal.</a>

<a id="5028" class="Keyword">infix</a> <a id="5034" class="Number">5</a> <a id="5036" href="Algebra.Solver.CommutativeMonoid.html#5041" class="Function Operator">_≟_</a>

<a id="_≟_"></a><a id="5041" href="Algebra.Solver.CommutativeMonoid.html#5041" class="Function Operator">_≟_</a> <a id="5045" class="Symbol">:</a> <a id="5047" class="Symbol">∀</a> <a id="5049" class="Symbol">{</a><a id="5050" href="Algebra.Solver.CommutativeMonoid.html#5050" class="Bound">n</a><a id="5051" class="Symbol">}</a> <a id="5053" class="Symbol">(</a><a id="5054" href="Algebra.Solver.CommutativeMonoid.html#5054" class="Bound">nf₁</a> <a id="5058" href="Algebra.Solver.CommutativeMonoid.html#5058" class="Bound">nf₂</a> <a id="5062" class="Symbol">:</a> <a id="5064" href="Algebra.Solver.CommutativeMonoid.html#1982" class="Function">Normal</a> <a id="5071" href="Algebra.Solver.CommutativeMonoid.html#5050" class="Bound">n</a><a id="5072" class="Symbol">)</a> <a id="5074" class="Symbol">→</a> <a id="5076" href="Relation.Nullary.Decidable.Core.html#1476" class="Record">Dec</a> <a id="5080" class="Symbol">(</a><a id="5081" href="Algebra.Solver.CommutativeMonoid.html#5054" class="Bound">nf₁</a> <a id="5085" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="5087" href="Algebra.Solver.CommutativeMonoid.html#5058" class="Bound">nf₂</a><a id="5090" class="Symbol">)</a>
<a id="5092" href="Algebra.Solver.CommutativeMonoid.html#5092" class="Bound">nf₁</a> <a id="5096" href="Algebra.Solver.CommutativeMonoid.html#5041" class="Function Operator">≟</a> <a id="5098" href="Algebra.Solver.CommutativeMonoid.html#5098" class="Bound">nf₂</a> <a id="5102" class="Symbol">=</a> <a id="5104" href="Relation.Nullary.Decidable.html#1236" class="Function">Dec.map</a> <a id="5112" href="Data.Vec.Relation.Binary.Pointwise.Inductive.html#9073" class="Function">Pointwise-≡↔≡</a> <a id="5126" class="Symbol">(</a><a id="5127" href="Data.Vec.Relation.Binary.Pointwise.Inductive.html#3464" class="Function">decidable</a> <a id="5137" href="Data.Nat.Properties.html#2936" class="Function Operator">ℕ._≟_</a> <a id="5143" href="Algebra.Solver.CommutativeMonoid.html#5092" class="Bound">nf₁</a> <a id="5147" href="Algebra.Solver.CommutativeMonoid.html#5098" class="Bound">nf₂</a><a id="5150" class="Symbol">)</a>
  <a id="5154" class="Keyword">where</a> <a id="5160" class="Keyword">open</a> <a id="5165" href="Data.Vec.Relation.Binary.Pointwise.Inductive.html" class="Module">Pointwise</a>

<a id="5176" class="Comment">-- We can also give a sound, but not necessarily complete, procedure</a>
<a id="5245" class="Comment">-- for determining if two expressions have the same semantics.</a>

<a id="prove′"></a><a id="5309" href="Algebra.Solver.CommutativeMonoid.html#5309" class="Function">prove′</a> <a id="5316" class="Symbol">:</a> <a id="5318" class="Symbol">∀</a> <a id="5320" class="Symbol">{</a><a id="5321" href="Algebra.Solver.CommutativeMonoid.html#5321" class="Bound">n</a><a id="5322" class="Symbol">}</a> <a id="5324" class="Symbol">(</a><a id="5325" href="Algebra.Solver.CommutativeMonoid.html#5325" class="Bound">e₁</a> <a id="5328" href="Algebra.Solver.CommutativeMonoid.html#5328" class="Bound">e₂</a> <a id="5331" class="Symbol">:</a> <a id="5333" href="Algebra.Solver.CommutativeMonoid.html#1436" class="Datatype">Expr</a> <a id="5338" href="Algebra.Solver.CommutativeMonoid.html#5321" class="Bound">n</a><a id="5339" class="Symbol">)</a> <a id="5341" class="Symbol">→</a> <a id="5343" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="5349" class="Symbol">(∀</a> <a id="5352" href="Algebra.Solver.CommutativeMonoid.html#5352" class="Bound">ρ</a> <a id="5354" class="Symbol">→</a> <a id="5356" href="Algebra.Solver.CommutativeMonoid.html#1714" class="Function Operator">⟦</a> <a id="5358" href="Algebra.Solver.CommutativeMonoid.html#5325" class="Bound">e₁</a> <a id="5361" href="Algebra.Solver.CommutativeMonoid.html#1714" class="Function Operator">⟧</a> <a id="5363" href="Algebra.Solver.CommutativeMonoid.html#5352" class="Bound">ρ</a> <a id="5365" href="Algebra.Bundles.html#6700" class="Field Operator">≈</a> <a id="5367" href="Algebra.Solver.CommutativeMonoid.html#1714" class="Function Operator">⟦</a> <a id="5369" href="Algebra.Solver.CommutativeMonoid.html#5328" class="Bound">e₂</a> <a id="5372" href="Algebra.Solver.CommutativeMonoid.html#1714" class="Function Operator">⟧</a> <a id="5374" href="Algebra.Solver.CommutativeMonoid.html#5352" class="Bound">ρ</a><a id="5375" class="Symbol">)</a>
<a id="5377" href="Algebra.Solver.CommutativeMonoid.html#5309" class="Function">prove′</a> <a id="5384" href="Algebra.Solver.CommutativeMonoid.html#5384" class="Bound">e₁</a> <a id="5387" href="Algebra.Solver.CommutativeMonoid.html#5387" class="Bound">e₂</a> <a id="5390" class="Symbol">=</a>
  <a id="5394" href="Data.Maybe.Base.html#2035" class="Function">Maybe.map</a> <a id="5404" href="Algebra.Solver.CommutativeMonoid.html#5463" class="Function">lemma</a> <a id="5410" class="Symbol">(</a><a id="5411" href="Data.Maybe.Base.html#1227" class="Function">decToMaybe</a> <a id="5422" class="Symbol">(</a><a id="5423" href="Algebra.Solver.CommutativeMonoid.html#4090" class="Function">normalise</a> <a id="5433" href="Algebra.Solver.CommutativeMonoid.html#5384" class="Bound">e₁</a> <a id="5436" href="Algebra.Solver.CommutativeMonoid.html#5041" class="Function Operator">≟</a> <a id="5438" href="Algebra.Solver.CommutativeMonoid.html#4090" class="Function">normalise</a> <a id="5448" href="Algebra.Solver.CommutativeMonoid.html#5387" class="Bound">e₂</a><a id="5450" class="Symbol">))</a>
  <a id="5455" class="Keyword">where</a>
  <a id="5463" href="Algebra.Solver.CommutativeMonoid.html#5463" class="Function">lemma</a> <a id="5469" class="Symbol">:</a> <a id="5471" href="Algebra.Solver.CommutativeMonoid.html#4090" class="Function">normalise</a> <a id="5481" href="Algebra.Solver.CommutativeMonoid.html#5384" class="Bound">e₁</a> <a id="5484" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="5486" href="Algebra.Solver.CommutativeMonoid.html#4090" class="Function">normalise</a> <a id="5496" href="Algebra.Solver.CommutativeMonoid.html#5387" class="Bound">e₂</a> <a id="5499" class="Symbol">→</a> <a id="5501" class="Symbol">∀</a> <a id="5503" href="Algebra.Solver.CommutativeMonoid.html#5503" class="Bound">ρ</a> <a id="5505" class="Symbol">→</a> <a id="5507" href="Algebra.Solver.CommutativeMonoid.html#1714" class="Function Operator">⟦</a> <a id="5509" href="Algebra.Solver.CommutativeMonoid.html#5384" class="Bound">e₁</a> <a id="5512" href="Algebra.Solver.CommutativeMonoid.html#1714" class="Function Operator">⟧</a> <a id="5514" href="Algebra.Solver.CommutativeMonoid.html#5503" class="Bound">ρ</a> <a id="5516" href="Algebra.Bundles.html#6700" class="Field Operator">≈</a> <a id="5518" href="Algebra.Solver.CommutativeMonoid.html#1714" class="Function Operator">⟦</a> <a id="5520" href="Algebra.Solver.CommutativeMonoid.html#5387" class="Bound">e₂</a> <a id="5523" href="Algebra.Solver.CommutativeMonoid.html#1714" class="Function Operator">⟧</a> <a id="5525" href="Algebra.Solver.CommutativeMonoid.html#5503" class="Bound">ρ</a>
  <a id="5529" href="Algebra.Solver.CommutativeMonoid.html#5463" class="Function">lemma</a> <a id="5535" href="Algebra.Solver.CommutativeMonoid.html#5535" class="Bound">eq</a> <a id="5538" href="Algebra.Solver.CommutativeMonoid.html#5538" class="Bound">ρ</a> <a id="5540" class="Symbol">=</a>
    <a id="5546" href="Relation.Binary.Reflection.html#1709" class="Function">R.prove</a> <a id="5554" href="Algebra.Solver.CommutativeMonoid.html#5538" class="Bound">ρ</a> <a id="5556" href="Algebra.Solver.CommutativeMonoid.html#5384" class="Bound">e₁</a> <a id="5559" href="Algebra.Solver.CommutativeMonoid.html#5387" class="Bound">e₂</a> <a id="5562" class="Symbol">(</a><a id="5563" href="Relation.Binary.Reasoning.Base.Single.html#1916" class="Function Operator">begin</a>
      <a id="5575" href="Algebra.Solver.CommutativeMonoid.html#2055" class="Function Operator">⟦</a> <a id="5577" href="Algebra.Solver.CommutativeMonoid.html#4090" class="Function">normalise</a> <a id="5587" href="Algebra.Solver.CommutativeMonoid.html#5384" class="Bound">e₁</a> <a id="5590" href="Algebra.Solver.CommutativeMonoid.html#2055" class="Function Operator">⟧⇓</a> <a id="5593" href="Algebra.Solver.CommutativeMonoid.html#5538" class="Bound">ρ</a>  <a id="5596" href="Relation.Binary.Reasoning.Base.Single.html#2182" class="Function">≡⟨</a> <a id="5599" href="Relation.Binary.PropositionalEquality.Core.html#1144" class="Function">P.cong</a> <a id="5606" class="Symbol">(λ</a> <a id="5609" href="Algebra.Solver.CommutativeMonoid.html#5609" class="Bound">e</a> <a id="5611" class="Symbol">→</a> <a id="5613" href="Algebra.Solver.CommutativeMonoid.html#2055" class="Function Operator">⟦</a> <a id="5615" href="Algebra.Solver.CommutativeMonoid.html#5609" class="Bound">e</a> <a id="5617" href="Algebra.Solver.CommutativeMonoid.html#2055" class="Function Operator">⟧⇓</a> <a id="5620" href="Algebra.Solver.CommutativeMonoid.html#5538" class="Bound">ρ</a><a id="5621" class="Symbol">)</a> <a id="5623" href="Algebra.Solver.CommutativeMonoid.html#5535" class="Bound">eq</a> <a id="5626" href="Relation.Binary.Reasoning.Base.Single.html#2182" class="Function">⟩</a>
      <a id="5634" href="Algebra.Solver.CommutativeMonoid.html#2055" class="Function Operator">⟦</a> <a id="5636" href="Algebra.Solver.CommutativeMonoid.html#4090" class="Function">normalise</a> <a id="5646" href="Algebra.Solver.CommutativeMonoid.html#5387" class="Bound">e₂</a> <a id="5649" href="Algebra.Solver.CommutativeMonoid.html#2055" class="Function Operator">⟧⇓</a> <a id="5652" href="Algebra.Solver.CommutativeMonoid.html#5538" class="Bound">ρ</a>  <a id="5655" href="Relation.Binary.Reasoning.Base.Single.html#2555" class="Function Operator">∎</a><a id="5656" class="Symbol">)</a>

<a id="5659" class="Comment">-- This procedure can be combined with from-just.</a>

<a id="prove"></a><a id="5710" href="Algebra.Solver.CommutativeMonoid.html#5710" class="Function">prove</a> <a id="5716" class="Symbol">:</a> <a id="5718" class="Symbol">∀</a> <a id="5720" href="Algebra.Solver.CommutativeMonoid.html#5720" class="Bound">n</a> <a id="5722" class="Symbol">(</a><a id="5723" href="Algebra.Solver.CommutativeMonoid.html#5723" class="Bound">e₁</a> <a id="5726" href="Algebra.Solver.CommutativeMonoid.html#5726" class="Bound">e₂</a> <a id="5729" class="Symbol">:</a> <a id="5731" href="Algebra.Solver.CommutativeMonoid.html#1436" class="Datatype">Expr</a> <a id="5736" href="Algebra.Solver.CommutativeMonoid.html#5720" class="Bound">n</a><a id="5737" class="Symbol">)</a> <a id="5739" class="Symbol">→</a> <a id="5741" href="Data.Maybe.Base.html#1833" class="Function">From-just</a> <a id="5751" class="Symbol">(</a><a id="5752" href="Algebra.Solver.CommutativeMonoid.html#5309" class="Function">prove′</a> <a id="5759" href="Algebra.Solver.CommutativeMonoid.html#5723" class="Bound">e₁</a> <a id="5762" href="Algebra.Solver.CommutativeMonoid.html#5726" class="Bound">e₂</a><a id="5764" class="Symbol">)</a>
<a id="5766" href="Algebra.Solver.CommutativeMonoid.html#5710" class="Function">prove</a> <a id="5772" class="Symbol">_</a> <a id="5774" href="Algebra.Solver.CommutativeMonoid.html#5774" class="Bound">e₁</a> <a id="5777" href="Algebra.Solver.CommutativeMonoid.html#5777" class="Bound">e₂</a> <a id="5780" class="Symbol">=</a> <a id="5782" href="Data.Maybe.Base.html#1921" class="Function">from-just</a> <a id="5792" class="Symbol">(</a><a id="5793" href="Algebra.Solver.CommutativeMonoid.html#5309" class="Function">prove′</a> <a id="5800" href="Algebra.Solver.CommutativeMonoid.html#5774" class="Bound">e₁</a> <a id="5803" href="Algebra.Solver.CommutativeMonoid.html#5777" class="Bound">e₂</a><a id="5805" class="Symbol">)</a>

<a id="5808" class="Comment">-- prove : ∀ n (es : Expr n × Expr n) →</a>
<a id="5848" class="Comment">--         From-just (uncurry prove′ es)</a>
<a id="5889" class="Comment">-- prove _ = from-just ∘ uncurry prove′</a>
</pre></body></html>